cscope 15 $HOME\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\embitz\XRange\Receive-Ping-Florent"               0000501415
	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\apps\Receive-Ping-Florent\XRange\main.c

15 
	~<°rög.h
>

16 
	~<time.h
>

18 
	~"bﬂrd.h
"

19 
	~"ødio.h
"

21 #i‡
deföed
–
USE_BAND_868
 )

24 
	#RF_FREQUENCY
 869150000

25 

	)

26 #ñi‡
deföed
–
USE_BAND_915
 )

28 
	#RF_FREQUENCY
 915000000

29 

	)

34 
	#TX_OUTPUT_POWER
 20

35 

	)

36 #i‡
deföed
–
USE_MODEM_LORA
 )

38 
	#LORA_BANDWIDTH
 0

42 
	#LORA_SPREADING_FACTOR
 12

43 
	#LORA_CODINGRATE
 1

47 
	#LORA_PREAMBLE_LENGTH
 8

48 
	#LORA_SYMBOL_TIMEOUT
 5

49 
	#LORA_FIX_LENGTH_PAYLOAD_ON
 
Ál£


	)

50 
	#LORA_IQ_INVERSION_ON
 
Ál£


	)

52 #ñi‡
deföed
–
USE_MODEM_FSK
 )

54 
	#FSK_FDEV
 25e3

55 
	#FSK_DATARATE
 50e3

56 
	#FSK_BANDWIDTH
 50e3

57 
	#FSK_AFC_BANDWIDTH
 83.333e3

58 
	#FSK_PREAMBLE_LENGTH
 5

59 
	#FSK_FIX_LENGTH_PAYLOAD_ON
 
Ál£


	)

66 
	#LED1_PIN
 
GPIO_PIN_8


	)

67 
	#LED1_GPIO_PORT
 
GPIOA


	)

70 
	#LED2_PIN
 
GPIO_PIN_7


	)

71 
	#LED2_GPIO_PORT
 
GPIOA


	)

73 
	#LED_NB
 2

	)

75 
	#LED_ON
 
GPIO_PIN_SET


	)

76 
	#LED_OFF
 
GPIO_PIN_RESET


	)

80 
	mLED_YELLOW
 = 0,

81 
	mLED_GREEN
 = 1,

82 } 
	ttLed
;

84 
GPIO_Ty≥Def
* 
	gLedP‹t
[
LED_NB
] =

86 
LED1_GPIO_PORT
,

87 
LED2_GPIO_PORT


89 c⁄° 
uöt16_t
 
	gLedPö
[
LED_NB
] =

91 
LED1_PIN
,

92 
LED2_PIN
,

96 
	$LedOn
–
tLed
 
Àd
 )

98 
	`HAL_GPIO_WrôePö
–
LedP‹t
[
Àd
], 
LedPö
[Àd], 
LED_ON
 );

99 
	}
}

101 
	$LedOff
–
tLed
 
Àd
 )

103 
	`HAL_GPIO_WrôePö
–
LedP‹t
[
Àd
], 
LedPö
[Àd], 
LED_OFF
 );

104 
	}
}

106 
	$LedToggÀ
–
tLed
 
Àd
 )

108 
LedP‹t
[
Àd
]->
ODR
 ^
LedPö
[led];

109 
	}
}

111 
	$LedGªíBlök
()

113 
	`LedToggÀ
–
LED_GREEN
 );

114 
	`Dñay
(2);

115 
	`LedToggÀ
–
LED_GREEN
 );

116 
	}
}

118 
	$LedYñlowBlök
()

120 
uöt8_t
 
tmp
;

121 
tmp
=0;Åmp<10;Åmp++) {

122 
	`LedToggÀ
–
LED_YELLOW
 );

123 
	`Dñay
(2);

124 
	`LedToggÀ
–
LED_YELLOW
 );

126 
	}
}

130 
	mLOWPOWER
,

131 
	mRX
,

132 
	mRX_TIMEOUT
,

133 
	mRX_ERROR
,

134 
	mTX
,

135 
	mTX_TIMEOUT


136 }
	tSèãs_t
;

138 
	#RX_TIMEOUT_VALUE
 10000

	)

139 
	#BUFFER_SIZE
 64

140 

	)

142 
uöt16_t
 
	gBuf„rSize
 = 
BUFFER_SIZE
;

143 
uöt8_t
 
	gBuf„r
[
BUFFER_SIZE
];

144 
uöt8_t
 
	gOldBuf„r
[
BUFFER_SIZE
];

146 
Sèãs_t
 
	gSèã
 = 
LOWPOWER
;

148 
öt8_t
 
	gRssiVÆue
 = 0;

149 
öt8_t
 
	gSƒVÆue
 = 0;

154 
RadioEvíts_t
 
	gRadioEvíts
;

159 
OnTxD⁄e
( );

164 
OnRxD⁄e
–
uöt8_t
 *
∑ylﬂd
, 
uöt16_t
 
size
, 
öt16_t
 
rssi
, 
öt8_t
 
¢r
 );

169 
OnTxTimeout
( );

174 
OnRxTimeout
( );

179 
OnRxEº‹
( );

184 
	$maö
( )

187 
Àn_buf
=0;

188 
Buf„rRssiSƒSåög
[
BUFFER_SIZE
]="";

193 
	`BﬂrdInôMcu
( );

194 
	`BﬂrdInôPîùh
( );

197 
RadioEvíts
.
TxD⁄e
 = 
OnTxD⁄e
;

198 
RadioEvíts
.
RxD⁄e
 = 
OnRxD⁄e
;

199 
RadioEvíts
.
TxTimeout
 = 
OnTxTimeout
;

200 
RadioEvíts
.
RxTimeout
 = 
OnRxTimeout
;

201 
RadioEvíts
.
RxEº‹
 = 
OnRxEº‹
;

203 
Radio
.
	`Inô
–&
RadioEvíts
 );

205 
Radio
.
	`SëCh™√l
–
RF_FREQUENCY
 );

207 #i‡
	`deföed
–
USE_MODEM_LORA
 )

209 
Radio
.
	`SëTxC⁄fig
–
MODEM_LORA
, 
TX_OUTPUT_POWER
, 0, 
LORA_BANDWIDTH
,

210 
LORA_SPREADING_FACTOR
, 
LORA_CODINGRATE
,

211 
LORA_PREAMBLE_LENGTH
, 
LORA_FIX_LENGTH_PAYLOAD_ON
,

212 
åue
, 0, 0, 
LORA_IQ_INVERSION_ON
, 3000 );

214 
Radio
.
	`SëRxC⁄fig
–
MODEM_LORA
, 
LORA_BANDWIDTH
, 
LORA_SPREADING_FACTOR
,

215 
LORA_CODINGRATE
, 0, 
LORA_PREAMBLE_LENGTH
,

216 
LORA_SYMBOL_TIMEOUT
, 
LORA_FIX_LENGTH_PAYLOAD_ON
,

217 0, 
åue
, 0, 0, 
LORA_IQ_INVERSION_ON
,Årue );

219 #ñi‡
	`deföed
–
USE_MODEM_FSK
 )

221 
Radio
.
	`SëTxC⁄fig
–
MODEM_FSK
, 
TX_OUTPUT_POWER
, 
FSK_FDEV
, 0,

222 
FSK_DATARATE
, 0,

223 
FSK_PREAMBLE_LENGTH
, 
FSK_FIX_LENGTH_PAYLOAD_ON
,

224 
åue
, 0, 0, 0, 3000 );

226 
Radio
.
	`SëRxC⁄fig
–
MODEM_FSK
, 
FSK_BANDWIDTH
, 
FSK_DATARATE
,

227 0, 
FSK_AFC_BANDWIDTH
, 
FSK_PREAMBLE_LENGTH
,

228 0, 
FSK_FIX_LENGTH_PAYLOAD_ON
, 0, 
åue
,

229 0, 0,
Ál£
, 
åue
 );

247 
	`•rötf
(
Buf„rRssiSƒSåög
,"\r\nInitialisation");

248 
	`U¨tUsbPutBuf„r
(&
U¨tUsb
,
Buf„rRssiSƒSåög
,20);

251 
Radio
.
	`Rx
(125000);

255 
Sèã
) {

256 
TX
:

257 
	`U¨tUsbPutBuf„r
(&
U¨tUsb
,"TX ok",10);

260 
RX
:

266 
	`mem£t
(
Buf„rRssiSƒSåög
,0,(BufferRssiSnrString));

268 
	`•rötf
(
Buf„rRssiSƒSåög
,"\r\n%i%i%i%òC⁄t:%i",
Buf„r
[0],Buffer[1],Buffer[2],Buffer[3],Buffer[9]);

269 
	`U¨tUsbPutBuf„r
(&
U¨tUsb
,
Buf„rRssiSƒSåög
,20);

271 
	`mem£t
(
Buf„rRssiSƒSåög
,0,(BufferRssiSnrString));

273 
	`DñayMs
(100);

274 
Buf„r
[10]=Buffer[9]+10;

275 
Radio
.
	`Síd
–
Buf„r
, 20 );

276 
	`DñayMs
(100);

277 
	`mem£t
(
Buf„rRssiSƒSåög
,0,(BufferRssiSnrString));

315 
Sèã
 = 
LOWPOWER
;

318 
RX_TIMEOUT
:

319 
	`U¨tUsbPutBuf„r
(&
U¨tUsb
,"\r\nTIMEOUT",9);

320 
Sèã
 = 
LOWPOWER
;

322 
TX_TIMEOUT
:

323 
	`U¨tUsbPutBuf„r
(&
U¨tUsb
,"\r\nTX Timeout",10);

324 
Sèã
 = 
LOWPOWER
;

326 
RX_ERROR
:

327 
	`U¨tUsbPutBuf„r
(&
U¨tUsb
,"\r\nERROR",9);

328 
Sèã
 = 
LOWPOWER
;

331 
LOWPOWER
:

342 
Radio
.
	`Rx
(125000);

344 
	}
}

346 
	$OnTxD⁄e
( )

348 
Radio
.
	`SÀï
( );

349 
Sèã
 = 
TX
;

350 
	}
}

352 
	$OnRxD⁄e
–
uöt8_t
 *
∑ylﬂd
, 
uöt16_t
 
size
, 
öt16_t
 
rssi
, 
öt8_t
 
¢r
 )

354 
Radio
.
	`SÀï
( );

355 
Buf„rSize
 = 
size
;

356 
	`mem˝y
–
Buf„r
, 
∑ylﬂd
, 
Buf„rSize
 );

357 
RssiVÆue
 = 
rssi
;

358 
SƒVÆue
 = 
¢r
;

359 
Sèã
 = 
RX
;

360 
	}
}

362 
	$OnTxTimeout
( )

364 
Radio
.
	`SÀï
( );

365 
Sèã
 = 
TX_TIMEOUT
;

366 
	}
}

368 
	$OnRxTimeout
( )

370 
Radio
.
	`SÀï
( );

371 
Sèã
 = 
RX_TIMEOUT
;

372 
	}
}

374 
	$OnRxEº‹
( )

376 
Radio
.
	`SÀï
( );

377 
Sèã
 = 
RX_ERROR
;

378 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\adc-board.c

15 
	~"bﬂrd.h
"

16 
	~"adc-bﬂrd.h
"

18 
ADC_H™dÀTy≥Def
 
	gAdcH™dÀ
;

20 
	$AdcMcuInô
–
Adc_t
 *
obj
, 
PöNames
 
adcI≈ut
 )

22 
AdcH™dÀ
.
In°™˚
 = ( 
ADC_Ty≥Def
* )
ADC1_BASE
;

24 
	`__HAL_RCC_ADC1_CLK_ENABLE
( );

26 
	`HAL_ADC_DeInô
–&
AdcH™dÀ
 );

28 if–
adcI≈ut
 !
NC
 )

30 
	`GpioInô
–&
obj
->
AdcI≈ut
, 
adcI≈ut
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

32 
	}
}

34 
	$AdcMcuC⁄fig
( )

37 
AdcH™dÀ
.
Inô
.
Resﬁuti⁄
 = 
ADC_RESOLUTION_12B
;

38 
AdcH™dÀ
.
Inô
.
D©aAlign
 = 
ADC_DATAALIGN_RIGHT
;

39 
AdcH™dÀ
.
Inô
.
C⁄töuousC⁄vMode
 = 
DISABLE
;

40 
AdcH™dÀ
.
Inô
.
Disc⁄töuousC⁄vMode
 = 
DISABLE
;

41 
AdcH™dÀ
.
Inô
.
Exã∫ÆTrigC⁄vEdge
 = 
ADC_EXTERNALTRIGCONVEDGE_NONE
;

42 
AdcH™dÀ
.
Inô
.
Exã∫ÆTrigC⁄v
 = 
ADC_EXTERNALTRIGCONV_T6_TRGO
;

43 
AdcH™dÀ
.
Inô
.
DMAC⁄töuousReque°s
 = 
DISABLE
;

44 
AdcH™dÀ
.
Inô
.
EOCSñe˘i⁄
 = 
ADC_EOC_SINGLE_CONV
;

45 
AdcH™dÀ
.
Inô
.
NbrOfC⁄vîsi⁄
 = 1;

46 
AdcH™dÀ
.
Inô
.
LowPowîAutoWaô
 = 
DISABLE
;

47 
AdcH™dÀ
.
Inô
.
LowPowîAutoPowîOff
 = 
DISABLE
;

48 
	`HAL_ADC_Inô
–&
AdcH™dÀ
 );

49 
	}
}

51 
uöt16_t
 
	$AdcMcuRódCh™√l
–
Adc_t
 *
obj
, 
uöt32_t
 
ch™√l
 )

53 
ADC_Ch™√lC⁄fTy≥Def
 
adcC⁄f
 = { 0 };

54 
uöt16_t
 
adcD©a
 = 0;

57 
	`__HAL_RCC_HSI_ENABLE
( );

60  
	`__HAL_RCC_GET_FLAG
–
RCC_FLAG_HSIRDY
 ) =
RESET
 )

64 
	`__HAL_RCC_ADC1_CLK_ENABLE
( );

66 
adcC⁄f
.
Ch™√l
 = 
ch™√l
;

67 
adcC⁄f
.
R™k
 = 
ADC_REGULAR_RANK_1
;

68 
adcC⁄f
.
Sam∂ögTime
 = 
ADC_SAMPLETIME_192CYCLES
;

70 
	`HAL_ADC_C⁄figCh™√l
–&
AdcH™dÀ
, &
adcC⁄f
 );

73 
	`__HAL_ADC_ENABLE
–&
AdcH™dÀ
 );

76 
	`HAL_ADC_Sèπ
–&
AdcH™dÀ
 );

78 
	`HAL_ADC_PﬁlF‹C⁄vîsi⁄
–&
AdcH™dÀ
, 
HAL_MAX_DELAY
 );

80 
adcD©a
 = 
	`HAL_ADC_GëVÆue
–&
AdcH™dÀ
 );

82 
	`__HAL_ADC_DISABLE
–&
AdcH™dÀ
 );

84 if––
adcC⁄f
.
Ch™√l
 =
ADC_CHANNEL_TEMPSENSOR
 ) || (ádcC⁄f.Ch™√»=
ADC_CHANNEL_VREFINT
 ) )

86 
	`HAL_ADC_DeInô
–&
AdcH™dÀ
 );

88 
	`__HAL_RCC_ADC1_CLK_DISABLE
( );

91 
	`__HAL_RCC_HSI_DISABLE
( );

93  
adcD©a
;

94 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\board.c

15 
	~"bﬂrd.h
"

20 
	#ID1
 ( 0x1FF80050 )

	)

21 
	#ID2
 ( 0x1FF80054 )

	)

22 
	#ID3
 ( 0x1FF80064 )

	)

27 
Gpio_t
 
	gLed1
;

28 
Gpio_t
 
	gLed2
;

29 
Gpio_t
 
	gLed3
;

31 #i‡
deföed
–
USE_DEBUG_PINS
 )

32 
Gpio_t
 
	gDbgPö1
;

33 
Gpio_t
 
	gDbgPö2
;

34 
Gpio_t
 
	gDbgPö3
;

35 
Gpio_t
 
	gDbgPö4
;

36 
Gpio_t
 
	gDbgPö5
;

42 
Adc_t
 
	gAdc
;

43 
I2c_t
 
	gI2c
;

44 
U¨t_t
 
	gU¨t1
;

45 #i‡
deföed
–
USE_USB_CDC
 )

46 
U¨t_t
 
	gU¨tUsb
;

52 
BﬂrdUnu£dIoInô
( );

57 
Sy°emClockC⁄fig
( );

62 
CÆibøãSy°emWakeupTime
( );

67 
Sy°emClockReC⁄fig
( );

72 
TimîEvít_t
 
	gCÆibøãSy°emWakeupTimeTimî
;

77 
boﬁ
 
	gMcuInôülized
 = 
Ál£
;

82 
boﬁ
 
	gSy°emWakeupTimeCÆibøãd
 = 
Ál£
;

87 
	$OnCÆibøãSy°emWakeupTimeTimîEvít
( )

89 
Sy°emWakeupTimeCÆibøãd
 = 
åue
;

90 
	}
}

97 
uöt8_t
 
	gIrqNe°Levñ
 = 0;

99 
	$BﬂrdDißbÀIrq
( )

101 
	`__dißbÀ_úq
( );

102 
IrqNe°Levñ
++;

103 
	}
}

105 
	$BﬂrdE«bÀIrq
( )

107 
IrqNe°Levñ
--;

108 if–
IrqNe°Levñ
 == 0 )

110 
	`__íabÀ_úq
( );

112 
	}
}

114 
	$BﬂrdInôPîùh
( )

116 
	`GpioInô
–&
Led1
, 
LED_1
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

117 
	`GpioInô
–&
Led2
, 
LED_2
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

118 
	`GpioInô
–&
Led3
, 
LED_3
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

120 
	`GpioWrôe
–&
Led1
, 1 );

121 
	`GpioWrôe
–&
Led2
, 1 );

122 
	`GpioWrôe
–&
Led3
, 1 );

123 
	}
}

125 
	$BﬂrdInôMcu
( )

127 if–
McuInôülized
 =
Ál£
 )

129 #i‡
	`deföed
–
USE_BOOTLOADER
 )

131 
SCB
->
VTOR
 = 
FLASH_BASE
 | 0x3000;

133 
	`HAL_Inô
( );

135 
	`Sy°emClockC⁄fig
( );

137 #i‡
	`deföed
–
USE_USB_CDC
 )

138 
	`U¨tInô
–&
U¨tUsb
, 
UART_USB_CDC
, 
NC
, NC );

139 
	`U¨tC⁄fig
–&
U¨tUsb
, 
RX_TX
, 115200, 
UART_8_BIT
, 
UART_1_STOP_BIT
, 
NO_PARITY
, 
NO_FLOW_CTRL
 );

141 
	`DñayMs
( 1000 );

144 
	`RtcInô
( );

146 
	`BﬂrdUnu£dIoInô
( );

150 #i‡
	`deföed
–
USE_DEBUG_PINS
 )

151 
	`GpioInô
–&
DbgPö1
, 
CON_EXT_1
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

152 
	`GpioInô
–&
DbgPö2
, 
CON_EXT_3
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

153 
	`GpioInô
–&
DbgPö3
, 
CON_EXT_7
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

154 
	`GpioInô
–&
DbgPö4
, 
CON_EXT_8
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

155 
	`GpioInô
–&
DbgPö5
, 
CON_EXT_9
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

160 
	`Sy°emClockReC⁄fig
( );

165 
	`SpiInô
–&
SX1272
.
Spi
, 
RADIO_MOSI
, 
RADIO_MISO
, 
RADIO_SCLK
, 
NC
 );

166 
	`SX1272IoInô
( );

168 if–
McuInôülized
 =
Ál£
 )

170 
McuInôülized
 = 
åue
;

171 if–
	`GëBﬂrdPowîSour˚
–Ë=
BATTERY_POWER
 )

173 
	`CÆibøãSy°emWakeupTime
( );

176 
	}
}

178 
	$BﬂrdDeInôMcu
( )

180 
Gpio_t
 
ioPö
;

182 
	`AdcDeInô
–&
Adc
 );

184 
	`SpiDeInô
–&
SX1272
.
Spi
 );

185 
	`SX1272IoDeInô
( );

187 
	`GpioInô
–&
ioPö
, 
OSC_HSE_IN
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 1 );

188 
	`GpioInô
–&
ioPö
, 
OSC_HSE_OUT
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 1 );

190 
	`GpioInô
–&
ioPö
, 
OSC_LSE_IN
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 1 );

191 
	`GpioInô
–&
ioPö
, 
OSC_LSE_OUT
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 1 );

192 
	}
}

194 
uöt32_t
 
	$BﬂrdGëR™domSìd
( )

196  ( ( *–
uöt32_t
* )
ID1
 ) ^ ( *–uöt32_t* )
ID2
 ) ^ ( *–uöt32_t* )
ID3
 ) );

197 
	}
}

199 
	$BﬂrdGëUniqueId
–
uöt8_t
 *
id
 )

201 
id
[7] = ( ( *–
uöt32_t
* )
ID1
 )+ ( *–uöt32_t* )
ID3
 ) ) >> 24;

202 
id
[6] = ( ( *–
uöt32_t
* )
ID1
 )+ ( *–uöt32_t* )
ID3
 ) ) >> 16;

203 
id
[5] = ( ( *–
uöt32_t
* )
ID1
 )+ ( *–uöt32_t* )
ID3
 ) ) >> 8;

204 
id
[4] = ( ( *–
uöt32_t
* )
ID1
 )+ ( *–uöt32_t* )
ID3
 ) );

205 
id
[3] = ( ( *–
uöt32_t
* )
ID2
 ) ) >> 24;

206 
id
[2] = ( ( *–
uöt32_t
* )
ID2
 ) ) >> 16;

207 
id
[1] = ( ( *–
uöt32_t
* )
ID2
 ) ) >> 8;

208 
id
[0] = ( ( *–
uöt32_t
* )
ID2
 ) );

209 
	}
}

214 
	#FACTORY_POWER_SUPPLY
 3300

215 

	)

219 
	#VREFINT_CAL
 ( *–
uöt16_t
* )0x1FF80078 )

	)

224 
	#ADC_MAX_VALUE
 4095

	)

229 
	#BATTERY_MAX_LEVEL
 9000

230 
	#BATTERY_MIN_LEVEL
 4700

231 
	#BATTERY_SHUTDOWN_LEVEL
 4800

232 

	)

233 
uöt16_t
 
	gB©ãryVﬁège
 = 
BATTERY_MAX_LEVEL
;

235 
uöt16_t
 
	$BﬂrdB©ãryMósuªVﬁage
( )

237 
uöt16_t
 
vdd
 = 0;

238 
uöt16_t
 
vªf
 = 
VREFINT_CAL
;

239 
uöt16_t
 
vdiv
 = 0;

240 
uöt16_t
 
b©ãryVﬁège
 = 0;

242 
vdiv
 = 
	`AdcRódCh™√l
–&
Adc
, 
BAT_LEVEL_CHANNEL
 );

245 
vdd
 = ( )
FACTORY_POWER_SUPPLY
 * ( )
VREFINT_CAL
 / ( )
vªf
;

246 
b©ãryVﬁège
 = 
vdd
 * ( ( )
vdiv
 / ( )
ADC_MAX_VALUE
 );

250 
b©ãryVﬁège
 = 3 * batteryVoltage;

251  
b©ãryVﬁège
;

252 
	}
}

254 
uöt32_t
 
	$BﬂrdGëB©ãryVﬁège
( )

256  
B©ãryVﬁège
;

257 
	}
}

259 
uöt8_t
 
	$BﬂrdGëB©ãryLevñ
( )

261 
uöt8_t
 
b©ãryLevñ
 = 0;

263 
B©ãryVﬁège
 = 
	`BﬂrdB©ãryMósuªVﬁage
( );

265 if–
	`GëBﬂrdPowîSour˚
–Ë=
USB_POWER
 )

267 
b©ãryLevñ
 = 0;

271 if–
B©ãryVﬁège
 >
BATTERY_MAX_LEVEL
 )

273 
b©ãryLevñ
 = 254;

275 if––
B©ãryVﬁège
 > 
BATTERY_MIN_LEVEL
 ) && ( B©ãryVﬁègê< 
BATTERY_MAX_LEVEL
 ) )

277 
b©ãryLevñ
 = ( ( 253 * ( 
B©ãryVﬁège
 - 
BATTERY_MIN_LEVEL
 ) ) / ( 
BATTERY_MAX_LEVEL
 - BATTERY_MIN_LEVEL ) ) + 1;

279 if––
B©ãryVﬁège
 > 
BATTERY_SHUTDOWN_LEVEL
 ) && ( B©ãryVﬁègê<
BATTERY_MIN_LEVEL
 ) )

281 
b©ãryLevñ
 = 1;

285 
b©ãryLevñ
 = 255;

288  
b©ãryLevñ
;

289 
	}
}

291 
	$BﬂrdUnu£dIoInô
( )

293 
Gpio_t
 
ioPö
;

296 #i‡!
	`deföed
–
USE_DEBUG_PINS
 )

297 
	`GpioInô
–&
ioPö
, 
CON_EXT_1
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

298 
	`GpioInô
–&
ioPö
, 
CON_EXT_3
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

299 
	`GpioInô
–&
ioPö
, 
CON_EXT_7
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

300 
	`GpioInô
–&
ioPö
, 
CON_EXT_8
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

301 
	`GpioInô
–&
ioPö
, 
CON_EXT_9
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

304 if–
	`GëBﬂrdPowîSour˚
–Ë=
BATTERY_POWER
 )

306 
	`GpioInô
–&
ioPö
, 
USB_DM
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

307 
	`GpioInô
–&
ioPö
, 
USB_DP
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

310 
	`GpioInô
–&
ioPö
, 
BOOT_1
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

312 
	`GpioInô
–&
ioPö
, 
BAT_LEVEL_PIN
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

314 
	`GpioInô
–&
ioPö
, 
PIN_PB6
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

315 
	`GpioInô
–&
ioPö
, 
WKUP1
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

317 #i‡
	`deföed
–
USE_DEBUGGER
 )

318 
	`HAL_DBGMCU_E«bÀDBGSt›Mode
( );

319 
	`HAL_DBGMCU_E«bÀDBGSÀïMode
( );

320 
	`HAL_DBGMCU_E«bÀDBGSèndbyMode
( );

322 
	`HAL_DBGMCU_DißbÀDBGSÀïMode
( );

323 
	`HAL_DBGMCU_DißbÀDBGSt›Mode
( );

324 
	`HAL_DBGMCU_DißbÀDBGSèndbyMode
( );

326 
	`GpioInô
–&
ioPö
, 
JTAG_TMS
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

327 
	`GpioInô
–&
ioPö
, 
JTAG_TCK
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

328 
	`GpioInô
–&
ioPö
, 
JTAG_TDI
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

329 
	`GpioInô
–&
ioPö
, 
JTAG_TDO
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

330 
	`GpioInô
–&
ioPö
, 
JTAG_NRST
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

332 
	}
}

334 
	$Sy°emClockC⁄fig
( )

336 
RCC_OscInôTy≥Def
 
RCC_OscInôSåu˘
;

337 
RCC_ClkInôTy≥Def
 
RCC_ClkInôSåu˘
;

338 
RCC_PîùhCLKInôTy≥Def
 
PîùhClkInô
;

340 
	`__HAL_RCC_PWR_CLK_ENABLE
( );

342 
	`__HAL_PWR_VOLTAGESCALING_CONFIG
–
PWR_REGULATOR_VOLTAGE_SCALE1
 );

344 
RCC_OscInôSåu˘
.
Oscûœt‹Ty≥
 = 
RCC_OSCILLATORTYPE_HSE
 | 
RCC_OSCILLATORTYPE_LSE
;

345 
RCC_OscInôSåu˘
.
HSESèã
 = 
RCC_HSE_ON
;

346 
RCC_OscInôSåu˘
.
LSESèã
 = 
RCC_LSE_ON
;

347 
RCC_OscInôSåu˘
.
PLL
.
PLLSèã
 = 
RCC_PLL_ON
;

348 
RCC_OscInôSåu˘
.
PLL
.
PLLSour˚
 = 
RCC_PLLSOURCE_HSE
;

349 
RCC_OscInôSåu˘
.
PLL
.
PLLMUL
 = 
RCC_PLL_MUL6
;

350 
RCC_OscInôSåu˘
.
PLL
.
PLLDIV
 = 
RCC_PLL_DIV3
;

351 if–
	`HAL_RCC_OscC⁄fig
–&
RCC_OscInôSåu˘
 ) !
HAL_OK
 )

353 
	`as£π_∑øm
–
FAIL
 );

356 
RCC_ClkInôSåu˘
.
ClockTy≥
 = 
RCC_CLOCKTYPE_HCLK
 | 
RCC_CLOCKTYPE_SYSCLK
 |

357 
RCC_CLOCKTYPE_PCLK1
 | 
RCC_CLOCKTYPE_PCLK2
;

358 
RCC_ClkInôSåu˘
.
SYSCLKSour˚
 = 
RCC_SYSCLKSOURCE_PLLCLK
;

359 
RCC_ClkInôSåu˘
.
AHBCLKDividî
 = 
RCC_SYSCLK_DIV1
;

360 
RCC_ClkInôSåu˘
.
APB1CLKDividî
 = 
RCC_HCLK_DIV1
;

361 
RCC_ClkInôSåu˘
.
APB2CLKDividî
 = 
RCC_HCLK_DIV1
;

362 if–
	`HAL_RCC_ClockC⁄fig
–&
RCC_ClkInôSåu˘
, 
FLASH_LATENCY_1
 ) !
HAL_OK
 )

364 
	`as£π_∑øm
–
FAIL
 );

367 
PîùhClkInô
.
PîùhClockSñe˘i⁄
 = 
RCC_PERIPHCLK_RTC
;

368 
PîùhClkInô
.
RTCClockSñe˘i⁄
 = 
RCC_RTCCLKSOURCE_LSE
;

369 if–
	`HAL_RCCEx_PîùhCLKC⁄fig
–&
PîùhClkInô
 ) !
HAL_OK
 )

371 
	`as£π_∑øm
–
FAIL
 );

374 
	`HAL_SYSTICK_C⁄fig
–
	`HAL_RCC_GëHCLKFªq
( ) / 1000 );

376 
	`HAL_SYSTICK_CLKSour˚C⁄fig
–
SYSTICK_CLKSOURCE_HCLK
 );

379 
	`HAL_NVIC_SëPri‹ôyGroupög
–
NVIC_PRIORITYGROUP_4
 );

382 
	`HAL_NVIC_SëPri‹ôy
–
SysTick_IRQn
, 0, 0 );

383 
	}
}

385 
	$CÆibøãSy°emWakeupTime
( )

387 if–
Sy°emWakeupTimeCÆibøãd
 =
Ál£
 )

389 
	`TimîInô
–&
CÆibøãSy°emWakeupTimeTimî
, 
OnCÆibøãSy°emWakeupTimeTimîEvít
 );

390 
	`TimîSëVÆue
–&
CÆibøãSy°emWakeupTimeTimî
, 1000 );

391 
	`TimîSèπ
–&
CÆibøãSy°emWakeupTimeTimî
 );

392  
Sy°emWakeupTimeCÆibøãd
 =
Ál£
 )

394 
	`TimîLowPowîH™dÀr
( );

397 
	}
}

399 
	$Sy°emClockReC⁄fig
( )

401 
	`__HAL_RCC_PWR_CLK_ENABLE
( );

402 
	`__HAL_PWR_VOLTAGESCALING_CONFIG
–
PWR_REGULATOR_VOLTAGE_SCALE1
 );

405 
	`__HAL_RCC_HSE_CONFIG
–
RCC_HSE_ON
 );

408  
	`__HAL_RCC_GET_FLAG
–
RCC_FLAG_HSERDY
 ) =
RESET
 )

413 
	`__HAL_RCC_PLL_ENABLE
( );

416  
	`__HAL_RCC_GET_FLAG
–
RCC_FLAG_PLLRDY
 ) =
RESET
 )

421 
	`__HAL_RCC_SYSCLK_CONFIG
 ( 
RCC_SYSCLKSOURCE_PLLCLK
 );

424  
	`__HAL_RCC_GET_SYSCLK_SOURCE
–Ë!
RCC_SYSCLKSOURCE_STATUS_PLLCLK
 )

427 
	}
}

429 
	$SysTick_H™dÀr
( )

431 
	`HAL_IncTick
( );

432 
	`HAL_SYSTICK_IRQH™dÀr
( );

433 
	}
}

435 
uöt8_t
 
	$GëBﬂrdPowîSour˚
( )

437 #i‡
	`deföed
–
USE_USB_CDC
 )

438 if–
	`U¨tUsbIsUsbCabÀC⁄√˘ed
( ) == 0 )

440  
BATTERY_POWER
;

444  
USB_POWER
;

447  
BATTERY_POWER
;

449 
	}
}

451 #ifde‡
USE_FULL_ASSERT


461 
	$as£π_Áûed
–
uöt8_t
* 
fûe
, 
uöt32_t
 
löe
 )

470 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\cmsis\arm-gcc\startup_stm32l151xc.s

47 .
sy¡ax
 
	gunifõd


48 .
˝u
 
	gc‹ãx
-
	gm3


49 .
Âu
 
	gso·vÂ


50 .
	gthumb


52 .
globÆ
 
	gg_p‚Ve˘‹s


53 .
globÆ
 
	gDeÁu…_H™dÀr


57 .
w‹d
 
	g_sid©a


59 .
w‹d
 
	g_sd©a


61 .
w‹d
 
	g_ed©a


63 .
w‹d
 
	g_sbss


65 .
w‹d
 
	g_ebss


67 .
equ
 
	gBoŸRAM
, 0xF108F85F

77 .
	g£˘i⁄
 .
	gãxt
.
	gRe£t_H™dÀr


78 .
wók
 
	gRe£t_H™dÀr


79 .
ty≥
 
	gRe£t_H™dÀr
, %
fun˘i⁄


80 
	gRe£t_H™dÀr
:

83 
movs
 
r1
, #0

84 
b
 
Lo›C›yD©aInô


86 
	gC›yD©aInô
:

87 
ldr
 
r3
, =
_sid©a


88 
ldr
 
r3
, [r3, 
r1
]

89 
°r
 
	gr3
, [
r0
, 
r1
]

90 
adds
 
	gr1
,Ñ1, #4

92 
	gLo›C›yD©aInô
:

93 
ldr
 
r0
, =
_sd©a


94 
ldr
 
r3
, =
_ed©a


95 
adds
 
r2
, 
	gr0
, 
r1


96 
cmp
 
	gr2
, 
r3


97 
bcc
 
C›yD©aInô


98 
ldr
 
	gr2
, =
_sbss


99 
b
 
Lo›FûlZîobss


101 
FûlZîobss
:

102 
movs
 
r3
, #0

103 
°r
 
	gr3
, [
r2
], #4

105 
	gLo›FûlZîobss
:

106 
ldr
 
r3
, = 
_ebss


107 
cmp
 
r2
, 
r3


108 
bcc
 
FûlZîobss


111 
bl
 
Sy°emInô


113 
bl
 
__libc_öô_¨øy


115 
bl
 
maö


116 
bx
 
	gÃ


117 .
size
 
	gRe£t_H™dÀr
, .-Reset_Handler

127 .
	g£˘i⁄
 .
	gãxt
.
	gDeÁu…_H™dÀr
,"ax",%
¥ogbôs


128 
	gDeÁu…_H™dÀr
:

129 
Inföôe_Lo›
:

130 
b
 
Inföôe_Lo›


131 .
size
 
DeÁu…_H™dÀr
, .-
	gDeÁu…_H™dÀr


139 .
	g£˘i⁄
 .
	gi§_ve˘‹
,"a",%
	g¥ogbôs


140 .
ty≥
 
	gg_p‚Ve˘‹s
, %
	gobje˘


141 .
size
 
	gg_p‚Ve˘‹s
, .-
g_p‚Ve˘‹s


144 
	gg_p‚Ve˘‹s
:

145 .
w‹d
 
_e°ack


146 .
w‹d
 
Re£t_H™dÀr


147 .
w‹d
 
NMI_H™dÀr


148 .
w‹d
 
H¨dFau…_H™dÀr


149 .
w‹d
 
MemM™age_H™dÀr


150 .
w‹d
 
BusFau…_H™dÀr


151 .
w‹d
 
UßgeFau…_H™dÀr


152 .
w‹d
 0

153 .
w‹d
 0

154 .
w‹d
 0

155 .
w‹d
 0

156 .
w‹d
 
SVC_H™dÀr


157 .
w‹d
 
DebugM⁄_H™dÀr


158 .
w‹d
 0

159 .
w‹d
 
PídSV_H™dÀr


160 .
w‹d
 
SysTick_H™dÀr


161 .
w‹d
 
WWDG_IRQH™dÀr


162 .
w‹d
 
PVD_IRQH™dÀr


163 .
w‹d
 
TAMPER_STAMP_IRQH™dÀr


164 .
w‹d
 
RTC_WKUP_IRQH™dÀr


165 .
w‹d
 
FLASH_IRQH™dÀr


166 .
w‹d
 
RCC_IRQH™dÀr


167 .
w‹d
 
EXTI0_IRQH™dÀr


168 .
w‹d
 
EXTI1_IRQH™dÀr


169 .
w‹d
 
EXTI2_IRQH™dÀr


170 .
w‹d
 
EXTI3_IRQH™dÀr


171 .
w‹d
 
EXTI4_IRQH™dÀr


172 .
w‹d
 
DMA1_Ch™√l1_IRQH™dÀr


173 .
w‹d
 
DMA1_Ch™√l2_IRQH™dÀr


174 .
w‹d
 
DMA1_Ch™√l3_IRQH™dÀr


175 .
w‹d
 
DMA1_Ch™√l4_IRQH™dÀr


176 .
w‹d
 
DMA1_Ch™√l5_IRQH™dÀr


177 .
w‹d
 
DMA1_Ch™√l6_IRQH™dÀr


178 .
w‹d
 
DMA1_Ch™√l7_IRQH™dÀr


179 .
w‹d
 
ADC1_IRQH™dÀr


180 .
w‹d
 
USB_HP_IRQH™dÀr


181 .
w‹d
 
USB_LP_IRQH™dÀr


182 .
w‹d
 
DAC_IRQH™dÀr


183 .
w‹d
 
COMP_IRQH™dÀr


184 .
w‹d
 
EXTI9_5_IRQH™dÀr


185 .
w‹d
 0

186 .
w‹d
 
TIM9_IRQH™dÀr


187 .
w‹d
 
TIM10_IRQH™dÀr


188 .
w‹d
 
TIM11_IRQH™dÀr


189 .
w‹d
 
TIM2_IRQH™dÀr


190 .
w‹d
 
TIM3_IRQH™dÀr


191 .
w‹d
 
TIM4_IRQH™dÀr


192 .
w‹d
 
I2C1_EV_IRQH™dÀr


193 .
w‹d
 
I2C1_ER_IRQH™dÀr


194 .
w‹d
 
I2C2_EV_IRQH™dÀr


195 .
w‹d
 
I2C2_ER_IRQH™dÀr


196 .
w‹d
 
SPI1_IRQH™dÀr


197 .
w‹d
 
SPI2_IRQH™dÀr


198 .
w‹d
 
USART1_IRQH™dÀr


199 .
w‹d
 
USART2_IRQH™dÀr


200 .
w‹d
 
USART3_IRQH™dÀr


201 .
w‹d
 
EXTI15_10_IRQH™dÀr


202 .
w‹d
 
RTC_Aœrm_IRQH™dÀr


203 .
w‹d
 
USB_FS_WKUP_IRQH™dÀr


204 .
w‹d
 
TIM6_IRQH™dÀr


205 .
w‹d
 
TIM7_IRQH™dÀr


206 .
w‹d
 0

207 .
w‹d
 
TIM5_IRQH™dÀr


208 .
w‹d
 
SPI3_IRQH™dÀr


209 .
w‹d
 0

210 .
w‹d
 0

211 .
w‹d
 
DMA2_Ch™√l1_IRQH™dÀr


212 .
w‹d
 
DMA2_Ch™√l2_IRQH™dÀr


213 .
w‹d
 
DMA2_Ch™√l3_IRQH™dÀr


214 .
w‹d
 
DMA2_Ch™√l4_IRQH™dÀr


215 .
w‹d
 
DMA2_Ch™√l5_IRQH™dÀr


216 .
w‹d
 0

217 .
w‹d
 
COMP_ACQ_IRQH™dÀr


218 .
w‹d
 0

219 .
w‹d
 0

220 .
w‹d
 0

221 .
w‹d
 0

222 .
w‹d
 0

223 .
w‹d
 
BoŸRAM


234 .
wók
 
NMI_H™dÀr


235 .
thumb_£t
 
NMI_H™dÀr
,
	gDeÁu…_H™dÀr


237 .
wók
 
	gH¨dFau…_H™dÀr


238 .
thumb_£t
 
	gH¨dFau…_H™dÀr
,
	gDeÁu…_H™dÀr


240 .
wók
 
	gMemM™age_H™dÀr


241 .
thumb_£t
 
	gMemM™age_H™dÀr
,
	gDeÁu…_H™dÀr


243 .
wók
 
	gBusFau…_H™dÀr


244 .
thumb_£t
 
	gBusFau…_H™dÀr
,
	gDeÁu…_H™dÀr


246 .
wók
 
	gUßgeFau…_H™dÀr


247 .
thumb_£t
 
	gUßgeFau…_H™dÀr
,
	gDeÁu…_H™dÀr


249 .
wók
 
	gSVC_H™dÀr


250 .
thumb_£t
 
	gSVC_H™dÀr
,
	gDeÁu…_H™dÀr


252 .
wók
 
	gDebugM⁄_H™dÀr


253 .
thumb_£t
 
	gDebugM⁄_H™dÀr
,
	gDeÁu…_H™dÀr


255 .
wók
 
	gPídSV_H™dÀr


256 .
thumb_£t
 
	gPídSV_H™dÀr
,
	gDeÁu…_H™dÀr


258 .
wók
 
	gSysTick_H™dÀr


259 .
thumb_£t
 
	gSysTick_H™dÀr
,
	gDeÁu…_H™dÀr


261 .
wók
 
	gWWDG_IRQH™dÀr


262 .
thumb_£t
 
	gWWDG_IRQH™dÀr
,
	gDeÁu…_H™dÀr


264 .
wók
 
	gPVD_IRQH™dÀr


265 .
thumb_£t
 
	gPVD_IRQH™dÀr
,
	gDeÁu…_H™dÀr


267 .
wók
 
	gTAMPER_STAMP_IRQH™dÀr


268 .
thumb_£t
 
	gTAMPER_STAMP_IRQH™dÀr
,
	gDeÁu…_H™dÀr


270 .
wók
 
	gRTC_WKUP_IRQH™dÀr


271 .
thumb_£t
 
	gRTC_WKUP_IRQH™dÀr
,
	gDeÁu…_H™dÀr


273 .
wók
 
	gFLASH_IRQH™dÀr


274 .
thumb_£t
 
	gFLASH_IRQH™dÀr
,
	gDeÁu…_H™dÀr


276 .
wók
 
	gRCC_IRQH™dÀr


277 .
thumb_£t
 
	gRCC_IRQH™dÀr
,
	gDeÁu…_H™dÀr


279 .
wók
 
	gEXTI0_IRQH™dÀr


280 .
thumb_£t
 
	gEXTI0_IRQH™dÀr
,
	gDeÁu…_H™dÀr


282 .
wók
 
	gEXTI1_IRQH™dÀr


283 .
thumb_£t
 
	gEXTI1_IRQH™dÀr
,
	gDeÁu…_H™dÀr


285 .
wók
 
	gEXTI2_IRQH™dÀr


286 .
thumb_£t
 
	gEXTI2_IRQH™dÀr
,
	gDeÁu…_H™dÀr


288 .
wók
 
	gEXTI3_IRQH™dÀr


289 .
thumb_£t
 
	gEXTI3_IRQH™dÀr
,
	gDeÁu…_H™dÀr


291 .
wók
 
	gEXTI4_IRQH™dÀr


292 .
thumb_£t
 
	gEXTI4_IRQH™dÀr
,
	gDeÁu…_H™dÀr


294 .
wók
 
	gDMA1_Ch™√l1_IRQH™dÀr


295 .
thumb_£t
 
	gDMA1_Ch™√l1_IRQH™dÀr
,
	gDeÁu…_H™dÀr


297 .
wók
 
	gDMA1_Ch™√l2_IRQH™dÀr


298 .
thumb_£t
 
	gDMA1_Ch™√l2_IRQH™dÀr
,
	gDeÁu…_H™dÀr


300 .
wók
 
	gDMA1_Ch™√l3_IRQH™dÀr


301 .
thumb_£t
 
	gDMA1_Ch™√l3_IRQH™dÀr
,
	gDeÁu…_H™dÀr


303 .
wók
 
	gDMA1_Ch™√l4_IRQH™dÀr


304 .
thumb_£t
 
	gDMA1_Ch™√l4_IRQH™dÀr
,
	gDeÁu…_H™dÀr


306 .
wók
 
	gDMA1_Ch™√l5_IRQH™dÀr


307 .
thumb_£t
 
	gDMA1_Ch™√l5_IRQH™dÀr
,
	gDeÁu…_H™dÀr


309 .
wók
 
	gDMA1_Ch™√l6_IRQH™dÀr


310 .
thumb_£t
 
	gDMA1_Ch™√l6_IRQH™dÀr
,
	gDeÁu…_H™dÀr


312 .
wók
 
	gDMA1_Ch™√l7_IRQH™dÀr


313 .
thumb_£t
 
	gDMA1_Ch™√l7_IRQH™dÀr
,
	gDeÁu…_H™dÀr


315 .
wók
 
	gADC1_IRQH™dÀr


316 .
thumb_£t
 
	gADC1_IRQH™dÀr
,
	gDeÁu…_H™dÀr


318 .
wók
 
	gUSB_HP_IRQH™dÀr


319 .
thumb_£t
 
	gUSB_HP_IRQH™dÀr
,
	gDeÁu…_H™dÀr


321 .
wók
 
	gUSB_LP_IRQH™dÀr


322 .
thumb_£t
 
	gUSB_LP_IRQH™dÀr
,
	gDeÁu…_H™dÀr


324 .
wók
 
	gDAC_IRQH™dÀr


325 .
thumb_£t
 
	gDAC_IRQH™dÀr
,
	gDeÁu…_H™dÀr


327 .
wók
 
	gCOMP_IRQH™dÀr


328 .
thumb_£t
 
	gCOMP_IRQH™dÀr
,
	gDeÁu…_H™dÀr


330 .
wók
 
	gEXTI9_5_IRQH™dÀr


331 .
thumb_£t
 
	gEXTI9_5_IRQH™dÀr
,
	gDeÁu…_H™dÀr


333 .
wók
 
	gTIM9_IRQH™dÀr


334 .
thumb_£t
 
	gTIM9_IRQH™dÀr
,
	gDeÁu…_H™dÀr


336 .
wók
 
	gTIM10_IRQH™dÀr


337 .
thumb_£t
 
	gTIM10_IRQH™dÀr
,
	gDeÁu…_H™dÀr


339 .
wók
 
	gTIM11_IRQH™dÀr


340 .
thumb_£t
 
	gTIM11_IRQH™dÀr
,
	gDeÁu…_H™dÀr


342 .
wók
 
	gTIM2_IRQH™dÀr


343 .
thumb_£t
 
	gTIM2_IRQH™dÀr
,
	gDeÁu…_H™dÀr


345 .
wók
 
	gTIM3_IRQH™dÀr


346 .
thumb_£t
 
	gTIM3_IRQH™dÀr
,
	gDeÁu…_H™dÀr


348 .
wók
 
	gTIM4_IRQH™dÀr


349 .
thumb_£t
 
	gTIM4_IRQH™dÀr
,
	gDeÁu…_H™dÀr


351 .
wók
 
	gI2C1_EV_IRQH™dÀr


352 .
thumb_£t
 
	gI2C1_EV_IRQH™dÀr
,
	gDeÁu…_H™dÀr


354 .
wók
 
	gI2C1_ER_IRQH™dÀr


355 .
thumb_£t
 
	gI2C1_ER_IRQH™dÀr
,
	gDeÁu…_H™dÀr


357 .
wók
 
	gI2C2_EV_IRQH™dÀr


358 .
thumb_£t
 
	gI2C2_EV_IRQH™dÀr
,
	gDeÁu…_H™dÀr


360 .
wók
 
	gI2C2_ER_IRQH™dÀr


361 .
thumb_£t
 
	gI2C2_ER_IRQH™dÀr
,
	gDeÁu…_H™dÀr


363 .
wók
 
	gSPI1_IRQH™dÀr


364 .
thumb_£t
 
	gSPI1_IRQH™dÀr
,
	gDeÁu…_H™dÀr


366 .
wók
 
	gSPI2_IRQH™dÀr


367 .
thumb_£t
 
	gSPI2_IRQH™dÀr
,
	gDeÁu…_H™dÀr


369 .
wók
 
	gUSART1_IRQH™dÀr


370 .
thumb_£t
 
	gUSART1_IRQH™dÀr
,
	gDeÁu…_H™dÀr


372 .
wók
 
	gUSART2_IRQH™dÀr


373 .
thumb_£t
 
	gUSART2_IRQH™dÀr
,
	gDeÁu…_H™dÀr


375 .
wók
 
	gUSART3_IRQH™dÀr


376 .
thumb_£t
 
	gUSART3_IRQH™dÀr
,
	gDeÁu…_H™dÀr


378 .
wók
 
	gEXTI15_10_IRQH™dÀr


379 .
thumb_£t
 
	gEXTI15_10_IRQH™dÀr
,
	gDeÁu…_H™dÀr


381 .
wók
 
	gRTC_Aœrm_IRQH™dÀr


382 .
thumb_£t
 
	gRTC_Aœrm_IRQH™dÀr
,
	gDeÁu…_H™dÀr


384 .
wók
 
	gUSB_FS_WKUP_IRQH™dÀr


385 .
thumb_£t
 
	gUSB_FS_WKUP_IRQH™dÀr
,
	gDeÁu…_H™dÀr


387 .
wók
 
	gTIM6_IRQH™dÀr


388 .
thumb_£t
 
	gTIM6_IRQH™dÀr
,
	gDeÁu…_H™dÀr


390 .
wók
 
	gTIM7_IRQH™dÀr


391 .
thumb_£t
 
	gTIM7_IRQH™dÀr
,
	gDeÁu…_H™dÀr


393 .
wók
 
	gTIM5_IRQH™dÀr


394 .
thumb_£t
 
	gTIM5_IRQH™dÀr
,
	gDeÁu…_H™dÀr


396 .
wók
 
	gSPI3_IRQH™dÀr


397 .
thumb_£t
 
	gSPI3_IRQH™dÀr
,
	gDeÁu…_H™dÀr


399 .
wók
 
	gDMA2_Ch™√l1_IRQH™dÀr


400 .
thumb_£t
 
	gDMA2_Ch™√l1_IRQH™dÀr
,
	gDeÁu…_H™dÀr


402 .
wók
 
	gDMA2_Ch™√l2_IRQH™dÀr


403 .
thumb_£t
 
	gDMA2_Ch™√l2_IRQH™dÀr
,
	gDeÁu…_H™dÀr


405 .
wók
 
	gDMA2_Ch™√l3_IRQH™dÀr


406 .
thumb_£t
 
	gDMA2_Ch™√l3_IRQH™dÀr
,
	gDeÁu…_H™dÀr


408 .
wók
 
	gDMA2_Ch™√l4_IRQH™dÀr


409 .
thumb_£t
 
	gDMA2_Ch™√l4_IRQH™dÀr
,
	gDeÁu…_H™dÀr


411 .
wók
 
	gDMA2_Ch™√l5_IRQH™dÀr


412 .
thumb_£t
 
	gDMA2_Ch™√l5_IRQH™dÀr
,
	gDeÁu…_H™dÀr


414 .
wók
 
	gCOMP_ACQ_IRQH™dÀr


415 .
thumb_£t
 
	gCOMP_ACQ_IRQH™dÀr
,
	gDeÁu…_H™dÀr


	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\cmsis\system_stm32l1xx.c

65 
	~"°m32l1xx.h
"

82 #i‡!
deföed
 (
HSE_VALUE
)

83 
	#HSE_VALUE
 ((
uöt32_t
)8000000Ë

	)

87 #i‡!
deföed
 (
HSI_VALUE
)

88 
	#HSI_VALUE
 ((
uöt32_t
)8000000Ë

	)

99 
	#VECT_TAB_OFFSET
 0x0

	)

124 
uöt32_t
 
	gSy°emC‹eClock
 = 32000000;

125 c⁄° 
uöt8_t
 
	gPLLMulTabÀ
[9] = {3, 4, 6, 8, 12, 16, 24, 32, 48};

126 c⁄° 
uöt8_t
 
	gAHBPªscTabÀ
[16] = {0, 0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 6, 7, 8, 9};

127 c⁄° 
uöt8_t
 
	gAPBPªscTabÀ
[8] = {0, 0, 0, 0, 1, 2, 3, 4};

137 #i‡
deföed
 (
STM32L151xD
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xD
)

138 #ifde‡
DATA_IN_ExtSRAM


139 
Sy°emInô_ExtMemCé
();

158 
	$Sy°emInô
 ()

161 
RCC
->
CR
 |(
uöt32_t
)0x00000100;

164 
RCC
->
CFGR
 &(
uöt32_t
)0x88FFC00C;

167 
RCC
->
CR
 &(
uöt32_t
)0xEEFEFFFE;

170 
RCC
->
CR
 &(
uöt32_t
)0xFFFBFFFF;

173 
RCC
->
CFGR
 &(
uöt32_t
)0xFF02FFFF;

176 
RCC
->
CIR
 = 0x00000000;

178 #ifde‡
DATA_IN_ExtSRAM


179 
	`Sy°emInô_ExtMemCé
();

182 #ifde‡
VECT_TAB_SRAM


183 
SCB
->
VTOR
 = 
SRAM_BASE
 | 
VECT_TAB_OFFSET
;

185 
SCB
->
VTOR
 = 
FLASH_BASE
 | 
VECT_TAB_OFFSET
;

187 
	}
}

227 
	$Sy°emC‹eClockUpd©e
 ()

229 
uöt32_t
 
tmp
 = 0, 
∂lmul
 = 0, 
∂ldiv
 = 0, 
∂lsour˚
 = 0, 
msú™ge
 = 0;

232 
tmp
 = 
RCC
->
CFGR
 & 
RCC_CFGR_SWS
;

234 
tmp
)

237 
msú™ge
 = (
RCC
->
ICSCR
 & 
RCC_ICSCR_MSIRANGE
) >> 13;

238 
Sy°emC‹eClock
 = (32768 * (1 << (
msú™ge
 + 1)));

241 
Sy°emC‹eClock
 = 
HSI_VALUE
;

244 
Sy°emC‹eClock
 = 
HSE_VALUE
;

248 
∂lmul
 = 
RCC
->
CFGR
 & 
RCC_CFGR_PLLMUL
;

249 
∂ldiv
 = 
RCC
->
CFGR
 & 
RCC_CFGR_PLLDIV
;

250 
∂lmul
 = 
PLLMulTabÀ
[(pllmul >> 18)];

251 
∂ldiv
 = (plldiv >> 22) + 1;

253 
∂lsour˚
 = 
RCC
->
CFGR
 & 
RCC_CFGR_PLLSRC
;

255 i‡(
∂lsour˚
 == 0x00)

258 
Sy°emC‹eClock
 = (((
HSI_VALUE
Ë* 
∂lmul
Ë/ 
∂ldiv
);

263 
Sy°emC‹eClock
 = (((
HSE_VALUE
Ë* 
∂lmul
Ë/ 
∂ldiv
);

267 
msú™ge
 = (
RCC
->
ICSCR
 & 
RCC_ICSCR_MSIRANGE
) >> 13;

268 
Sy°emC‹eClock
 = (32768 * (1 << (
msú™ge
 + 1)));

273 
tmp
 = 
AHBPªscTabÀ
[((
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
) >> 4)];

275 
Sy°emC‹eClock
 >>
tmp
;

276 
	}
}

278 #i‡
deföed
 (
STM32L151xD
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xD
)

279 #ifde‡
DATA_IN_ExtSRAM


288 
	$Sy°emInô_ExtMemCé
()

290 
__IO
 
uöt32_t
 
tm¥eg
 = 0;

293 
FLASH
->
ACR
 |
FLASH_ACR_LATENCY
;

296 
RCC
->
APB1ENR
 |
RCC_APB1ENR_PWREN
;

299 
tm¥eg
 = 
	`READ_BIT
(
RCC
->
APB1ENR
, 
RCC_APB1ENR_PWREN
);

302 
PWR
->
CR
 = 
PWR_CR_VOS_0
;

305 (
PWR
->
CSR
 & 
PWR_CSR_VOSF
Ë!
RESET
)

330 
RCC
->
AHBENR
 = 0x000080D8;

333 
tm¥eg
 = 
	`READ_BIT
(
RCC
->
AHBENR
, 
RCC_AHBENR_GPIODEN
);

336 
GPIOD
->
AFR
[0] = 0x00CC00CC;

337 
GPIOD
->
AFR
[1] = 0xCCCCCCCC;

339 
GPIOD
->
MODER
 = 0xAAAA0A0A;

341 
GPIOD
->
OSPEEDR
 = 0xFFFF0F0F;

343 
GPIOD
->
OTYPER
 = 0x00000000;

345 
GPIOD
->
PUPDR
 = 0x00000000;

348 
GPIOE
->
AFR
[0] = 0xC00000CC;

349 
GPIOE
->
AFR
[1] = 0xCCCCCCCC;

351 
GPIOE
->
MODER
 = 0xAAAA800A;

353 
GPIOE
->
OSPEEDR
 = 0xFFFFC00F;

355 
GPIOE
->
OTYPER
 = 0x00000000;

357 
GPIOE
->
PUPDR
 = 0x00000000;

360 
GPIOF
->
AFR
[0] = 0x00CCCCCC;

361 
GPIOF
->
AFR
[1] = 0xCCCC0000;

363 
GPIOF
->
MODER
 = 0xAA000AAA;

365 
GPIOF
->
OSPEEDR
 = 0xFF000FFF;

367 
GPIOF
->
OTYPER
 = 0x00000000;

369 
GPIOF
->
PUPDR
 = 0x00000000;

372 
GPIOG
->
AFR
[0] = 0x00CCCCCC;

373 
GPIOG
->
AFR
[1] = 0x00000C00;

375 
GPIOG
->
MODER
 = 0x00200AAA;

377 
GPIOG
->
OSPEEDR
 = 0x00300FFF;

379 
GPIOG
->
OTYPER
 = 0x00000000;

381 
GPIOG
->
PUPDR
 = 0x00000000;

385 
RCC
->
AHBENR
 = 0x400080D8;

388 
tm¥eg
 = 
	`READ_BIT
(
RCC
->
AHBENR
, 
RCC_AHBENR_FSMCEN
);

390 ()(
tm¥eg
);

393 
FSMC_B™k1
->
BTCR
[4] = 0x00001011;

394 
FSMC_B™k1
->
BTCR
[5] = 0x00000300;

395 
FSMC_B™k1E
->
BWTR
[4] = 0x0FFFFFFF;

428 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\gpio-board.c

15 
	~"bﬂrd.h
"

16 
	~"gpio-bﬂrd.h
"

18 
GpioIrqH™dÀr
 *
	gGpioIrq
[16];

20 
	$GpioMcuInô
–
Gpio_t
 *
obj
, 
PöNames
 
pö
, 
PöModes
 
mode
, 
PöC⁄figs
 
c⁄fig
, 
PöTy≥s
 
ty≥
, 
uöt32_t
 
vÆue
 )

22 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

24 
obj
->
pö
 =Öin;

26 if–
pö
 =
NC
 )

31 
obj
->
pöIndex
 = ( 0x01 << ( obj->
pö
 & 0x0F ) );

33 if––
obj
->
pö
 & 0xF0 ) == 0x00 )

35 
obj
->
p‹t
 = 
GPIOA
;

36 
	`__HAL_RCC_GPIOA_CLK_ENABLE
( );

38 if––
obj
->
pö
 & 0xF0 ) == 0x10 )

40 
obj
->
p‹t
 = 
GPIOB
;

41 
	`__HAL_RCC_GPIOB_CLK_ENABLE
( );

43 if––
obj
->
pö
 & 0xF0 ) == 0x20 )

45 
obj
->
p‹t
 = 
GPIOC
;

46 
	`__HAL_RCC_GPIOC_CLK_ENABLE
( );

48 if––
obj
->
pö
 & 0xF0 ) == 0x30 )

50 
obj
->
p‹t
 = 
GPIOD
;

51 
	`__HAL_RCC_GPIOD_CLK_ENABLE
( );

55 
obj
->
p‹t
 = 
GPIOH
;

56 
	`__HAL_RCC_GPIOH_CLK_ENABLE
( );

59 
GPIO_InôSåu˘uª
.
Pö
 = 
obj
->
pöIndex
 ;

60 
GPIO_InôSåu˘uª
.
PuŒ
 = 
obj
->
puŒ
 = 
ty≥
;

61 
GPIO_InôSåu˘uª
.
S≥ed
 = 
GPIO_SPEED_FREQ_HIGH
;

63 if–
mode
 =
PIN_INPUT
 )

65 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_INPUT
;

67 if–
mode
 =
PIN_ANALOGIC
 )

69 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_ANALOG
;

71 if–
mode
 =
PIN_ALTERNATE_FCT
 )

73 if–
c⁄fig
 =
PIN_OPEN_DRAIN
 )

75 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_AF_OD
;

79 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_AF_PP
;

81 
GPIO_InôSåu˘uª
.
A…î«ã
 = 
vÆue
;

85 if–
c⁄fig
 =
PIN_OPEN_DRAIN
 )

87 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_OUTPUT_OD
;

91 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_OUTPUT_PP
;

95 
	`HAL_GPIO_Inô
–
obj
->
p‹t
, &
GPIO_InôSåu˘uª
 );

98 if–
mode
 =
PIN_OUTPUT
 )

100 
	`GpioMcuWrôe
–
obj
, 
vÆue
 );

102 
	}
}

104 
	$GpioMcuSëI¡îru±
–
Gpio_t
 *
obj
, 
IrqModes
 
úqMode
, 
IrqPri‹ôõs
 
úqPri‹ôy
, 
GpioIrqH™dÀr
 *
úqH™dÀr
 )

106 
uöt32_t
 
¥i‹ôy
 = 0;

108 
IRQn_Ty≥
 
IRQnb
 = 
EXTI0_IRQn
;

109 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

111 if–
úqH™dÀr
 =
NULL
 )

116 
GPIO_InôSåu˘uª
.
Pö
 = 
obj
->
pöIndex
;

118 if–
úqMode
 =
IRQ_RISING_EDGE
 )

120 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_IT_RISING
;

122 if–
úqMode
 =
IRQ_FALLING_EDGE
 )

124 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_IT_FALLING
;

128 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_IT_RISING_FALLING
;

131 
GPIO_InôSåu˘uª
.
PuŒ
 = 
obj
->
puŒ
;

132 
GPIO_InôSåu˘uª
.
S≥ed
 = 
GPIO_SPEED_FREQ_HIGH
;

134 
	`HAL_GPIO_Inô
–
obj
->
p‹t
, &
GPIO_InôSåu˘uª
 );

136  
úqPri‹ôy
 )

138 
IRQ_VERY_LOW_PRIORITY
:

139 
IRQ_LOW_PRIORITY
:

140 
¥i‹ôy
 = 3;

142 
IRQ_MEDIUM_PRIORITY
:

143 
¥i‹ôy
 = 2;

145 
IRQ_HIGH_PRIORITY
:

146 
¥i‹ôy
 = 1;

148 
IRQ_VERY_HIGH_PRIORITY
:

150 
¥i‹ôy
 = 0;

154  
obj
->
pöIndex
 )

156 
GPIO_PIN_0
:

157 
IRQnb
 = 
EXTI0_IRQn
;

159 
GPIO_PIN_1
:

160 
IRQnb
 = 
EXTI1_IRQn
;

162 
GPIO_PIN_2
:

163 
IRQnb
 = 
EXTI2_IRQn
;

165 
GPIO_PIN_3
:

166 
IRQnb
 = 
EXTI3_IRQn
;

168 
GPIO_PIN_4
:

169 
IRQnb
 = 
EXTI4_IRQn
;

171 
GPIO_PIN_5
:

172 
GPIO_PIN_6
:

173 
GPIO_PIN_7
:

174 
GPIO_PIN_8
:

175 
GPIO_PIN_9
:

176 
IRQnb
 = 
EXTI9_5_IRQn
;

178 
GPIO_PIN_10
:

179 
GPIO_PIN_11
:

180 
GPIO_PIN_12
:

181 
GPIO_PIN_13
:

182 
GPIO_PIN_14
:

183 
GPIO_PIN_15
:

184 
IRQnb
 = 
EXTI15_10_IRQn
;

190 
GpioIrq
[–
obj
->
pö
 ) & 0x0F] = 
úqH™dÀr
;

192 
	`HAL_NVIC_SëPri‹ôy
–
IRQnb
 , 
¥i‹ôy
, 0 );

193 
	`HAL_NVIC_E«bÀIRQ
–
IRQnb
 );

194 
	}
}

196 
	$GpioMcuRemoveI¡îru±
–
Gpio_t
 *
obj
 )

198 
GPIO_InôTy≥Def
 
GPIO_InôSåu˘uª
;

200 
GPIO_InôSåu˘uª
.
Pö
 = 
obj
->
pöIndex
 ;

201 
GPIO_InôSåu˘uª
.
Mode
 = 
GPIO_MODE_ANALOG
;

202 
	`HAL_GPIO_Inô
–
obj
->
p‹t
, &
GPIO_InôSåu˘uª
 );

203 
	}
}

205 
	$GpioMcuWrôe
–
Gpio_t
 *
obj
, 
uöt32_t
 
vÆue
 )

207 if––
obj
 =
NULL
 ) || ( obj->
p‹t
 == NULL ) )

209 
	`as£π_∑øm
–
FAIL
 );

212 if–
obj
->
pö
 =
NC
 )

216 
	`HAL_GPIO_WrôePö
–
obj
->
p‹t
, obj->
pöIndex
 , ( 
GPIO_PöSèã
 )
vÆue
 );

217 
	}
}

219 
	$GpioMcuToggÀ
–
Gpio_t
 *
obj
 )

221 if––
obj
 =
NULL
 ) || ( obj->
p‹t
 == NULL ) )

223 
	`as£π_∑øm
–
FAIL
 );

227 if–
obj
->
pö
 =
NC
 )

231 
	`HAL_GPIO_ToggÀPö
–
obj
->
p‹t
, obj->
pöIndex
 );

232 
	}
}

234 
uöt32_t
 
	$GpioMcuRód
–
Gpio_t
 *
obj
 )

236 if–
obj
 =
NULL
 )

238 
	`as£π_∑øm
–
FAIL
 );

241 if–
obj
->
pö
 =
NC
 )

245  
	`HAL_GPIO_RódPö
–
obj
->
p‹t
, obj->
pöIndex
 );

246 
	}
}

248 
	$EXTI0_IRQH™dÀr
( )

250 #i‡!
	`deföed
–
USE_NO_TIMER
 )

251 
	`RtcRecovîMcuSètus
( );

253 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_0
 );

254 
	}
}

256 
	$EXTI1_IRQH™dÀr
( )

258 #i‡!
	`deföed
–
USE_NO_TIMER
 )

259 
	`RtcRecovîMcuSètus
( );

261 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_1
 );

262 
	}
}

264 
	$EXTI2_IRQH™dÀr
( )

266 #i‡!
	`deföed
–
USE_NO_TIMER
 )

267 
	`RtcRecovîMcuSètus
( );

269 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_2
 );

270 
	}
}

272 
	$EXTI3_IRQH™dÀr
( )

274 #i‡!
	`deföed
–
USE_NO_TIMER
 )

275 
	`RtcRecovîMcuSètus
( );

277 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_3
 );

278 
	}
}

280 
	$EXTI4_IRQH™dÀr
( )

282 #i‡!
	`deföed
–
USE_NO_TIMER
 )

283 
	`RtcRecovîMcuSètus
( );

285 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_4
 );

286 
	}
}

288 
	$EXTI9_5_IRQH™dÀr
( )

290 #i‡!
	`deföed
–
USE_NO_TIMER
 )

291 
	`RtcRecovîMcuSètus
( );

293 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_5
 );

294 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_6
 );

295 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_7
 );

296 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_8
 );

297 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_9
 );

298 
	}
}

300 
	$EXTI15_10_IRQH™dÀr
( )

302 #i‡!
	`deföed
–
USE_NO_TIMER
 )

303 
	`RtcRecovîMcuSètus
( );

305 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_10
 );

306 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_11
 );

307 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_12
 );

308 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_13
 );

309 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_14
 );

310 
	`HAL_GPIO_EXTI_IRQH™dÀr
–
GPIO_PIN_15
 );

311 
	}
}

313 
	$HAL_GPIO_EXTI_CÆlback
–
uöt16_t
 
gpioPö
 )

315 
uöt8_t
 
ˇŒbackIndex
 = 0;

317 if–
gpioPö
 > 0 )

319  
gpioPö
 != 0x01 )

321 
gpioPö
 = gpioPin >> 1;

322 
ˇŒbackIndex
++;

326 if–
GpioIrq
[
ˇŒbackIndex
] !
NULL
 )

328 
GpioIrq
[
ˇŒbackIndex
]( );

330 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\i2c-board.c

15 
	~"bﬂrd.h
"

16 
	~"i2c-bﬂrd.h
"

21 
	#TIMEOUT_MAX
 0x8000

	)

23 
I2cAddrSize
 
	gI2cI¡î«lAddrSize
 = 
I2C_ADDR_SIZE_8
;

29 
	mI2C_1
 = ( 
uöt32_t
 )
I2C1_BASE
,

30 
	mI2C_2
 = ( 
uöt32_t
 )
I2C2_BASE
,

31 } 
	tI2cName
;

33 
	$I2cMcuInô
–
I2c_t
 *
obj
, 
PöNames
 
s˛
, PöName†
sda
 )

35 
	`__HAL_RCC_I2C1_CLK_DISABLE
( );

36 
	`__HAL_RCC_I2C1_CLK_ENABLE
( );

37 
	`__HAL_RCC_I2C1_FORCE_RESET
( );

38 
	`__HAL_RCC_I2C1_RELEASE_RESET
( );

40 
obj
->
I2c
.
In°™˚
 = ( 
I2C_Ty≥Def
 * )
I2C1_BASE
;

42 
	`GpioInô
–&
obj
->
S˛
, 
s˛
, 
PIN_ALTERNATE_FCT
, 
PIN_OPEN_DRAIN
, 
PIN_NO_PULL
, 
GPIO_AF4_I2C1
 );

43 
	`GpioInô
–&
obj
->
Sda
, 
sda
, 
PIN_ALTERNATE_FCT
, 
PIN_OPEN_DRAIN
, 
PIN_NO_PULL
, 
GPIO_AF4_I2C1
 );

44 
	}
}

46 
	$I2cMcuF‹m©
–
I2c_t
 *
obj
, 
I2cMode
 
mode
, 
I2cDutyCy˛e
 
dutyCy˛e
, 
boﬁ
 
I2cAckE«bÀ
, 
I2cAckAddrMode
 
AckAddrMode
, 
uöt32_t
 
I2cFªquícy
 )

48 
I2C_H™dÀTy≥Def
 *
i2c
;

50 
	`__HAL_RCC_I2C1_CLK_ENABLE
( );

51 
obj
->
I2c
.
Inô
.
ClockS≥ed
 = 
I2cFªquícy
;

53 if–
dutyCy˛e
 =
I2C_DUTY_CYCLE_2
 )

55 
obj
->
I2c
.
Inô
.
DutyCy˛e
 = 
I2C_DUTYCYCLE_2
;

59 
obj
->
I2c
.
Inô
.
DutyCy˛e
 = 
I2C_DUTYCYCLE_16_9
;

62 
obj
->
I2c
.
Inô
.
OwnAddªss1
 = 0;

63 
obj
->
I2c
.
Inô
.
AddªssögMode
 = 
I2C_ADDRESSINGMODE_7BIT
;

64 
obj
->
I2c
.
Inô
.
DuÆAddªssMode
 = 
I2C_DUALADDRESS_DISABLE
;

65 
obj
->
I2c
.
Inô
.
OwnAddªss2
 = 0;

66 
obj
->
I2c
.
Inô
.
GíîÆCÆlMode
 = 
I2C_GENERALCALL_DISABLED
;

67 
obj
->
I2c
.
Inô
.
NoSåëchMode
 = 
I2C_NOSTRETCH_DISABLED
;

69 
i2c
 = &
obj
->
I2c
;

70 
	`HAL_I2C_Inô
–
i2c
 );

71 
	}
}

73 
	$I2cMcuDeInô
–
I2c_t
 *
obj
 )

75 
I2C_H™dÀTy≥Def
 *
i2c
;

76 
i2c
 = &
obj
->
I2c
;

78 
	`HAL_I2C_DeInô
–
i2c
 );

80 if–
obj
->
I2c
.
In°™˚
 =–
I2C_Ty≥Def
 * ) 
I2C1_BASE
 )

82 
	`__HAL_RCC_I2C1_FORCE_RESET
();

83 
	`__HAL_RCC_I2C1_RELEASE_RESET
();

84 
	`__HAL_RCC_I2C1_CLK_DISABLE
( );

88 
	`__HAL_RCC_I2C2_FORCE_RESET
();

89 
	`__HAL_RCC_I2C2_RELEASE_RESET
();

90 
	`__HAL_RCC_I2C2_CLK_DISABLE
( );

93 
	`GpioInô
–&
obj
->
S˛
, obj->S˛.
pö
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

94 
	`GpioInô
–&
obj
->
Sda
, obj->Sda.
pö
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

95 
	}
}

97 
	$I2cSëAddrSize
–
I2c_t
 *
obj
, 
I2cAddrSize
 
addrSize
 )

99 
I2cI¡î«lAddrSize
 = 
addrSize
;

100 
	}
}

102 
uöt8_t
 
	$I2cMcuWrôeBuf„r
–
I2c_t
 *
obj
, 
uöt8_t
 
devi˚Addr
, 
uöt16_t
 
addr
, uöt8_à*
buf„r
, uöt16_à
size
 )

104 
uöt8_t
 
°©us
 = 
FAIL
;

105 
uöt16_t
 
memAddSize
 = 0;

107 
I2C_H™dÀTy≥Def
 *
i2c
;

108 
i2c
 = &
obj
->
I2c
;

110 if–
I2cI¡î«lAddrSize
 =
I2C_ADDR_SIZE_8
 )

112 
memAddSize
 = 
I2C_MEMADD_SIZE_8BIT
;

116 
memAddSize
 = 
I2C_MEMADD_SIZE_16BIT
;

118 
°©us
 = ( 
	`HAL_I2C_Mem_Wrôe
–
i2c
, 
devi˚Addr
, 
addr
, 
memAddSize
, 
buf„r
, 
size
, 2000 ) =
HAL_OK
 ) ? 
SUCCESS
 : 
FAIL
;

119  
°©us
;

120 
	}
}

122 
uöt8_t
 
	$I2cMcuRódBuf„r
–
I2c_t
 *
obj
, 
uöt8_t
 
devi˚Addr
, 
uöt16_t
 
addr
, uöt8_à*
buf„r
, uöt16_à
size
 )

124 
uöt8_t
 
°©us
 = 
FAIL
;

125 
uöt16_t
 
memAddSize
 = 0;

127 
I2C_H™dÀTy≥Def
 *
i2c
;

128 
i2c
 = &
obj
->
I2c
;

129 if–
I2cI¡î«lAddrSize
 =
I2C_ADDR_SIZE_8
 )

131 
memAddSize
 = 
I2C_MEMADD_SIZE_8BIT
;

135 
memAddSize
 = 
I2C_MEMADD_SIZE_16BIT
;

137 
°©us
 = ( 
	`HAL_I2C_Mem_Ród
–
i2c
, 
devi˚Addr
, 
addr
, 
memAddSize
, 
buf„r
, 
size
, 2000 ) =
HAL_OK
 ) ? 
SUCCESS
 : 
FAIL
;

138  
°©us
;

139 
	}
}

141 
uöt8_t
 
	$I2cMcuWaôSèndbySèã
–
I2c_t
 *
obj
, 
uöt8_t
 
devi˚Addr
 )

143 
uöt8_t
 
°©us
 = 
FAIL
;

144 
I2C_H™dÀTy≥Def
 *
i2c
;

145 
i2c
 = &
obj
->
I2c
;

146 
°©us
 = ( 
	`HAL_I2C_IsDevi˚Ródy
–
i2c
, 
devi˚Addr
, 300, 4096 ) =
HAL_OK
 ) ? 
SUCCESS
 : 
FAIL
;;

147  
°©us
;

148 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\rtc-board.c

15 
	~<m©h.h
>

16 
	~"bﬂrd.h
"

17 
	~"πc-bﬂrd.h
"

22 
	#RTC_ALARM_TICK_PER_MS
 0x7FF

23 

	)

25 
	#N_PREDIV_S
 11

	)

28 
	#PREDIV_S
 ( ( 1 << 
N_PREDIV_S
 ) - 1 )

	)

31 
	#PREDIV_A
 ( 1 << ( 15 - 
N_PREDIV_S
 ) ) - 1

	)

34 
	#USEC_NUMBER
 1000000

	)

35 
	#MSEC_NUMBER
 ( 
USEC_NUMBER
 / 1000 )

	)

36 
	#RTC_ALARM_TIME_BASE
 ( 
USEC_NUMBER
 >> 
N_PREDIV_S
 )

	)

38 
	#COMMON_FACTOR
 3

	)

39 
	#CONV_NUMER
 ( 
MSEC_NUMBER
 >> 
COMMON_FACTOR
 )

	)

40 
	#CONV_DENOM
 ( 1 << ( 
N_PREDIV_S
 - 
COMMON_FACTOR
 ) )

	)

45 c⁄° 
uöt8_t
 
	gSec⁄dsInMöuã
 = 60;

50 c⁄° 
uöt16_t
 
	gSec⁄dsInHour
 = 3600;

55 c⁄° 
uöt32_t
 
	gSec⁄dsInDay
 = 86400;

60 c⁄° 
uöt8_t
 
	gHoursInDay
 = 24;

65 c⁄° 
uöt32_t
 
	gSec⁄dsInLópYór
 = 31622400;

70 c⁄° 
uöt32_t
 
	gSec⁄dsInYór
 = 31536000;

75 c⁄° 
uöt8_t
 
	gDaysInM⁄th
[] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };

80 c⁄° 
uöt8_t
 
	gDaysInM⁄thLópYór
[] = { 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };

85 vﬁ©ûê
boﬁ
 
	gN⁄ScheduÀdWakeUp
 = 
Ál£
;

90 
	sRtcCÆíd¨_s


92 
RTC_D©eTy≥Def
 
	mCÆíd¨D©e
;

93 
RTC_TimeTy≥Def
 
	mCÆíd¨Time
;

94 } 
	tRtcCÆíd¨_t
;

99 
RtcCÆíd¨_t
 
	gRtcCÆíd¨C⁄ãxt
;

105 
boﬁ
 
	gRtcTimîEvítAŒowsLowPowî
 = 
Ál£
;

111 
boﬁ
 
	gLowPowîDißbÀDurögTask
 = 
Ál£
;

116 
RTC_H™dÀTy≥Def
 
	gRtcH™dÀ
 = { 0 };

121 
boﬁ
 
	gRtcInôÆized
 = 
Ál£
;

126 
boﬁ
 
	gWakeUpTimeInôülized
 = 
Ál£
;

131 vﬁ©ûê
uöt32_t
 
	gMcuWakeUpTime
 = 0;

136 
RtcCompuãWakeUpTime
( );

141 
RtcSèπWakeUpAœrm
–
uöt32_t
 
timeoutVÆue
 );

154 
RtcCÆíd¨_t
 
RtcC⁄vîtTimîTimeToCÆíd¨Tick
–
TimîTime_t
 
timeCou¡î
 );

164 
TimîTime_t
 
RtcC⁄vîtCÆíd¨TickToTimîTime
–
RtcCÆíd¨_t
 *
ˇÀnd¨
 );

166 
TimîTime_t
 
RtcC⁄vîtMsToTick
–TimîTime_à
timeoutVÆue
 );

168 
TimîTime_t
 
RtcC⁄vîtTickToMs
–TimîTime_à
timeoutVÆue
 );

177 
RtcCÆíd¨_t
 
RtcCompuãTimîTimeToAœrmTick
–
TimîTime_t
 
timeCou¡î
, RtcCÆíd¨_à
now
 );

184 
RtcCÆíd¨_t
 
RtcGëCÆíd¨
( );

186 
	$RtcInô
( )

188 
RtcCÆíd¨_t
 
πcInô
;

190 if–
RtcInôÆized
 =
Ál£
 )

192 
	`__HAL_RCC_RTC_ENABLE
( );

194 
RtcH™dÀ
.
In°™˚
 = 
RTC
;

195 
RtcH™dÀ
.
Inô
.
HourF‹m©
 = 
RTC_HOURFORMAT_24
;

196 
RtcH™dÀ
.
Inô
.
AsynchPªdiv
 = 
PREDIV_A
;

197 
RtcH™dÀ
.
Inô
.
SynchPªdiv
 = 
PREDIV_S
;

199 
RtcH™dÀ
.
Inô
.
OutPut
 = 
RTC_OUTPUT_DISABLE
;

200 
RtcH™dÀ
.
Inô
.
OutPutPﬁ¨ôy
 = 
RTC_OUTPUT_POLARITY_HIGH
;

201 
RtcH™dÀ
.
Inô
.
OutPutTy≥
 = 
RTC_OUTPUT_TYPE_OPENDRAIN
;

202 
	`HAL_RTC_Inô
–&
RtcH™dÀ
 );

205 
πcInô
.
CÆíd¨D©e
.
Yór
 = 0;

206 
πcInô
.
CÆíd¨D©e
.
M⁄th
 = 
RTC_MONTH_JANUARY
;

207 
πcInô
.
CÆíd¨D©e
.
D©e
 = 1;

208 
πcInô
.
CÆíd¨D©e
.
WìkDay
 = 
RTC_WEEKDAY_SATURDAY
;

209 
	`HAL_RTC_SëD©e
–&
RtcH™dÀ
, &
πcInô
.
CÆíd¨D©e
, 
RTC_FORMAT_BIN
 );

212 
πcInô
.
CÆíd¨Time
.
Hours
 = 0;

213 
πcInô
.
CÆíd¨Time
.
Möuãs
 = 0;

214 
πcInô
.
CÆíd¨Time
.
Sec⁄ds
 = 0;

215 
πcInô
.
CÆíd¨Time
.
Sec⁄dFø˘i⁄
 = 0;

216 
πcInô
.
CÆíd¨Time
.
TimeF‹m©
 = 
RTC_HOURFORMAT12_AM
;

217 
πcInô
.
CÆíd¨Time
.
DayLightSavög
 = 
RTC_DAYLIGHTSAVING_NONE
;

218 
πcInô
.
CÆíd¨Time
.
St‹eO≥øti⁄
 = 
RTC_STOREOPERATION_RESET
;

219 
	`HAL_RTC_SëTime
–&
RtcH™dÀ
, &
πcInô
.
CÆíd¨Time
, 
RTC_FORMAT_BIN
 );

222 
	`HAL_RTCEx_E«bÀBy∑ssShadow
–&
RtcH™dÀ
 );

224 
	`HAL_NVIC_SëPri‹ôy
–
RTC_Aœrm_IRQn
, 1, 0 );

225 
	`HAL_NVIC_E«bÀIRQ
–
RTC_Aœrm_IRQn
 );

226 
RtcInôÆized
 = 
åue
;

228 
	}
}

230 
	$RtcSëTimeout
–
uöt32_t
 
timeout
 )

232 
	`RtcSèπWakeUpAœrm
–
	`RtcC⁄vîtMsToTick
–
timeout
 ) );

233 
	}
}

235 
TimîTime_t
 
	$RtcGëAdju°edTimeoutVÆue
–
uöt32_t
 
timeout
 )

237 if–
timeout
 > 
McuWakeUpTime
 )

239 if–
N⁄ScheduÀdWakeUp
 =
åue
 )

241 
N⁄ScheduÀdWakeUp
 = 
Ál£
;

242 
timeout
 -
McuWakeUpTime
;

246 if–
timeout
 > 
McuWakeUpTime
 )

248 if–
timeout
 < 50 )

250 
RtcTimîEvítAŒowsLowPowî
 = 
Ál£
;

254 
RtcTimîEvítAŒowsLowPowî
 = 
åue
;

255 
timeout
 -
McuWakeUpTime
;

258  
timeout
;

259 
	}
}

261 
TimîTime_t
 
	$RtcGëTimîVÆue
( )

263 
TimîTime_t
 
ªtVÆ
 = 0;

264 
ªtVÆ
 = 
	`RtcC⁄vîtCÆíd¨TickToTimîTime
–
NULL
 );

265 
	`RtcC⁄vîtTickToMs
–
ªtVÆ
 );

267 –
	`RtcC⁄vîtTickToMs
–
ªtVÆ
 ) );

268 
	}
}

270 
TimîTime_t
 
	$RtcGëEœp£dAœrmTime
( )

272 
TimîTime_t
 
ªtVÆ
 = 0;

273 
TimîTime_t
 
cuºítTime
 = 0;

274 
TimîTime_t
 
c⁄ãxtTime
 = 0;

276 
cuºítTime
 = 
	`RtcC⁄vîtCÆíd¨TickToTimîTime
–
NULL
 );

277 
c⁄ãxtTime
 = 
	`RtcC⁄vîtCÆíd¨TickToTimîTime
–&
RtcCÆíd¨C⁄ãxt
 );

279 if–
cuºítTime
 < 
c⁄ãxtTime
 )

281 
ªtVÆ
 = ( 
cuºítTime
 + ( 0xFFFFFFFF - 
c⁄ãxtTime
 ) );

285 
ªtVÆ
 = ( 
cuºítTime
 - 
c⁄ãxtTime
 );

287 –
	`RtcC⁄vîtTickToMs
–
ªtVÆ
 ) );

288 
	}
}

290 
TimîTime_t
 
	$RtcCompuãFutuªEvítTime
–
TimîTime_t
 
futuªEvítInTime
 )

292 –
	`RtcGëTimîVÆue
–Ë+ 
futuªEvítInTime
 );

293 
	}
}

295 
TimîTime_t
 
	$RtcCompuãEœp£dTime
–
TimîTime_t
 
evítInTime
 )

297 
TimîTime_t
 
ñ≠£dTime
 = 0;

300 if–
evítInTime
 == 0 )

305 
ñ≠£dTime
 = 
	`RtcC⁄vîtCÆíd¨TickToTimîTime
–
NULL
 );

307 
ñ≠£dTime
 = 
	`RtcC⁄vîtTickToMs
(ÉlapsedTime );

309 if–
ñ≠£dTime
 < 
evítInTime
 )

311 –
ñ≠£dTime
 + ( 0xFFFFFFFF - 
evítInTime
 ) );

315 –
ñ≠£dTime
 - 
evítInTime
 );

317 
	}
}

319 
	$BlockLowPowîDurögTask
 ( 
boﬁ
 
°©us
 )

321 if–
°©us
 =
åue
 )

323 
	`RtcRecovîMcuSètus
( );

325 
LowPowîDißbÀDurögTask
 = 
°©us
;

326 
	}
}

328 
	$RtcE¡îLowPowîSt›Mode
( )

330 if––
LowPowîDißbÀDurögTask
 =
Ál£
 ) && ( 
RtcTimîEvítAŒowsLowPowî
 =
åue
 ) )

332 
	`BﬂrdDeInôMcu
( );

335 
	`HAL_PWR_DißbÀPVD
( );

337 
	`SET_BIT
–
PWR
->
CR
, 
PWR_CR_CWUF
 );

340 
	`HAL_PWREx_E«bÀU…øLowPowî
( );

343 
	`HAL_PWREx_E«bÀFa°WakeUp
( );

346 
	`HAL_PWR_E¡îSTOPMode
–
PWR_LOWPOWERREGULATOR_ON
, 
PWR_STOPENTRY_WFI
 );

348 
	}
}

350 
	$RtcRecovîMcuSètus
( )

353 if–
	`__HAL_PWR_GET_FLAG
–
PWR_FLAG_WU
 ) !
RESET
 )

355 
	`__HAL_PWR_CLEAR_FLAG
–
PWR_FLAG_WU
 );

359 
N⁄ScheduÀdWakeUp
 = 
åue
;

362 if––
	`__HAL_RCC_GET_SYSCLK_SOURCE
–Ë=
RCC_SYSCLKSOURCE_STATUS_HSI
 ) ||

363 –
	`__HAL_RCC_GET_SYSCLK_SOURCE
–Ë=
RCC_SYSCLKSOURCE_STATUS_MSI
 ) )

365 
	`BﬂrdInôMcu
( );

367 
	}
}

369 
	$RtcCompuãWakeUpTime
( )

371 
uöt32_t
 
°¨t
 = 0;

372 
uöt32_t
 
°›
 = 0;

373 
RTC_AœrmTy≥Def
 
Æ¨mRtc
;

374 
RtcCÆíd¨_t
 
now
;

376 if–
WakeUpTimeInôülized
 =
Ál£
 )

378 
now
 = 
	`RtcGëCÆíd¨
( );

379 
	`HAL_RTC_GëAœrm
–&
RtcH™dÀ
, &
Æ¨mRtc
, 
RTC_ALARM_A
, 
RTC_FORMAT_BIN
 );

381 
°¨t
 = 
PREDIV_S
 - 
Æ¨mRtc
.
AœrmTime
.
SubSec⁄ds
;

382 
°›
 = 
PREDIV_S
 - 
now
.
CÆíd¨Time
.
SubSec⁄ds
;

384 
McuWakeUpTime
 = 
	`RtcC⁄vîtTickToMs
–
°›
 - 
°¨t
 );

386 
WakeUpTimeInôülized
 = 
åue
;

388 
	}
}

390 
	$RtcSèπWakeUpAœrm
–
uöt32_t
 
timeoutVÆue
 )

392 
RtcCÆíd¨_t
 
now
;

393 
RtcCÆíd¨_t
 
Æ¨mTimî
;

394 
RTC_AœrmTy≥Def
 
Æ¨mSåu˘uª
;

396 
	`HAL_RTC_Dó˘iv©eAœrm
–&
RtcH™dÀ
, 
RTC_ALARM_A
 );

398 if–
timeoutVÆue
 <= 3 )

400 
timeoutVÆue
 = 3;

404 
now
 = 
	`RtcGëCÆíd¨
( );

407 
RtcCÆíd¨C⁄ãxt
 = 
now
;

410 
Æ¨mTimî
 = 
	`RtcCompuãTimîTimeToAœrmTick
–
timeoutVÆue
, 
now
 );

412 
Æ¨mSåu˘uª
.
Aœrm
 = 
RTC_ALARM_A
;

413 
Æ¨mSåu˘uª
.
AœrmD©eWìkDaySñ
 = 
RTC_ALARMDATEWEEKDAYSEL_DATE
;

414 
Æ¨mSåu˘uª
.
AœrmMask
 = 
RTC_ALARMMASK_NONE
;

415 
Æ¨mSåu˘uª
.
AœrmSubSec⁄dMask
 = 
RTC_ALARMSUBSECONDMASK_NONE
;

416 
Æ¨mSåu˘uª
.
AœrmTime
.
TimeF‹m©
 = 
RTC_HOURFORMAT12_AM
;

418 
Æ¨mSåu˘uª
.
AœrmTime
.
SubSec⁄ds
 = 
Æ¨mTimî
.
CÆíd¨Time
.SubSeconds;

419 
Æ¨mSåu˘uª
.
AœrmTime
.
Sec⁄ds
 = 
Æ¨mTimî
.
CÆíd¨Time
.Seconds;

420 
Æ¨mSåu˘uª
.
AœrmTime
.
Möuãs
 = 
Æ¨mTimî
.
CÆíd¨Time
.Minutes;

421 
Æ¨mSåu˘uª
.
AœrmTime
.
Hours
 = 
Æ¨mTimî
.
CÆíd¨Time
.Hours;

422 
Æ¨mSåu˘uª
.
AœrmD©eWìkDay
 = 
Æ¨mTimî
.
CÆíd¨D©e
.
D©e
;

424 if–
	`HAL_RTC_SëAœrm_IT
–&
RtcH™dÀ
, &
Æ¨mSåu˘uª
, 
RTC_FORMAT_BIN
 ) !
HAL_OK
 )

426 
	`as£π_∑øm
–
FAIL
 );

428 
	}
}

430 
RtcCÆíd¨_t
 
	$RtcCompuãTimîTimeToAœrmTick
–
TimîTime_t
 
timeCou¡î
, 
RtcCÆíd¨_t
 
now
 )

432 
RtcCÆíd¨_t
 
ˇÀnd¨
 = 
now
;

434 
TimîTime_t
 
timeoutVÆue
 = 0;

436 
uöt16_t
 
mûli£c⁄ds
 = 0;

437 
uöt16_t
 
£c⁄ds
 = 
now
.
CÆíd¨Time
.
Sec⁄ds
;

438 
uöt16_t
 
möuãs
 = 
now
.
CÆíd¨Time
.
Möuãs
;

439 
uöt16_t
 
hours
 = 
now
.
CÆíd¨Time
.
Hours
;

440 
uöt16_t
 
days
 = 
now
.
CÆíd¨D©e
.
D©e
;

442 
timeoutVÆue
 = 
timeCou¡î
;

444 
mûli£c⁄ds
 = 
PREDIV_S
 - 
now
.
CÆíd¨Time
.
SubSec⁄ds
;

445 
mûli£c⁄ds
 +–
timeoutVÆue
 & 
PREDIV_S
 );

448 
timeoutVÆue
 >>
N_PREDIV_S
;

451  
timeoutVÆue
 >
Sec⁄dsInDay
 )

453 
timeoutVÆue
 -
Sec⁄dsInDay
;

454 
days
++;

458  
timeoutVÆue
 >
Sec⁄dsInHour
 )

460 
timeoutVÆue
 -
Sec⁄dsInHour
;

461 
hours
++;

465  
timeoutVÆue
 >
Sec⁄dsInMöuã
 )

467 
timeoutVÆue
 -
Sec⁄dsInMöuã
;

468 
möuãs
++;

472 
£c⁄ds
 +
timeoutVÆue
;

475  
mûli£c⁄ds
 >–
PREDIV_S
 + 1 ) )

477 
mûli£c⁄ds
 -–
PREDIV_S
 + 1 );

478 
£c⁄ds
++;

481  
£c⁄ds
 >
Sec⁄dsInMöuã
 )

483 
£c⁄ds
 -
Sec⁄dsInMöuã
;

484 
möuãs
++;

487  
möuãs
 >= 60 )

489 
möuãs
 -= 60;

490 
hours
++;

493  
hours
 >
HoursInDay
 )

495 
hours
 -
HoursInDay
;

496 
days
++;

499 if––
now
.
CÆíd¨D©e
.
Yór
 == 0 ) || (Çow.CalendarDate.Year % 4 ) == 0 )

501 if–
days
 > 
DaysInM⁄thLópYór
[
now
.
CÆíd¨D©e
.
M⁄th
 - 1] )

503 
days
 = day†% 
DaysInM⁄thLópYór
[
now
.
CÆíd¨D©e
.
M⁄th
 - 1];

504 
ˇÀnd¨
.
CÆíd¨D©e
.
M⁄th
++;

509 if–
days
 > 
DaysInM⁄th
[
now
.
CÆíd¨D©e
.
M⁄th
 - 1] )

511 
days
 = day†% 
DaysInM⁄th
[
now
.
CÆíd¨D©e
.
M⁄th
 - 1];

512 
ˇÀnd¨
.
CÆíd¨D©e
.
M⁄th
++;

516 
ˇÀnd¨
.
CÆíd¨Time
.
SubSec⁄ds
 = 
PREDIV_S
 - 
mûli£c⁄ds
;

517 
ˇÀnd¨
.
CÆíd¨Time
.
Sec⁄ds
 = 
£c⁄ds
;

518 
ˇÀnd¨
.
CÆíd¨Time
.
Möuãs
 = 
möuãs
;

519 
ˇÀnd¨
.
CÆíd¨Time
.
Hours
 = 
hours
;

520 
ˇÀnd¨
.
CÆíd¨D©e
.
D©e
 = 
days
;

522  
ˇÀnd¨
;

523 
	}
}

530 
RtcCÆíd¨_t
 
	$RtcC⁄vîtTimîTimeToCÆíd¨Tick
–
TimîTime_t
 
timeCou¡î
 )

532 
RtcCÆíd¨_t
 
ˇÀnd¨
 = { { 0 }, { 0 } };

534 
TimîTime_t
 
timeoutVÆue
 = 0;

536 
uöt16_t
 
mûli£c⁄ds
 = 0;

537 
uöt16_t
 
£c⁄ds
 = 0;

538 
uöt16_t
 
möuãs
 = 0;

539 
uöt16_t
 
hours
 = 0;

540 
uöt16_t
 
days
 = 0;

541 
uöt8_t
 
m⁄ths
 = 1;

542 
uöt16_t
 
yórs
 = 0;

544 
timeoutVÆue
 = 
timeCou¡î
;

546 
mûli£c⁄ds
 +–
timeoutVÆue
 & 
PREDIV_S
);

549 
timeoutVÆue
 >>
N_PREDIV_S
;

552  
timeoutVÆue
 >
Sec⁄dsInDay
 )

554 
timeoutVÆue
 -
Sec⁄dsInDay
;

555 
days
++;

559  
timeoutVÆue
 >
Sec⁄dsInHour
 )

561 
timeoutVÆue
 -
Sec⁄dsInHour
;

562 
hours
++;

566  
timeoutVÆue
 >
Sec⁄dsInMöuã
 )

568 
timeoutVÆue
 -
Sec⁄dsInMöuã
;

569 
möuãs
++;

573 
£c⁄ds
 +
timeoutVÆue
;

576  
mûli£c⁄ds
 >–
PREDIV_S
 + 1 ) )

578 
mûli£c⁄ds
 -–
PREDIV_S
 + 1 );

579 
£c⁄ds
++;

582  
£c⁄ds
 >
Sec⁄dsInMöuã
 )

584 
£c⁄ds
 -
Sec⁄dsInMöuã
;

585 
möuãs
++;

588  
möuãs
 >= 60 )

590 
möuãs
 -= 60;

591 
hours
++;

594  
hours
 >
HoursInDay
 )

596 
hours
 -
HoursInDay
;

597 
days
++;

600  
days
 > 
DaysInM⁄thLópYór
[
m⁄ths
 - 1] )

602 
days
 -
DaysInM⁄thLópYór
[
m⁄ths
 - 1];

603 
m⁄ths
++;

606 
ˇÀnd¨
.
CÆíd¨Time
.
SubSec⁄ds
 = 
PREDIV_S
 - 
mûli£c⁄ds
;

607 
ˇÀnd¨
.
CÆíd¨Time
.
Sec⁄ds
 = 
£c⁄ds
;

608 
ˇÀnd¨
.
CÆíd¨Time
.
Möuãs
 = 
möuãs
;

609 
ˇÀnd¨
.
CÆíd¨Time
.
Hours
 = 
hours
;

610 
ˇÀnd¨
.
CÆíd¨D©e
.
D©e
 = 
days
;

611 
ˇÀnd¨
.
CÆíd¨D©e
.
M⁄th
 = 
m⁄ths
;

612 
ˇÀnd¨
.
CÆíd¨D©e
.
Yór
 = 
yórs
;

614  
ˇÀnd¨
;

615 
	}
}

617 
TimîTime_t
 
	$RtcC⁄vîtCÆíd¨TickToTimîTime
–
RtcCÆíd¨_t
 *
ˇÀnd¨
 )

619 
TimîTime_t
 
timeCou¡î
 = 0;

620 
RtcCÆíd¨_t
 
now
;

621 
uöt32_t
 
timeCou¡îTemp
 = 0;

625 if–
ˇÀnd¨
 =
NULL
 )

627 
now
 = 
	`RtcGëCÆíd¨
( );

631 
now
 = *
ˇÀnd¨
;

635  
öt16_t
 
i
 = 0; i < 
now
.
CÆíd¨D©e
.
Yór
 ; i++ )

637 if––
i
 == 0 ) || ( i % 4 ) == 0 )

639 
timeCou¡îTemp
 +–
uöt32_t
 )
Sec⁄dsInLópYór
;

643 
timeCou¡îTemp
 +–
uöt32_t
 )
Sec⁄dsInYór
;

648 if––
now
.
CÆíd¨D©e
.
Yór
 == 0 ) || (Çow.CalendarDate.Year % 4 ) == 0 )

650  
uöt8_t
 
i
 = 0; i < ( 
now
.
CÆíd¨D©e
.
M⁄th
 - 1 ); i++ )

652 
timeCou¡îTemp
 +–
uöt32_t
 )–
DaysInM⁄thLópYór
[
i
] * 
Sec⁄dsInDay
 );

657  
uöt8_t
 
i
 = 0; i < ( 
now
.
CÆíd¨D©e
.
M⁄th
 - 1 ); i++ )

659 
timeCou¡îTemp
 +–
uöt32_t
 )–
DaysInM⁄th
[
i
] * 
Sec⁄dsInDay
 );

663 
timeCou¡îTemp
 +–
uöt32_t
 )––uöt32_à)
now
.
CÆíd¨Time
.
Sec⁄ds
 +

664 ––
uöt32_t
 )
now
.
CÆíd¨Time
.
Möuãs
 * 
Sec⁄dsInMöuã
 ) +

665 ––
uöt32_t
 )
now
.
CÆíd¨Time
.
Hours
 * 
Sec⁄dsInHour
 ) +

666 ––
uöt32_t
 )–
now
.
CÆíd¨D©e
.
D©e
 * 
Sec⁄dsInDay
 ) ) );

668 
timeCou¡î
 = ( 
timeCou¡îTemp
 << 
N_PREDIV_S
 ) + ( 
PREDIV_S
 - 
now
.
CÆíd¨Time
.
SubSec⁄ds
);

670  ( 
timeCou¡î
 );

671 
	}
}

673 
TimîTime_t
 
	$RtcC⁄vîtMsToTick
–
TimîTime_t
 
timeoutVÆue
 )

675 
ªtVÆ
 = 0;

676 
ªtVÆ
 = 
	`round
–––)
timeoutVÆue
 * 
CONV_DENOM
 ) / 
CONV_NUMER
 );

677 ––
TimîTime_t
 )
ªtVÆ
 );

678 
	}
}

680 
TimîTime_t
 
	$RtcC⁄vîtTickToMs
–
TimîTime_t
 
timeoutVÆue
 )

682 
ªtVÆ
 = 0.0;

683 
ªtVÆ
 = 
	`round
–––)
timeoutVÆue
 * 
CONV_NUMER
 ) / 
CONV_DENOM
 );

684 ––
TimîTime_t
 )
ªtVÆ
 );

685 
	}
}

687 
RtcCÆíd¨_t
 
	$RtcGëCÆíd¨
( )

689 
uöt32_t
 
fú°_ªad
 = 0;

690 
uöt32_t
 
£c⁄d_ªad
 = 0;

691 
RtcCÆíd¨_t
 
now
;

694 
	`HAL_RTC_GëTime
–&
RtcH™dÀ
, &
now
.
CÆíd¨Time
, 
RTC_FORMAT_BIN
 );

695 
fú°_ªad
 = 
now
.
CÆíd¨Time
.
SubSec⁄ds
;

696 
	`HAL_RTC_GëTime
–&
RtcH™dÀ
, &
now
.
CÆíd¨Time
, 
RTC_FORMAT_BIN
 );

697 
£c⁄d_ªad
 = 
now
.
CÆíd¨Time
.
SubSec⁄ds
;

700  
fú°_ªad
 !
£c⁄d_ªad
 )

702 
fú°_ªad
 = 
£c⁄d_ªad
;

703 
	`HAL_RTC_GëTime
–&
RtcH™dÀ
, &
now
.
CÆíd¨Time
, 
RTC_FORMAT_BIN
 );

704 
£c⁄d_ªad
 = 
now
.
CÆíd¨Time
.
SubSec⁄ds
;

706 
	`HAL_RTC_GëD©e
–&
RtcH™dÀ
, &
now
.
CÆíd¨D©e
, 
RTC_FORMAT_BIN
 );

707 –
now
 );

708 
	}
}

713 
	$RTC_Aœrm_IRQH™dÀr
( )

715 
	`HAL_RTC_AœrmIRQH™dÀr
–&
RtcH™dÀ
 );

716 
	`HAL_RTC_Dó˘iv©eAœrm
–&
RtcH™dÀ
, 
RTC_ALARM_A
 );

717 
	`RtcRecovîMcuSètus
( );

718 
	`RtcCompuãWakeUpTime
( );

719 
	`BlockLowPowîDurögTask
–
Ál£
 );

720 
	`TimîIrqH™dÀr
( );

721 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\spi-board.c

15 
	~"bﬂrd.h
"

16 
	~"•i-bﬂrd.h
"

17 
	~"°m32l1xx_hÆ_•i.h
"

24 
	mSPI_1
 = ( 
uöt32_t
 )
SPI1_BASE
,

25 
	mSPI_2
 = ( 
uöt32_t
 )
SPI2_BASE
,

26 }
	tSPIName
;

28 
	$SpiInô
–
Spi_t
 *
obj
, 
PöNames
 
mosi
, PöName†
miso
, PöName†
s˛k
, PöName†
nss
 )

30 
	`BﬂrdDißbÀIrq
( );

33 if–
mosi
 =
PA_7
 )

35 
	`__HAL_RCC_SPI1_FORCE_RESET
( );

36 
	`__HAL_RCC_SPI1_RELEASE_RESET
( );

38 
	`__HAL_RCC_SPI1_CLK_ENABLE
( );

40 
obj
->
Spi
.
In°™˚
 = ( 
SPI_Ty≥Def
* )
SPI1_BASE
;

42 
	`GpioInô
–&
obj
->
Mosi
, 
mosi
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 
GPIO_AF5_SPI1
 );

43 
	`GpioInô
–&
obj
->
Miso
, 
miso
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 
GPIO_AF5_SPI1
 );

44 
	`GpioInô
–&
obj
->
S˛k
, 
s˛k
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 
GPIO_AF5_SPI1
 );

45 
	`GpioInô
–&
obj
->
Nss
, 
nss
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 
GPIO_AF5_SPI1
 );

47 if–
nss
 =
NC
 )

49 
obj
->
Spi
.
Inô
.
NSS
 = 
SPI_NSS_SOFT
;

50 
	`SpiF‹m©
–
obj
, 
SPI_DATASIZE_8BIT
, 
SPI_POLARITY_LOW
, 
SPI_PHASE_1EDGE
, 0 );

54 
	`SpiF‹m©
–
obj
, 
SPI_DATASIZE_8BIT
, 
SPI_POLARITY_LOW
, 
SPI_PHASE_1EDGE
, 1 );

57 if–
mosi
 =
PB_15
 )

59 
	`__HAL_RCC_SPI2_FORCE_RESET
( );

60 
	`__HAL_RCC_SPI2_RELEASE_RESET
( );

62 
	`__HAL_RCC_SPI2_CLK_ENABLE
( );

64 
obj
->
Spi
.
In°™˚
 = ( 
SPI_Ty≥Def
* )
SPI2_BASE
;

66 
	`GpioInô
–&
obj
->
Mosi
, 
mosi
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 
GPIO_AF5_SPI2
 );

67 
	`GpioInô
–&
obj
->
Miso
, 
miso
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 
GPIO_AF5_SPI2
 );

68 
	`GpioInô
–&
obj
->
S˛k
, 
s˛k
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 
GPIO_AF5_SPI2
 );

69 
	`GpioInô
–&
obj
->
Nss
, 
nss
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 
GPIO_AF5_SPI2
 );

71 if–
nss
 =
NC
 )

73 
obj
->
Spi
.
Inô
.
NSS
 = 
SPI_NSS_SOFT
;

74 
	`SpiF‹m©
–
obj
, 
SPI_DATASIZE_8BIT
, 
SPI_POLARITY_LOW
, 
SPI_PHASE_1EDGE
, 0 );

78 
	`SpiF‹m©
–
obj
, 
SPI_DATASIZE_8BIT
, 
SPI_POLARITY_LOW
, 
SPI_PHASE_1EDGE
, 1 );

81 
	`SpiFªquícy
–
obj
, 10000000 );

83 
	`HAL_SPI_Inô
–&
obj
->
Spi
 );

85 
	`BﬂrdE«bÀIrq
( );

86 
	}
}

88 
	$SpiDeInô
–
Spi_t
 *
obj
 )

90 
	`HAL_SPI_DeInô
–&
obj
->
Spi
 );

92 
	`GpioInô
–&
obj
->
Mosi
, obj->Mosi.
pö
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

93 
	`GpioInô
–&
obj
->
Miso
, obj->Miso.
pö
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_DOWN
, 0 );

94 
	`GpioInô
–&
obj
->
S˛k
, obj->S˛k.
pö
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

95 
	`GpioInô
–&
obj
->
Nss
, obj->Nss.
pö
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 1 );

96 
	}
}

98 
	$SpiF‹m©
–
Spi_t
 *
obj
, 
öt8_t
 
bôs
, i¡8_à
˝ﬁ
, i¡8_à
˝ha
, i¡8_à
¶ave
 )

100 
obj
->
Spi
.
Inô
.
Dúe˘i⁄
 = 
SPI_DIRECTION_2LINES
;

101 if–
bôs
 =
SPI_DATASIZE_8BIT
 )

103 
obj
->
Spi
.
Inô
.
D©aSize
 = 
SPI_DATASIZE_8BIT
;

107 
obj
->
Spi
.
Inô
.
D©aSize
 = 
SPI_DATASIZE_16BIT
;

109 
obj
->
Spi
.
Inô
.
CLKPﬁ¨ôy
 = 
˝ﬁ
;

110 
obj
->
Spi
.
Inô
.
CLKPha£
 = 
˝ha
;

111 
obj
->
Spi
.
Inô
.
Fú°Bô
 = 
SPI_FIRSTBIT_MSB
;

112 
obj
->
Spi
.
Inô
.
TIMode
 = 
SPI_TIMODE_DISABLE
;

113 
obj
->
Spi
.
Inô
.
CRCCÆcuœti⁄
 = 
SPI_CRCCALCULATION_DISABLE
;

114 
obj
->
Spi
.
Inô
.
CRCPﬁynomül
 = 7;

116 if–
¶ave
 == 0 )

118 
obj
->
Spi
.
Inô
.
Mode
 = 
SPI_MODE_MASTER
;

122 
obj
->
Spi
.
Inô
.
Mode
 = 
SPI_MODE_SLAVE
;

124 
	}
}

126 
	$SpiFªquícy
–
Spi_t
 *
obj
, 
uöt32_t
 
hz
 )

128 
uöt32_t
 
divis‹
 = 0;

129 
uöt32_t
 
sysClkTmp
 = 
Sy°emC‹eClock
;

130 
uöt32_t
 
baudR©e
;

132  
sysClkTmp
 > 
hz
 )

134 
divis‹
++;

135 
sysClkTmp
 = ( sysClkTmp >> 1 );

137 if–
divis‹
 >= 7 )

143 
baudR©e
 =–––
divis‹
 & 0x4 ) =0 ) ? 0x0 : 
SPI_CR1_BR_2
 ) |

144 –––
divis‹
 & 0x2 ) =0 ) ? 0x0 : 
SPI_CR1_BR_1
 ) |

145 –––
divis‹
 & 0x1 ) =0 ) ? 0x0 : 
SPI_CR1_BR_0
 );

147 
obj
->
Spi
.
Inô
.
BaudR©ePªsˇÀr
 = 
baudR©e
;

148 
	}
}

150 
uöt16_t
 
	$SpiInOut
–
Spi_t
 *
obj
, 
uöt16_t
 
outD©a
 )

152 
uöt8_t
 
rxD©a
 = 0;

154 if––
obj
 =
NULL
 ) || ( obj->
Spi
.
In°™˚
 ) == NULL )

156 
	`as£π_∑øm
–
FAIL
 );

159 
	`__HAL_SPI_ENABLE
–&
obj
->
Spi
 );

161 
	`BﬂrdDißbÀIrq
( );

163  
	`__HAL_SPI_GET_FLAG
–&
obj
->
Spi
, 
SPI_FLAG_TXE
 ) =
RESET
 );

164 
obj
->
Spi
.
In°™˚
->
DR
 = ( 
uöt16_t
 ) ( 
outD©a
 & 0xFF );

166  
	`__HAL_SPI_GET_FLAG
–&
obj
->
Spi
, 
SPI_FLAG_RXNE
 ) =
RESET
 );

167 
rxD©a
 = ( 
uöt16_t
 ) 
obj
->
Spi
.
In°™˚
->
DR
;

169 
	`BﬂrdE«bÀIrq
( );

171 –
rxD©a
 );

172 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\sx1272-board.c

15 
	~"bﬂrd.h
"

16 
	~"ødio.h
"

17 
	~"sx1272/sx1272.h
"

18 
	~"sx1272-bﬂrd.h
"

23 
boﬁ
 
	gRadioIsA˘ive
 = 
Ál£
;

28 c⁄° 
Radio_s
 
	gRadio
 =

30 
SX1272Inô
,

31 
SX1272GëSètus
,

32 
SX1272SëModem
,

33 
SX1272SëCh™√l
,

34 
SX1272IsCh™√lFªe
,

35 
SX1272R™dom
,

36 
SX1272SëRxC⁄fig
,

37 
SX1272SëTxC⁄fig
,

38 
SX1272CheckRfFªquícy
,

39 
SX1272GëTimeOnAú
,

40 
SX1272Síd
,

41 
SX1272SëSÀï
,

42 
SX1272SëStby
,

43 
SX1272SëRx
,

44 
SX1272SèπCad
,

45 
SX1272SëTxC⁄töuousWave
,

46 
SX1272RódRssi
,

47 
SX1272Wrôe
,

48 
SX1272Ród
,

49 
SX1272WrôeBuf„r
,

50 
SX1272RódBuf„r
,

51 
SX1272SëMaxPaylﬂdLígth
,

52 
SX1272SëPublicNëw‹k


58 
Gpio_t
 
	gA¡Rx
;

59 
Gpio_t
 
	gA¡Tx
;

61 
	$SX1272IoInô
( )

63 
	`GpioInô
–&
SX1272
.
Spi
.
Nss
, 
RADIO_NSS
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 1 );

65 
	`GpioInô
–&
SX1272
.
DIO0
, 
RADIO_DIO_0
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 0 );

66 
	`GpioInô
–&
SX1272
.
DIO1
, 
RADIO_DIO_1
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 0 );

67 
	`GpioInô
–&
SX1272
.
DIO2
, 
RADIO_DIO_2
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 0 );

68 
	`GpioInô
–&
SX1272
.
DIO3
, 
RADIO_DIO_3
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 0 );

69 
	`GpioInô
–&
SX1272
.
DIO4
, 
RADIO_DIO_4
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 0 );

71 
	}
}

73 
	$SX1272IoIrqInô
–
DioIrqH™dÀr
 **
úqH™dÀrs
 )

75 
	`GpioSëI¡îru±
–&
SX1272
.
DIO0
, 
IRQ_RISING_EDGE
, 
IRQ_HIGH_PRIORITY
, 
úqH™dÀrs
[0] );

76 
	`GpioSëI¡îru±
–&
SX1272
.
DIO1
, 
IRQ_RISING_EDGE
, 
IRQ_HIGH_PRIORITY
, 
úqH™dÀrs
[1] );

77 
	`GpioSëI¡îru±
–&
SX1272
.
DIO2
, 
IRQ_RISING_EDGE
, 
IRQ_HIGH_PRIORITY
, 
úqH™dÀrs
[2] );

78 
	`GpioSëI¡îru±
–&
SX1272
.
DIO3
, 
IRQ_RISING_EDGE
, 
IRQ_HIGH_PRIORITY
, 
úqH™dÀrs
[3] );

79 
	`GpioSëI¡îru±
–&
SX1272
.
DIO4
, 
IRQ_RISING_EDGE
, 
IRQ_HIGH_PRIORITY
, 
úqH™dÀrs
[4] );

81 
	}
}

83 
	$SX1272IoDeInô
( )

85 
	`GpioInô
–&
SX1272
.
Spi
.
Nss
, 
RADIO_NSS
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 1 );

87 
	`GpioInô
–&
SX1272
.
DIO0
, 
RADIO_DIO_0
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

88 
	`GpioInô
–&
SX1272
.
DIO1
, 
RADIO_DIO_1
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

89 
	`GpioInô
–&
SX1272
.
DIO2
, 
RADIO_DIO_2
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

90 
	`GpioInô
–&
SX1272
.
DIO3
, 
RADIO_DIO_3
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

91 
	`GpioInô
–&
SX1272
.
DIO4
, 
RADIO_DIO_4
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

93 
	}
}

95 
	$SX1272SëRfTxPowî
–
öt8_t
 
powî
 )

97 
uöt8_t
 
∑C⁄fig
 = 0;

98 
uöt8_t
 
∑Dac
 = 0;

100 
∑C⁄fig
 = 
	`SX1272Ród
–
REG_PACONFIG
 );

101 
∑Dac
 = 
	`SX1272Ród
–
REG_PADAC
 );

103 
∑C⁄fig
 = (ÖaC⁄fig & 
RF_PACONFIG_PASELECT_MASK
 ) | 
	`SX1272GëPaSñe˘
–
SX1272
.
Sëtögs
.
Ch™√l
 );

105 if––
∑C⁄fig
 & 
RF_PACONFIG_PASELECT_PABOOST
 ) == RF_PACONFIG_PASELECT_PABOOST )

107 if–
powî
 > 17 )

109 
∑Dac
 = (ÖaDa¯& 
RF_PADAC_20DBM_MASK
 ) | 
RF_PADAC_20DBM_ON
;

113 
∑Dac
 = (ÖaDa¯& 
RF_PADAC_20DBM_MASK
 ) | 
RF_PADAC_20DBM_OFF
;

115 if––
∑Dac
 & 
RF_PADAC_20DBM_ON
 ) == RF_PADAC_20DBM_ON )

117 if–
powî
 < 5 )

119 
powî
 = 5;

121 if–
powî
 > 20 )

123 
powî
 = 20;

125 
∑C⁄fig
 = (ÖaC⁄fig & 
RFLR_PACONFIG_OUTPUTPOWER_MASK
 ) | ( 
uöt8_t
 )––
uöt16_t
 )–
powî
 - 5 ) & 0x0F );

129 if–
powî
 < 2 )

131 
powî
 = 2;

133 if–
powî
 > 17 )

135 
powî
 = 17;

137 
∑C⁄fig
 = (ÖaC⁄fig & 
RFLR_PACONFIG_OUTPUTPOWER_MASK
 ) | ( 
uöt8_t
 )––
uöt16_t
 )–
powî
 - 2 ) & 0x0F );

142 if–
powî
 < -1 )

144 
powî
 = -1;

146 if–
powî
 > 14 )

148 
powî
 = 14;

150 
∑C⁄fig
 = (ÖaC⁄fig & 
RFLR_PACONFIG_OUTPUTPOWER_MASK
 ) | ( 
uöt8_t
 )––
uöt16_t
 )–
powî
 + 1 ) & 0x0F );

152 
	`SX1272Wrôe
–
REG_PACONFIG
, 
∑C⁄fig
 );

153 
	`SX1272Wrôe
–
REG_PADAC
, 
∑Dac
 );

154 
	}
}

156 
uöt8_t
 
	$SX1272GëPaSñe˘
–
uöt32_t
 
ch™√l
 )

158  
RF_PACONFIG_PASELECT_PABOOST
;

159 
	}
}

161 
	$SX1272SëA¡SwLowPowî
–
boﬁ
 
°©us
 )

163 if–
RadioIsA˘ive
 !
°©us
 )

165 
RadioIsA˘ive
 = 
°©us
;

167 if–
°©us
 =
Ál£
 )

169 
	`SX1272A¡SwInô
( );

173 
	`SX1272A¡SwDeInô
( );

176 
	}
}

178 
	$SX1272A¡SwInô
( )

180 
	`GpioInô
–&
A¡Tx
, 
RADIO_ANT_SWITCH_TX
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 0 );

181 
	}
}

183 
	$SX1272A¡SwDeInô
( )

185 
	`GpioInô
–&
A¡Tx
, 
RADIO_ANT_SWITCH_TX
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

186 
	}
}

188 
	$SX1272SëA¡Sw
–
uöt8_t
 
›Mode
 )

190  
›Mode
 )

192 
RFLR_OPMODE_TRANSMITTER
:

193 
	`GpioWrôe
–&
A¡Tx
, 1 );

195 
RFLR_OPMODE_RECEIVER
:

196 
RFLR_OPMODE_RECEIVER_SINGLE
:

197 
RFLR_OPMODE_CAD
:

199 
	`GpioWrôe
–&
A¡Tx
, 0 );

202 
	}
}

204 
boﬁ
 
	$SX1272CheckRfFªquícy
–
uöt32_t
 
‰equícy
 )

207  
åue
;

208 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\uart-board.c

15 
	~"bﬂrd.h
"

17 
	~"u¨t-bﬂrd.h
"

19 
UART_H™dÀTy≥Def
 
	gU¨tH™dÀ
;

20 
uöt8_t
 
	gRxD©a
 = 0;

21 
uöt8_t
 
	gTxD©a
 = 0;

23 
	$U¨tMcuInô
–
U¨t_t
 *
obj
, 
uöt8_t
 
u¨tId
, 
PöNames
 
tx
, PöName†
rx
 )

25 
obj
->
U¨tId
 = 
u¨tId
;

27 
	`__HAL_RCC_USART1_FORCE_RESET
( );

28 
	`__HAL_RCC_USART1_RELEASE_RESET
( );

29 
	`__HAL_RCC_USART1_CLK_ENABLE
( );

31 
	`GpioInô
–&
obj
->
Tx
, 
tx
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 
GPIO_AF7_USART1
 );

32 
	`GpioInô
–&
obj
->
Rx
, 
rx
, 
PIN_ALTERNATE_FCT
, 
PIN_PUSH_PULL
, 
PIN_PULL_UP
, 
GPIO_AF7_USART1
 );

33 
	}
}

35 
	$U¨tMcuC⁄fig
–
U¨t_t
 *
obj
, 
U¨tMode_t
 
mode
, 
uöt32_t
 
baudøã
, 
W‹dLígth_t
 
w‹dLígth
, 
St›Bôs_t
 
°›Bôs
, 
P¨ôy_t
 
∑rôy
, 
FlowCål_t
 
ÊowCål
 )

37 
U¨tH™dÀ
.
In°™˚
 = 
USART1
;

38 
U¨tH™dÀ
.
Inô
.
BaudR©e
 = 
baudøã
;

40 if–
mode
 =
TX_ONLY
 )

42 if–
obj
->
FifoTx
.
D©a
 =
NULL
 )

44 
	`as£π_∑øm
–
FAIL
 );

46 
U¨tH™dÀ
.
Inô
.
Mode
 = 
UART_MODE_TX
;

48 if–
mode
 =
RX_ONLY
 )

50 if–
obj
->
FifoRx
.
D©a
 =
NULL
 )

52 
	`as£π_∑øm
–
FAIL
 );

54 
U¨tH™dÀ
.
Inô
.
Mode
 = 
UART_MODE_RX
;

56 if–
mode
 =
RX_TX
 )

58 if––
obj
->
FifoTx
.
D©a
 =
NULL
 ) || ( obj->
FifoRx
.Data == NULL ) )

60 
	`as£π_∑øm
–
FAIL
 );

62 
U¨tH™dÀ
.
Inô
.
Mode
 = 
UART_MODE_TX_RX
;

66 
	`as£π_∑øm
–
FAIL
 );

69 if–
w‹dLígth
 =
UART_8_BIT
 )

71 
U¨tH™dÀ
.
Inô
.
W‹dLígth
 = 
UART_WORDLENGTH_8B
;

73 if–
w‹dLígth
 =
UART_9_BIT
 )

75 
U¨tH™dÀ
.
Inô
.
W‹dLígth
 = 
UART_WORDLENGTH_9B
;

78  
°›Bôs
 )

80 
UART_2_STOP_BIT
:

81 
U¨tH™dÀ
.
Inô
.
St›Bôs
 = 
UART_STOPBITS_2
;

83 
UART_1_STOP_BIT
:

85 
U¨tH™dÀ
.
Inô
.
St›Bôs
 = 
UART_STOPBITS_1
;

89 if–
∑rôy
 =
NO_PARITY
 )

91 
U¨tH™dÀ
.
Inô
.
P¨ôy
 = 
UART_PARITY_NONE
;

93 if–
∑rôy
 =
EVEN_PARITY
 )

95 
U¨tH™dÀ
.
Inô
.
P¨ôy
 = 
UART_PARITY_EVEN
;

99 
U¨tH™dÀ
.
Inô
.
P¨ôy
 = 
UART_PARITY_ODD
;

102 if–
ÊowCål
 =
NO_FLOW_CTRL
 )

104 
U¨tH™dÀ
.
Inô
.
HwFlowCé
 = 
UART_HWCONTROL_NONE
;

106 if–
ÊowCål
 =
RTS_FLOW_CTRL
 )

108 
U¨tH™dÀ
.
Inô
.
HwFlowCé
 = 
UART_HWCONTROL_RTS
;

110 if–
ÊowCål
 =
CTS_FLOW_CTRL
 )

112 
U¨tH™dÀ
.
Inô
.
HwFlowCé
 = 
UART_HWCONTROL_CTS
;

114 if–
ÊowCål
 =
RTS_CTS_FLOW_CTRL
 )

116 
U¨tH™dÀ
.
Inô
.
HwFlowCé
 = 
UART_HWCONTROL_RTS_CTS
;

119 
U¨tH™dÀ
.
Inô
.
OvîSam∂ög
 = 
UART_OVERSAMPLING_16
;

121 if–
	`HAL_UART_Inô
–&
U¨tH™dÀ
 ) !
HAL_OK
 )

123 
	`as£π_∑øm
–
FAIL
 );

126 
	`HAL_NVIC_SëPri‹ôy
–
USART1_IRQn
, 8, 0 );

127 
	`HAL_NVIC_E«bÀIRQ
–
USART1_IRQn
 );

130 
	`HAL_UART_Re˚ive_IT
–&
U¨tH™dÀ
, &
RxD©a
, 1 );

131 
	}
}

133 
	$U¨tMcuDeInô
–
U¨t_t
 *
obj
 )

135 
	`__HAL_RCC_USART1_FORCE_RESET
( );

136 
	`__HAL_RCC_USART1_RELEASE_RESET
( );

137 
	`__HAL_RCC_USART1_CLK_DISABLE
( );

139 
	`GpioInô
–&
obj
->
Tx
, obj->Tx.
pö
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

140 
	`GpioInô
–&
obj
->
Rx
, obj->Rx.
pö
, 
PIN_ANALOGIC
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 0 );

141 
	}
}

143 
uöt8_t
 
	$U¨tMcuPutCh¨
–
U¨t_t
 *
obj
, 
uöt8_t
 
d©a
 )

145 
	`BﬂrdDißbÀIrq
( );

146 
TxD©a
 = 
d©a
;

148 if–
	`IsFifoFuŒ
–&
obj
->
FifoTx
 ) =
Ál£
 )

150 
	`FifoPush
–&
obj
->
FifoTx
, 
TxD©a
 );

153 
	`__HAL_UART_ENABLE_IT
–&
U¨tH™dÀ
, 
UART_IT_TC
 );

155 
	`BﬂrdE«bÀIrq
( );

158 
	`BﬂrdE«bÀIrq
( );

160 
	}
}

162 
uöt8_t
 
	$U¨tMcuGëCh¨
–
U¨t_t
 *
obj
, 
uöt8_t
 *
d©a
 )

164 
	`BﬂrdDißbÀIrq
( );

166 if–
	`IsFifoEm±y
–&
obj
->
FifoRx
 ) =
Ál£
 )

168 *
d©a
 = 
	`FifoP›
–&
obj
->
FifoRx
 );

169 
	`BﬂrdE«bÀIrq
( );

172 
	`BﬂrdE«bÀIrq
( );

174 
	}
}

176 
	$HAL_UART_TxC∂tCÆlback
–
UART_H™dÀTy≥Def
 *
h™dÀ
 )

178 if–
	`IsFifoEm±y
–&
U¨t1
.
FifoTx
 ) =
Ál£
 )

180 
TxD©a
 = 
	`FifoP›
–&
U¨t1
.
FifoTx
 );

182 
	`HAL_UART_Tønsmô_IT
–&
U¨tH™dÀ
, &
TxD©a
, 1 );

185 if–
U¨t1
.
IrqNŸify
 !
NULL
 )

187 
U¨t1
.
	`IrqNŸify
–
UART_NOTIFY_TX
 );

189 
	}
}

191 
	$HAL_UART_RxC∂tCÆlback
–
UART_H™dÀTy≥Def
 *
h™dÀ
 )

193 if–
	`IsFifoFuŒ
–&
U¨t1
.
FifoRx
 ) =
Ál£
 )

196 
	`FifoPush
–&
U¨t1
.
FifoRx
, 
RxD©a
 );

199 if–
U¨t1
.
IrqNŸify
 !
NULL
 )

201 
U¨t1
.
	`IrqNŸify
–
UART_NOTIFY_RX
 );

204 
	`HAL_UART_Re˚ive_IT
–&
U¨tH™dÀ
, &
RxD©a
, 1 );

205 
	}
}

207 
	$HAL_UART_Eº‹CÆlback
–
UART_H™dÀTy≥Def
 *
h™dÀ
 )

209 
	`HAL_UART_Re˚ive_IT
–&
U¨tH™dÀ
, &
RxD©a
, 1 );

210 
	}
}

212 
	$USART1_IRQH™dÀr
( )

214 
	`HAL_UART_IRQH™dÀr
–&
U¨tH™dÀ
 );

215 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\uart-usb-board.c

15 
	~"bﬂrd.h
"

17 
	~"usbd_c‹e.h
"

18 
	~"usbd_desc.h
"

19 
	~"usbd_cdc.h
"

20 
	~"usbd_cdc_if.h
"

21 
	~"u¨t-usb-bﬂrd.h
"

27 
USBD_H™dÀTy≥Def
 
	ghUsbDevi˚FS
;

28 
PCD_H™dÀTy≥Def
 
hpcd_USB_FS
;

30 
	$U¨tUsbInô
–
U¨t_t
 *
obj
, 
uöt8_t
 
u¨tId
, 
PöNames
 
tx
, PöName†
rx
 )

32 
obj
->
U¨tId
 = 
u¨tId
;

34 
	`__HAL_RCC_COMP_CLK_ENABLE
( );

35 
	`__HAL_RCC_SYSCFG_CLK_ENABLE
( );

37 
	`CDC_Së_U¨t_Obj
–
obj
 );

40 
	`USBD_Inô
–&
hUsbDevi˚FS
, &
FS_Desc
, 
DEVICE_FS
 );

42 
	`USBD_Regi°îCœss
–&
hUsbDevi˚FS
, &
USBD_CDC
 );

44 
	`USBD_CDC_Regi°îI¡îÁ˚
–&
hUsbDevi˚FS
, &
USBD_I¡îÁ˚_f›s_FS
 );

46 
	`USBD_Sèπ
–&
hUsbDevi˚FS
 );

47 
	}
}

49 
	$U¨tUsbC⁄fig
–
U¨t_t
 *
obj
, 
U¨tMode_t
 
mode
, 
uöt32_t
 
baudøã
, 
W‹dLígth_t
 
w‹dLígth
, 
St›Bôs_t
 
°›Bôs
, 
P¨ôy_t
 
∑rôy
, 
FlowCål_t
 
ÊowCål
 )

52 
	}
}

54 
	$U¨tUsbDeInô
–
U¨t_t
 *
obj
 )

57 
	}
}

59 
uöt8_t
 
	$U¨tUsbIsUsbCabÀC⁄√˘ed
( )

61 if–
hUsbDevi˚FS
.
dev_addªss
 == 0 )

71 
	}
}

73 
uöt8_t
 
	$U¨tUsbPutBuf„r
–
U¨t_t
 *
obj
, 
uöt8_t
 *
buf„r
, 
uöt16_t
 
size
 )

75  
	`CDC_Tønsmô_FS
–
buf„r
, 
size
 );

76 
	}
}

78 
uöt8_t
 
	$U¨tUsbPutCh¨
–
U¨t_t
 *
obj
, 
uöt8_t
 
d©a
 )

80  
	`U¨tUsbPutBuf„r
–
obj
, &
d©a
, 1 );

81 
	}
}

83 
uöt8_t
 
	$U¨tUsbGëCh¨
–
U¨t_t
 *
obj
, 
uöt8_t
 *
d©a
 )

85 if–
	`IsFifoEm±y
–&
obj
->
FifoRx
 ) =
Ál£
 )

87 
	`BﬂrdDißbÀIrq
( );

88 *
d©a
 = 
	`FifoP›
–&
obj
->
FifoRx
 );

89 
	`BﬂrdE«bÀIrq
( );

93 
	}
}

95 
	$USB_LP_IRQH™dÀr
( )

97 
	`HAL_PCD_IRQH™dÀr
–&
hpcd_USB_FS
 );

98 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\usb\cdc\src\usbd_cdc_if.c

34 
	~"bﬂrd.h
"

35 
	~"usbd_cdc_if.h
"

63 
	#APP_RX_DATA_SIZE
 64

	)

64 
	#APP_TX_DATA_SIZE
 64

	)

66 
	#FIFO_RX_SIZE
 1024

	)

89 
uöt8_t
 
	gU£rRxBuf„rFS
[
APP_RX_DATA_SIZE
];

92 
uöt8_t
 
	gU£rTxBuf„rFS
[
APP_TX_DATA_SIZE
];

94 
uöt8_t
 
	gFifoRxBuf„r
[
FIFO_RX_SIZE
];

98 
USBD_H™dÀTy≥Def
 *
	ghUsbDevi˚_0
;

109 
USBD_H™dÀTy≥Def
 
hUsbDevi˚FS
;

120 
öt8_t
 
CDC_Inô_FS
 ();

121 
öt8_t
 
CDC_DeInô_FS
 ();

122 
öt8_t
 
CDC_C⁄åﬁ_FS
 (
uöt8_t
 
cmd
, uöt8_t* 
pbuf
, 
uöt16_t
 
Àngth
);

123 
öt8_t
 
CDC_Re˚ive_FS
 (
uöt8_t
* 
pbuf
, 
uöt32_t
 *
Lí
);

132 
USBD_CDC_ItfTy≥Def
 
	gUSBD_I¡îÁ˚_f›s_FS
 =

134 
CDC_Inô_FS
,

135 
CDC_DeInô_FS
,

136 
CDC_C⁄åﬁ_FS
,

137 
CDC_Re˚ive_FS


140 
USBD_CDC_LöeCodögTy≥Def
 
	glöecodög
 =

148 
U¨t_t
 *
	gU¨tObj
;

150 
	$CDC_Së_U¨t_Obj
–
U¨t_t
 *
obj
 )

152 
U¨tObj
 = 
obj
;

154 
	`FifoInô
–&
obj
->
FifoRx
, 
FifoRxBuf„r
, 
FIFO_RX_SIZE
 );

155 
	}
}

164 
öt8_t
 
	$CDC_Inô_FS
( )

166 
hUsbDevi˚_0
 = &
hUsbDevi˚FS
;

169 
	`USBD_CDC_SëTxBuf„r
–
hUsbDevi˚_0
, 
U£rTxBuf„rFS
, 0 );

170 
	`USBD_CDC_SëRxBuf„r
–
hUsbDevi˚_0
, 
U£rRxBuf„rFS
 );

171  (
USBD_OK
);

173 
	}
}

181 
öt8_t
 
	$CDC_DeInô_FS
( )

184  (
USBD_OK
);

186 
	}
}

196 
öt8_t
 
	$CDC_C⁄åﬁ_FS
 (
uöt8_t
 
cmd
, uöt8_t* 
pbuf
, 
uöt16_t
 
Àngth
)

199 
cmd
)

201 
CDC_SEND_ENCAPSULATED_COMMAND
:

204 
CDC_GET_ENCAPSULATED_RESPONSE
:

207 
CDC_SET_COMM_FEATURE
:

210 
CDC_GET_COMM_FEATURE
:

213 
CDC_CLEAR_COMM_FEATURE
:

233 
CDC_SET_LINE_CODING
:

234 
löecodög
.
bôøã
 = (
uöt32_t
)(
pbuf
[0] | (pbuf[1] << 8) |\

235 (
pbuf
[2] << 16) | (pbuf[3] << 24));

236 
löecodög
.
f‹m©
 = 
pbuf
[4];

237 
löecodög
.
∑rôyty≥
 = 
pbuf
[5];

238 
löecodög
.
d©©y≥
 = 
pbuf
[6];

241 
CDC_GET_LINE_CODING
:

242 
pbuf
[0] = (
uöt8_t
)(
löecodög
.
bôøã
);

243 
pbuf
[1] = (
uöt8_t
)(
löecodög
.
bôøã
 >> 8);

244 
pbuf
[2] = (
uöt8_t
)(
löecodög
.
bôøã
 >> 16);

245 
pbuf
[3] = (
uöt8_t
)(
löecodög
.
bôøã
 >> 24);

246 
pbuf
[4] = 
löecodög
.
f‹m©
;

247 
pbuf
[5] = 
löecodög
.
∑rôyty≥
;

248 
pbuf
[6] = 
löecodög
.
d©©y≥
;

251 
CDC_SET_CONTROL_LINE_STATE
:

254 
CDC_SEND_BREAK
:

261  (
USBD_OK
);

263 
	}
}

276 #ifde‡
USB_NON_BLOCKING


277 vﬁ©ûê
	gbussy_cou¡
=0;

278 
	#BUSSY_COUNT_MAX
 32768

	)

281 
uöt8_t
 
	$CDC_Tønsmô_FS
(
uöt8_t
* 
buf„r
, 
uöt16_t
 
size
)

285 
uöt16_t
 
idx
 = 0;

286 
uöt16_t
 
usbBuf„rSize
 = 
APP_TX_DATA_SIZE
 - 1;

288 if(
bussy_cou¡
 < 
BUSSY_COUNT_MAX
)

290 
bussy_cou¡
 = 0;

292  
size
 > 
usbBuf„rSize
 )

294 
	`USBD_CDC_SëTxBuf„r
–
hUsbDevi˚_0
, 
buf„r
 + 
idx
, 
usbBuf„rSize
 );

295 
size
 -
usbBuf„rSize
;

296 
idx
 +
usbBuf„rSize
;

297  
	`USBD_CDC_TønsmôPackë
–
hUsbDevi˚_0
 ) !
USBD_OK
 )

299 ++
bussy_cou¡
;

300 if(
bussy_cou¡
 > 
BUSSY_COUNT_MAX
Ë 
USBD_BUSY
;

304 if–
size
 != 0 )

306 
	`USBD_CDC_SëTxBuf„r
–
hUsbDevi˚_0
, 
buf„r
 + 
idx
, 
size
 );

307  
	`USBD_CDC_TønsmôPackë
–
hUsbDevi˚_0
 ) !
USBD_OK
 )

309 ++
bussy_cou¡
;

310 if(
bussy_cou¡
 > 
BUSSY_COUNT_MAX
Ë 
USBD_BUSY
;

315  
USBD_BUSY
;

319  
USBD_OK
;

320 
	}
}

322 
uöt8_t
 
	$CDC_Tønsmô_FS
(
uöt8_t
* 
buf„r
, 
uöt16_t
 
size
)

326 
uöt16_t
 
idx
 = 0;

327 
uöt16_t
 
usbBuf„rSize
 = 
APP_TX_DATA_SIZE
 - 1;

329  
size
 > 
usbBuf„rSize
 )

331 
	`USBD_CDC_SëTxBuf„r
–
hUsbDevi˚_0
, 
buf„r
 + 
idx
, 
usbBuf„rSize
 );

332 
size
 -
usbBuf„rSize
;

333 
idx
 +
usbBuf„rSize
;

334  
	`USBD_CDC_TønsmôPackë
–
hUsbDevi˚_0
 ) !
USBD_OK
 );

337 if–
size
 != 0 )

339 
	`USBD_CDC_SëTxBuf„r
–
hUsbDevi˚_0
, 
buf„r
 + 
idx
, 
size
 );

340  
	`USBD_CDC_TønsmôPackë
–
hUsbDevi˚_0
 ) !
USBD_OK
 );

344  
USBD_OK
;

345 
	}
}

366 
öt8_t
 
	$CDC_Re˚ive_FS
 (
uöt8_t
* 
Buf
, 
uöt32_t
 *
Lí
)

368 
uöt8_t
 
i
;

370  
i
 = 0; i < *
Lí
; i++ )

372 if–
	`IsFifoFuŒ
–&
U¨tObj
->
FifoRx
 ) =
Ál£
 )

375 
	`FifoPush
–&
U¨tObj
->
FifoRx
, 
Buf
[
i
] );

378 if–
U¨tObj
->
IrqNŸify
 !
NULL
 )

380 
U¨tObj
->
	`IrqNŸify
–
UART_NOTIFY_RX
 );

382 
	`USBD_CDC_SëRxBuf„r
(
hUsbDevi˚_0
, 
Buf
);

383 
	`USBD_CDC_Re˚ivePackë
(
hUsbDevi˚_0
);

384  (
USBD_OK
);

385 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\usb\cdc\src\usbd_conf.c

35 
	~"°m32l1xx.h
"

36 
	~"°m32l1xx_hÆ.h
"

37 
	~"usbd_def.h
"

38 
	~"usbd_c‹e.h
"

39 
	~"usbd_cdc.h
"

44 
PCD_H™dÀTy≥Def
 
	ghpcd_USB_FS
;

55 
HAL_PCDEx_SëC⁄√˘i⁄Sèã
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
°©e
);

62 
	$HAL_PCD_M•Inô
(
PCD_H™dÀTy≥Def
* 
pcdH™dÀ
)

64 if(
pcdH™dÀ
->
In°™˚
==
USB
)

70 
	`__HAL_RCC_USB_CLK_ENABLE
();

73 
	`HAL_NVIC_SëPri‹ôy
(
USB_LP_IRQn
, 0, 0);

74 
	`HAL_NVIC_E«bÀIRQ
(
USB_LP_IRQn
);

79 
	}
}

81 
	$HAL_PCD_M•DeInô
(
PCD_H™dÀTy≥Def
* 
pcdH™dÀ
)

83 if(
pcdH™dÀ
->
In°™˚
==
USB
)

89 
	`__HAL_RCC_USB_CLK_DISABLE
();

92 
	`HAL_NVIC_DißbÀIRQ
(
USB_LP_IRQn
);

98 
	}
}

105 
	$HAL_PCD_SëupSègeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

107 
	`USBD_LL_SëupSège
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
, (
uöt8_t
 *)hpcd->
Sëup
);

108 
	}
}

116 
	$HAL_PCD_D©aOutSègeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

118 
	`USBD_LL_D©aOutSège
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
, 
ïnum
, hpcd->
OUT_ï
[ïnum].
x„r_buff
);

119 
	}
}

127 
	$HAL_PCD_D©aInSègeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

129 
	`USBD_LL_D©aInSège
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
, 
ïnum
, hpcd->
IN_ï
[ïnum].
x„r_buff
);

130 
	}
}

137 
	$HAL_PCD_SOFCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

139 
	`USBD_LL_SOF
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
);

140 
	}
}

147 
	$HAL_PCD_Re£tCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

149 
USBD_S≥edTy≥Def
 
•ìd
 = 
USBD_SPEED_FULL
;

152 
hpcd
->
Inô
.
•ìd
)

154 
PCD_SPEED_FULL
:

155 
•ìd
 = 
USBD_SPEED_FULL
;

159 
•ìd
 = 
USBD_SPEED_FULL
;

162 
	`USBD_LL_SëS≥ed
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
, 
•ìd
);

165 
	`USBD_LL_Re£t
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
);

166 
	}
}

174 
	$HAL_PCD_Su•ídCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

177 
	`USBD_LL_Su•íd
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
);

180 i‡(
hpcd
->
Inô
.
low_powî_íabÀ
)

183 
SCB
->
SCR
 |(
uöt32_t
)((uöt32_t)(
SCB_SCR_SLEEPDEEP_Msk
 | 
SCB_SCR_SLEEPONEXIT_Msk
));

186 
	}
}

194 
	$HAL_PCD_ResumeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

199 
	`USBD_LL_Resume
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
);

201 
	}
}

209 
	$HAL_PCD_ISOOUTIncom∂ëeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

211 
	`USBD_LL_IsoOUTIncom∂ëe
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
, 
ïnum
);

212 
	}
}

220 
	$HAL_PCD_ISOINIncom∂ëeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

222 
	`USBD_LL_IsoINIncom∂ëe
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
, 
ïnum
);

223 
	}
}

230 
	$HAL_PCD_C⁄√˘CÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

232 
	`USBD_LL_DevC⁄√˘ed
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
);

233 
	}
}

240 
	$HAL_PCD_Disc⁄√˘CÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

242 
	`USBD_LL_DevDisc⁄√˘ed
((
USBD_H™dÀTy≥Def
*)
hpcd
->
pD©a
);

243 
	}
}

253 
USBD_SètusTy≥Def
 
	$USBD_LL_Inô
 (
USBD_H™dÀTy≥Def
 *
pdev
)

257 
hpcd_USB_FS
.
pD©a
 = 
pdev
;

258 
pdev
->
pD©a
 = &
hpcd_USB_FS
;

260 
hpcd_USB_FS
.
In°™˚
 = 
USB
;

261 
hpcd_USB_FS
.
Inô
.
dev_ídpoöts
 = 8;

262 
hpcd_USB_FS
.
Inô
.
•ìd
 = 
PCD_SPEED_FULL
;

263 
hpcd_USB_FS
.
Inô
.
ï0_mps
 = 
DEP0CTL_MPS_8
;

264 
hpcd_USB_FS
.
Inô
.
phy_ôÁ˚
 = 
PCD_PHY_EMBEDDED
;

265 
hpcd_USB_FS
.
Inô
.
low_powî_íabÀ
 = 
DISABLE
;

266 
hpcd_USB_FS
.
Inô
.
b©ãry_ch¨gög_íabÀ
 = 
DISABLE
;

267 
	`HAL_PCD_Inô
(&
hpcd_USB_FS
);

269 
	`HAL_PCDEx_PMAC⁄fig
((
PCD_H™dÀTy≥Def
*)
pdev
->
pD©a
 , 0x00 , 
PCD_SNG_BUF
, 0x18);

270 
	`HAL_PCDEx_PMAC⁄fig
((
PCD_H™dÀTy≥Def
*)
pdev
->
pD©a
 , 0x80 , 
PCD_SNG_BUF
, 0x58);

271 
	`HAL_PCDEx_PMAC⁄fig
((
PCD_H™dÀTy≥Def
*)
pdev
->
pD©a
 , 0x81 , 
PCD_SNG_BUF
, 0xC0);

272 
	`HAL_PCDEx_PMAC⁄fig
((
PCD_H™dÀTy≥Def
*)
pdev
->
pD©a
 , 0x01 , 
PCD_SNG_BUF
, 0x110);

273 
	`HAL_PCDEx_PMAC⁄fig
((
PCD_H™dÀTy≥Def
*)
pdev
->
pD©a
 , 0x82 , 
PCD_SNG_BUF
, 0x100);

274  
USBD_OK
;

275 
	}
}

282 
USBD_SètusTy≥Def
 
	$USBD_LL_DeInô
 (
USBD_H™dÀTy≥Def
 *
pdev
)

284 
	`HAL_PCD_DeInô
((
PCD_H™dÀTy≥Def
*)
pdev
->
pD©a
);

285  
USBD_OK
;

286 
	}
}

293 
USBD_SètusTy≥Def
 
	$USBD_LL_Sèπ
(
USBD_H™dÀTy≥Def
 *
pdev
)

295 
	`HAL_PCD_Sèπ
((
PCD_H™dÀTy≥Def
*)
pdev
->
pD©a
);

296  
USBD_OK
;

297 
	}
}

304 
USBD_SètusTy≥Def
 
	$USBD_LL_St›
 (
USBD_H™dÀTy≥Def
 *
pdev
)

306 
	`HAL_PCD_St›
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
);

307  
USBD_OK
;

308 
	}
}

318 
USBD_SètusTy≥Def
 
	$USBD_LL_O≥nEP
 (
USBD_H™dÀTy≥Def
 *
pdev
,

319 
uöt8_t
 
ï_addr
,

320 
uöt8_t
 
ï_ty≥
,

321 
uöt16_t
 
ï_mps
)

323 
	`HAL_PCD_EP_O≥n
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
,

324 
ï_addr
,

325 
ï_mps
,

326 
ï_ty≥
);

328  
USBD_OK
;

329 
	}
}

337 
USBD_SètusTy≥Def
 
	$USBD_LL_Clo£EP
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ï_addr
)

339 
	`HAL_PCD_EP_Clo£
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
ï_addr
);

340  
USBD_OK
;

341 
	}
}

349 
USBD_SètusTy≥Def
 
	$USBD_LL_FlushEP
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ï_addr
)

351 
	`HAL_PCD_EP_Flush
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
ï_addr
);

352  
USBD_OK
;

353 
	}
}

361 
USBD_SètusTy≥Def
 
	$USBD_LL_SèŒEP
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ï_addr
)

363 
	`HAL_PCD_EP_SëSèŒ
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
ï_addr
);

364  
USBD_OK
;

365 
	}
}

373 
USBD_SètusTy≥Def
 
	$USBD_LL_CÀ¨SèŒEP
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ï_addr
)

375 
	`HAL_PCD_EP_CÃSèŒ
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
ï_addr
);

376  
USBD_OK
;

377 
	}
}

385 
uöt8_t
 
	$USBD_LL_IsSèŒEP
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ï_addr
)

387 
PCD_H™dÀTy≥Def
 *
hpcd
 = (PCD_H™dÀTy≥Def*Ë
pdev
->
pD©a
;

389 if((
ï_addr
 & 0x80) == 0x80)

391  
hpcd
->
IN_ï
[
ï_addr
 & 0x7F].
is_°Æl
;

395  
hpcd
->
OUT_ï
[
ï_addr
 & 0x7F].
is_°Æl
;

397 
	}
}

404 
USBD_SètusTy≥Def
 
	$USBD_LL_SëUSBAddªss
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
dev_addr
)

406 
	`HAL_PCD_SëAddªss
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
dev_addr
);

407  
USBD_OK
;

408 
	}
}

418 
USBD_SètusTy≥Def
 
	$USBD_LL_Tønsmô
 (
USBD_H™dÀTy≥Def
 *
pdev
,

419 
uöt8_t
 
ï_addr
,

420 
uöt8_t
 *
pbuf
,

421 
uöt16_t
 
size
)

423 
	`HAL_PCD_EP_Tønsmô
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
ï_addr
, 
pbuf
, 
size
);

424  
USBD_OK
;

425 
	}
}

435 
USBD_SètusTy≥Def
 
	$USBD_LL_Pª∑ªRe˚ive
(
USBD_H™dÀTy≥Def
 *
pdev
,

436 
uöt8_t
 
ï_addr
,

437 
uöt8_t
 *
pbuf
,

438 
uöt16_t
 
size
)

440 
	`HAL_PCD_EP_Re˚ive
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
ï_addr
, 
pbuf
, 
size
);

441  
USBD_OK
;

442 
	}
}

450 
uöt32_t
 
	$USBD_LL_GëRxD©aSize
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ï_addr
)

452  
	`HAL_PCD_EP_GëRxCou¡
((
PCD_H™dÀTy≥Def
*Ë
pdev
->
pD©a
, 
ï_addr
);

453 
	}
}

460 
	$USBD_LL_Dñay
 (
uöt32_t
 
Dñay
)

462 
	`HAL_Dñay
(
Dñay
);

463 
	}
}

470 *
	$USBD_°©ic_mÆloc
(
uöt32_t
 
size
)

472 
uöt32_t
 
mem
[((
USBD_CDC_H™dÀTy≥Def
)/4)+1];

473  
mem
;

474 
	}
}

481 
	$USBD_°©ic_‰ì
(*
p
)

484 
	}
}

492 
	$HAL_PCDEx_SëC⁄√˘i⁄Sèã
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
°©e
)

495 i‡(
°©e
 == 1)

498 
	`__HAL_SYSCFG_USBPULLUP_ENABLE
();

503 
	`__HAL_SYSCFG_USBPULLUP_DISABLE
();

506 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\usb\cdc\src\usbd_desc.c

36 
	~"usbd_c‹e.h
"

37 
	~"usbd_desc.h
"

38 
	~"usbd_c⁄f.h
"

59 
	#USBD_VID
 1155

	)

60 
	#USBD_LANGID_STRING
 1033

	)

61 
	#USBD_MANUFACTURER_STRING
 "STMi¸€À˘r⁄ics"

	)

62 
	#USBD_PID_FS
 22336

	)

63 
	#USBD_PRODUCT_STRING_FS
 "STM32 VútuÆ ComP‹t"

	)

64 
	#USBD_SERIALNUMBER_STRING_FS
 "00000000001A"

	)

65 
	#USBD_CONFIGURATION_STRING_FS
 "CDC C⁄fig"

	)

66 
	#USBD_INTERFACE_STRING_FS
 "CDC I¡îÁ˚"

	)

85 
uöt8_t
 * 
USBD_FS_Devi˚Des¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
);

86 
uöt8_t
 * 
USBD_FS_L™gIDSåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
);

87 
uöt8_t
 * 
USBD_FS_M™uÁ˘uªrSåDes¸ùt‹
 ( 
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
);

88 
uöt8_t
 * 
USBD_FS_Produ˘SåDes¸ùt‹
 ( 
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
);

89 
uöt8_t
 * 
USBD_FS_SîülSåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
);

90 
uöt8_t
 * 
USBD_FS_C⁄figSåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
);

91 
uöt8_t
 * 
USBD_FS_I¡îÁ˚SåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
);

93 #ifde‡
USB_SUPPORT_USER_STRING_DESC


94 
uöt8_t
 * 
USBD_FS_USRSåögDesc
 (
USBD_S≥edTy≥Def
 
•ìd
, uöt8_à
idx
 , 
uöt16_t
 *
Àngth
);

97 
USBD_Des¸ùt‹sTy≥Def
 
	gFS_Desc
 =

99 
USBD_FS_Devi˚Des¸ùt‹
,

100 
USBD_FS_L™gIDSåDes¸ùt‹
,

101 
USBD_FS_M™uÁ˘uªrSåDes¸ùt‹
,

102 
USBD_FS_Produ˘SåDes¸ùt‹
,

103 
USBD_FS_SîülSåDes¸ùt‹
,

104 
USBD_FS_C⁄figSåDes¸ùt‹
,

105 
USBD_FS_I¡îÁ˚SåDes¸ùt‹
,

108 #i‡
deföed
 ( 
__ICCARM__
 )

109 #¥agm®
d©a_Æignmít
=4

112 
__ALIGN_BEGIN
 
uöt8_t
 
	gUSBD_FS_Devi˚Desc
[
USB_LEN_DEV_DESC
] 
	g__ALIGN_END
 =

115 
USB_DESC_TYPE_DEVICE
,

121 
USB_MAX_EP0_SIZE
,

122 
LOBYTE
(
USBD_VID
),

123 
HIBYTE
(
USBD_VID
),

124 
LOBYTE
(
USBD_PID_FS
),

125 
HIBYTE
(
USBD_PID_FS
),

128 
USBD_IDX_MFC_STR
,

129 
USBD_IDX_PRODUCT_STR
,

130 
USBD_IDX_SERIAL_STR
,

131 
USBD_MAX_NUM_CONFIGURATION


135 #i‡
deföed
 ( 
__ICCARM__
 )

136 #¥agm®
d©a_Æignmít
=4

140 
__ALIGN_BEGIN
 
uöt8_t
 
	gUSBD_L™gIDDesc
[
USB_LEN_LANGID_STR_DESC
] 
	g__ALIGN_END
 =

142 
USB_LEN_LANGID_STR_DESC
,

143 
USB_DESC_TYPE_STRING
,

144 
LOBYTE
(
USBD_LANGID_STRING
),

145 
HIBYTE
(
USBD_LANGID_STRING
),

148 #i‡
deföed
 ( 
__ICCARM__
 )

149 #¥agm®
d©a_Æignmít
=4

151 
__ALIGN_BEGIN
 
uöt8_t
 
	gUSBD_SåDesc
[
USBD_MAX_STR_DESC_SIZ
] 
	g__ALIGN_END
;

174 
uöt8_t
 * 
	$USBD_FS_Devi˚Des¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
)

176 *
Àngth
 = (
USBD_FS_Devi˚Desc
);

177  
USBD_FS_Devi˚Desc
;

178 
	}
}

187 
uöt8_t
 * 
	$USBD_FS_L™gIDSåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
)

189 *
Àngth
 = (
USBD_L™gIDDesc
);

190  
USBD_L™gIDDesc
;

191 
	}
}

200 
uöt8_t
 * 
	$USBD_FS_Produ˘SåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
)

202 if(
•ìd
 == 0)

204 
	`USBD_GëSåög
 (
USBD_PRODUCT_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

208 
	`USBD_GëSåög
 (
USBD_PRODUCT_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

210  
USBD_SåDesc
;

211 
	}
}

220 
uöt8_t
 * 
	$USBD_FS_M™uÁ˘uªrSåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
)

222 
	`USBD_GëSåög
 (
USBD_MANUFACTURER_STRING
, 
USBD_SåDesc
, 
Àngth
);

223  
USBD_SåDesc
;

224 
	}
}

233 
uöt8_t
 * 
	$USBD_FS_SîülSåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
)

235 if(
•ìd
 =
USBD_SPEED_HIGH
)

237 
	`USBD_GëSåög
 (
USBD_SERIALNUMBER_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

241 
	`USBD_GëSåög
 (
USBD_SERIALNUMBER_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

243  
USBD_SåDesc
;

244 
	}
}

253 
uöt8_t
 * 
	$USBD_FS_C⁄figSåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
)

255 if(
•ìd
 =
USBD_SPEED_HIGH
)

257 
	`USBD_GëSåög
 (
USBD_CONFIGURATION_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

261 
	`USBD_GëSåög
 (
USBD_CONFIGURATION_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

263  
USBD_SåDesc
;

264 
	}
}

273 
uöt8_t
 * 
	$USBD_FS_I¡îÁ˚SåDes¸ùt‹
–
USBD_S≥edTy≥Def
 
•ìd
 , 
uöt16_t
 *
Àngth
)

275 if(
•ìd
 == 0)

277 
	`USBD_GëSåög
 (
USBD_INTERFACE_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

281 
	`USBD_GëSåög
 (
USBD_INTERFACE_STRING_FS
, 
USBD_SåDesc
, 
Àngth
);

283  
USBD_SåDesc
;

284 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Inc\stm32l1xx_hal_def.h

40 #i‚de‡
__STM32L1xx_HAL_DEF


41 
	#__STM32L1xx_HAL_DEF


	)

43 #ifde‡
__˝lu•lus


48 
	~"°m32l1xx.h
"

49 
	~"Legacy/°m32_hÆ_Àgacy.h
"

50 
	~<°dio.h
>

59 
HAL_OK
 = 0x00,

60 
HAL_ERROR
 = 0x01,

61 
HAL_BUSY
 = 0x02,

62 
HAL_TIMEOUT
 = 0x03

63 } 
	tHAL_SètusTy≥Def
;

70 
HAL_UNLOCKED
 = 0x00,

71 
HAL_LOCKED
 = 0x01

72 } 
	tHAL_LockTy≥Def
;

76 
	#HAL_MAX_DELAY
 0xFFFFFFFFU

	)

78 
	#HAL_IS_BIT_SET
(
REG
, 
BIT
Ë(((REGË& (BIT)Ë!
RESET
)

	)

79 
	#HAL_IS_BIT_CLR
(
REG
, 
BIT
Ë(((REGË& (BIT)Ë=
RESET
)

	)

81 
	#__HAL_LINKDMA
(
__HANDLE__
, 
__PPP_DMA_FIELD_
, 
__DMA_HANDLE_
) \

83 (
__HANDLE__
)->
__PPP_DMA_FIELD_
 = &(
__DMA_HANDLE_
); \

84 (
__DMA_HANDLE_
).
P¨ít
 = (
__HANDLE__
); \

85 } 0)

	)

87 
	#UNUSED
(
x
Ë(()(x))

	)

104 
	#__HAL_RESET_HANDLE_STATE
(
__HANDLE__
Ë((__HANDLE__)->
Sèã
 = 0)

	)

106 #i‡(
USE_RTOS
 == 1)

109 
	#__HAL_LOCK
(
__HANDLE__
) \

111 if((
__HANDLE__
)->
Lock
 =
HAL_LOCKED
) \

113  
HAL_BUSY
; \

117 (
__HANDLE__
)->
Lock
 = 
HAL_LOCKED
; \

119 }0)

	)

121 
	#__HAL_UNLOCK
(
__HANDLE__
) \

123 (
__HANDLE__
)->
Lock
 = 
HAL_UNLOCKED
; \

124 }0)

	)

127 #i‡ 
deföed
 ( 
__GNUC__
 )

128 #i‚de‡
__wók


129 
	#__wók
 
	`__©åibuã__
((
wók
))

	)

131 #i‚de‡
__∑cked


132 
	#__∑cked
 
	`__©åibuã__
((
__∑cked__
))

	)

138 #i‡
deföed
 (
__GNUC__
)

139 #i‚de‡
__ALIGN_END


140 
	#__ALIGN_END
 
	`__©åibuã__
 ((
	`Æig√d
 (4)))

	)

142 #i‚de‡
__ALIGN_BEGIN


143 
	#__ALIGN_BEGIN


	)

146 #i‚de‡
__ALIGN_END


147 
	#__ALIGN_END


	)

149 #i‚de‡
__ALIGN_BEGIN


150 #i‡
deföed
 (
__CC_ARM
)

151 
	#__ALIGN_BEGIN
 
	`__Æign
(4)

	)

152 #ñi‡
deföed
 (
__ICCARM__
)

153 
	#__ALIGN_BEGIN


	)

161 #i‡
deföed
 ( 
__CC_ARM
 )

171 
	#__RAM_FUNC
 
HAL_SètusTy≥Def


	)

173 #ñi‡
deföed
 ( 
__ICCARM__
 )

178 
	#__RAM_FUNC
 
__ømfunc
 
HAL_SètusTy≥Def


	)

180 #ñi‡
deföed
 ( 
__GNUC__
 )

186 
	#__RAM_FUNC
 
HAL_SètusTy≥Def
 
	`__©åibuã__
((
	`£˘i⁄
(".RamFunc")))

	)

193 #i‡
deföed
 ( 
__CC_ARM
 ) || deföed ( 
__GNUC__
 )

197 
	#__NOINLINE
 
	`__©åibuã__
 ( (
noölöe
Ë)

	)

199 #ñi‡
deföed
 ( 
__ICCARM__
 )

203 
	#__NOINLINE
 
	`_Pøgma
("›timizêno_ölöe")

	)

207 #ifde‡
__˝lu•lus


	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal.c

54 
	~"°m32l1xx_hÆ.h
"

65 #ifde‡
HAL_MODULE_ENABLED


77 
	#__STM32L1xx_HAL_VERSION_MAIN
 (0x01Ë

	)

78 
	#__STM32L1xx_HAL_VERSION_SUB1
 (0x02Ë

	)

79 
	#__STM32L1xx_HAL_VERSION_SUB2
 (0x00Ë

	)

80 
	#__STM32L1xx_HAL_VERSION_RC
 (0x00Ë

	)

81 
	#__STM32L1xx_HAL_VERSION
 ((
__STM32L1xx_HAL_VERSION_MAIN
 << 24)\

82 |(
__STM32L1xx_HAL_VERSION_SUB1
 << 16)\

83 |(
__STM32L1xx_HAL_VERSION_SUB2
 << 8 )\

84 |(
__STM32L1xx_HAL_VERSION_RC
))

	)

86 
	#IDCODE_DEVID_MASK
 ((
uöt32_t
)0x00000FFF)

	)

99 
__IO
 
uöt32_t
 
	guwTick
;

157 
HAL_SètusTy≥Def
 
	$HAL_Inô
()

160 #i‡(
PREFETCH_ENABLE
 != 0)

161 
	`__HAL_FLASH_PREFETCH_BUFFER_ENABLE
();

165 
	`HAL_NVIC_SëPri‹ôyGroupög
(
NVIC_PRIORITYGROUP_4
);

168 
	`HAL_InôTick
(
TICK_INT_PRIORITY
);

171 
	`HAL_M•Inô
();

174  
HAL_OK
;

175 
	}
}

183 
HAL_SètusTy≥Def
 
	$HAL_DeInô
()

186 
	`__HAL_RCC_APB1_FORCE_RESET
();

187 
	`__HAL_RCC_APB1_RELEASE_RESET
();

189 
	`__HAL_RCC_APB2_FORCE_RESET
();

190 
	`__HAL_RCC_APB2_RELEASE_RESET
();

192 
	`__HAL_RCC_AHB_FORCE_RESET
();

193 
	`__HAL_RCC_AHB_RELEASE_RESET
();

196 
	`HAL_M•DeInô
();

199  
HAL_OK
;

200 
	}
}

206 
__wók
 
	$HAL_M•Inô
()

211 
	}
}

217 
__wók
 
	$HAL_M•DeInô
()

222 
	}
}

240 
__wók
 
HAL_SètusTy≥Def
 
	$HAL_InôTick
(
uöt32_t
 
TickPri‹ôy
)

243 
	`HAL_SYSTICK_C⁄fig
(
Sy°emC‹eClock
 /1000);

246 
	`HAL_NVIC_SëPri‹ôy
(
SysTick_IRQn
, 
TickPri‹ôy
 ,0);

249  
HAL_OK
;

250 
	}
}

288 
__wók
 
	$HAL_IncTick
()

290 
uwTick
++;

291 
	}
}

299 
__wók
 
uöt32_t
 
	$HAL_GëTick
()

301  
uwTick
;

302 
	}
}

315 
__wók
 
	$HAL_Dñay
(
__IO
 
uöt32_t
 
Dñay
)

317 
uöt32_t
 
tick°¨t
 = 0;

318 
tick°¨t
 = 
	`HAL_GëTick
();

319 (
	`HAL_GëTick
(Ë- 
tick°¨t
Ë< 
Dñay
)

322 
	}
}

334 
__wók
 
	$HAL_Su•ídTick
()

337 
	`CLEAR_BIT
(
SysTick
->
CTRL
,
SysTick_CTRL_TICKINT_Msk
);

338 
	}
}

350 
__wók
 
	$HAL_ResumeTick
()

353 
	`SET_BIT
(
SysTick
->
CTRL
,
SysTick_CTRL_TICKINT_Msk
);

354 
	}
}

360 
uöt32_t
 
	$HAL_GëHÆVîsi⁄
()

362  
__STM32L1xx_HAL_VERSION
;

363 
	}
}

369 
uöt32_t
 
	$HAL_GëREVID
()

371 ((
DBGMCU
->
IDCODE
) >> 16);

372 
	}
}

378 
uöt32_t
 
	$HAL_GëDEVID
()

380 ((
DBGMCU
->
IDCODE
Ë& 
IDCODE_DEVID_MASK
);

381 
	}
}

387 
	$HAL_DBGMCU_E«bÀDBGSÀïMode
()

389 
	`SET_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_SLEEP
);

390 
	}
}

396 
	$HAL_DBGMCU_DißbÀDBGSÀïMode
()

398 
	`CLEAR_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_SLEEP
);

399 
	}
}

405 
	$HAL_DBGMCU_E«bÀDBGSt›Mode
()

407 
	`SET_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STOP
);

408 
	}
}

414 
	$HAL_DBGMCU_DißbÀDBGSt›Mode
()

416 
	`CLEAR_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STOP
);

417 
	}
}

423 
	$HAL_DBGMCU_E«bÀDBGSèndbyMode
()

425 
	`SET_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STANDBY
);

426 
	}
}

432 
	$HAL_DBGMCU_DißbÀDBGSèndbyMode
()

434 
	`CLEAR_BIT
(
DBGMCU
->
CR
, 
DBGMCU_CR_DBG_STANDBY
);

435 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_adc.c

287 
	~"°m32l1xx_hÆ.h
"

298 #ifde‡
HAL_ADC_MODULE_ENABLED


312 
	#ADC_ENABLE_TIMEOUT
 ((
uöt32_t
Ë2)

	)

313 
	#ADC_DISABLE_TIMEOUT
 ((
uöt32_t
Ë2)

	)

318 
	#ADC_STAB_DELAY_US
 ((
uöt32_t
Ë3)

	)

323 
	#ADC_TEMPSENSOR_DELAY_US
 ((
uöt32_t
Ë10)

	)

335 
ADC_DMAC⁄vC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
);

336 
ADC_DMAHÆfC⁄vC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
);

337 
ADC_DMAEº‹
(
DMA_H™dÀTy≥Def
 *
hdma
);

385 
HAL_SètusTy≥Def
 
	$HAL_ADC_Inô
(
ADC_H™dÀTy≥Def
* 
hadc
)

387 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

388 
uöt32_t
 
tmp_¸1
 = 0;

389 
uöt32_t
 
tmp_¸2
 = 0;

392 if(
hadc
 =
NULL
)

394  
HAL_ERROR
;

398 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

399 
	`as£π_∑øm
(
	`IS_ADC_CLOCKPRESCALER
(
hadc
->
Inô
.
ClockPªsˇÀr
));

400 
	`as£π_∑øm
(
	`IS_ADC_RESOLUTION
(
hadc
->
Inô
.
Resﬁuti⁄
));

401 
	`as£π_∑øm
(
	`IS_ADC_DATA_ALIGN
(
hadc
->
Inô
.
D©aAlign
));

402 
	`as£π_∑øm
(
	`IS_ADC_SCAN_MODE
(
hadc
->
Inô
.
SˇnC⁄vMode
));

403 
	`as£π_∑øm
(
	`IS_ADC_EOC_SELECTION
(
hadc
->
Inô
.
EOCSñe˘i⁄
));

404 
	`as£π_∑øm
(
	`IS_ADC_AUTOWAIT
(
hadc
->
Inô
.
LowPowîAutoWaô
));

405 
	`as£π_∑øm
(
	`IS_ADC_AUTOPOWEROFF
(
hadc
->
Inô
.
LowPowîAutoPowîOff
));

406 
	`as£π_∑øm
(
	`IS_ADC_CHANNELSBANK
(
hadc
->
Inô
.
Ch™√lsB™k
));

407 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
hadc
->
Inô
.
C⁄töuousC⁄vMode
));

408 
	`as£π_∑øm
(
	`IS_ADC_EXTTRIG
(
hadc
->
Inô
.
Exã∫ÆTrigC⁄v
));

409 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
hadc
->
Inô
.
DMAC⁄töuousReque°s
));

411 if(
hadc
->
Inô
.
SˇnC⁄vMode
 !
ADC_SCAN_DISABLE
)

413 
	`as£π_∑øm
(
	`IS_ADC_REGULAR_NB_CONV
(
hadc
->
Inô
.
NbrOfC⁄vîsi⁄
));

414 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
hadc
->
Inô
.
Disc⁄töuousC⁄vMode
));

415 if(
hadc
->
Inô
.
Disc⁄töuousC⁄vMode
 !
DISABLE
)

417 
	`as£π_∑øm
(
	`IS_ADC_REGULAR_DISCONT_NUMBER
(
hadc
->
Inô
.
NbrOfDiscC⁄vîsi⁄
));

421 if(
hadc
->
Inô
.
Exã∫ÆTrigC⁄v
 !
ADC_SOFTWARE_START
)

423 
	`as£π_∑øm
(
	`IS_ADC_EXTTRIG_EDGE
(
hadc
->
Inô
.
Exã∫ÆTrigC⁄vEdge
));

434 i‡(
hadc
->
Sèã
 =
HAL_ADC_STATE_RESET
)

437 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

440 
hadc
->
Lock
 = 
HAL_UNLOCKED
;

443 
	`__HAL_RCC_SYSCFG_CLK_ENABLE
();

446 
	`HAL_ADC_M•Inô
(
hadc
);

451 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_INTERNAL
))

454 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

455 
HAL_ADC_STATE_REG_BUSY
 | 
HAL_ADC_STATE_INJ_BUSY
,

456 
HAL_ADC_STATE_BUSY_INTERNAL
);

462 
	`MODIFY_REG
(
ADC
->
CCR
 ,

463 
ADC_CCR_ADCPRE
 ,

464 
hadc
->
Inô
.
ClockPªsˇÀr
 );

472 
tmp_¸2
 |(
hadc
->
Inô
.
D©aAlign
 |

473 
hadc
->
Inô
.
EOCSñe˘i⁄
 |

474 
	`ADC_CR2_DMACONTREQ
(
hadc
->
Inô
.
DMAC⁄töuousReque°s
) |

475 
hadc
->
Inô
.
Ch™√lsB™k
 |

476 
	`ADC_CR2_CONTINUOUS
(
hadc
->
Inô
.
C⁄töuousC⁄vMode
) );

483 i‡(
hadc
->
Inô
.
Exã∫ÆTrigC⁄v
 !
ADC_SOFTWARE_START
)

485 
tmp_¸2
 |–
hadc
->
Inô
.
Exã∫ÆTrigC⁄v
 |

486 
hadc
->
Inô
.
Exã∫ÆTrigC⁄vEdge
 );

497 i‡((
	`ADC_IS_ENABLE
(
hadc
Ë=
RESET
))

499 
tmp_¸2
 |
hadc
->
Inô
.
LowPowîAutoWaô
;

501 
tmp_¸1
 |(
hadc
->
Inô
.
Resﬁuti⁄
 |

502 
hadc
->
Inô
.
LowPowîAutoPowîOff
 |

503 
	`ADC_CR1_SCAN_SET
(
hadc
->
Inô
.
SˇnC⁄vMode
) );

508 i‡(
hadc
->
Inô
.
Disc⁄töuousC⁄vMode
 =
ENABLE
)

510 i‡(
hadc
->
Inô
.
C⁄töuousC⁄vMode
 =
DISABLE
)

514 
	`SET_BIT
(
tmp_¸1
, 
ADC_CR1_DISCEN
 |

515 
	`ADC_CR1_DISCONTINUOUS_NUM
(
hadc
->
Inô
.
NbrOfDiscC⁄vîsi⁄
) );

523 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_CONFIG
);

526 
	`SET_BIT
(
hadc
->
Eº‹Code
, 
HAL_ADC_ERROR_INTERNAL
);

531 
	`MODIFY_REG
(
hadc
->
In°™˚
->
CR1
,

532 
ADC_CR1_RES
 |

533 
ADC_CR1_PDI
 |

534 
ADC_CR1_PDD
 |

535 
ADC_CR1_DISCNUM
 |

536 
ADC_CR1_DISCEN
 |

537 
ADC_CR1_SCAN
 ,

538 
tmp_¸1
 );

542 
	`MODIFY_REG
(
hadc
->
In°™˚
->
CR2
 ,

543 
	`ADC_CR2_MASK_ADCINIT
() ,

544 
tmp_¸2
 );

555 i‡(
	`ADC_CR1_SCAN_SET
(
hadc
->
Inô
.
SˇnC⁄vMode
Ë=
ADC_SCAN_ENABLE
)

557 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SQR1
 ,

558 
ADC_SQR1_L
 ,

559 
	`ADC_SQR1_L_SHIFT
(
hadc
->
Inô
.
NbrOfC⁄vîsi⁄
) );

563 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SQR1
,

564 
ADC_SQR1_L
 ,

572 i‡((
	`READ_REG
(
hadc
->
In°™˚
->
CR2
Ë& ~(
ADC_CR2_ADON
 |

573 
ADC_CR2_SWSTART
 | 
ADC_CR2_JSWSTART
 |

574 
ADC_CR2_JEXTEN
 | 
ADC_CR2_JEXTSEL
 ))

575 =
tmp_¸2
)

578 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

581 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

582 
HAL_ADC_STATE_BUSY_INTERNAL
,

583 
HAL_ADC_STATE_READY
);

588 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

589 
HAL_ADC_STATE_BUSY_INTERNAL
,

590 
HAL_ADC_STATE_ERROR_INTERNAL
);

593 
	`SET_BIT
(
hadc
->
Eº‹Code
, 
HAL_ADC_ERROR_INTERNAL
);

595 
tmp_hÆ_°©us
 = 
HAL_ERROR
;

601 
tmp_hÆ_°©us
 = 
HAL_ERROR
;

605  
tmp_hÆ_°©us
;

606 
	}
}

617 
HAL_SètusTy≥Def
 
	$HAL_ADC_DeInô
(
ADC_H™dÀTy≥Def
* 
hadc
)

619 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

622 if(
hadc
 =
NULL
)

624  
HAL_ERROR
;

628 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

631 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_BUSY_INTERNAL
);

635 
tmp_hÆ_°©us
 = 
	`ADC_C⁄vîsi⁄St›_DißbÀ
(
hadc
);

640 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

644 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, (
ADC_FLAG_AWD
 | 
ADC_FLAG_JEOC
 | 
ADC_FLAG_EOC
 |

645 
ADC_FLAG_JSTRT
 | 
ADC_FLAG_STRT
));

648 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
CR1
, (
ADC_CR1_OVRIE
 | 
ADC_CR1_RES
 | 
ADC_CR1_AWDEN
 |

649 
ADC_CR1_JAWDEN
 | 
ADC_CR1_PDI
 | 
ADC_CR1_PDD
 |

650 
ADC_CR1_DISCNUM
 | 
ADC_CR1_JDISCEN
 | 
ADC_CR1_DISCEN
 |

651 
ADC_CR1_JAUTO
 | 
ADC_CR1_AWDSGL
 | 
ADC_CR1_SCAN
 |

652 
ADC_CR1_JEOCIE
 | 
ADC_CR1_AWDIE
 | 
ADC_CR1_EOCIE
 |

653 
ADC_CR1_AWDCH
 ));

656 
	`ADC_CR2_CLEAR
(
hadc
);

659 
	`ADC_SMPR0_CLEAR
(
hadc
);

662 
	`ADC_SMPR1_CLEAR
(
hadc
);

665 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
SMPR2
, (
ADC_SMPR2_SMP19
 | 
ADC_SMPR2_SMP18
 | 
ADC_SMPR2_SMP17
 |

666 
ADC_SMPR2_SMP16
 | 
ADC_SMPR2_SMP15
 | 
ADC_SMPR2_SMP14
 |

667 
ADC_SMPR2_SMP13
 | 
ADC_SMPR2_SMP12
 | 
ADC_SMPR2_SMP11
 |

668 
ADC_SMPR2_SMP10
 ));

671 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
SMPR3
, (
ADC_SMPR3_SMP9
 | 
ADC_SMPR3_SMP8
 | 
ADC_SMPR3_SMP7
 |

672 
ADC_SMPR3_SMP6
 | 
ADC_SMPR3_SMP5
 | 
ADC_SMPR3_SMP4
 |

673 
ADC_SMPR3_SMP3
 | 
ADC_SMPR3_SMP2
 | 
ADC_SMPR3_SMP1
 |

674 
ADC_SMPR3_SMP0
 ));

677 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
JOFR1
, 
ADC_JOFR1_JOFFSET1
);

679 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
JOFR2
, 
ADC_JOFR2_JOFFSET2
);

681 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
JOFR3
, 
ADC_JOFR3_JOFFSET3
);

683 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
JOFR4
, 
ADC_JOFR4_JOFFSET4
);

686 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
HTR
, 
ADC_HTR_HT
);

688 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
LTR
, 
ADC_LTR_LT
);

691 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
SQR1
, (
ADC_SQR1_L
 | 
__ADC_SQR1_SQXX
));

694 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
SQR2
, (
ADC_SQR2_SQ24
 | 
ADC_SQR2_SQ23
 | 
ADC_SQR2_SQ22
 |

695 
ADC_SQR2_SQ21
 | 
ADC_SQR2_SQ20
 | 
ADC_SQR2_SQ19
 ));

698 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
SQR3
, (
ADC_SQR3_SQ18
 | 
ADC_SQR3_SQ17
 | 
ADC_SQR3_SQ16
 |

699 
ADC_SQR3_SQ15
 | 
ADC_SQR3_SQ14
 | 
ADC_SQR3_SQ13
 ));

702 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
SQR4
, (
ADC_SQR4_SQ12
 | 
ADC_SQR4_SQ11
 | 
ADC_SQR4_SQ10
 |

703 
ADC_SQR4_SQ9
 | 
ADC_SQR4_SQ8
 | 
ADC_SQR4_SQ7
 ));

706 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
SQR5
, (
ADC_SQR5_SQ6
 | 
ADC_SQR5_SQ5
 | 
ADC_SQR5_SQ4
 |

707 
ADC_SQR5_SQ3
 | 
ADC_SQR5_SQ2
 | 
ADC_SQR5_SQ1
 ));

711 
	`CLEAR_BIT
(
hadc
->
In°™˚
->
JSQR
, (
ADC_JSQR_JL
 |

712 
ADC_JSQR_JSQ4
 | 
ADC_JSQR_JSQ3
 |

713 
ADC_JSQR_JSQ2
 | 
ADC_JSQR_JSQ1
 ));

722 
	`CLEAR_BIT
(
ADC
->
CCR
, 
ADC_CCR_TSVREFE
);

734 
	`HAL_ADC_M•DeInô
(
hadc
);

737 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

740 
hadc
->
Sèã
 = 
HAL_ADC_STATE_RESET
;

745 
	`__HAL_UNLOCK
(
hadc
);

748  
tmp_hÆ_°©us
;

749 
	}
}

756 
__wók
 
	$HAL_ADC_M•Inô
(
ADC_H™dÀTy≥Def
* 
hadc
)

759 
	`UNUSED
(
hadc
);

764 
	}
}

771 
__wók
 
	$HAL_ADC_M•DeInô
(
ADC_H™dÀTy≥Def
* 
hadc
)

774 
	`UNUSED
(
hadc
);

779 
	}
}

813 
HAL_SètusTy≥Def
 
	$HAL_ADC_Sèπ
(
ADC_H™dÀTy≥Def
* 
hadc
)

815 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

818 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

821 
	`__HAL_LOCK
(
hadc
);

824 
tmp_hÆ_°©us
 = 
	`ADC_E«bÀ
(
hadc
);

827 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

832 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

833 
HAL_ADC_STATE_READY
 | 
HAL_ADC_STATE_REG_EOC
 | 
HAL_ADC_STATE_REG_OVR
,

834 
HAL_ADC_STATE_REG_BUSY
);

838 i‡(
	`READ_BIT
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
Ë!
RESET
)

840 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_EOC
, 
HAL_ADC_STATE_INJ_BUSY
);

844 i‡(
	`HAL_IS_BIT_SET
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
))

847 
	`CLEAR_BIT
(
hadc
->
Eº‹Code
, (
HAL_ADC_ERROR_OVR
 | 
HAL_ADC_ERROR_DMA
));

852 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

858 
	`__HAL_UNLOCK
(
hadc
);

862 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_EOC
 | 
ADC_FLAG_OVR
);

868 i‡(
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
))

871 
	`SET_BIT
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_SWSTART
);

876  
tmp_hÆ_°©us
;

877 
	}
}

888 
HAL_SètusTy≥Def
 
	$HAL_ADC_St›
(
ADC_H™dÀTy≥Def
* 
hadc
)

890 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

893 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

896 
	`__HAL_LOCK
(
hadc
);

900 
tmp_hÆ_°©us
 = 
	`ADC_C⁄vîsi⁄St›_DißbÀ
(
hadc
);

903 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

906 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

907 
HAL_ADC_STATE_REG_BUSY
 | 
HAL_ADC_STATE_INJ_BUSY
,

908 
HAL_ADC_STATE_READY
);

912 
	`__HAL_UNLOCK
(
hadc
);

915  
tmp_hÆ_°©us
;

916 
	}
}

936 
HAL_SètusTy≥Def
 
	$HAL_ADC_PﬁlF‹C⁄vîsi⁄
(
ADC_H™dÀTy≥Def
* 
hadc
, 
uöt32_t
 
Timeout
)

938 
uöt32_t
 
tick°¨t
 = 0;

941 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

949 i‡(
	`HAL_IS_BIT_SET
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_EOCS
) &&

950 
	`HAL_IS_BIT_SET
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_DMA
) )

953 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_CONFIG
);

956 
	`__HAL_UNLOCK
(
hadc
);

958  
HAL_ERROR
;

962 
tick°¨t
 = 
	`HAL_GëTick
();

965 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
SR
, 
ADC_FLAG_EOC
))

968 if(
Timeout
 !
HAL_MAX_DELAY
)

970 if((
Timeout
 =0Ë|| ((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

973 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_TIMEOUT
);

976 
	`__HAL_UNLOCK
(
hadc
);

978  
HAL_TIMEOUT
;

986 i‡(
hadc
->
Inô
.
LowPowîAutoWaô
 =
DISABLE
)

989 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_STRT
 | 
ADC_FLAG_EOC
);

993 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_EOC
);

1001 if(
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
) &&

1002 (
hadc
->
Inô
.
C⁄töuousC⁄vMode
 =
DISABLE
) &&

1003 (
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
SQR1
, 
ADC_SQR1_L
) ||

1004 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_EOCS
) ) )

1007 
	`CLEAR_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_BUSY
);

1009 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
))

1011 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_READY
);

1016  
HAL_OK
;

1017 
	}
}

1029 
HAL_SètusTy≥Def
 
	$HAL_ADC_PﬁlF‹Evít
(
ADC_H™dÀTy≥Def
* 
hadc
, 
uöt32_t
 
EvítTy≥
, uöt32_à
Timeout
)

1031 
uöt32_t
 
tick°¨t
 = 0;

1034 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1035 
	`as£π_∑øm
(
	`IS_ADC_EVENT_TYPE
(
EvítTy≥
));

1038 
tick°¨t
 = 
	`HAL_GëTick
();

1041 
	`__HAL_ADC_GET_FLAG
(
hadc
, 
EvítTy≥
Ë=
RESET
)

1044 if(
Timeout
 !
HAL_MAX_DELAY
)

1046 if((
Timeout
 =0Ë|| ((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1049 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_TIMEOUT
);

1052 
	`__HAL_UNLOCK
(
hadc
);

1054  
HAL_TIMEOUT
;

1059 
EvítTy≥
)

1062 
ADC_AWD_EVENT
:

1064 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_AWD1
);

1067 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_AWD
);

1077 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_OVR
);

1079 
	`SET_BIT
(
hadc
->
Eº‹Code
, 
HAL_ADC_ERROR_OVR
);

1082 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_OVR
);

1087  
HAL_OK
;

1088 
	}
}

1099 
HAL_SètusTy≥Def
 
	$HAL_ADC_Sèπ_IT
(
ADC_H™dÀTy≥Def
* 
hadc
)

1101 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

1104 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1107 
	`__HAL_LOCK
(
hadc
);

1110 
tmp_hÆ_°©us
 = 
	`ADC_E«bÀ
(
hadc
);

1113 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

1118 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

1119 
HAL_ADC_STATE_READY
 | 
HAL_ADC_STATE_REG_EOC
 | 
HAL_ADC_STATE_REG_OVR
,

1120 
HAL_ADC_STATE_REG_BUSY
);

1124 i‡(
	`READ_BIT
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
Ë!
RESET
)

1126 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_EOC
, 
HAL_ADC_STATE_INJ_BUSY
);

1130 i‡(
	`HAL_IS_BIT_SET
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
))

1133 
	`CLEAR_BIT
(
hadc
->
Eº‹Code
, (
HAL_ADC_ERROR_OVR
 | 
HAL_ADC_ERROR_DMA
));

1138 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

1144 
	`__HAL_UNLOCK
(
hadc
);

1148 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_EOC
 | 
ADC_FLAG_OVR
);

1151 
	`__HAL_ADC_ENABLE_IT
(
hadc
, (
ADC_IT_EOC
 | 
ADC_IT_OVR
));

1157 i‡(
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
))

1160 
	`SET_BIT
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_SWSTART
);

1165  
tmp_hÆ_°©us
;

1166 
	}
}

1175 
HAL_SètusTy≥Def
 
	$HAL_ADC_St›_IT
(
ADC_H™dÀTy≥Def
* 
hadc
)

1177 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

1180 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1183 
	`__HAL_LOCK
(
hadc
);

1187 
tmp_hÆ_°©us
 = 
	`ADC_C⁄vîsi⁄St›_DißbÀ
(
hadc
);

1190 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

1193 
	`__HAL_ADC_DISABLE_IT
(
hadc
, 
ADC_IT_EOC
);

1196 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

1197 
HAL_ADC_STATE_REG_BUSY
 | 
HAL_ADC_STATE_INJ_BUSY
,

1198 
HAL_ADC_STATE_READY
);

1202 
	`__HAL_UNLOCK
(
hadc
);

1205  
tmp_hÆ_°©us
;

1206 
	}
}

1221 
HAL_SètusTy≥Def
 
	$HAL_ADC_Sèπ_DMA
(
ADC_H™dÀTy≥Def
* 
hadc
, 
uöt32_t
* 
pD©a
, uöt32_à
Lígth
)

1223 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

1226 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1229 
	`__HAL_LOCK
(
hadc
);

1232 
tmp_hÆ_°©us
 = 
	`ADC_E«bÀ
(
hadc
);

1235 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

1240 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

1241 
HAL_ADC_STATE_READY
 | 
HAL_ADC_STATE_REG_EOC
 | 
HAL_ADC_STATE_REG_OVR
,

1242 
HAL_ADC_STATE_REG_BUSY
);

1246 i‡(
	`READ_BIT
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
Ë!
RESET
)

1248 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_EOC
, 
HAL_ADC_STATE_INJ_BUSY
);

1252 i‡(
	`HAL_IS_BIT_SET
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
))

1255 
	`CLEAR_BIT
(
hadc
->
Eº‹Code
, (
HAL_ADC_ERROR_OVR
 | 
HAL_ADC_ERROR_DMA
));

1260 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

1266 
	`__HAL_UNLOCK
(
hadc
);

1269 
hadc
->
DMA_H™dÀ
->
X„rC∂tCÆlback
 = 
ADC_DMAC⁄vC∂t
;

1272 
hadc
->
DMA_H™dÀ
->
X„rHÆfC∂tCÆlback
 = 
ADC_DMAHÆfC⁄vC∂t
;

1275 
hadc
->
DMA_H™dÀ
->
X„rEº‹CÆlback
 = 
ADC_DMAEº‹
;

1283 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_EOC
 | 
ADC_FLAG_OVR
);

1286 
	`__HAL_ADC_ENABLE_IT
(
hadc
, 
ADC_IT_OVR
);

1289 
hadc
->
In°™˚
->
CR2
 |
ADC_CR2_DMA
;

1292 
	`HAL_DMA_Sèπ_IT
(
hadc
->
DMA_H™dÀ
, (
uöt32_t
)&hadc->
In°™˚
->
DR
, (uöt32_t)
pD©a
, 
Lígth
);

1300 i‡(
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
))

1303 
	`SET_BIT
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_SWSTART
);

1308  
tmp_hÆ_°©us
;

1309 
	}
}

1321 
HAL_SètusTy≥Def
 
	$HAL_ADC_St›_DMA
(
ADC_H™dÀTy≥Def
* 
hadc
)

1323 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

1326 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1329 
	`__HAL_LOCK
(
hadc
);

1333 
tmp_hÆ_°©us
 = 
	`ADC_C⁄vîsi⁄St›_DißbÀ
(
hadc
);

1336 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

1339 
hadc
->
In°™˚
->
CR2
 &~
ADC_CR2_DMA
;

1343 
tmp_hÆ_°©us
 = 
	`HAL_DMA_Ab‹t
(
hadc
->
DMA_H™dÀ
);

1346 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

1349 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

1350 
HAL_ADC_STATE_REG_BUSY
 | 
HAL_ADC_STATE_INJ_BUSY
,

1351 
HAL_ADC_STATE_READY
);

1356 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_DMA
);

1360 
	`__HAL_ADC_DISABLE_IT
(
hadc
, 
ADC_IT_OVR
);

1364 
	`__HAL_UNLOCK
(
hadc
);

1367  
tmp_hÆ_°©us
;

1368 
	}
}

1389 
uöt32_t
 
	$HAL_ADC_GëVÆue
(
ADC_H™dÀTy≥Def
* 
hadc
)

1392 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1398  
hadc
->
In°™˚
->
DR
;

1399 
	}
}

1406 
	$HAL_ADC_IRQH™dÀr
(
ADC_H™dÀTy≥Def
* 
hadc
)

1409 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1410 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
hadc
->
Inô
.
C⁄töuousC⁄vMode
));

1411 
	`as£π_∑øm
(
	`IS_ADC_REGULAR_NB_CONV
(
hadc
->
Inô
.
NbrOfC⁄vîsi⁄
));

1415 if(
	`__HAL_ADC_GET_IT_SOURCE
(
hadc
, 
ADC_IT_EOC
))

1417 if(
	`__HAL_ADC_GET_FLAG
(
hadc
, 
ADC_FLAG_EOC
) )

1420 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_INTERNAL
))

1423 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_EOC
);

1432 if(
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
) &&

1433 (
hadc
->
Inô
.
C⁄töuousC⁄vMode
 =
DISABLE
) &&

1434 (
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
SQR1
, 
ADC_SQR1_L
) ||

1435 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_EOCS
) ) )

1441 
	`__HAL_ADC_DISABLE_IT
(
hadc
, 
ADC_IT_EOC
);

1444 
	`CLEAR_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_BUSY
);

1446 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
))

1448 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_READY
);

1453 
	`HAL_ADC_C⁄vC∂tCÆlback
(
hadc
);

1456 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_STRT
 | 
ADC_FLAG_EOC
);

1461 if(
	`__HAL_ADC_GET_IT_SOURCE
(
hadc
, 
ADC_IT_JEOC
))

1463 if(
	`__HAL_ADC_GET_FLAG
(
hadc
, 
ADC_FLAG_JEOC
))

1466 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_INTERNAL
))

1469 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_EOC
);

1476 if(
	`ADC_IS_SOFTWARE_START_INJECTED
(
hadc
) &&

1477 (
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
JSQR
, 
ADC_JSQR_JL
) ||

1478 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_EOCS
) ) &&

1479 (
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
) &&

1480 (
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
) &&

1481 (
hadc
->
Inô
.
C⁄töuousC⁄vMode
 =
DISABLE
) ) ) )

1484 
	`__HAL_ADC_DISABLE_IT
(
hadc
, 
ADC_IT_JEOC
);

1487 
	`CLEAR_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
);

1489 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_BUSY
))

1491 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_READY
);

1496 
	`HAL_ADCEx_Inje˘edC⁄vC∂tCÆlback
(
hadc
);

1499 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, (
ADC_FLAG_JSTRT
 | 
ADC_FLAG_JEOC
));

1504 if(
	`__HAL_ADC_GET_IT_SOURCE
(
hadc
, 
ADC_IT_AWD
))

1506 if(
	`__HAL_ADC_GET_FLAG
(
hadc
, 
ADC_FLAG_AWD
))

1509 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_AWD1
);

1512 
	`HAL_ADC_LevñOutOfWödowCÆlback
(
hadc
);

1515 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_AWD
);

1520 if(
	`__HAL_ADC_GET_IT_SOURCE
(
hadc
, 
ADC_IT_OVR
))

1522 if(
	`__HAL_ADC_GET_FLAG
(
hadc
, 
ADC_FLAG_OVR
))

1529 
	`SET_BIT
(
hadc
->
Eº‹Code
, 
HAL_ADC_ERROR_OVR
);

1532 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_OVR
);

1535 
	`HAL_ADC_Eº‹CÆlback
(
hadc
);

1538 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_OVR
);

1542 
	}
}

1549 
__wók
 
	$HAL_ADC_C⁄vC∂tCÆlback
(
ADC_H™dÀTy≥Def
* 
hadc
)

1552 
	`UNUSED
(
hadc
);

1557 
	}
}

1564 
__wók
 
	$HAL_ADC_C⁄vHÆfC∂tCÆlback
(
ADC_H™dÀTy≥Def
* 
hadc
)

1567 
	`UNUSED
(
hadc
);

1572 
	}
}

1579 
__wók
 
	$HAL_ADC_LevñOutOfWödowCÆlback
(
ADC_H™dÀTy≥Def
* 
hadc
)

1582 
	`UNUSED
(
hadc
);

1587 
	}
}

1601 
__wók
 
	$HAL_ADC_Eº‹CÆlback
(
ADC_H™dÀTy≥Def
 *
hadc
)

1604 
	`UNUSED
(
hadc
);

1609 
	}
}

1650 
HAL_SètusTy≥Def
 
	$HAL_ADC_C⁄figCh™√l
(
ADC_H™dÀTy≥Def
* 
hadc
, 
ADC_Ch™√lC⁄fTy≥Def
* 
sC⁄fig
)

1652 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

1653 
__IO
 
uöt32_t
 
waô_lo›_ödex
 = 0;

1656 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1657 
	`as£π_∑øm
(
	`IS_ADC_CHANNEL
(
sC⁄fig
->
Ch™√l
));

1658 
	`as£π_∑øm
(
	`IS_ADC_REGULAR_RANK
(
sC⁄fig
->
R™k
));

1659 
	`as£π_∑øm
(
	`IS_ADC_SAMPLE_TIME
(
sC⁄fig
->
Sam∂ögTime
));

1662 
	`__HAL_LOCK
(
hadc
);

1667 i‡(
sC⁄fig
->
R™k
 < 7)

1669 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SQR5
,

1670 
	`ADC_SQR5_RK
(
ADC_SQR5_SQ1
, 
sC⁄fig
->
R™k
),

1671 
	`ADC_SQR5_RK
(
sC⁄fig
->
Ch™√l
, sC⁄fig->
R™k
) );

1674 i‡(
sC⁄fig
->
R™k
 < 13)

1676 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SQR4
,

1677 
	`ADC_SQR4_RK
(
ADC_SQR4_SQ7
, 
sC⁄fig
->
R™k
),

1678 
	`ADC_SQR4_RK
(
sC⁄fig
->
Ch™√l
, sC⁄fig->
R™k
) );

1681 i‡(
sC⁄fig
->
R™k
 < 19)

1683 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SQR3
,

1684 
	`ADC_SQR3_RK
(
ADC_SQR3_SQ13
, 
sC⁄fig
->
R™k
),

1685 
	`ADC_SQR3_RK
(
sC⁄fig
->
Ch™√l
, sC⁄fig->
R™k
) );

1688 i‡(
sC⁄fig
->
R™k
 < 25)

1690 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SQR2
,

1691 
	`ADC_SQR2_RK
(
ADC_SQR2_SQ19
, 
sC⁄fig
->
R™k
),

1692 
	`ADC_SQR2_RK
(
sC⁄fig
->
Ch™√l
, sC⁄fig->
R™k
) );

1697 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SQR1
,

1698 
	`ADC_SQR1_RK
(
ADC_SQR1_SQ25
, 
sC⁄fig
->
R™k
),

1699 
	`ADC_SQR1_RK
(
sC⁄fig
->
Ch™√l
, sC⁄fig->
R™k
) );

1705 i‡(
sC⁄fig
->
Ch™√l
 < 
ADC_CHANNEL_10
)

1707 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SMPR3
,

1708 
	`ADC_SMPR3
(
ADC_SMPR3_SMP0
, 
sC⁄fig
->
Ch™√l
),

1709 
	`ADC_SMPR3
(
sC⁄fig
->
Sam∂ögTime
, sC⁄fig->
Ch™√l
) );

1712 i‡(
sC⁄fig
->
Ch™√l
 < 
ADC_CHANNEL_20
)

1714 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SMPR2
,

1715 
	`ADC_SMPR2
(
ADC_SMPR2_SMP10
, 
sC⁄fig
->
Ch™√l
),

1716 
	`ADC_SMPR2
(
sC⁄fig
->
Sam∂ögTime
, sC⁄fig->
Ch™√l
) );

1720 i‡(
sC⁄fig
->
Ch™√l
 <
ADC_SMPR1_CHANNEL_MAX
)

1722 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SMPR1
,

1723 
	`ADC_SMPR1
(
ADC_SMPR1_SMP20
, 
sC⁄fig
->
Ch™√l
),

1724 
	`ADC_SMPR1
(
sC⁄fig
->
Sam∂ögTime
, sC⁄fig->
Ch™√l
) );

1729 
	`ADC_SMPR0_CHANNEL_SET
(
hadc
, 
sC⁄fig
->
Sam∂ögTime
, sC⁄fig->
Ch™√l
);

1734 i‡((
sC⁄fig
->
Ch™√l
 =
ADC_CHANNEL_TEMPSENSOR
) ||

1735 (
sC⁄fig
->
Ch™√l
 =
ADC_CHANNEL_VREFINT
) )

1737 i‡(
	`READ_BIT
(
ADC
->
CCR
, 
ADC_CCR_TSVREFE
Ë=
RESET
)

1739 
	`SET_BIT
(
ADC
->
CCR
, 
ADC_CCR_TSVREFE
);

1741 i‡((
sC⁄fig
->
Ch™√l
 =
ADC_CHANNEL_TEMPSENSOR
))

1745 
waô_lo›_ödex
 = (
ADC_TEMPSENSOR_DELAY_US
 * (
Sy°emC‹eClock
 / 1000000));

1746 
waô_lo›_ödex
 != 0)

1748 
waô_lo›_ödex
--;

1755 
	`__HAL_UNLOCK
(
hadc
);

1758  
tmp_hÆ_°©us
;

1759 
	}
}

1775 
HAL_SètusTy≥Def
 
	$HAL_ADC_A«logWDGC⁄fig
(
ADC_H™dÀTy≥Def
* 
hadc
, 
ADC_A«logWDGC⁄fTy≥Def
* 
A«logWDGC⁄fig
)

1778 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

1779 
	`as£π_∑øm
(
	`IS_ADC_ANALOG_WATCHDOG_MODE
(
A«logWDGC⁄fig
->
W©chdogMode
));

1780 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
A«logWDGC⁄fig
->
ITMode
));

1781 
	`as£π_∑øm
(
	`IS_ADC_RANGE
(
ADC_RESOLUTION_12B
, 
A«logWDGC⁄fig
->
HighThªshﬁd
));

1782 
	`as£π_∑øm
(
	`IS_ADC_RANGE
(
ADC_RESOLUTION_12B
, 
A«logWDGC⁄fig
->
LowThªshﬁd
));

1784 if((
A«logWDGC⁄fig
->
W©chdogMode
 =
ADC_ANALOGWATCHDOG_SINGLE_REG
) ||

1785 (
A«logWDGC⁄fig
->
W©chdogMode
 =
ADC_ANALOGWATCHDOG_SINGLE_INJEC
) ||

1786 (
A«logWDGC⁄fig
->
W©chdogMode
 =
ADC_ANALOGWATCHDOG_SINGLE_REGINJEC
) )

1788 
	`as£π_∑øm
(
	`IS_ADC_CHANNEL
(
A«logWDGC⁄fig
->
Ch™√l
));

1792 
	`__HAL_LOCK
(
hadc
);

1797 if(
A«logWDGC⁄fig
->
ITMode
 =
ENABLE
)

1800 
	`__HAL_ADC_ENABLE_IT
(
hadc
, 
ADC_IT_AWD
);

1805 
	`__HAL_ADC_DISABLE_IT
(
hadc
, 
ADC_IT_AWD
);

1813 
hadc
->
In°™˚
->
CR1
 &~–
ADC_CR1_AWDSGL
 |

1814 
ADC_CR1_JAWDEN
 |

1815 
ADC_CR1_AWDEN
 |

1816 
ADC_CR1_AWDCH
 );

1818 
hadc
->
In°™˚
->
CR1
 |–
A«logWDGC⁄fig
->
W©chdogMode
 |

1819 
A«logWDGC⁄fig
->
Ch™√l
 );

1822 
hadc
->
In°™˚
->
HTR
 = 
A«logWDGC⁄fig
->
HighThªshﬁd
;

1825 
hadc
->
In°™˚
->
LTR
 = 
A«logWDGC⁄fig
->
LowThªshﬁd
;

1828 
	`__HAL_UNLOCK
(
hadc
);

1831  
HAL_OK
;

1832 
	}
}

1862 
uöt32_t
 
	$HAL_ADC_GëSèã
(
ADC_H™dÀTy≥Def
* 
hadc
)

1865  
hadc
->
Sèã
;

1866 
	}
}

1873 
uöt32_t
 
	$HAL_ADC_GëEº‹
(
ADC_H™dÀTy≥Def
 *
hadc
)

1875  
hadc
->
Eº‹Code
;

1876 
	}
}

1903 
HAL_SètusTy≥Def
 
	$ADC_E«bÀ
(
ADC_H™dÀTy≥Def
* 
hadc
)

1905 
uöt32_t
 
tick°¨t
 = 0;

1906 
__IO
 
uöt32_t
 
waô_lo›_ödex
 = 0;

1912 i‡(
	`ADC_IS_ENABLE
(
hadc
Ë=
RESET
)

1915 
	`__HAL_ADC_ENABLE
(
hadc
);

1919 
waô_lo›_ödex
 = (
ADC_STAB_DELAY_US
 * (
Sy°emC‹eClock
 / 1000000));

1920 
waô_lo›_ödex
 != 0)

1922 
waô_lo›_ödex
--;

1926 
tick°¨t
 = 
	`HAL_GëTick
();

1929 
	`ADC_IS_ENABLE
(
hadc
Ë=
RESET
)

1931 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
ADC_ENABLE_TIMEOUT
)

1934 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_INTERNAL
);

1937 
	`SET_BIT
(
hadc
->
Eº‹Code
, 
HAL_ADC_ERROR_INTERNAL
);

1940 
	`__HAL_UNLOCK
(
hadc
);

1942  
HAL_ERROR
;

1948  
HAL_OK
;

1949 
	}
}

1958 
HAL_SètusTy≥Def
 
	$ADC_C⁄vîsi⁄St›_DißbÀ
(
ADC_H™dÀTy≥Def
* 
hadc
)

1960 
uöt32_t
 
tick°¨t
 = 0;

1963 i‡(
	`ADC_IS_ENABLE
(
hadc
Ë!
RESET
)

1966 
	`__HAL_ADC_DISABLE
(
hadc
);

1969 
tick°¨t
 = 
	`HAL_GëTick
();

1972 
	`ADC_IS_ENABLE
(
hadc
Ë!
RESET
)

1974 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
ADC_DISABLE_TIMEOUT
)

1977 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_INTERNAL
);

1980 
	`SET_BIT
(
hadc
->
Eº‹Code
, 
HAL_ADC_ERROR_INTERNAL
);

1982  
HAL_ERROR
;

1988  
HAL_OK
;

1989 
	}
}

1996 
	$ADC_DMAC⁄vC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
)

1999 
ADC_H™dÀTy≥Def
* 
hadc
 = ( ADC_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2002 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_INTERNAL
 | 
HAL_ADC_STATE_ERROR_DMA
))

2005 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_EOC
);

2013 if(
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
) &&

2014 (
hadc
->
Inô
.
C⁄töuousC⁄vMode
 =
DISABLE
) &&

2015 (
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
SQR1
, 
ADC_SQR1_L
) ||

2016 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_EOCS
) ) )

2022 
	`__HAL_ADC_DISABLE_IT
(
hadc
, 
ADC_IT_EOC
);

2025 
	`CLEAR_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_BUSY
);

2027 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
))

2029 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_READY
);

2034 
	`HAL_ADC_C⁄vC∂tCÆlback
(
hadc
);

2039 
hadc
->
DMA_H™dÀ
->
	`X„rEº‹CÆlback
(
hdma
);

2041 
	}
}

2048 
	$ADC_DMAHÆfC⁄vC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
)

2051 
ADC_H™dÀTy≥Def
* 
hadc
 = ( ADC_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2054 
	`HAL_ADC_C⁄vHÆfC∂tCÆlback
(
hadc
);

2055 
	}
}

2062 
	$ADC_DMAEº‹
(
DMA_H™dÀTy≥Def
 *
hdma
)

2065 
ADC_H™dÀTy≥Def
* 
hadc
 = ( ADC_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2068 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_DMA
);

2071 
	`SET_BIT
(
hadc
->
Eº‹Code
, 
HAL_ADC_ERROR_DMA
);

2074 
	`HAL_ADC_Eº‹CÆlback
(
hadc
);

2075 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_adc_ex.c

56 
	~"°m32l1xx_hÆ.h
"

67 #ifde‡
HAL_ADC_MODULE_ENABLED


78 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_4CYCLE5
 ((
uöt32_t
Ë16)

	)

79 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_9CYCLES
 ((
uöt32_t
Ë21)

	)

80 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_16CYCLES
 ((
uöt32_t
Ë28)

	)

81 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_24CYCLES
 ((
uöt32_t
Ë36)

	)

82 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_48CYCLES
 ((
uöt32_t
Ë60)

	)

83 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_96CYCLES
 ((
uöt32_t
)108)

	)

84 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_192CYCLES
 ((
uöt32_t
)204)

	)

85 
	#ADC_CONVERSIONCLOCKCYCLES_SAMPLETIME_384CYCLES
 ((
uöt32_t
)396)

	)

90 
	#ADC_TEMPSENSOR_DELAY_US
 ((
uöt32_t
Ë10)

	)

130 
HAL_SètusTy≥Def
 
	$HAL_ADCEx_Inje˘edSèπ
(
ADC_H™dÀTy≥Def
* 
hadc
)

132 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

135 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

138 
	`__HAL_LOCK
(
hadc
);

141 
tmp_hÆ_°©us
 = 
	`ADC_E«bÀ
(
hadc
);

144 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

149 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

150 
HAL_ADC_STATE_READY
 | 
HAL_ADC_STATE_INJ_EOC
,

151 
HAL_ADC_STATE_INJ_BUSY
);

157 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_BUSY
))

160 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

166 
	`__HAL_UNLOCK
(
hadc
);

170 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_JEOC
);

178 i‡(
	`ADC_IS_SOFTWARE_START_INJECTED
(
hadc
) &&

179 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
) )

182 
	`SET_BIT
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_JSWSTART
);

187  
tmp_hÆ_°©us
;

188 
	}
}

202 
HAL_SètusTy≥Def
 
	$HAL_ADCEx_Inje˘edSt›
(
ADC_H™dÀTy≥Def
* 
hadc
)

204 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

207 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

210 
	`__HAL_LOCK
(
hadc
);

218 if(((
hadc
->
Sèã
 & 
HAL_ADC_STATE_REG_BUSY
Ë=
RESET
) &&

219 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
) )

223 
tmp_hÆ_°©us
 = 
	`ADC_C⁄vîsi⁄St›_DißbÀ
(
hadc
);

226 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

229 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

230 
HAL_ADC_STATE_REG_BUSY
 | 
HAL_ADC_STATE_INJ_BUSY
,

231 
HAL_ADC_STATE_READY
);

237 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_CONFIG
);

239 
tmp_hÆ_°©us
 = 
HAL_ERROR
;

243 
	`__HAL_UNLOCK
(
hadc
);

246  
tmp_hÆ_°©us
;

247 
	}
}

255 
HAL_SètusTy≥Def
 
	$HAL_ADCEx_Inje˘edPﬁlF‹C⁄vîsi⁄
(
ADC_H™dÀTy≥Def
* 
hadc
, 
uöt32_t
 
Timeout
)

257 
uöt32_t
 
tick°¨t
;

264 
uöt32_t
 
c⁄vîsi⁄_timeout_˝u_cy˛es
 = 28;

265 
uöt32_t
 
c⁄vîsi⁄_timeout_˝u_cy˛es_max
 = 0;

268 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

271 
tick°¨t
 = 
	`HAL_GëTick
();

294 i‡(((
hadc
->
In°™˚
->
JSQR
 & 
ADC_JSQR_JL
Ë=
RESET
) ||

295 (
hadc
->
Inô
.
EOCSñe˘i⁄
 !
ADC_EOC_SINGLE_CONV
) )

298 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
SR
, 
ADC_FLAG_JEOC
))

301 if(
Timeout
 !
HAL_MAX_DELAY
)

303 if((
Timeout
 =0Ë|| ((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

306 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_TIMEOUT
);

309 
	`__HAL_UNLOCK
(
hadc
);

311  
HAL_TIMEOUT
;

321 
c⁄vîsi⁄_timeout_˝u_cy˛es_max
 = 
	`ADC_GET_CLOCK_PRESCALER_DECIMAL
(
hadc
);

322 
c⁄vîsi⁄_timeout_˝u_cy˛es_max
 *
	`ADC_CONVCYCLES_MAX_RANGE
(
hadc
);

325 
c⁄vîsi⁄_timeout_˝u_cy˛es
 < 
c⁄vîsi⁄_timeout_˝u_cy˛es_max
)

328 if(
Timeout
 !
HAL_MAX_DELAY
)

330 if((
Timeout
 =0Ë|| ((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

333 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_TIMEOUT
);

336 
	`__HAL_UNLOCK
(
hadc
);

338  
HAL_TIMEOUT
;

341 
c⁄vîsi⁄_timeout_˝u_cy˛es
 ++;

348 i‡(
hadc
->
Inô
.
LowPowîAutoWaô
 =
DISABLE
)

351 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_JSTRT
 | 
ADC_FLAG_JEOC
);

355 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_EOC
);

363 if(
	`ADC_IS_SOFTWARE_START_INJECTED
(
hadc
) &&

364 (
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
JSQR
, 
ADC_JSQR_JL
) ||

365 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_EOCS
) ) &&

366 (
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
) &&

367 (
	`ADC_IS_SOFTWARE_START_REGULAR
(
hadc
) &&

368 (
hadc
->
Inô
.
C⁄töuousC⁄vMode
 =
DISABLE
) ) ) )

371 
	`CLEAR_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_INJ_BUSY
);

373 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_BUSY
))

375 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_READY
);

380  
HAL_OK
;

381 
	}
}

390 
HAL_SètusTy≥Def
 
	$HAL_ADCEx_Inje˘edSèπ_IT
(
ADC_H™dÀTy≥Def
* 
hadc
)

392 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

395 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

398 
	`__HAL_LOCK
(
hadc
);

401 
tmp_hÆ_°©us
 = 
	`ADC_E«bÀ
(
hadc
);

404 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

409 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

410 
HAL_ADC_STATE_READY
 | 
HAL_ADC_STATE_INJ_EOC
,

411 
HAL_ADC_STATE_INJ_BUSY
);

417 i‡(
	`HAL_IS_BIT_CLR
(
hadc
->
Sèã
, 
HAL_ADC_STATE_REG_BUSY
))

420 
	`ADC_CLEAR_ERRORCODE
(
hadc
);

426 
	`__HAL_UNLOCK
(
hadc
);

430 
	`__HAL_ADC_CLEAR_FLAG
(
hadc
, 
ADC_FLAG_JEOC
);

433 
	`__HAL_ADC_ENABLE_IT
(
hadc
, 
ADC_IT_JEOC
);

441 i‡(
	`ADC_IS_SOFTWARE_START_INJECTED
(
hadc
) &&

442 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
) )

445 
	`SET_BIT
(
hadc
->
In°™˚
->
CR2
, 
ADC_CR2_JSWSTART
);

450  
tmp_hÆ_°©us
;

451 
	}
}

465 
HAL_SètusTy≥Def
 
	$HAL_ADCEx_Inje˘edSt›_IT
(
ADC_H™dÀTy≥Def
* 
hadc
)

467 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

470 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

473 
	`__HAL_LOCK
(
hadc
);

481 if(((
hadc
->
Sèã
 & 
HAL_ADC_STATE_REG_BUSY
Ë=
RESET
) &&

482 
	`HAL_IS_BIT_CLR
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
) )

486 
tmp_hÆ_°©us
 = 
	`ADC_C⁄vîsi⁄St›_DißbÀ
(
hadc
);

489 i‡(
tmp_hÆ_°©us
 =
HAL_OK
)

492 
	`__HAL_ADC_DISABLE_IT
(
hadc
, 
ADC_IT_JEOC
);

495 
	`ADC_STATE_CLR_SET
(
hadc
->
Sèã
,

496 
HAL_ADC_STATE_REG_BUSY
 | 
HAL_ADC_STATE_INJ_BUSY
,

497 
HAL_ADC_STATE_READY
);

503 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_CONFIG
);

505 
tmp_hÆ_°©us
 = 
HAL_ERROR
;

509 
	`__HAL_UNLOCK
(
hadc
);

512  
tmp_hÆ_°©us
;

513 
	}
}

543 
uöt32_t
 
	$HAL_ADCEx_Inje˘edGëVÆue
(
ADC_H™dÀTy≥Def
* 
hadc
, 
uöt32_t
 
Inje˘edR™k
)

545 
uöt32_t
 
tmp_jdr
 = 0;

548 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

549 
	`as£π_∑øm
(
	`IS_ADC_INJECTED_RANK
(
Inje˘edR™k
));

552 
Inje˘edR™k
)

554 
ADC_INJECTED_RANK_4
:

555 
tmp_jdr
 = 
hadc
->
In°™˚
->
JDR4
;

557 
ADC_INJECTED_RANK_3
:

558 
tmp_jdr
 = 
hadc
->
In°™˚
->
JDR3
;

560 
ADC_INJECTED_RANK_2
:

561 
tmp_jdr
 = 
hadc
->
In°™˚
->
JDR2
;

563 
ADC_INJECTED_RANK_1
:

565 
tmp_jdr
 = 
hadc
->
In°™˚
->
JDR1
;

570  
tmp_jdr
;

571 
	}
}

578 
__wók
 
	$HAL_ADCEx_Inje˘edC⁄vC∂tCÆlback
(
ADC_H™dÀTy≥Def
* 
hadc
)

581 
	`UNUSED
(
hadc
);

586 
	}
}

620 
HAL_SètusTy≥Def
 
	$HAL_ADCEx_Inje˘edC⁄figCh™√l
(
ADC_H™dÀTy≥Def
* 
hadc
, 
ADC_Inje˘i⁄C⁄fTy≥Def
* 
sC⁄figInje˘ed
)

622 
HAL_SètusTy≥Def
 
tmp_hÆ_°©us
 = 
HAL_OK
;

623 
__IO
 
uöt32_t
 
waô_lo›_ödex
 = 0;

626 
	`as£π_∑øm
(
	`IS_ADC_ALL_INSTANCE
(
hadc
->
In°™˚
));

627 
	`as£π_∑øm
(
	`IS_ADC_CHANNEL
(
sC⁄figInje˘ed
->
Inje˘edCh™√l
));

628 
	`as£π_∑øm
(
	`IS_ADC_SAMPLE_TIME
(
sC⁄figInje˘ed
->
Inje˘edSam∂ögTime
));

629 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
sC⁄figInje˘ed
->
AutoInje˘edC⁄v
));

630 
	`as£π_∑øm
(
	`IS_ADC_EXTTRIGINJEC
(
sC⁄figInje˘ed
->
Exã∫ÆTrigInjecC⁄v
));

631 
	`as£π_∑øm
(
	`IS_ADC_RANGE
(
ADC_RESOLUTION_12B
, 
sC⁄figInje˘ed
->
Inje˘edOff£t
));

633 if(
hadc
->
Inô
.
SˇnC⁄vMode
 !
ADC_SCAN_DISABLE
)

635 
	`as£π_∑øm
(
	`IS_ADC_INJECTED_RANK
(
sC⁄figInje˘ed
->
Inje˘edR™k
));

636 
	`as£π_∑øm
(
	`IS_ADC_INJECTED_NB_CONV
(
sC⁄figInje˘ed
->
Inje˘edNbrOfC⁄vîsi⁄
));

637 
	`as£π_∑øm
(
	`IS_FUNCTIONAL_STATE
(
sC⁄figInje˘ed
->
Inje˘edDisc⁄töuousC⁄vMode
));

640 if(
sC⁄figInje˘ed
->
Exã∫ÆTrigInjecC⁄v
 !
ADC_INJECTED_SOFTWARE_START
)

642 
	`as£π_∑øm
(
	`IS_ADC_EXTTRIGINJEC_EDGE
(
sC⁄figInje˘ed
->
Exã∫ÆTrigInjecC⁄vEdge
));

646 
	`__HAL_LOCK
(
hadc
);

657 i‡(
hadc
->
Inô
.
SˇnC⁄vMode
 =
ADC_SCAN_DISABLE
)

659 i‡(
sC⁄figInje˘ed
->
Inje˘edR™k
 =
ADC_INJECTED_RANK_1
)

662 
	`MODIFY_REG
(
hadc
->
In°™˚
->
JSQR
 ,

663 
ADC_JSQR_JL
 |

664 
ADC_JSQR_JSQ4
 |

665 
ADC_JSQR_JSQ3
 |

666 
ADC_JSQR_JSQ2
 |

667 
ADC_JSQR_JSQ1
 ,

668 
	`ADC_JSQR_RK_JL
(
sC⁄figInje˘ed
->
Inje˘edCh™√l
,

669 
ADC_INJECTED_RANK_1
,

677 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_CONFIG
);

679 
tmp_hÆ_°©us
 = 
HAL_ERROR
;

687 i‡(
sC⁄figInje˘ed
->
Inje˘edR™k
 <sC⁄figInje˘ed->
Inje˘edNbrOfC⁄vîsi⁄
)

691 
	`MODIFY_REG
(
hadc
->
In°™˚
->
JSQR
 ,

693 
ADC_JSQR_JL
 |

694 
	`ADC_JSQR_RK_JL
(
ADC_JSQR_JSQ1
,

695 
sC⁄figInje˘ed
->
Inje˘edR™k
,

696 
sC⁄figInje˘ed
->
Inje˘edNbrOfC⁄vîsi⁄
) ,

698 
	`ADC_JSQR_JL_SHIFT
(
sC⁄figInje˘ed
->
Inje˘edNbrOfC⁄vîsi⁄
) |

699 
	`ADC_JSQR_RK_JL
(
sC⁄figInje˘ed
->
Inje˘edCh™√l
,

700 
sC⁄figInje˘ed
->
Inje˘edR™k
,

701 
sC⁄figInje˘ed
->
Inje˘edNbrOfC⁄vîsi⁄
) );

706 
	`MODIFY_REG
(
hadc
->
In°™˚
->
JSQR
 ,

708 
ADC_JSQR_JL
 |

709 
	`ADC_JSQR_RK_JL
(
ADC_JSQR_JSQ1
,

710 
sC⁄figInje˘ed
->
Inje˘edR™k
,

711 
sC⁄figInje˘ed
->
Inje˘edNbrOfC⁄vîsi⁄
) ,

723 i‡(
sC⁄figInje˘ed
->
Exã∫ÆTrigInjecC⁄v
 !
ADC_INJECTED_SOFTWARE_START
)

725 
	`MODIFY_REG
(
hadc
->
In°™˚
->
CR2
 ,

726 
ADC_CR2_JEXTEN
 |

727 
ADC_CR2_JEXTSEL
 ,

728 
sC⁄figInje˘ed
->
Exã∫ÆTrigInjecC⁄v
 |

729 
sC⁄figInje˘ed
->
Exã∫ÆTrigInjecC⁄vEdge
 );

733 
	`MODIFY_REG
(
hadc
->
In°™˚
->
CR2
,

734 
ADC_CR2_JEXTEN
 |

735 
ADC_CR2_JEXTSEL
 ,

744 i‡((
	`ADC_IS_ENABLE
(
hadc
Ë=
RESET
))

746 
hadc
->
In°™˚
->
CR1
 &~(
ADC_CR1_JAUTO
 |

747 
ADC_CR1_JDISCEN
 );

751 i‡(
sC⁄figInje˘ed
->
AutoInje˘edC⁄v
 =
ENABLE
)

753 i‡(
sC⁄figInje˘ed
->
Exã∫ÆTrigInjecC⁄v
 =
ADC_INJECTED_SOFTWARE_START
)

755 
	`SET_BIT
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JAUTO
);

760 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_CONFIG
);

762 
tmp_hÆ_°©us
 = 
HAL_ERROR
;

768 i‡(
sC⁄figInje˘ed
->
Inje˘edDisc⁄töuousC⁄vMode
 =
ENABLE
)

770 i‡(
sC⁄figInje˘ed
->
AutoInje˘edC⁄v
 =
DISABLE
)

772 
	`SET_BIT
(
hadc
->
In°™˚
->
CR1
, 
ADC_CR1_JDISCEN
);

777 
	`SET_BIT
(
hadc
->
Sèã
, 
HAL_ADC_STATE_ERROR_CONFIG
);

779 
tmp_hÆ_°©us
 = 
HAL_ERROR
;

786 i‡(
sC⁄figInje˘ed
->
Inje˘edCh™√l
 < 
ADC_CHANNEL_10
)

788 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SMPR3
,

789 
	`ADC_SMPR3
(
ADC_SMPR3_SMP0
, 
sC⁄figInje˘ed
->
Inje˘edCh™√l
),

790 
	`ADC_SMPR3
(
sC⁄figInje˘ed
->
Inje˘edSam∂ögTime
, sC⁄figInje˘ed->
Inje˘edCh™√l
) );

793 i‡(
sC⁄figInje˘ed
->
Inje˘edCh™√l
 < 
ADC_CHANNEL_20
)

795 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SMPR2
,

796 
	`ADC_SMPR2
(
ADC_SMPR2_SMP10
, 
sC⁄figInje˘ed
->
Inje˘edCh™√l
),

797 
	`ADC_SMPR2
(
sC⁄figInje˘ed
->
Inje˘edSam∂ögTime
, sC⁄figInje˘ed->
Inje˘edCh™√l
) );

801 i‡(
sC⁄figInje˘ed
->
Inje˘edCh™√l
 <
ADC_SMPR1_CHANNEL_MAX
)

803 
	`MODIFY_REG
(
hadc
->
In°™˚
->
SMPR1
,

804 
	`ADC_SMPR1
(
ADC_SMPR1_SMP20
, 
sC⁄figInje˘ed
->
Inje˘edCh™√l
),

805 
	`ADC_SMPR1
(
sC⁄figInje˘ed
->
Inje˘edSam∂ögTime
, sC⁄figInje˘ed->
Inje˘edCh™√l
) );

810 
	`ADC_SMPR0_CHANNEL_SET
(
hadc
, 
sC⁄figInje˘ed
->
Inje˘edSam∂ögTime
, sC⁄figInje˘ed->
Inje˘edCh™√l
);

815 
sC⁄figInje˘ed
->
Inje˘edR™k
)

819 
	`MODIFY_REG
(
hadc
->
In°™˚
->
JOFR1
,

820 
ADC_JOFR1_JOFFSET1
,

821 
sC⁄figInje˘ed
->
Inje˘edOff£t
);

825 
	`MODIFY_REG
(
hadc
->
In°™˚
->
JOFR2
,

826 
ADC_JOFR2_JOFFSET2
,

827 
sC⁄figInje˘ed
->
Inje˘edOff£t
);

831 
	`MODIFY_REG
(
hadc
->
In°™˚
->
JOFR3
,

832 
ADC_JOFR3_JOFFSET3
,

833 
sC⁄figInje˘ed
->
Inje˘edOff£t
);

837 
	`MODIFY_REG
(
hadc
->
In°™˚
->
JOFR4
,

838 
ADC_JOFR4_JOFFSET4
,

839 
sC⁄figInje˘ed
->
Inje˘edOff£t
);

845 i‡((
sC⁄figInje˘ed
->
Inje˘edCh™√l
 =
ADC_CHANNEL_TEMPSENSOR
) ||

846 (
sC⁄figInje˘ed
->
Inje˘edCh™√l
 =
ADC_CHANNEL_VREFINT
) )

848 
	`SET_BIT
(
ADC
->
CCR
, 
ADC_CCR_TSVREFE
);

850 i‡((
sC⁄figInje˘ed
->
Inje˘edCh™√l
 =
ADC_CHANNEL_TEMPSENSOR
))

854 
waô_lo›_ödex
 = (
ADC_TEMPSENSOR_DELAY_US
 * (
Sy°emC‹eClock
 / 1000000));

855 
waô_lo›_ödex
 != 0)

857 
waô_lo›_ödex
--;

863 
	`__HAL_UNLOCK
(
hadc
);

866  
tmp_hÆ_°©us
;

867 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_cortex.c

124 
	~"°m32l1xx_hÆ.h
"

135 #ifde‡
HAL_CORTEX_MODULE_ENABLED


184 
	$HAL_NVIC_SëPri‹ôyGroupög
(
uöt32_t
 
Pri‹ôyGroup
)

187 
	`as£π_∑øm
(
	`IS_NVIC_PRIORITY_GROUP
(
Pri‹ôyGroup
));

190 
	`NVIC_SëPri‹ôyGroupög
(
Pri‹ôyGroup
);

191 
	}
}

206 
	$HAL_NVIC_SëPri‹ôy
(
IRQn_Ty≥
 
IRQn
, 
uöt32_t
 
Pªem±Pri‹ôy
, uöt32_à
SubPri‹ôy
)

208 
uöt32_t
 
¥i‹ôygroup
 = 0x00;

211 
	`as£π_∑øm
(
	`IS_NVIC_SUB_PRIORITY
(
SubPri‹ôy
));

212 
	`as£π_∑øm
(
	`IS_NVIC_PREEMPTION_PRIORITY
(
Pªem±Pri‹ôy
));

214 
¥i‹ôygroup
 = 
	`NVIC_GëPri‹ôyGroupög
();

216 
	`NVIC_SëPri‹ôy
(
IRQn
, 
	`NVIC_EncodePri‹ôy
(
¥i‹ôygroup
, 
Pªem±Pri‹ôy
, 
SubPri‹ôy
));

217 
	}
}

228 
	$HAL_NVIC_E«bÀIRQ
(
IRQn_Ty≥
 
IRQn
)

231 
	`as£π_∑øm
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

234 
	`NVIC_E«bÀIRQ
(
IRQn
);

235 
	}
}

244 
	$HAL_NVIC_DißbÀIRQ
(
IRQn_Ty≥
 
IRQn
)

247 
	`as£π_∑øm
(
	`IS_NVIC_DEVICE_IRQ
(
IRQn
));

250 
	`NVIC_DißbÀIRQ
(
IRQn
);

251 
	}
}

257 
	$HAL_NVIC_Sy°emRe£t
()

260 
	`NVIC_Sy°emRe£t
();

261 
	}
}

270 
uöt32_t
 
	$HAL_SYSTICK_C⁄fig
(
uöt32_t
 
TicksNumb
)

272  
	`SysTick_C⁄fig
(
TicksNumb
);

273 
	}
}

294 #i‡(
__MPU_PRESENT
 == 1)

301 
	$HAL_MPU_C⁄figRegi⁄
(
MPU_Regi⁄_InôTy≥Def
 *
MPU_Inô
)

304 
	`as£π_∑øm
(
	`IS_MPU_REGION_NUMBER
(
MPU_Inô
->
Numbî
));

305 
	`as£π_∑øm
(
	`IS_MPU_REGION_ENABLE
(
MPU_Inô
->
E«bÀ
));

308 
MPU
->
RNR
 = 
MPU_Inô
->
Numbî
;

310 i‡((
MPU_Inô
->
E«bÀ
Ë!
RESET
)

313 
	`as£π_∑øm
(
	`IS_MPU_INSTRUCTION_ACCESS
(
MPU_Inô
->
DißbÀExec
));

314 
	`as£π_∑øm
(
	`IS_MPU_REGION_PERMISSION_ATTRIBUTE
(
MPU_Inô
->
Ac˚ssPîmissi⁄
));

315 
	`as£π_∑øm
(
	`IS_MPU_TEX_LEVEL
(
MPU_Inô
->
Ty≥ExtFõld
));

316 
	`as£π_∑øm
(
	`IS_MPU_ACCESS_SHAREABLE
(
MPU_Inô
->
IsSh¨óbÀ
));

317 
	`as£π_∑øm
(
	`IS_MPU_ACCESS_CACHEABLE
(
MPU_Inô
->
IsCachóbÀ
));

318 
	`as£π_∑øm
(
	`IS_MPU_ACCESS_BUFFERABLE
(
MPU_Inô
->
IsBuf„øbÀ
));

319 
	`as£π_∑øm
(
	`IS_MPU_SUB_REGION_DISABLE
(
MPU_Inô
->
SubRegi⁄DißbÀ
));

320 
	`as£π_∑øm
(
	`IS_MPU_REGION_SIZE
(
MPU_Inô
->
Size
));

322 
MPU
->
RBAR
 = 
MPU_Inô
->
Ba£Addªss
;

323 
MPU
->
RASR
 = ((
uöt32_t
)
MPU_Inô
->
DißbÀExec
 << 
MPU_RASR_XN_Pos
) |

324 ((
uöt32_t
)
MPU_Inô
->
Ac˚ssPîmissi⁄
 << 
MPU_RASR_AP_Pos
) |

325 ((
uöt32_t
)
MPU_Inô
->
Ty≥ExtFõld
 << 
MPU_RASR_TEX_Pos
) |

326 ((
uöt32_t
)
MPU_Inô
->
IsSh¨óbÀ
 << 
MPU_RASR_S_Pos
) |

327 ((
uöt32_t
)
MPU_Inô
->
IsCachóbÀ
 << 
MPU_RASR_C_Pos
) |

328 ((
uöt32_t
)
MPU_Inô
->
IsBuf„øbÀ
 << 
MPU_RASR_B_Pos
) |

329 ((
uöt32_t
)
MPU_Inô
->
SubRegi⁄DißbÀ
 << 
MPU_RASR_SRD_Pos
) |

330 ((
uöt32_t
)
MPU_Inô
->
Size
 << 
MPU_RASR_SIZE_Pos
) |

331 ((
uöt32_t
)
MPU_Inô
->
E«bÀ
 << 
MPU_RASR_ENABLE_Pos
);

335 
MPU
->
RBAR
 = 0x00;

336 
MPU
->
RASR
 = 0x00;

338 
	}
}

345 
uöt32_t
 
	$HAL_NVIC_GëPri‹ôyGroupög
()

348  
	`NVIC_GëPri‹ôyGroupög
();

349 
	}
}

372 
	$HAL_NVIC_GëPri‹ôy
(
IRQn_Ty≥
 
IRQn
, 
uöt32_t
 
Pri‹ôyGroup
, uöt32_t* 
pPªem±Pri‹ôy
, uöt32_t* 
pSubPri‹ôy
)

375 
	`as£π_∑øm
(
	`IS_NVIC_PRIORITY_GROUP
(
Pri‹ôyGroup
));

377 
	`NVIC_DecodePri‹ôy
(
	`NVIC_GëPri‹ôy
(
IRQn
), 
Pri‹ôyGroup
, 
pPªem±Pri‹ôy
, 
pSubPri‹ôy
);

378 
	}
}

387 
	$HAL_NVIC_SëPídögIRQ
(
IRQn_Ty≥
 
IRQn
)

390 
	`NVIC_SëPídögIRQ
(
IRQn
);

391 
	}
}

402 
uöt32_t
 
	$HAL_NVIC_GëPídögIRQ
(
IRQn_Ty≥
 
IRQn
)

405  
	`NVIC_GëPídögIRQ
(
IRQn
);

406 
	}
}

415 
	$HAL_NVIC_CÀ¨PídögIRQ
(
IRQn_Ty≥
 
IRQn
)

418 
	`NVIC_CÀ¨PídögIRQ
(
IRQn
);

419 
	}
}

429 
uöt32_t
 
	$HAL_NVIC_GëA˘ive
(
IRQn_Ty≥
 
IRQn
)

432  
	`NVIC_GëA˘ive
(
IRQn
);

433 
	}
}

443 
	$HAL_SYSTICK_CLKSour˚C⁄fig
(
uöt32_t
 
CLKSour˚
)

446 
	`as£π_∑øm
(
	`IS_SYSTICK_CLK_SOURCE
(
CLKSour˚
));

447 i‡(
CLKSour˚
 =
SYSTICK_CLKSOURCE_HCLK
)

449 
SysTick
->
CTRL
 |
SYSTICK_CLKSOURCE_HCLK
;

453 
SysTick
->
CTRL
 &~
SYSTICK_CLKSOURCE_HCLK
;

455 
	}
}

461 
	$HAL_SYSTICK_IRQH™dÀr
()

463 
	`HAL_SYSTICK_CÆlback
();

464 
	}
}

470 
__wók
 
	$HAL_SYSTICK_CÆlback
()

475 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_dma.c

103 
	~"°m32l1xx_hÆ.h
"

114 #ifde‡
HAL_DMA_MODULE_ENABLED


124 
DMA_SëC⁄fig
(
DMA_H™dÀTy≥Def
 *
hdma
, 
uöt32_t
 
SrcAddªss
, uöt32_à
D°Addªss
, uöt32_à
D©aLígth
);

162 
HAL_SètusTy≥Def
 
	$HAL_DMA_Inô
(
DMA_H™dÀTy≥Def
 *
hdma
)

164 
uöt32_t
 
tmp
 = 0;

167 if(
hdma
 =
NULL
)

169  
HAL_ERROR
;

173 
	`as£π_∑øm
(
	`IS_DMA_ALL_INSTANCE
(
hdma
->
In°™˚
));

174 
	`as£π_∑øm
(
	`IS_DMA_DIRECTION
(
hdma
->
Inô
.
Dúe˘i⁄
));

175 
	`as£π_∑øm
(
	`IS_DMA_PERIPHERAL_INC_STATE
(
hdma
->
Inô
.
PîùhInc
));

176 
	`as£π_∑øm
(
	`IS_DMA_MEMORY_INC_STATE
(
hdma
->
Inô
.
MemInc
));

177 
	`as£π_∑øm
(
	`IS_DMA_PERIPHERAL_DATA_SIZE
(
hdma
->
Inô
.
PîùhD©aAlignmít
));

178 
	`as£π_∑øm
(
	`IS_DMA_MEMORY_DATA_SIZE
(
hdma
->
Inô
.
MemD©aAlignmít
));

179 
	`as£π_∑øm
(
	`IS_DMA_MODE
(
hdma
->
Inô
.
Mode
));

180 
	`as£π_∑øm
(
	`IS_DMA_PRIORITY
(
hdma
->
Inô
.
Pri‹ôy
));

182 #i‡
	`deföed
 (
DMA2
)

184 i‡((
uöt32_t
)(
hdma
->
In°™˚
Ë< (uöt32_t)(
DMA2_Ch™√l1
))

187 
hdma
->
Ch™√lIndex
 = (((
uöt32_t
)hdma->
In°™˚
 - (uöt32_t)
DMA1_Ch™√l1
Ë/ ((uöt32_t)
DMA1_Ch™√l2
 - (uint32_t)DMA1_Channel1)) << 2;

188 
hdma
->
DmaBa£Addªss
 = 
DMA1
;

193 
hdma
->
Ch™√lIndex
 = (((
uöt32_t
)hdma->
In°™˚
 - (uöt32_t)
DMA2_Ch™√l1
Ë/ ((uöt32_t)
DMA2_Ch™√l2
 - (uint32_t)DMA2_Channel1)) << 2;

194 
hdma
->
DmaBa£Addªss
 = 
DMA2
;

199 
hdma
->
Ch™√lIndex
 = (((
uöt32_t
)hdma->
In°™˚
 - (uöt32_t)
DMA1_Ch™√l1
Ë/ ((uöt32_t)
DMA1_Ch™√l2
 - (uint32_t)DMA1_Channel1)) << 2;

200 
hdma
->
DmaBa£Addªss
 = 
DMA1
;

204 
hdma
->
Sèã
 = 
HAL_DMA_STATE_BUSY
;

207 
tmp
 = 
hdma
->
In°™˚
->
CCR
;

210 
tmp
 &((
uöt32_t
)~(
DMA_CCR_PL
 | 
DMA_CCR_MSIZE
 | 
DMA_CCR_PSIZE
 | \

211 
DMA_CCR_MINC
 | 
DMA_CCR_PINC
 | 
DMA_CCR_CIRC
 | \

212 
DMA_CCR_DIR
));

215 
tmp
 |
hdma
->
Inô
.
Dúe˘i⁄
 |

216 
hdma
->
Inô
.
PîùhInc
 | hdma->Inô.
MemInc
 |

217 
hdma
->
Inô
.
PîùhD©aAlignmít
 | hdma->Inô.
MemD©aAlignmít
 |

218 
hdma
->
Inô
.
Mode
 | hdma->Inô.
Pri‹ôy
;

221 
hdma
->
In°™˚
->
CCR
 = 
tmp
;

224 
hdma
->
X„rC∂tCÆlback
 = 
NULL
;

225 
hdma
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

226 
hdma
->
X„rEº‹CÆlback
 = 
NULL
;

227 
hdma
->
X„rAb‹tCÆlback
 = 
NULL
;

230 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_NONE
;

233 
hdma
->
Sèã
 = 
HAL_DMA_STATE_READY
;

236 
hdma
->
Lock
 = 
HAL_UNLOCKED
;

238  
HAL_OK
;

239 
	}
}

247 
HAL_SètusTy≥Def
 
	$HAL_DMA_DeInô
(
DMA_H™dÀTy≥Def
 *
hdma
)

250 i‡(
NULL
 =
hdma
 )

252  
HAL_ERROR
;

256 
	`as£π_∑øm
(
	`IS_DMA_ALL_INSTANCE
(
hdma
->
In°™˚
));

259 
	`__HAL_DMA_DISABLE
(
hdma
);

261 #i‡
	`deföed
 (
DMA2
)

263 i‡((
uöt32_t
)(
hdma
->
In°™˚
Ë< (uöt32_t)(
DMA2_Ch™√l1
))

266 
hdma
->
Ch™√lIndex
 = (((
uöt32_t
)hdma->
In°™˚
 - (uöt32_t)
DMA1_Ch™√l1
Ë/ ((uöt32_t)
DMA1_Ch™√l2
 - (uint32_t)DMA1_Channel1)) << 2;

267 
hdma
->
DmaBa£Addªss
 = 
DMA1
;

272 
hdma
->
Ch™√lIndex
 = (((
uöt32_t
)hdma->
In°™˚
 - (uöt32_t)
DMA2_Ch™√l1
Ë/ ((uöt32_t)
DMA2_Ch™√l2
 - (uint32_t)DMA2_Channel1)) << 2;

273 
hdma
->
DmaBa£Addªss
 = 
DMA2
;

278 
hdma
->
Ch™√lIndex
 = (((
uöt32_t
)hdma->
In°™˚
 - (uöt32_t)
DMA1_Ch™√l1
Ë/ ((uöt32_t)
DMA1_Ch™√l2
 - (uint32_t)DMA1_Channel1)) << 2;

279 
hdma
->
DmaBa£Addªss
 = 
DMA1
;

283 
hdma
->
In°™˚
->
CCR
 = 0;

286 
hdma
->
In°™˚
->
CNDTR
 = 0;

289 
hdma
->
In°™˚
->
CPAR
 = 0;

292 
hdma
->
In°™˚
->
CMAR
 = 0;

295 
hdma
->
DmaBa£Addªss
->
IFCR
 = ((
DMA_ISR_GIF1
Ë<< (hdma->
Ch™√lIndex
));

298 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_NONE
;

301 
hdma
->
Sèã
 = 
HAL_DMA_STATE_RESET
;

304 
	`__HAL_UNLOCK
(
hdma
);

306  
HAL_OK
;

307 
	}
}

341 
HAL_SètusTy≥Def
 
	$HAL_DMA_Sèπ
(
DMA_H™dÀTy≥Def
 *
hdma
, 
uöt32_t
 
SrcAddªss
, uöt32_à
D°Addªss
, uöt32_à
D©aLígth
)

343 
HAL_SètusTy≥Def
 
°©us
 = 
HAL_OK
;

346 
	`as£π_∑øm
(
	`IS_DMA_BUFFER_SIZE
(
D©aLígth
));

349 
	`__HAL_LOCK
(
hdma
);

351 if(
HAL_DMA_STATE_READY
 =
hdma
->
Sèã
)

354 
hdma
->
Sèã
 = 
HAL_DMA_STATE_BUSY
;

355 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_NONE
;

358 
	`__HAL_DMA_DISABLE
(
hdma
);

361 
	`DMA_SëC⁄fig
(
hdma
, 
SrcAddªss
, 
D°Addªss
, 
D©aLígth
);

364 
	`__HAL_DMA_ENABLE
(
hdma
);

369 
	`__HAL_UNLOCK
(
hdma
);

370 
°©us
 = 
HAL_BUSY
;

372  
°©us
;

373 
	}
}

384 
HAL_SètusTy≥Def
 
	$HAL_DMA_Sèπ_IT
(
DMA_H™dÀTy≥Def
 *
hdma
, 
uöt32_t
 
SrcAddªss
, uöt32_à
D°Addªss
, uöt32_à
D©aLígth
)

386 
HAL_SètusTy≥Def
 
°©us
 = 
HAL_OK
;

389 
	`as£π_∑øm
(
	`IS_DMA_BUFFER_SIZE
(
D©aLígth
));

392 
	`__HAL_LOCK
(
hdma
);

394 if(
HAL_DMA_STATE_READY
 =
hdma
->
Sèã
)

397 
hdma
->
Sèã
 = 
HAL_DMA_STATE_BUSY
;

398 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_NONE
;

401 
	`__HAL_DMA_DISABLE
(
hdma
);

404 
	`DMA_SëC⁄fig
(
hdma
, 
SrcAddªss
, 
D°Addªss
, 
D©aLígth
);

408 if(
NULL
 !
hdma
->
X„rHÆfC∂tCÆlback
 )

411 
	`__HAL_DMA_ENABLE_IT
(
hdma
, (
DMA_IT_TC
 | 
DMA_IT_HT
 | 
DMA_IT_TE
));

415 
	`__HAL_DMA_DISABLE_IT
(
hdma
, 
DMA_IT_HT
);

416 
	`__HAL_DMA_ENABLE_IT
(
hdma
, (
DMA_IT_TC
 | 
DMA_IT_TE
));

419 
	`__HAL_DMA_ENABLE
(
hdma
);

424 
	`__HAL_UNLOCK
(
hdma
);

427 
°©us
 = 
HAL_BUSY
;

429  
°©us
;

430 
	}
}

438 
HAL_SètusTy≥Def
 
	$HAL_DMA_Ab‹t
(
DMA_H™dÀTy≥Def
 *
hdma
)

440 
HAL_SètusTy≥Def
 
°©us
 = 
HAL_OK
;

443 
	`__HAL_DMA_DISABLE_IT
(
hdma
, (
DMA_IT_TC
 | 
DMA_IT_HT
 | 
DMA_IT_TE
));

446 
	`__HAL_DMA_DISABLE
(
hdma
);

449 
hdma
->
DmaBa£Addªss
->
IFCR
 = ((
DMA_ISR_GIF1
Ë<< (hdma->
Ch™√lIndex
));

452 
hdma
->
Sèã
 = 
HAL_DMA_STATE_READY
;

455 
	`__HAL_UNLOCK
(
hdma
);

457  
°©us
;

458 
	}
}

466 
HAL_SètusTy≥Def
 
	$HAL_DMA_Ab‹t_IT
(
DMA_H™dÀTy≥Def
 *
hdma
)

468 
HAL_SètusTy≥Def
 
°©us
 = 
HAL_OK
;

470 if(
HAL_DMA_STATE_BUSY
 !
hdma
->
Sèã
)

473 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_NO_XFER
;

475 
°©us
 = 
HAL_ERROR
;

480 
	`__HAL_DMA_DISABLE_IT
(
hdma
, (
DMA_IT_TC
 | 
DMA_IT_HT
 | 
DMA_IT_TE
));

483 
	`__HAL_DMA_DISABLE
(
hdma
);

486 
hdma
->
DmaBa£Addªss
->
IFCR
 = ((
DMA_ISR_GIF1
Ë<< (hdma->
Ch™√lIndex
));

489 
hdma
->
Sèã
 = 
HAL_DMA_STATE_READY
;

492 
	`__HAL_UNLOCK
(
hdma
);

495 if(
hdma
->
X„rAb‹tCÆlback
 !
NULL
)

497 
hdma
->
	`X„rAb‹tCÆlback
(hdma);

500  
°©us
;

501 
	}
}

511 
HAL_SètusTy≥Def
 
	$HAL_DMA_PﬁlF‹Tøns„r
(
DMA_H™dÀTy≥Def
 *
hdma
, 
uöt32_t
 
Com∂ëeLevñ
, uöt32_à
Timeout
)

513 
uöt32_t
 
ãmp
;

514 
uöt32_t
 
tick°¨t
 = 0;

516 if(
HAL_DMA_STATE_BUSY
 !
hdma
->
Sèã
)

519 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_NO_XFER
;

520 
	`__HAL_UNLOCK
(
hdma
);

521  
HAL_ERROR
;

525 i‡(
RESET
 !(
hdma
->
In°™˚
->
CCR
 & 
DMA_CCR_CIRC
))

527 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_NOT_SUPPORTED
;

528  
HAL_ERROR
;

532 i‡(
HAL_DMA_FULL_TRANSFER
 =
Com∂ëeLevñ
)

535 
ãmp
 = 
DMA_FLAG_TC1
 << 
hdma
->
Ch™√lIndex
;

540 
ãmp
 = 
DMA_FLAG_HT1
 << 
hdma
->
Ch™√lIndex
;

544 
tick°¨t
 = 
	`HAL_GëTick
();

546 
RESET
 =(
hdma
->
DmaBa£Addªss
->
ISR
 & 
ãmp
))

548 if((
RESET
 !(
hdma
->
DmaBa£Addªss
->
ISR
 & (
DMA_FLAG_TE1
 << hdma->
Ch™√lIndex
))))

553 
hdma
->
DmaBa£Addªss
->
IFCR
 = ((
DMA_ISR_GIF1
Ë<< (hdma->
Ch™√lIndex
));

556 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_TE
;

559 
hdma
->
Sèã

HAL_DMA_STATE_READY
;

562 
	`__HAL_UNLOCK
(
hdma
);

564  
HAL_ERROR
;

567 if(
Timeout
 !
HAL_MAX_DELAY
)

569 if((
Timeout
 =0Ë|| ((
	`HAL_GëTick
(Ë- 
tick°¨t
) > Timeout))

572 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_TIMEOUT
;

575 
hdma
->
Sèã
 = 
HAL_DMA_STATE_READY
;

578 
	`__HAL_UNLOCK
(
hdma
);

580  
HAL_ERROR
;

585 if(
HAL_DMA_FULL_TRANSFER
 =
Com∂ëeLevñ
)

588 
hdma
->
DmaBa£Addªss
->
IFCR
 = (
DMA_FLAG_TC1
 << hdma->
Ch™√lIndex
);

592 
hdma
->
Sèã
 = 
HAL_DMA_STATE_READY
;

597 
hdma
->
DmaBa£Addªss
->
IFCR
 = (
DMA_FLAG_HT1
 << hdma->
Ch™√lIndex
);

601 
	`__HAL_UNLOCK
(
hdma
);

603  
HAL_OK
;

604 
	}
}

612 
	$HAL_DMA_IRQH™dÀr
(
DMA_H™dÀTy≥Def
 *
hdma
)

614 
uöt32_t
 
Êag_ô
 = 
hdma
->
DmaBa£Addªss
->
ISR
;

615 
uöt32_t
 
sour˚_ô
 = 
hdma
->
In°™˚
->
CCR
;

618 i‡((
RESET
 !(
Êag_ô
 & (
DMA_FLAG_HT1
 << 
hdma
->
Ch™√lIndex
))Ë&& (RESET !(
sour˚_ô
 & 
DMA_IT_HT
)))

621 if((
hdma
->
In°™˚
->
CCR
 & 
DMA_CCR_CIRC
) == 0)

624 
	`__HAL_DMA_DISABLE_IT
(
hdma
, 
DMA_IT_HT
);

627 
hdma
->
DmaBa£Addªss
->
IFCR
 = (
DMA_ISR_HTIF1
 << hdma->
Ch™√lIndex
);

632 if(
hdma
->
X„rHÆfC∂tCÆlback
 !
NULL
)

635 
hdma
->
	`X„rHÆfC∂tCÆlback
(hdma);

640 i‡((
RESET
 !(
Êag_ô
 & (
DMA_FLAG_TC1
 << 
hdma
->
Ch™√lIndex
))Ë&& (RESET !(
sour˚_ô
 & 
DMA_IT_TC
)))

642 if((
hdma
->
In°™˚
->
CCR
 & 
DMA_CCR_CIRC
) == 0)

645 
	`__HAL_DMA_DISABLE_IT
(
hdma
, 
DMA_IT_TE
 | 
DMA_IT_TC
);

648 
hdma
->
Sèã
 = 
HAL_DMA_STATE_READY
;

652 
hdma
->
DmaBa£Addªss
->
IFCR
 = (
DMA_ISR_TCIF1
 << hdma->
Ch™√lIndex
);

655 
	`__HAL_UNLOCK
(
hdma
);

657 if(
hdma
->
X„rC∂tCÆlback
 !
NULL
)

660 
hdma
->
	`X„rC∂tCÆlback
(hdma);

665 i‡(–
RESET
 !(
Êag_ô
 & (
DMA_FLAG_TE1
 << 
hdma
->
Ch™√lIndex
))Ë&& (RESET !(
sour˚_ô
 & 
DMA_IT_TE
)))

670 
	`__HAL_DMA_DISABLE_IT
(
hdma
, (
DMA_IT_TC
 | 
DMA_IT_HT
 | 
DMA_IT_TE
));

673 
hdma
->
DmaBa£Addªss
->
IFCR
 = (
DMA_ISR_GIF1
 << hdma->
Ch™√lIndex
);

676 
hdma
->
Eº‹Code
 = 
HAL_DMA_ERROR_TE
;

679 
hdma
->
Sèã
 = 
HAL_DMA_STATE_READY
;

682 
	`__HAL_UNLOCK
(
hdma
);

684 i‡(
hdma
->
X„rEº‹CÆlback
 !
NULL
)

687 
hdma
->
	`X„rEº‹CÆlback
(hdma);

691 
	}
}

703 
HAL_SètusTy≥Def
 
HAL_DMA_Regi°îCÆlback
(
DMA_H™dÀTy≥Def
 *
hdma
, 
HAL_DMA_CÆlbackIDTy≥Def
 
CÆlbackID
, (* 
pCÆlback
)–DMA_H™dÀTy≥De‡* 
_hdma
))

705 
HAL_SètusTy≥Def
 
°©us
 = 
HAL_OK
;

708 
	`__HAL_LOCK
(
hdma
);

710 if(
HAL_DMA_STATE_READY
 =
hdma
->
Sèã
)

712 
CÆlbackID
)

714 
HAL_DMA_XFER_CPLT_CB_ID
:

715 
hdma
->
X„rC∂tCÆlback
 = 
pCÆlback
;

718 
HAL_DMA_XFER_HALFCPLT_CB_ID
:

719 
hdma
->
X„rHÆfC∂tCÆlback
 = 
pCÆlback
;

722 
HAL_DMA_XFER_ERROR_CB_ID
:

723 
hdma
->
X„rEº‹CÆlback
 = 
pCÆlback
;

726 
HAL_DMA_XFER_ABORT_CB_ID
:

727 
hdma
->
X„rAb‹tCÆlback
 = 
pCÆlback
;

731 
°©us
 = 
HAL_ERROR
;

737 
°©us
 = 
HAL_ERROR
;

741 
	`__HAL_UNLOCK
(
hdma
);

743  
°©us
;

744 
	}
}

754 
HAL_SètusTy≥Def
 
	$HAL_DMA_UnRegi°îCÆlback
(
DMA_H™dÀTy≥Def
 *
hdma
, 
HAL_DMA_CÆlbackIDTy≥Def
 
CÆlbackID
)

756 
HAL_SètusTy≥Def
 
°©us
 = 
HAL_OK
;

759 
	`__HAL_LOCK
(
hdma
);

761 if(
HAL_DMA_STATE_READY
 =
hdma
->
Sèã
)

763 
CÆlbackID
)

765 
HAL_DMA_XFER_CPLT_CB_ID
:

766 
hdma
->
X„rC∂tCÆlback
 = 
NULL
;

769 
HAL_DMA_XFER_HALFCPLT_CB_ID
:

770 
hdma
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

773 
HAL_DMA_XFER_ERROR_CB_ID
:

774 
hdma
->
X„rEº‹CÆlback
 = 
NULL
;

777 
HAL_DMA_XFER_ABORT_CB_ID
:

778 
hdma
->
X„rAb‹tCÆlback
 = 
NULL
;

781 
HAL_DMA_XFER_ALL_CB_ID
:

782 
hdma
->
X„rC∂tCÆlback
 = 
NULL
;

783 
hdma
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

784 
hdma
->
X„rEº‹CÆlback
 = 
NULL
;

785 
hdma
->
X„rAb‹tCÆlback
 = 
NULL
;

789 
°©us
 = 
HAL_ERROR
;

795 
°©us
 = 
HAL_ERROR
;

799 
	`__HAL_UNLOCK
(
hdma
);

801  
°©us
;

802 
	}
}

832 
HAL_DMA_SèãTy≥Def
 
	$HAL_DMA_GëSèã
(
DMA_H™dÀTy≥Def
 *
hdma
)

835  
hdma
->
Sèã
;

836 
	}
}

844 
uöt32_t
 
	$HAL_DMA_GëEº‹
(
DMA_H™dÀTy≥Def
 *
hdma
)

846  
hdma
->
Eº‹Code
;

847 
	}
}

870 
	$DMA_SëC⁄fig
(
DMA_H™dÀTy≥Def
 *
hdma
, 
uöt32_t
 
SrcAddªss
, uöt32_à
D°Addªss
, uöt32_à
D©aLígth
)

873 
hdma
->
DmaBa£Addªss
->
IFCR
 = (
DMA_ISR_GIF1
 << hdma->
Ch™√lIndex
);

876 
hdma
->
In°™˚
->
CNDTR
 = 
D©aLígth
;

879 if((
hdma
->
Inô
.
Dúe˘i⁄
Ë=
DMA_MEMORY_TO_PERIPH
)

882 
hdma
->
In°™˚
->
CPAR
 = 
D°Addªss
;

885 
hdma
->
In°™˚
->
CMAR
 = 
SrcAddªss
;

891 
hdma
->
In°™˚
->
CPAR
 = 
SrcAddªss
;

894 
hdma
->
In°™˚
->
CMAR
 = 
D°Addªss
;

896 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_gpio.c

136 
	~"°m32l1xx_hÆ.h
"

147 #ifde‡
HAL_GPIO_MODULE_ENABLED


154 
	#GPIO_MODE
 ((
uöt32_t
)0x00000003)

	)

155 
	#EXTI_MODE
 ((
uöt32_t
)0x10000000)

	)

156 
	#GPIO_MODE_IT
 ((
uöt32_t
)0x00010000)

	)

157 
	#GPIO_MODE_EVT
 ((
uöt32_t
)0x00020000)

	)

158 
	#RISING_EDGE
 ((
uöt32_t
)0x00100000)

	)

159 
	#FALLING_EDGE
 ((
uöt32_t
)0x00200000)

	)

160 
	#GPIO_OUTPUT_TYPE
 ((
uöt32_t
)0x00000010)

	)

162 
	#GPIO_NUMBER
 ((
uöt32_t
)16)

	)

196 
	$HAL_GPIO_Inô
(
GPIO_Ty≥Def
 *
GPIOx
, 
GPIO_InôTy≥Def
 *
GPIO_Inô
)

198 
uöt32_t
 
posôi⁄
 = 0x00;

199 
uöt32_t
 
iocuºít
 = 0x00;

200 
uöt32_t
 
ãmp
 = 0x00;

203 
	`as£π_∑øm
(
	`IS_GPIO_ALL_INSTANCE
(
GPIOx
));

204 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Inô
->
Pö
));

205 
	`as£π_∑øm
(
	`IS_GPIO_MODE
(
GPIO_Inô
->
Mode
));

206 
	`as£π_∑øm
(
	`IS_GPIO_PULL
(
GPIO_Inô
->
PuŒ
));

209 ((
GPIO_Inô
->
Pö
Ë>> 
posôi⁄
) != 0)

212 
iocuºít
 = (
GPIO_Inô
->
Pö
Ë& ((
uöt32_t
)1 << 
posôi⁄
);

214 if(
iocuºít
)

218 if((
GPIO_Inô
->
Mode
 =
GPIO_MODE_AF_PP
Ë|| (GPIO_Inô->Modê=
GPIO_MODE_AF_OD
))

221 
	`as£π_∑øm
(
	`IS_GPIO_AF_INSTANCE
(
GPIOx
));

222 
	`as£π_∑øm
(
	`IS_GPIO_AF
(
GPIO_Inô
->
A…î«ã
));

226 
ãmp
 = 
GPIOx
->
AFR
[
posôi⁄
 >> 3];

227 
	`CLEAR_BIT
(
ãmp
, (
uöt32_t
)0xF << ((uöt32_t)(
posôi⁄
 & (uint32_t)0x07) * 4)) ;

228 
	`SET_BIT
(
ãmp
, (
uöt32_t
)(
GPIO_Inô
->
A…î«ã
Ë<< (((uöt32_t)
posôi⁄
 & (uint32_t)0x07) * 4));

229 
GPIOx
->
AFR
[
posôi⁄
 >> 3] = 
ãmp
;

233 
ãmp
 = 
GPIOx
->
MODER
;

234 
	`CLEAR_BIT
(
ãmp
, 
GPIO_MODER_MODER0
 << (
posôi⁄
 * 2));

235 
	`SET_BIT
(
ãmp
, (
GPIO_Inô
->
Mode
 & 
GPIO_MODE
Ë<< (
posôi⁄
 * 2));

236 
GPIOx
->
MODER
 = 
ãmp
;

239 i‡((
GPIO_Inô
->
Mode
 =
GPIO_MODE_OUTPUT_PP
Ë|| (GPIO_Inô->Modê=
GPIO_MODE_AF_PP
) ||

240 (
GPIO_Inô
->
Mode
 =
GPIO_MODE_OUTPUT_OD
Ë|| (GPIO_Inô->Modê=
GPIO_MODE_AF_OD
))

243 
	`as£π_∑øm
(
	`IS_GPIO_SPEED
(
GPIO_Inô
->
S≥ed
));

245 
ãmp
 = 
GPIOx
->
OSPEEDR
;

246 
	`CLEAR_BIT
(
ãmp
, 
GPIO_OSPEEDER_OSPEEDR0
 << (
posôi⁄
 * 2));

247 
	`SET_BIT
(
ãmp
, 
GPIO_Inô
->
S≥ed
 << (
posôi⁄
 * 2));

248 
GPIOx
->
OSPEEDR
 = 
ãmp
;

251 
ãmp
 = 
GPIOx
->
OTYPER
;

252 
	`CLEAR_BIT
(
ãmp
, 
GPIO_OTYPER_OT_0
 << 
posôi⁄
) ;

253 
	`SET_BIT
(
ãmp
, ((
GPIO_Inô
->
Mode
 & 
GPIO_OUTPUT_TYPE
Ë>> 4Ë<< 
posôi⁄
);

254 
GPIOx
->
OTYPER
 = 
ãmp
;

258 
ãmp
 = 
GPIOx
->
PUPDR
;

259 
	`CLEAR_BIT
(
ãmp
, 
GPIO_PUPDR_PUPDR0
 << (
posôi⁄
 * 2));

260 
	`SET_BIT
(
ãmp
, (
GPIO_Inô
->
PuŒ
Ë<< (
posôi⁄
 * 2));

261 
GPIOx
->
PUPDR
 = 
ãmp
;

265 if((
GPIO_Inô
->
Mode
 & 
EXTI_MODE
) == EXTI_MODE)

268 
	`__HAL_RCC_SYSCFG_CLK_ENABLE
();

270 
ãmp
 = 
SYSCFG
->
EXTICR
[
posôi⁄
 >> 2];

271 
	`CLEAR_BIT
(
ãmp
, ((
uöt32_t
)0x0FË<< (4 * (
posôi⁄
 & 0x03)));

272 
	`SET_BIT
(
ãmp
, (
	`GPIO_GET_INDEX
(
GPIOx
)Ë<< (4 * (
posôi⁄
 & 0x03)));

273 
SYSCFG
->
EXTICR
[
posôi⁄
 >> 2] = 
ãmp
;

276 
ãmp
 = 
EXTI
->
IMR
;

277 
	`CLEAR_BIT
(
ãmp
, (
uöt32_t
)
iocuºít
);

278 if((
GPIO_Inô
->
Mode
 & 
GPIO_MODE_IT
) == GPIO_MODE_IT)

280 
	`SET_BIT
(
ãmp
, 
iocuºít
);

282 
EXTI
->
IMR
 = 
ãmp
;

284 
ãmp
 = 
EXTI
->
EMR
;

285 
	`CLEAR_BIT
(
ãmp
, (
uöt32_t
)
iocuºít
);

286 if((
GPIO_Inô
->
Mode
 & 
GPIO_MODE_EVT
) == GPIO_MODE_EVT)

288 
	`SET_BIT
(
ãmp
, 
iocuºít
);

290 
EXTI
->
EMR
 = 
ãmp
;

293 
ãmp
 = 
EXTI
->
RTSR
;

294 
	`CLEAR_BIT
(
ãmp
, (
uöt32_t
)
iocuºít
);

295 if((
GPIO_Inô
->
Mode
 & 
RISING_EDGE
) == RISING_EDGE)

297 
	`SET_BIT
(
ãmp
, 
iocuºít
);

299 
EXTI
->
RTSR
 = 
ãmp
;

301 
ãmp
 = 
EXTI
->
FTSR
;

302 
	`CLEAR_BIT
(
ãmp
, (
uöt32_t
)
iocuºít
);

303 if((
GPIO_Inô
->
Mode
 & 
FALLING_EDGE
) == FALLING_EDGE)

305 
	`SET_BIT
(
ãmp
, 
iocuºít
);

307 
EXTI
->
FTSR
 = 
ãmp
;

311 
posôi⁄
++;

313 
	}
}

322 
	$HAL_GPIO_DeInô
(
GPIO_Ty≥Def
 *
GPIOx
, 
uöt32_t
 
GPIO_Pö
)

324 
uöt32_t
 
posôi⁄
 = 0x00;

325 
uöt32_t
 
iocuºít
 = 0x00;

326 
uöt32_t
 
tmp
 = 0x00;

329 
	`as£π_∑øm
(
	`IS_GPIO_ALL_INSTANCE
(
GPIOx
));

330 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

333 (
GPIO_Pö
 >> 
posôi⁄
) != 0)

336 
iocuºít
 = (
GPIO_Pö
Ë& ((
uöt32_t
)1 << 
posôi⁄
);

338 i‡(
iocuºít
)

342 
	`CLEAR_BIT
(
GPIOx
->
MODER
, 
GPIO_MODER_MODER0
 << (
posôi⁄
 * 2));

345 
	`CLEAR_BIT
(
GPIOx
->
AFR
[
posôi⁄
 >> 3], (
uöt32_t
)0xF << ((uint32_t)(position & (uint32_t)0x07) * 4)) ;

348 
	`CLEAR_BIT
(
GPIOx
->
OSPEEDR
, 
GPIO_OSPEEDER_OSPEEDR0
 << (
posôi⁄
 * 2));

351 
	`CLEAR_BIT
(
GPIOx
->
OTYPER
, 
GPIO_OTYPER_OT_0
 << 
posôi⁄
) ;

354 
	`CLEAR_BIT
(
GPIOx
->
PUPDR
, 
GPIO_PUPDR_PUPDR0
 << (
posôi⁄
 * 2));

359 
tmp
 = 
SYSCFG
->
EXTICR
[
posôi⁄
 >> 2];

360 
tmp
 &(((
uöt32_t
)0x0FË<< (4 * (
posôi⁄
 & 0x03)));

361 if(
tmp
 =(
	`GPIO_GET_INDEX
(
GPIOx
Ë<< (4 * (
posôi⁄
 & 0x03))))

363 
tmp
 = ((
uöt32_t
)0x0FË<< (4 * (
posôi⁄
 & 0x03));

364 
	`CLEAR_BIT
(
SYSCFG
->
EXTICR
[
posôi⁄
 >> 2], 
tmp
);

367 
	`CLEAR_BIT
(
EXTI
->
IMR
, (
uöt32_t
)
iocuºít
);

368 
	`CLEAR_BIT
(
EXTI
->
EMR
, (
uöt32_t
)
iocuºít
);

371 
	`CLEAR_BIT
(
EXTI
->
RTSR
, (
uöt32_t
)
iocuºít
);

372 
	`CLEAR_BIT
(
EXTI
->
FTSR
, (
uöt32_t
)
iocuºít
);

376 
posôi⁄
++;

378 
	}
}

403 
GPIO_PöSèã
 
	$HAL_GPIO_RódPö
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

405 
GPIO_PöSèã
 
bô°©us
;

408 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

410 i‡((
GPIOx
->
IDR
 & 
GPIO_Pö
Ë!(
uöt32_t
)
GPIO_PIN_RESET
)

412 
bô°©us
 = 
GPIO_PIN_SET
;

416 
bô°©us
 = 
GPIO_PIN_RESET
;

418  
bô°©us
;

419 
	}
}

435 
	$HAL_GPIO_WrôePö
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
, 
GPIO_PöSèã
 
PöSèã
)

438 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

439 
	`as£π_∑øm
(
	`IS_GPIO_PIN_ACTION
(
PöSèã
));

441 i‡(
PöSèã
 !
GPIO_PIN_RESET
)

443 
GPIOx
->
BSRR
 = (
uöt32_t
)
GPIO_Pö
;

447 
GPIOx
->
BSRR
 = (
uöt32_t
)
GPIO_Pö
 << 16 ;

449 
	}
}

457 
	$HAL_GPIO_ToggÀPö
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

460 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

462 
GPIOx
->
ODR
 ^
GPIO_Pö
;

463 
	}
}

485 
HAL_SètusTy≥Def
 
	$HAL_GPIO_LockPö
(
GPIO_Ty≥Def
* 
GPIOx
, 
uöt16_t
 
GPIO_Pö
)

487 
__IO
 
uöt32_t
 
tmp
 = 
GPIO_LCKR_LCKK
;

490 
	`as£π_∑øm
(
	`IS_GPIO_LOCK_INSTANCE
(
GPIOx
));

491 
	`as£π_∑øm
(
	`IS_GPIO_PIN
(
GPIO_Pö
));

494 
	`SET_BIT
(
tmp
, 
GPIO_Pö
);

496 
GPIOx
->
LCKR
 = 
tmp
;

498 
GPIOx
->
LCKR
 = 
GPIO_Pö
;

500 
GPIOx
->
LCKR
 = 
tmp
;

502 
tmp
 = 
GPIOx
->
LCKR
;

504 if((
GPIOx
->
LCKR
 & 
GPIO_LCKR_LCKK
Ë!
RESET
)

506  
HAL_OK
;

510  
HAL_ERROR
;

512 
	}
}

519 
	$HAL_GPIO_EXTI_IRQH™dÀr
(
uöt16_t
 
GPIO_Pö
)

522 if(
	`__HAL_GPIO_EXTI_GET_IT
(
GPIO_Pö
Ë!
RESET
)

524 
	`__HAL_GPIO_EXTI_CLEAR_IT
(
GPIO_Pö
);

525 
	`HAL_GPIO_EXTI_CÆlback
(
GPIO_Pö
);

527 
	}
}

534 
__wók
 
	$HAL_GPIO_EXTI_CÆlback
(
uöt16_t
 
GPIO_Pö
)

537 
	`UNUSED
(
GPIO_Pö
);

542 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_i2c.c

242 
	~"°m32l1xx_hÆ.h
"

253 #ifde‡
HAL_I2C_MODULE_ENABLED


260 
	#I2C_TIMEOUT_FLAG
 ((
uöt32_t
)35UË

	)

261 
	#I2C_TIMEOUT_ADDR_SLAVE
 ((
uöt32_t
)10000UË

	)

262 
	#I2C_TIMEOUT_BUSY_FLAG
 ((
uöt32_t
)25UË

	)

263 
	#I2C_NO_OPTION_FRAME
 ((
uöt32_t
)0xFFFF0000UË

	)

265 
	#I2C_MIN_PCLK_FREQ
 ((
uöt32_t
)2000000UË

	)

268 
	#I2C_STATE_MSK
 ((
uöt32_t
)((
HAL_I2C_STATE_BUSY_TX
 | 
HAL_I2C_STATE_BUSY_RX
Ë& (~(uöt32_t)
HAL_I2C_STATE_READY
))Ë

	)

269 
	#I2C_STATE_NONE
 ((
uöt32_t
)(
HAL_I2C_MODE_NONE
)Ë

	)

270 
	#I2C_STATE_MASTER_BUSY_TX
 ((
uöt32_t
)((
HAL_I2C_STATE_BUSY_TX
 & 
I2C_STATE_MSK
Ë| 
HAL_I2C_MODE_MASTER
)Ë

	)

271 
	#I2C_STATE_MASTER_BUSY_RX
 ((
uöt32_t
)((
HAL_I2C_STATE_BUSY_RX
 & 
I2C_STATE_MSK
Ë| 
HAL_I2C_MODE_MASTER
)Ë

	)

272 
	#I2C_STATE_SLAVE_BUSY_TX
 ((
uöt32_t
)((
HAL_I2C_STATE_BUSY_TX
 & 
I2C_STATE_MSK
Ë| 
HAL_I2C_MODE_SLAVE
)Ë

	)

273 
	#I2C_STATE_SLAVE_BUSY_RX
 ((
uöt32_t
)((
HAL_I2C_STATE_BUSY_RX
 & 
I2C_STATE_MSK
Ë| 
HAL_I2C_MODE_SLAVE
)Ë

	)

286 
I2C_DMAX„rC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
);

287 
I2C_DMAEº‹
(
DMA_H™dÀTy≥Def
 *
hdma
);

288 
I2C_DMAAb‹t
(
DMA_H™dÀTy≥Def
 *
hdma
);

290 
I2C_ITEº‹
(
I2C_H™dÀTy≥Def
 *
hi2c
);

292 
HAL_SètusTy≥Def
 
I2C_Ma°îReque°Wrôe
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

293 
HAL_SètusTy≥Def
 
I2C_Ma°îReque°Ród
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

294 
HAL_SètusTy≥Def
 
I2C_Reque°Mem‹yWrôe
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

295 
HAL_SètusTy≥Def
 
I2C_Reque°Mem‹yRód
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

296 
HAL_SètusTy≥Def
 
I2C_WaôOnFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Fœg
, 
FœgSètus
 
Sètus
, uöt32_à
Timeout
, uöt32_à
Tick°¨t
);

297 
HAL_SètusTy≥Def
 
I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Fœg
, uöt32_à
Timeout
, uöt32_à
Tick°¨t
);

298 
HAL_SètusTy≥Def
 
I2C_WaôOnTXEFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

299 
HAL_SètusTy≥Def
 
I2C_WaôOnBTFFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

300 
HAL_SètusTy≥Def
 
I2C_WaôOnRXNEFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

301 
HAL_SètusTy≥Def
 
I2C_WaôOnSTOPFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
);

302 
HAL_SètusTy≥Def
 
I2C_IsAcknowÀdgeFaûed
(
I2C_H™dÀTy≥Def
 *
hi2c
);

305 
HAL_SètusTy≥Def
 
I2C_Ma°îTønsmô_TXE
(
I2C_H™dÀTy≥Def
 *
hi2c
);

306 
HAL_SètusTy≥Def
 
I2C_Ma°îTønsmô_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
);

307 
HAL_SètusTy≥Def
 
I2C_Ma°îRe˚ive_RXNE
(
I2C_H™dÀTy≥Def
 *
hi2c
);

308 
HAL_SètusTy≥Def
 
I2C_Ma°îRe˚ive_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
);

309 
HAL_SètusTy≥Def
 
I2C_Ma°î_SB
(
I2C_H™dÀTy≥Def
 *
hi2c
);

310 
HAL_SètusTy≥Def
 
I2C_Ma°î_ADD10
(
I2C_H™dÀTy≥Def
 *
hi2c
);

311 
HAL_SètusTy≥Def
 
I2C_Ma°î_ADDR
(
I2C_H™dÀTy≥Def
 *
hi2c
);

313 
HAL_SètusTy≥Def
 
I2C_SœveTønsmô_TXE
(
I2C_H™dÀTy≥Def
 *
hi2c
);

314 
HAL_SètusTy≥Def
 
I2C_SœveTønsmô_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
);

315 
HAL_SètusTy≥Def
 
I2C_SœveRe˚ive_RXNE
(
I2C_H™dÀTy≥Def
 *
hi2c
);

316 
HAL_SètusTy≥Def
 
I2C_SœveRe˚ive_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
);

317 
HAL_SètusTy≥Def
 
I2C_Sœve_ADDR
(
I2C_H™dÀTy≥Def
 *
hi2c
);

318 
HAL_SètusTy≥Def
 
I2C_Sœve_STOPF
(
I2C_H™dÀTy≥Def
 *
hi2c
);

319 
HAL_SètusTy≥Def
 
I2C_Sœve_AF
(
I2C_H™dÀTy≥Def
 *
hi2c
);

367 
HAL_SètusTy≥Def
 
	$HAL_I2C_Inô
(
I2C_H™dÀTy≥Def
 *
hi2c
)

369 
uöt32_t
 
‰eqønge
 = 0U;

370 
uöt32_t
 
p˛k1
 = 0U;

373 if(
hi2c
 =
NULL
)

375  
HAL_ERROR
;

379 
	`as£π_∑øm
(
	`IS_I2C_ALL_INSTANCE
(
hi2c
->
In°™˚
));

380 
	`as£π_∑øm
(
	`IS_I2C_CLOCK_SPEED
(
hi2c
->
Inô
.
ClockS≥ed
));

381 
	`as£π_∑øm
(
	`IS_I2C_DUTY_CYCLE
(
hi2c
->
Inô
.
DutyCy˛e
));

382 
	`as£π_∑øm
(
	`IS_I2C_OWN_ADDRESS1
(
hi2c
->
Inô
.
OwnAddªss1
));

383 
	`as£π_∑øm
(
	`IS_I2C_ADDRESSING_MODE
(
hi2c
->
Inô
.
AddªssögMode
));

384 
	`as£π_∑øm
(
	`IS_I2C_DUAL_ADDRESS
(
hi2c
->
Inô
.
DuÆAddªssMode
));

385 
	`as£π_∑øm
(
	`IS_I2C_OWN_ADDRESS2
(
hi2c
->
Inô
.
OwnAddªss2
));

386 
	`as£π_∑øm
(
	`IS_I2C_GENERAL_CALL
(
hi2c
->
Inô
.
GíîÆCÆlMode
));

387 
	`as£π_∑øm
(
	`IS_I2C_NO_STRETCH
(
hi2c
->
Inô
.
NoSåëchMode
));

389 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_RESET
)

392 
hi2c
->
Lock
 = 
HAL_UNLOCKED
;

395 
	`HAL_I2C_M•Inô
(
hi2c
);

399 
p˛k1
 = 
	`HAL_RCC_GëPCLK1Fªq
();

402 if(
p˛k1
 < 
I2C_MIN_PCLK_FREQ
)

404  
HAL_ERROR
;

407 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY
;

410 
	`__HAL_I2C_DISABLE
(
hi2c
);

413 
‰eqønge
 = 
	`I2C_FREQ_RANGE
(
p˛k1
);

417 
	`MODIFY_REG
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_FREQ
, 
‰eqønge
);

421 
	`MODIFY_REG
(
hi2c
->
In°™˚
->
TRISE
, 
I2C_TRISE_TRISE
, 
	`I2C_RISE_TIME
(
‰eqønge
, hi2c->
Inô
.
ClockS≥ed
));

425 
	`MODIFY_REG
(
hi2c
->
In°™˚
->
CCR
, (
I2C_CCR_FS
 | 
I2C_CCR_DUTY
 | 
I2C_CCR_CCR
), 
	`I2C_SPEED
(
p˛k1
, hi2c->
Inô
.
ClockS≥ed
, hi2c->Inô.
DutyCy˛e
));

429 
	`MODIFY_REG
(
hi2c
->
In°™˚
->
CR1
, (
I2C_CR1_ENGC
 | 
I2C_CR1_NOSTRETCH
), (hi2c->
Inô
.
GíîÆCÆlMode
 | hi2c->Inô.
NoSåëchMode
));

433 
	`MODIFY_REG
(
hi2c
->
In°™˚
->
OAR1
, (
I2C_OAR1_ADDMODE
 | 
I2C_OAR1_ADD8_9
 | 
I2C_OAR1_ADD1_7
 | 
I2C_OAR1_ADD0
), (hi2c->
Inô
.
AddªssögMode
 | hi2c->Inô.
OwnAddªss1
));

437 
	`MODIFY_REG
(
hi2c
->
In°™˚
->
OAR2
, (
I2C_OAR2_ENDUAL
 | 
I2C_OAR2_ADD2
), (hi2c->
Inô
.
DuÆAddªssMode
 | hi2c->Inô.
OwnAddªss2
));

440 
	`__HAL_I2C_ENABLE
(
hi2c
);

442 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

443 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

444 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

445 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

447  
HAL_OK
;

448 
	}
}

456 
HAL_SètusTy≥Def
 
	$HAL_I2C_DeInô
(
I2C_H™dÀTy≥Def
 *
hi2c
)

459 if(
hi2c
 =
NULL
)

461  
HAL_ERROR
;

465 
	`as£π_∑øm
(
	`IS_I2C_ALL_INSTANCE
(
hi2c
->
In°™˚
));

467 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY
;

470 
	`__HAL_I2C_DISABLE
(
hi2c
);

473 
	`HAL_I2C_M•DeInô
(
hi2c
);

475 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

476 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_RESET
;

477 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

478 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

481 
	`__HAL_UNLOCK
(
hi2c
);

483  
HAL_OK
;

484 
	}
}

492 
__wók
 
	$HAL_I2C_M•Inô
(
I2C_H™dÀTy≥Def
 *
hi2c
)

495 
	`UNUSED
(
hi2c
);

500 
	}
}

508 
__wók
 
	$HAL_I2C_M•DeInô
(
I2C_H™dÀTy≥Def
 *
hi2c
)

511 
	`UNUSED
(
hi2c
);

516 
	}
}

597 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Tønsmô
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
, 
uöt32_t
 
Timeout
)

599 
uöt32_t
 
tick°¨t
 = 0x00U;

602 
tick°¨t
 = 
	`HAL_GëTick
();

604 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

607 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

609  
HAL_BUSY
;

613 
	`__HAL_LOCK
(
hi2c
);

616 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

619 
	`__HAL_I2C_ENABLE
(
hi2c
);

623 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

625 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

626 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

627 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

630 
hi2c
->
pBuffPå
 = 
pD©a
;

631 
hi2c
->
X„rCou¡
 = 
Size
;

632 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

633 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

636 if(
	`I2C_Ma°îReque°Wrôe
(
hi2c
, 
DevAddªss
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

638 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

641 
	`__HAL_UNLOCK
(
hi2c
);

642  
HAL_ERROR
;

647 
	`__HAL_UNLOCK
(
hi2c
);

648  
HAL_TIMEOUT
;

653 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

655 
hi2c
->
X„rSize
 > 0U)

658 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

660 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

663 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

664  
HAL_ERROR
;

668  
HAL_TIMEOUT
;

673 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

674 
hi2c
->
X„rCou¡
--;

675 
hi2c
->
X„rSize
--;

677 if((
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
SET
Ë&& (
Size
 != 0U))

680 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

681 
hi2c
->
X„rCou¡
--;

682 
hi2c
->
X„rSize
--;

686 if(
	`I2C_WaôOnBTFFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

688 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

691 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

692  
HAL_ERROR
;

696  
HAL_TIMEOUT
;

702 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

704 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

705 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

708 
	`__HAL_UNLOCK
(
hi2c
);

710  
HAL_OK
;

714  
HAL_BUSY
;

716 
	}
}

729 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Re˚ive
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
, 
uöt32_t
 
Timeout
)

731 
uöt32_t
 
tick°¨t
 = 0x00U;

734 
tick°¨t
 = 
	`HAL_GëTick
();

736 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

739 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

741  
HAL_BUSY
;

745 
	`__HAL_LOCK
(
hi2c
);

748 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

751 
	`__HAL_I2C_ENABLE
(
hi2c
);

755 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

757 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

758 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

759 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

762 
hi2c
->
pBuffPå
 = 
pD©a
;

763 
hi2c
->
X„rCou¡
 = 
Size
;

764 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

765 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

768 if(
	`I2C_Ma°îReque°Ród
(
hi2c
, 
DevAddªss
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

770 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

773 
	`__HAL_UNLOCK
(
hi2c
);

774  
HAL_ERROR
;

779 
	`__HAL_UNLOCK
(
hi2c
);

780  
HAL_TIMEOUT
;

784 if(
hi2c
->
X„rSize
 == 0U)

787 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

790 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

792 if(
hi2c
->
X„rSize
 == 1U)

795 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

798 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

801 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

803 if(
hi2c
->
X„rSize
 == 2U)

806 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

809 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

812 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

817 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

820 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

823 
hi2c
->
X„rSize
 > 0U)

825 if(
hi2c
->
X„rSize
 <= 3U)

828 if(
hi2c
->
X„rSize
 == 1U)

831 if(
	`I2C_WaôOnRXNEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

833 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_TIMEOUT
)

835  
HAL_TIMEOUT
;

839  
HAL_ERROR
;

844 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

845 
hi2c
->
X„rSize
--;

846 
hi2c
->
X„rCou¡
--;

849 if(
hi2c
->
X„rSize
 == 2U)

852 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BTF
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

854  
HAL_TIMEOUT
;

858 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

861 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

862 
hi2c
->
X„rSize
--;

863 
hi2c
->
X„rCou¡
--;

866 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

867 
hi2c
->
X„rSize
--;

868 
hi2c
->
X„rCou¡
--;

874 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BTF
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

876  
HAL_TIMEOUT
;

880 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

883 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

884 
hi2c
->
X„rSize
--;

885 
hi2c
->
X„rCou¡
--;

888 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BTF
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

890  
HAL_TIMEOUT
;

894 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

897 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

898 
hi2c
->
X„rSize
--;

899 
hi2c
->
X„rCou¡
--;

902 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

903 
hi2c
->
X„rSize
--;

904 
hi2c
->
X„rCou¡
--;

910 if(
	`I2C_WaôOnRXNEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

912 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_TIMEOUT
)

914  
HAL_TIMEOUT
;

918  
HAL_ERROR
;

923 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

924 
hi2c
->
X„rSize
--;

925 
hi2c
->
X„rCou¡
--;

927 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
SET
)

930 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

931 
hi2c
->
X„rSize
--;

932 
hi2c
->
X„rCou¡
--;

937 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

938 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

941 
	`__HAL_UNLOCK
(
hi2c
);

943  
HAL_OK
;

947  
HAL_BUSY
;

949 
	}
}

960 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Tønsmô
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
Timeout
)

962 
uöt32_t
 
tick°¨t
 = 0x00U;

965 
tick°¨t
 = 
	`HAL_GëTick
();

967 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

969 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

971  
HAL_ERROR
;

975 
	`__HAL_LOCK
(
hi2c
);

978 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

981 
	`__HAL_I2C_ENABLE
(
hi2c
);

985 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

987 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

988 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

989 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

992 
hi2c
->
pBuffPå
 = 
pD©a
;

993 
hi2c
->
X„rCou¡
 = 
Size
;

994 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

995 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

998 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1001 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

1003  
HAL_TIMEOUT
;

1007 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

1010 if(
hi2c
->
Inô
.
AddªssögMode
 =
I2C_ADDRESSINGMODE_10BIT
)

1013 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

1015  
HAL_TIMEOUT
;

1019 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

1022 
hi2c
->
X„rSize
 > 0U)

1025 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

1028 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1029 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

1031  
HAL_ERROR
;

1035  
HAL_TIMEOUT
;

1040 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

1041 
hi2c
->
X„rCou¡
--;

1042 
hi2c
->
X„rSize
--;

1044 if((
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
SET
Ë&& (
Size
 != 0U))

1047 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

1048 
hi2c
->
X„rCou¡
--;

1049 
hi2c
->
X„rSize
--;

1054 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_AF
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

1056  
HAL_TIMEOUT
;

1060 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

1063 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1065 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

1066 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

1069 
	`__HAL_UNLOCK
(
hi2c
);

1071  
HAL_OK
;

1075  
HAL_BUSY
;

1077 
	}
}

1088 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Re˚ive
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
Timeout
)

1090 
uöt32_t
 
tick°¨t
 = 0x00U;

1093 
tick°¨t
 = 
	`HAL_GëTick
();

1095 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1097 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

1099  
HAL_ERROR
;

1103 
	`__HAL_LOCK
(
hi2c
);

1106 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1109 
	`__HAL_I2C_ENABLE
(
hi2c
);

1113 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1115 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

1116 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

1117 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1120 
hi2c
->
pBuffPå
 = 
pD©a
;

1121 
hi2c
->
X„rCou¡
 = 
Size
;

1122 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

1123 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1126 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1129 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

1131  
HAL_TIMEOUT
;

1135 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

1137 
hi2c
->
X„rSize
 > 0U)

1140 if(
	`I2C_WaôOnRXNEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

1143 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1144 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_TIMEOUT
)

1146  
HAL_TIMEOUT
;

1150  
HAL_ERROR
;

1155 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

1156 
hi2c
->
X„rSize
--;

1157 
hi2c
->
X„rCou¡
--;

1159 if((
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
SET
Ë&& (
Size
 != 0U))

1162 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

1163 
hi2c
->
X„rSize
--;

1164 
hi2c
->
X„rCou¡
--;

1169 if(
	`I2C_WaôOnSTOPFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

1172 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1174 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

1176  
HAL_ERROR
;

1180  
HAL_TIMEOUT
;

1185 
	`__HAL_I2C_CLEAR_STOPFLAG
(
hi2c
);

1188 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1190 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

1191 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

1194 
	`__HAL_UNLOCK
(
hi2c
);

1196  
HAL_OK
;

1200  
HAL_BUSY
;

1202 
	}
}

1214 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Tønsmô_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

1216 
__IO
 
uöt32_t
 
cou¡
 = 0U;

1218 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1221 
cou¡
 = 
I2C_TIMEOUT_BUSY_FLAG
 * (
Sy°emC‹eClock
 /25U /1000U);

1224 if(
cou¡
-- == 0U)

1226 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

1227 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

1230 
	`__HAL_UNLOCK
(
hi2c
);

1232  
HAL_TIMEOUT
;

1235 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BUSY
Ë!
RESET
);

1238 
	`__HAL_LOCK
(
hi2c
);

1241 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1244 
	`__HAL_I2C_ENABLE
(
hi2c
);

1248 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1250 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

1251 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

1252 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1255 
hi2c
->
pBuffPå
 = 
pD©a
;

1256 
hi2c
->
X„rCou¡
 = 
Size
;

1257 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

1258 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1259 
hi2c
->
Devaddªss
 = 
DevAddªss
;

1262 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1265 
	`__HAL_UNLOCK
(
hi2c
);

1271 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1273  
HAL_OK
;

1277  
HAL_BUSY
;

1279 
	}
}

1291 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Re˚ive_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

1293 
__IO
 
uöt32_t
 
cou¡
 = 0U;

1295 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1298 
cou¡
 = 
I2C_TIMEOUT_BUSY_FLAG
 * (
Sy°emC‹eClock
 /25U /1000U);

1301 if(
cou¡
-- == 0U)

1303 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

1304 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

1307 
	`__HAL_UNLOCK
(
hi2c
);

1309  
HAL_TIMEOUT
;

1312 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BUSY
Ë!
RESET
);

1315 
	`__HAL_LOCK
(
hi2c
);

1318 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1321 
	`__HAL_I2C_ENABLE
(
hi2c
);

1325 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1327 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

1328 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

1329 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1332 
hi2c
->
pBuffPå
 = 
pD©a
;

1333 
hi2c
->
X„rCou¡
 = 
Size
;

1334 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

1335 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1336 
hi2c
->
Devaddªss
 = 
DevAddªss
;

1339 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1342 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1345 
	`__HAL_UNLOCK
(
hi2c
);

1352 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1354  
HAL_OK
;

1358  
HAL_BUSY
;

1360 
	}
}

1374 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Sequítül_Tønsmô_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
, 
uöt32_t
 
X„rO±i⁄s
)

1376 
__IO
 
uöt32_t
 
cou¡
 = 0U;

1379 
	`as£π_∑øm
(
	`IS_I2C_TRANSFER_OPTIONS_REQUEST
(
X„rO±i⁄s
));

1381 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1384 if((
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (X„rO±i⁄†=
I2C_FIRST_FRAME
))

1387 
cou¡
 = 
I2C_TIMEOUT_BUSY_FLAG
 * (
Sy°emC‹eClock
 /25U /1000U);

1390 if(
cou¡
-- == 0U)

1392 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

1393 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

1396 
	`__HAL_UNLOCK
(
hi2c
);

1398  
HAL_TIMEOUT
;

1401 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BUSY
Ë!
RESET
);

1405 
	`__HAL_LOCK
(
hi2c
);

1408 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1411 
	`__HAL_I2C_ENABLE
(
hi2c
);

1415 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1417 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

1418 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

1419 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1422 
hi2c
->
pBuffPå
 = 
pD©a
;

1423 
hi2c
->
X„rCou¡
 = 
Size
;

1424 
hi2c
->
X„rO±i⁄s
 = XferOptions;

1425 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1426 
hi2c
->
Devaddªss
 = 
DevAddªss
;

1429 if((
hi2c
->
PªviousSèã
 =
I2C_STATE_MASTER_BUSY_RX
Ë|| (hi2c->PªviousSèã =
I2C_STATE_NONE
))

1432 if((
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (X„rO±i⁄†=
I2C_FIRST_FRAME
))

1435 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1437 if(
hi2c
->
PªviousSèã
 =
I2C_STATE_MASTER_BUSY_RX
)

1440 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1445 
	`__HAL_UNLOCK
(
hi2c
);

1452 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1454  
HAL_OK
;

1458  
HAL_BUSY
;

1460 
	}
}

1474 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Sequítül_Re˚ive_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
, 
uöt32_t
 
X„rO±i⁄s
)

1476 
__IO
 
uöt32_t
 
cou¡
 = 0U;

1479 
	`as£π_∑øm
(
	`IS_I2C_TRANSFER_OPTIONS_REQUEST
(
X„rO±i⁄s
));

1481 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1484 if((
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (X„rO±i⁄†=
I2C_FIRST_FRAME
))

1487 
cou¡
 = 
I2C_TIMEOUT_BUSY_FLAG
 * (
Sy°emC‹eClock
 /25U /1000U);

1490 if(
cou¡
-- == 0U)

1492 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

1493 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

1496 
	`__HAL_UNLOCK
(
hi2c
);

1498  
HAL_TIMEOUT
;

1501 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BUSY
Ë!
RESET
);

1505 
	`__HAL_LOCK
(
hi2c
);

1508 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1511 
	`__HAL_I2C_ENABLE
(
hi2c
);

1515 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1517 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

1518 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

1519 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1522 
hi2c
->
pBuffPå
 = 
pD©a
;

1523 
hi2c
->
X„rCou¡
 = 
Size
;

1524 
hi2c
->
X„rO±i⁄s
 = XferOptions;

1525 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1526 
hi2c
->
Devaddªss
 = 
DevAddªss
;

1528 if((
hi2c
->
PªviousSèã
 =
I2C_STATE_MASTER_BUSY_TX
Ë|| (hi2c->PªviousSèã =
I2C_STATE_NONE
))

1531 if((
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (X„rO±i⁄†=
I2C_FIRST_FRAME
Ë|| (X„rO±i⁄†=
I2C_NO_OPTION_FRAME
))

1534 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1537 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1539 if(
hi2c
->
PªviousSèã
 =
I2C_STATE_MASTER_BUSY_TX
)

1542 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1545 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1550 
	`__HAL_UNLOCK
(
hi2c
);

1557 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1559  
HAL_OK
;

1563  
HAL_BUSY
;

1565 
	}
}

1575 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Tønsmô_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

1577 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1579 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

1581  
HAL_ERROR
;

1585 
	`__HAL_LOCK
(
hi2c
);

1588 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1591 
	`__HAL_I2C_ENABLE
(
hi2c
);

1595 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1597 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

1598 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

1599 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1602 
hi2c
->
pBuffPå
 = 
pD©a
;

1603 
hi2c
->
X„rCou¡
 = 
Size
;

1604 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

1605 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1608 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1611 
	`__HAL_UNLOCK
(
hi2c
);

1618 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1620  
HAL_OK
;

1624  
HAL_BUSY
;

1626 
	}
}

1636 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Re˚ive_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

1638 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1640 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

1642  
HAL_ERROR
;

1646 
	`__HAL_LOCK
(
hi2c
);

1649 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1652 
	`__HAL_I2C_ENABLE
(
hi2c
);

1656 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1658 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

1659 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

1660 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1663 
hi2c
->
pBuffPå
 = 
pD©a
;

1664 
hi2c
->
X„rCou¡
 = 
Size
;

1665 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

1666 
hi2c
->
X„rSize
 = 
Size
;

1669 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1672 
	`__HAL_UNLOCK
(
hi2c
);

1679 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1681  
HAL_OK
;

1685  
HAL_BUSY
;

1687 
	}
}

1699 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Sequítül_Tønsmô_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
X„rO±i⁄s
)

1702 
	`as£π_∑øm
(
	`IS_I2C_TRANSFER_OPTIONS_REQUEST
(
X„rO±i⁄s
));

1704 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_LISTEN
)

1706 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

1708  
HAL_ERROR
;

1712 
	`__HAL_LOCK
(
hi2c
);

1715 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1718 
	`__HAL_I2C_ENABLE
(
hi2c
);

1722 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1724 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX_LISTEN
;

1725 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

1726 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1729 
hi2c
->
pBuffPå
 = 
pD©a
;

1730 
hi2c
->
X„rCou¡
 = 
Size
;

1731 
hi2c
->
X„rO±i⁄s
 = XferOptions;

1732 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1735 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

1738 
	`__HAL_UNLOCK
(
hi2c
);

1745 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1747  
HAL_OK
;

1751  
HAL_BUSY
;

1753 
	}
}

1765 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Sequítül_Re˚ive_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
X„rO±i⁄s
)

1768 
	`as£π_∑øm
(
	`IS_I2C_TRANSFER_OPTIONS_REQUEST
(
X„rO±i⁄s
));

1770 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_LISTEN
)

1772 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

1774  
HAL_ERROR
;

1778 
	`__HAL_LOCK
(
hi2c
);

1781 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1784 
	`__HAL_I2C_ENABLE
(
hi2c
);

1788 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1790 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX_LISTEN
;

1791 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

1792 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1795 
hi2c
->
pBuffPå
 = 
pD©a
;

1796 
hi2c
->
X„rCou¡
 = 
Size
;

1797 
hi2c
->
X„rO±i⁄s
 = XferOptions;

1798 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1801 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

1804 
	`__HAL_UNLOCK
(
hi2c
);

1811 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1813  
HAL_OK
;

1817  
HAL_BUSY
;

1819 
	}
}

1827 
HAL_SètusTy≥Def
 
	$HAL_I2C_E«bÀLi°í_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
)

1829 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1831 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_LISTEN
;

1834 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1837 
	`__HAL_I2C_ENABLE
(
hi2c
);

1841 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1844 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

1846  
HAL_OK
;

1850  
HAL_BUSY
;

1852 
	}
}

1860 
HAL_SètusTy≥Def
 
	$HAL_I2C_DißbÀLi°í_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
)

1863 
uöt32_t
 
tmp
;

1866 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_LISTEN
)

1868 
tmp
 = (
uöt32_t
)(
hi2c
->
Sèã
Ë& 
I2C_STATE_MSK
;

1869 
hi2c
->
PªviousSèã
 = 
tmp
 | (
uöt32_t
)(hi2c->
Mode
);

1870 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

1871 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

1874 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1877 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

1879  
HAL_OK
;

1883  
HAL_BUSY
;

1885 
	}
}

1897 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Tønsmô_DMA
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

1899 
__IO
 
uöt32_t
 
cou¡
 = 0U;

1901 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

1904 
cou¡
 = 
I2C_TIMEOUT_BUSY_FLAG
 * (
Sy°emC‹eClock
 /25U /1000U);

1907 if(
cou¡
-- == 0U)

1909 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

1910 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

1913 
	`__HAL_UNLOCK
(
hi2c
);

1915  
HAL_TIMEOUT
;

1918 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BUSY
Ë!
RESET
);

1921 
	`__HAL_LOCK
(
hi2c
);

1924 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

1927 
	`__HAL_I2C_ENABLE
(
hi2c
);

1931 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

1933 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

1934 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

1935 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

1938 
hi2c
->
pBuffPå
 = 
pD©a
;

1939 
hi2c
->
X„rCou¡
 = 
Size
;

1940 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

1941 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

1942 
hi2c
->
Devaddªss
 = 
DevAddªss
;

1944 if(
hi2c
->
X„rSize
 > 0U)

1947 
hi2c
->
hdm©x
->
X„rC∂tCÆlback
 = 
I2C_DMAX„rC∂t
;

1950 
hi2c
->
hdm©x
->
X„rEº‹CÆlback
 = 
I2C_DMAEº‹
;

1953 
hi2c
->
hdm©x
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

1954 
hi2c
->
hdm©x
->
X„rAb‹tCÆlback
 = 
NULL
;

1957 
	`HAL_DMA_Sèπ_IT
(
hi2c
->
hdm©x
, (
uöt32_t
)hi2c->
pBuffPå
, (uöt32_t)&hi2c->
In°™˚
->
DR
, hi2c->
X„rSize
);

1960 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1963 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1966 
	`__HAL_UNLOCK
(
hi2c
);

1973 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

1976 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_DMAEN
);

1981 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

1984 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

1987 
	`__HAL_UNLOCK
(
hi2c
);

1994 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

1997  
HAL_OK
;

2001  
HAL_BUSY
;

2003 
	}
}

2015 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Re˚ive_DMA
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

2017 
__IO
 
uöt32_t
 
cou¡
 = 0U;

2019 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2022 
cou¡
 = 
I2C_TIMEOUT_BUSY_FLAG
 * (
Sy°emC‹eClock
 /25U /1000U);

2025 if(
cou¡
-- == 0U)

2027 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

2028 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

2031 
	`__HAL_UNLOCK
(
hi2c
);

2033  
HAL_TIMEOUT
;

2036 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BUSY
Ë!
RESET
);

2039 
	`__HAL_LOCK
(
hi2c
);

2042 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2045 
	`__HAL_I2C_ENABLE
(
hi2c
);

2049 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2051 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

2052 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MASTER
;

2053 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2056 
hi2c
->
pBuffPå
 = 
pD©a
;

2057 
hi2c
->
X„rCou¡
 = 
Size
;

2058 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2059 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2060 
hi2c
->
Devaddªss
 = 
DevAddªss
;

2062 if(
hi2c
->
X„rSize
 > 0U)

2065 
hi2c
->
hdm¨x
->
X„rC∂tCÆlback
 = 
I2C_DMAX„rC∂t
;

2068 
hi2c
->
hdm¨x
->
X„rEº‹CÆlback
 = 
I2C_DMAEº‹
;

2071 
hi2c
->
hdm¨x
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

2072 
hi2c
->
hdm¨x
->
X„rAb‹tCÆlback
 = 
NULL
;

2075 
	`HAL_DMA_Sèπ_IT
(
hi2c
->
hdm¨x
, (
uöt32_t
)&hi2c->
In°™˚
->
DR
, (uöt32_t)hi2c->
pBuffPå
, hi2c->
X„rSize
);

2078 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2081 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

2084 
	`__HAL_UNLOCK
(
hi2c
);

2091 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

2094 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_DMAEN
);

2099 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2102 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

2105 
	`__HAL_UNLOCK
(
hi2c
);

2112 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

2115  
HAL_OK
;

2119  
HAL_BUSY
;

2121 
	}
}

2132 
HAL_SètusTy≥Def
 
	$HAL_I2C_Ma°î_Ab‹t_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
)

2135 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MASTER
)

2138 
	`__HAL_LOCK
(
hi2c
);

2140 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

2141 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_ABORT
;

2144 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2147 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

2149 
hi2c
->
X„rCou¡
 = 0U;

2152 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

2155 
	`__HAL_UNLOCK
(
hi2c
);

2158 
	`I2C_ITEº‹
(
hi2c
);

2160  
HAL_OK
;

2166  
HAL_ERROR
;

2168 
	}
}

2178 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Tønsmô_DMA
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

2180 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2182 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

2184  
HAL_ERROR
;

2188 
	`__HAL_LOCK
(
hi2c
);

2191 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2194 
	`__HAL_I2C_ENABLE
(
hi2c
);

2198 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2200 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

2201 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

2202 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2205 
hi2c
->
pBuffPå
 = 
pD©a
;

2206 
hi2c
->
X„rCou¡
 = 
Size
;

2207 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2208 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2211 
hi2c
->
hdm©x
->
X„rC∂tCÆlback
 = 
I2C_DMAX„rC∂t
;

2214 
hi2c
->
hdm©x
->
X„rEº‹CÆlback
 = 
I2C_DMAEº‹
;

2217 
hi2c
->
hdm©x
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

2218 
hi2c
->
hdm©x
->
X„rAb‹tCÆlback
 = 
NULL
;

2221 
	`HAL_DMA_Sèπ_IT
(
hi2c
->
hdm©x
, (
uöt32_t
)hi2c->
pBuffPå
, (uöt32_t)&hi2c->
In°™˚
->
DR
, hi2c->
X„rSize
);

2224 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2227 
	`__HAL_UNLOCK
(
hi2c
);

2233 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

2236 
hi2c
->
In°™˚
->
CR2
 |
I2C_CR2_DMAEN
;

2238  
HAL_OK
;

2242  
HAL_BUSY
;

2244 
	}
}

2254 
HAL_SètusTy≥Def
 
	$HAL_I2C_Sœve_Re˚ive_DMA
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

2256 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2258 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

2260  
HAL_ERROR
;

2264 
	`__HAL_LOCK
(
hi2c
);

2267 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2270 
	`__HAL_I2C_ENABLE
(
hi2c
);

2274 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2276 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

2277 
hi2c
->
Mode
 = 
HAL_I2C_MODE_SLAVE
;

2278 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2281 
hi2c
->
pBuffPå
 = 
pD©a
;

2282 
hi2c
->
X„rCou¡
 = 
Size
;

2283 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2284 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2287 
hi2c
->
hdm¨x
->
X„rC∂tCÆlback
 = 
I2C_DMAX„rC∂t
;

2290 
hi2c
->
hdm¨x
->
X„rEº‹CÆlback
 = 
I2C_DMAEº‹
;

2293 
hi2c
->
hdm¨x
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

2294 
hi2c
->
hdm¨x
->
X„rAb‹tCÆlback
 = 
NULL
;

2297 
	`HAL_DMA_Sèπ_IT
(
hi2c
->
hdm¨x
, (
uöt32_t
)&hi2c->
In°™˚
->
DR
, (uöt32_t)hi2c->
pBuffPå
, hi2c->
X„rSize
);

2300 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2303 
	`__HAL_UNLOCK
(
hi2c
);

2309 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

2312 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_DMAEN
);

2314  
HAL_OK
;

2318  
HAL_BUSY
;

2320 
	}
}

2334 
HAL_SètusTy≥Def
 
	$HAL_I2C_Mem_Wrôe
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
, 
uöt32_t
 
Timeout
)

2336 
uöt32_t
 
tick°¨t
 = 0x00U;

2339 
tick°¨t
 = 
	`HAL_GëTick
();

2342 
	`as£π_∑øm
(
	`IS_I2C_MEMADD_SIZE
(
MemAddSize
));

2344 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2346 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

2348  
HAL_ERROR
;

2352 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2354  
HAL_BUSY
;

2358 
	`__HAL_LOCK
(
hi2c
);

2361 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2364 
	`__HAL_I2C_ENABLE
(
hi2c
);

2368 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2370 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

2371 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MEM
;

2372 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2375 
hi2c
->
pBuffPå
 = 
pD©a
;

2376 
hi2c
->
X„rCou¡
 = 
Size
;

2377 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2378 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2381 if(
	`I2C_Reque°Mem‹yWrôe
(
hi2c
, 
DevAddªss
, 
MemAddªss
, 
MemAddSize
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2383 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

2386 
	`__HAL_UNLOCK
(
hi2c
);

2387  
HAL_ERROR
;

2392 
	`__HAL_UNLOCK
(
hi2c
);

2393  
HAL_TIMEOUT
;

2397 
hi2c
->
X„rSize
 > 0U)

2400 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2402 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

2405 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

2406  
HAL_ERROR
;

2410  
HAL_TIMEOUT
;

2415 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

2416 
hi2c
->
X„rSize
--;

2417 
hi2c
->
X„rCou¡
--;

2419 if((
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
SET
Ë&& (hi2c->
X„rSize
 != 0U))

2422 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

2423 
hi2c
->
X„rSize
--;

2424 
hi2c
->
X„rCou¡
--;

2429 if(
	`I2C_WaôOnBTFFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2431 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

2434 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

2435  
HAL_ERROR
;

2439  
HAL_TIMEOUT
;

2444 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

2446 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

2447 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

2450 
	`__HAL_UNLOCK
(
hi2c
);

2452  
HAL_OK
;

2456  
HAL_BUSY
;

2458 
	}
}

2473 
HAL_SètusTy≥Def
 
	$HAL_I2C_Mem_Ród
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
, 
uöt32_t
 
Timeout
)

2475 
uöt32_t
 
tick°¨t
 = 0x00U;

2478 
tick°¨t
 = 
	`HAL_GëTick
();

2481 
	`as£π_∑øm
(
	`IS_I2C_MEMADD_SIZE
(
MemAddSize
));

2483 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2485 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

2487  
HAL_ERROR
;

2491 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2493  
HAL_BUSY
;

2497 
	`__HAL_LOCK
(
hi2c
);

2500 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2503 
	`__HAL_I2C_ENABLE
(
hi2c
);

2507 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2509 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

2510 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MEM
;

2511 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2514 
hi2c
->
pBuffPå
 = 
pD©a
;

2515 
hi2c
->
X„rCou¡
 = 
Size
;

2516 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2517 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2520 if(
	`I2C_Reque°Mem‹yRód
(
hi2c
, 
DevAddªss
, 
MemAddªss
, 
MemAddSize
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2522 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

2525 
	`__HAL_UNLOCK
(
hi2c
);

2526  
HAL_ERROR
;

2531 
	`__HAL_UNLOCK
(
hi2c
);

2532  
HAL_TIMEOUT
;

2536 if(
hi2c
->
X„rSize
 == 1U)

2539 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2542 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

2545 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

2547 if(
hi2c
->
X„rSize
 == 2U)

2550 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2553 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2556 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

2561 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

2564 
hi2c
->
X„rSize
 > 0U)

2566 if(
hi2c
->
X„rSize
 <= 3U)

2569 if(
hi2c
->
X„rSize
== 1U)

2572 if(
	`I2C_WaôOnRXNEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2574 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_TIMEOUT
)

2576  
HAL_TIMEOUT
;

2580  
HAL_ERROR
;

2585 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2586 
hi2c
->
X„rSize
--;

2587 
hi2c
->
X„rCou¡
--;

2590 if(
Size
 == 2U)

2593 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BTF
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2595  
HAL_TIMEOUT
;

2599 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

2602 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2603 
hi2c
->
X„rSize
--;

2604 
hi2c
->
X„rCou¡
--;

2607 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2608 
hi2c
->
X„rSize
--;

2609 
hi2c
->
X„rCou¡
--;

2615 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BTF
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2617  
HAL_TIMEOUT
;

2621 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2624 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2625 
hi2c
->
X„rSize
--;

2626 
hi2c
->
X„rCou¡
--;

2629 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BTF
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2631  
HAL_TIMEOUT
;

2635 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

2638 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2639 
hi2c
->
X„rSize
--;

2640 
hi2c
->
X„rCou¡
--;

2643 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2644 
hi2c
->
X„rSize
--;

2645 
hi2c
->
X„rCou¡
--;

2651 if(
	`I2C_WaôOnRXNEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

2653 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_TIMEOUT
)

2655  
HAL_TIMEOUT
;

2659  
HAL_ERROR
;

2664 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2665 
hi2c
->
X„rSize
--;

2666 
hi2c
->
X„rCou¡
--;

2668 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
SET
)

2671 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

2672 
hi2c
->
X„rSize
--;

2673 
hi2c
->
X„rCou¡
--;

2678 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

2679 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

2682 
	`__HAL_UNLOCK
(
hi2c
);

2684  
HAL_OK
;

2688  
HAL_BUSY
;

2690 
	}
}

2704 
HAL_SètusTy≥Def
 
	$HAL_I2C_Mem_Wrôe_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

2706 
uöt32_t
 
tick°¨t
 = 0x00U;

2709 
tick°¨t
 = 
	`HAL_GëTick
();

2712 
	`as£π_∑øm
(
	`IS_I2C_MEMADD_SIZE
(
MemAddSize
));

2714 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2716 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

2718  
HAL_ERROR
;

2722 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2724  
HAL_BUSY
;

2728 
	`__HAL_LOCK
(
hi2c
);

2731 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2734 
	`__HAL_I2C_ENABLE
(
hi2c
);

2738 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2740 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

2741 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MEM
;

2742 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2745 
hi2c
->
pBuffPå
 = 
pD©a
;

2746 
hi2c
->
X„rCou¡
 = 
Size
;

2747 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2748 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2751 if(
	`I2C_Reque°Mem‹yWrôe
(
hi2c
, 
DevAddªss
, 
MemAddªss
, 
MemAddSize
, 
I2C_TIMEOUT_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2753 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

2756 
	`__HAL_UNLOCK
(
hi2c
);

2757  
HAL_ERROR
;

2762 
	`__HAL_UNLOCK
(
hi2c
);

2763  
HAL_TIMEOUT
;

2768 
	`__HAL_UNLOCK
(
hi2c
);

2775 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

2777  
HAL_OK
;

2781  
HAL_BUSY
;

2783 
	}
}

2797 
HAL_SètusTy≥Def
 
	$HAL_I2C_Mem_Ród_IT
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

2799 
uöt32_t
 
tick°¨t
 = 0x00U;

2802 
tick°¨t
 = 
	`HAL_GëTick
();

2805 
	`as£π_∑øm
(
	`IS_I2C_MEMADD_SIZE
(
MemAddSize
));

2807 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2809 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

2811  
HAL_ERROR
;

2815 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2817  
HAL_BUSY
;

2821 
	`__HAL_LOCK
(
hi2c
);

2824 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2827 
	`__HAL_I2C_ENABLE
(
hi2c
);

2831 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2833 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

2834 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MEM
;

2835 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2838 
hi2c
->
pBuffPå
 = 
pD©a
;

2839 
hi2c
->
X„rCou¡
 = 
Size
;

2840 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2841 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2844 if(
	`I2C_Reque°Mem‹yRód
(
hi2c
, 
DevAddªss
, 
MemAddªss
, 
MemAddSize
, 
I2C_TIMEOUT_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2846 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

2849 
	`__HAL_UNLOCK
(
hi2c
);

2850  
HAL_ERROR
;

2855 
	`__HAL_UNLOCK
(
hi2c
);

2856  
HAL_TIMEOUT
;

2860 if(
hi2c
->
X„rCou¡
 == 1U)

2863 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2866 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

2869 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

2871 if(
hi2c
->
X„rCou¡
 == 2U)

2874 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2877 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2880 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

2885 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

2888 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

2892 
	`__HAL_UNLOCK
(
hi2c
);

2899 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

2901  
HAL_OK
;

2905  
HAL_BUSY
;

2907 
	}
}

2921 
HAL_SètusTy≥Def
 
	$HAL_I2C_Mem_Wrôe_DMA
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

2923 
uöt32_t
 
tick°¨t
 = 0x00U;

2926 
tick°¨t
 = 
	`HAL_GëTick
();

2929 
	`as£π_∑øm
(
	`IS_I2C_MEMADD_SIZE
(
MemAddSize
));

2931 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

2933 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

2935  
HAL_ERROR
;

2939 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2941  
HAL_BUSY
;

2945 
	`__HAL_LOCK
(
hi2c
);

2948 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

2951 
	`__HAL_I2C_ENABLE
(
hi2c
);

2955 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

2957 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_TX
;

2958 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MEM
;

2959 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

2962 
hi2c
->
pBuffPå
 = 
pD©a
;

2963 
hi2c
->
X„rCou¡
 = 
Size
;

2964 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

2965 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

2968 
hi2c
->
hdm©x
->
X„rC∂tCÆlback
 = 
I2C_DMAX„rC∂t
;

2971 
hi2c
->
hdm©x
->
X„rEº‹CÆlback
 = 
I2C_DMAEº‹
;

2974 
hi2c
->
hdm©x
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

2975 
hi2c
->
hdm©x
->
X„rAb‹tCÆlback
 = 
NULL
;

2978 
	`HAL_DMA_Sèπ_IT
(
hi2c
->
hdm©x
, (
uöt32_t
)hi2c->
pBuffPå
, (uöt32_t)&hi2c->
In°™˚
->
DR
, hi2c->
X„rSize
);

2981 if(
	`I2C_Reque°Mem‹yWrôe
(
hi2c
, 
DevAddªss
, 
MemAddªss
, 
MemAddSize
, 
I2C_TIMEOUT_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

2983 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

2986 
	`__HAL_UNLOCK
(
hi2c
);

2987  
HAL_ERROR
;

2992 
	`__HAL_UNLOCK
(
hi2c
);

2993  
HAL_TIMEOUT
;

2998 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

3001 
	`__HAL_UNLOCK
(
hi2c
);

3007 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_ERR
);

3010 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_DMAEN
);

3012  
HAL_OK
;

3016  
HAL_BUSY
;

3018 
	}
}

3032 
HAL_SètusTy≥Def
 
	$HAL_I2C_Mem_Ród_DMA
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt8_t
 *
pD©a
, uöt16_à
Size
)

3034 
uöt32_t
 
tick°¨t
 = 0x00U;

3037 
tick°¨t
 = 
	`HAL_GëTick
();

3040 
	`as£π_∑øm
(
	`IS_I2C_MEMADD_SIZE
(
MemAddSize
));

3042 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

3044 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0U))

3046  
HAL_ERROR
;

3050 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

3052  
HAL_BUSY
;

3056 
	`__HAL_LOCK
(
hi2c
);

3059 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

3062 
	`__HAL_I2C_ENABLE
(
hi2c
);

3066 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

3068 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY_RX
;

3069 
hi2c
->
Mode
 = 
HAL_I2C_MODE_MEM
;

3070 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

3073 
hi2c
->
pBuffPå
 = 
pD©a
;

3074 
hi2c
->
X„rCou¡
 = 
Size
;

3075 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

3076 
hi2c
->
X„rSize
 = hi2c->
X„rCou¡
;

3079 
hi2c
->
hdm¨x
->
X„rC∂tCÆlback
 = 
I2C_DMAX„rC∂t
;

3082 
hi2c
->
hdm¨x
->
X„rEº‹CÆlback
 = 
I2C_DMAEº‹
;

3085 
hi2c
->
hdm¨x
->
X„rHÆfC∂tCÆlback
 = 
NULL
;

3086 
hi2c
->
hdm¨x
->
X„rAb‹tCÆlback
 = 
NULL
;

3089 
	`HAL_DMA_Sèπ_IT
(
hi2c
->
hdm¨x
, (
uöt32_t
)&hi2c->
In°™˚
->
DR
, (uöt32_t)hi2c->
pBuffPå
, hi2c->
X„rSize
);

3092 if(
	`I2C_Reque°Mem‹yRód
(
hi2c
, 
DevAddªss
, 
MemAddªss
, 
MemAddSize
, 
I2C_TIMEOUT_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

3094 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

3097 
	`__HAL_UNLOCK
(
hi2c
);

3098  
HAL_ERROR
;

3103 
	`__HAL_UNLOCK
(
hi2c
);

3104  
HAL_TIMEOUT
;

3108 if(
Size
 == 1U)

3111 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3116 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_LAST
);

3120 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

3123 
	`__HAL_UNLOCK
(
hi2c
);

3129 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_ERR
);

3132 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_DMAEN
);

3134  
HAL_OK
;

3138  
HAL_BUSY
;

3140 
	}
}

3153 
HAL_SètusTy≥Def
 
	$HAL_I2C_IsDevi˚Ródy
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt32_t
 
Trüls
, uöt32_à
Timeout
)

3155 
uöt32_t
 
tick°¨t
 = 0U, 
I2C_Trüls
 = 1U;

3158 
tick°¨t
 = 
	`HAL_GëTick
();

3160 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_READY
)

3163 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

3165  
HAL_BUSY
;

3169 
	`__HAL_LOCK
(
hi2c
);

3172 if((
hi2c
->
In°™˚
->
CR1
 & 
I2C_CR1_PE
) != I2C_CR1_PE)

3175 
	`__HAL_I2C_ENABLE
(
hi2c
);

3179 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

3181 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_BUSY
;

3182 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

3183 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

3188 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

3191 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_SB
, 
RESET
, 
Timeout
, 
tick°¨t
Ë!
HAL_OK
)

3193  
HAL_TIMEOUT
;

3197 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_WRITE
(
DevAddªss
);

3201 
tick°¨t
 = 
	`HAL_GëTick
();

3203 (
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_ADDR
Ë=
RESET
) && \

3204 (
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_AF
Ë=
RESET
) && \

3205 (
hi2c
->
Sèã
 !
HAL_I2C_STATE_TIMEOUT
))

3207 if(
Timeout
 !
HAL_MAX_DELAY
)

3209 if((
Timeout
 =0U)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

3211 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_TIMEOUT
;

3216 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3219 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_ADDR
Ë=
SET
)

3222 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

3225 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

3228 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

3230  
HAL_TIMEOUT
;

3233 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3236 
	`__HAL_UNLOCK
(
hi2c
);

3238  
HAL_OK
;

3243 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

3246 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

3249 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_BUSY
, 
SET
, 
I2C_TIMEOUT_BUSY_FLAG
, 
tick°¨t
Ë!
HAL_OK
)

3251  
HAL_TIMEOUT
;

3254 }
I2C_Trüls
++ < 
Trüls
);

3256 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3259 
	`__HAL_UNLOCK
(
hi2c
);

3261  
HAL_ERROR
;

3265  
HAL_BUSY
;

3267 
	}
}

3275 
	$HAL_I2C_EV_IRQH™dÀr
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3277 
uöt32_t
 
§2ôÊags
 = 
	`READ_REG
(
hi2c
->
In°™˚
->
SR2
);

3278 
uöt32_t
 
§1ôÊags
 = 
	`READ_REG
(
hi2c
->
In°™˚
->
SR1
);

3279 
uöt32_t
 
ôsour˚s
 = 
	`READ_REG
(
hi2c
->
In°™˚
->
CR2
);

3282 if((
hi2c
->
Mode
 =
HAL_I2C_MODE_MASTER
) || \

3283 (
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
))

3286 if(((
§1ôÊags
 & 
I2C_FLAG_SB
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3288 
	`I2C_Ma°î_SB
(
hi2c
);

3291 if(((
§1ôÊags
 & 
I2C_FLAG_ADD10
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3293 
	`I2C_Ma°î_ADD10
(
hi2c
);

3296 if(((
§1ôÊags
 & 
I2C_FLAG_ADDR
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3298 
	`I2C_Ma°î_ADDR
(
hi2c
);

3302 if((
hi2c
->
EvítCou¡
 =0UË&& ((
§2ôÊags
 & 
I2C_FLAG_TRA
Ë!
RESET
))

3305 if(((
§1ôÊags
 & 
I2C_FLAG_TXE
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_BUF
Ë!RESETË&& ((§1ôÊag†& 
I2C_FLAG_BTF
) == RESET))

3307 
	`I2C_Ma°îTønsmô_TXE
(
hi2c
);

3310 if(((
§1ôÊags
 & 
I2C_FLAG_BTF
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3312 
	`I2C_Ma°îTønsmô_BTF
(
hi2c
);

3319 if(((
§1ôÊags
 & 
I2C_FLAG_RXNE
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_BUF
Ë!RESETË&& ((§1ôÊag†& 
I2C_FLAG_BTF
) == RESET))

3321 
	`I2C_Ma°îRe˚ive_RXNE
(
hi2c
);

3324 if(((
§1ôÊags
 & 
I2C_FLAG_BTF
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3326 
	`I2C_Ma°îRe˚ive_BTF
(
hi2c
);

3334 if(((
§1ôÊags
 & 
I2C_FLAG_ADDR
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3336 
	`I2C_Sœve_ADDR
(
hi2c
);

3339 if(((
§1ôÊags
 & 
I2C_FLAG_STOPF
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3341 
	`I2C_Sœve_STOPF
(
hi2c
);

3344 if((
§2ôÊags
 & 
I2C_FLAG_TRA
Ë!
RESET
)

3347 if(((
§1ôÊags
 & 
I2C_FLAG_TXE
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_BUF
Ë!RESETË&& ((§1ôÊag†& 
I2C_FLAG_BTF
) == RESET))

3349 
	`I2C_SœveTønsmô_TXE
(
hi2c
);

3352 if(((
§1ôÊags
 & 
I2C_FLAG_BTF
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3354 
	`I2C_SœveTønsmô_BTF
(
hi2c
);

3361 if(((
§1ôÊags
 & 
I2C_FLAG_RXNE
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_BUF
Ë!RESETË&& ((§1ôÊag†& 
I2C_FLAG_BTF
) == RESET))

3363 
	`I2C_SœveRe˚ive_RXNE
(
hi2c
);

3366 if(((
§1ôÊags
 & 
I2C_FLAG_BTF
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_EVT
) != RESET))

3368 
	`I2C_SœveRe˚ive_BTF
(
hi2c
);

3372 
	}
}

3380 
	$HAL_I2C_ER_IRQH™dÀr
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3382 
uöt32_t
 
§1ôÊags
 = 
	`READ_REG
(
hi2c
->
In°™˚
->
SR1
);

3383 
uöt32_t
 
ôsour˚s
 = 
	`READ_REG
(
hi2c
->
In°™˚
->
CR2
);

3386 if(((
§1ôÊags
 & 
I2C_FLAG_BERR
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_ERR
) != RESET))

3388 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_BERR
;

3391 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_BERR
);

3395 if(((
§1ôÊags
 & 
I2C_FLAG_ARLO
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_ERR
) != RESET))

3397 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_ARLO
;

3400 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_ARLO
);

3404 if(((
§1ôÊags
 & 
I2C_FLAG_AF
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_ERR
) != RESET))

3406 if((
hi2c
->
Mode
 =
HAL_I2C_MODE_SLAVE
) && \

3407 (
hi2c
->
X„rCou¡
 == 0U) && \

3408 ((
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_TX
Ë|| (hi2c->Sèã =
HAL_I2C_STATE_BUSY_TX_LISTEN
) || \

3409 ((
hi2c
->
Sèã
 =
HAL_I2C_STATE_LISTEN
Ë&& (hi2c->
PªviousSèã
 =
HAL_I2C_STATE_BUSY_TX
))))

3411 
	`I2C_Sœve_AF
(
hi2c
);

3415 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_AF
;

3418 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MASTER
)

3421 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

3425 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

3430 if(((
§1ôÊags
 & 
I2C_FLAG_OVR
Ë!
RESET
Ë&& ((
ôsour˚s
 & 
I2C_IT_ERR
) != RESET))

3432 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_OVR
;

3434 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_OVR
);

3438 if(
hi2c
->
Eº‹Code
 !
HAL_I2C_ERROR_NONE
)

3440 
	`I2C_ITEº‹
(
hi2c
);

3442 
	}
}

3450 
__wók
 
	$HAL_I2C_Ma°îTxC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3453 
	`UNUSED
(
hi2c
);

3458 
	}
}

3466 
__wók
 
	$HAL_I2C_Ma°îRxC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3469 
	`UNUSED
(
hi2c
);

3474 
	}
}

3481 
__wók
 
	$HAL_I2C_SœveTxC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3484 
	`UNUSED
(
hi2c
);

3489 
	}
}

3497 
__wók
 
	$HAL_I2C_SœveRxC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3500 
	`UNUSED
(
hi2c
);

3505 
	}
}

3515 
__wók
 
	$HAL_I2C_AddrCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt8_t
 
Tøns„rDúe˘i⁄
, 
uöt16_t
 
AddrM©chCode
)

3518 
	`UNUSED
(
hi2c
);

3519 
	`UNUSED
(
Tøns„rDúe˘i⁄
);

3520 
	`UNUSED
(
AddrM©chCode
);

3525 
	}
}

3533 
__wók
 
	$HAL_I2C_Li°íC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3536 
	`UNUSED
(
hi2c
);

3541 
	}
}

3549 
__wók
 
	$HAL_I2C_MemTxC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3552 
	`UNUSED
(
hi2c
);

3557 
	}
}

3565 
__wók
 
	$HAL_I2C_MemRxC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3568 
	`UNUSED
(
hi2c
);

3573 
	}
}

3581 
__wók
 
	$HAL_I2C_Eº‹CÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3584 
	`UNUSED
(
hi2c
);

3589 
	}
}

3597 
__wók
 
	$HAL_I2C_Ab‹tC∂tCÆlback
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3600 
	`UNUSED
(
hi2c
);

3605 
	}
}

3632 
HAL_I2C_SèãTy≥Def
 
	$HAL_I2C_GëSèã
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3635  
hi2c
->
Sèã
;

3636 
	}
}

3644 
HAL_I2C_ModeTy≥Def
 
	$HAL_I2C_GëMode
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3646  
hi2c
->
Mode
;

3647 
	}
}

3655 
uöt32_t
 
	$HAL_I2C_GëEº‹
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3657  
hi2c
->
Eº‹Code
;

3658 
	}
}

3680 
HAL_SètusTy≥Def
 
	$I2C_Ma°îTønsmô_TXE
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3682 if((
hi2c
->
X„rSize
 =0UË&& (hi2c->
Sèã
 =
HAL_I2C_STATE_BUSY_TX
))

3685 if((
hi2c
->
X„rO±i⁄s
 !
I2C_FIRST_AND_LAST_FRAME
Ë&& (hi2c->X„rO±i⁄†!
I2C_LAST_FRAME
Ë&& (hi2c->X„rO±i⁄†!
I2C_NO_OPTION_FRAME
))

3687 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

3689 
hi2c
->
PªviousSèã
 = 
I2C_STATE_MASTER_BUSY_TX
;

3690 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3691 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3693 
	`HAL_I2C_Ma°îTxC∂tCÆlback
(
hi2c
);

3698 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

3701 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

3703 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

3704 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3706 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
)

3708 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3709 
	`HAL_I2C_MemTxC∂tCÆlback
(
hi2c
);

3713 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3714 
	`HAL_I2C_Ma°îTxC∂tCÆlback
(
hi2c
);

3718 if((
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_TX
) || \

3719 ((
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
Ë&& (hi2c->
Sèã
 =
HAL_I2C_STATE_BUSY_RX
)))

3721 if(
hi2c
->
X„rCou¡
 == 0U)

3724 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_BUF
);

3729 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

3730 
hi2c
->
X„rCou¡
--;

3733  
HAL_OK
;

3734 
	}
}

3742 
HAL_SètusTy≥Def
 
	$I2C_Ma°îTønsmô_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3744 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_TX
)

3746 if(
hi2c
->
X„rCou¡
 != 0U)

3749 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

3750 
hi2c
->
X„rCou¡
--;

3755 if((
hi2c
->
X„rO±i⁄s
 !
I2C_FIRST_AND_LAST_FRAME
Ë&& (hi2c->X„rO±i⁄†!
I2C_LAST_FRAME
Ë&& (hi2c->X„rO±i⁄†!
I2C_NO_OPTION_FRAME
))

3757 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

3759 
hi2c
->
PªviousSèã
 = 
I2C_STATE_MASTER_BUSY_TX
;

3760 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3761 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3763 
	`HAL_I2C_Ma°îTxC∂tCÆlback
(
hi2c
);

3768 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

3771 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

3773 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

3774 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3776 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
)

3778 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3780 
	`HAL_I2C_MemTxC∂tCÆlback
(
hi2c
);

3784 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3786 
	`HAL_I2C_Ma°îTxC∂tCÆlback
(
hi2c
);

3791  
HAL_OK
;

3792 
	}
}

3800 
HAL_SètusTy≥Def
 
	$I2C_Ma°îRe˚ive_RXNE
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3802 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_RX
)

3804 if(
hi2c
->
X„rCou¡
 > 3U)

3807 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

3808 
hi2c
->
X„rCou¡
--;

3810 if((
hi2c
->
X„rCou¡
 == 2U) || (hi2c->XferCount == 3U))

3812 if(
hi2c
->
X„rO±i⁄s
 !
I2C_NEXT_FRAME
)

3815 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3818 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

3823 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3827 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_BUF
);

3831 if(
hi2c
->
X„rO±i⁄s
 !
I2C_NEXT_FRAME
)

3834 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3839 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3843 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

3846 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

3847 
hi2c
->
X„rCou¡
--;

3849 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3851 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
)

3853 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

3854 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3855 
	`HAL_I2C_MemRxC∂tCÆlback
(
hi2c
);

3859 
hi2c
->
PªviousSèã
 = 
I2C_STATE_MASTER_BUSY_RX
;

3860 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3861 
	`HAL_I2C_Ma°îRxC∂tCÆlback
(
hi2c
);

3865  
HAL_OK
;

3866 
	}
}

3874 
HAL_SètusTy≥Def
 
	$I2C_Ma°îRe˚ive_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3876 if(
hi2c
->
X„rCou¡
 == 3U)

3878 if((
hi2c
->
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (hi2c->X„rO±i⁄†=
I2C_LAST_FRAME
Ë|| (hi2c->X„rO±i⁄†=
I2C_NO_OPTION_FRAME
))

3881 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3885 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

3886 
hi2c
->
X„rCou¡
--;

3888 if(
hi2c
->
X„rCou¡
 == 2U)

3891 if((
hi2c
->
X„rO±i⁄s
 !
I2C_FIRST_AND_LAST_FRAME
Ë&& (hi2c->X„rO±i⁄†!
I2C_LAST_FRAME
Ë&& (hi2c->X„rO±i⁄†!
I2C_NO_OPTION_FRAME
))

3893 if(
hi2c
->
X„rO±i⁄s
 !
I2C_NEXT_FRAME
)

3896 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3901 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

3907 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

3911 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

3912 
hi2c
->
X„rCou¡
--;

3915 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

3916 
hi2c
->
X„rCou¡
--;

3919 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

3921 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

3923 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
)

3925 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

3926 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3927 
	`HAL_I2C_MemRxC∂tCÆlback
(
hi2c
);

3931 
hi2c
->
PªviousSèã
 = 
I2C_STATE_MASTER_BUSY_RX
;

3932 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

3933 
	`HAL_I2C_Ma°îRxC∂tCÆlback
(
hi2c
);

3939 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

3940 
hi2c
->
X„rCou¡
--;

3942  
HAL_OK
;

3943 
	}
}

3951 
HAL_SètusTy≥Def
 
	$I2C_Ma°î_SB
(
I2C_H™dÀTy≥Def
 *
hi2c
)

3953 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
)

3955 if(
hi2c
->
EvítCou¡
 == 0U)

3958 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_WRITE
(hi2c->
Devaddªss
);

3962 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_READ
(hi2c->
Devaddªss
);

3967 if(
hi2c
->
Inô
.
AddªssögMode
 =
I2C_ADDRESSINGMODE_7BIT
)

3970 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_TX
)

3972 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_WRITE
(hi2c->
Devaddªss
);

3976 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_READ
(hi2c->
Devaddªss
);

3981 if(
hi2c
->
EvítCou¡
 == 0U)

3984 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_HEADER_WRITE
(hi2c->
Devaddªss
);

3986 if(
hi2c
->
EvítCou¡
 == 1U)

3989 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_HEADER_READ
(hi2c->
Devaddªss
);

3994  
HAL_OK
;

3995 
	}
}

4003 
HAL_SètusTy≥Def
 
	$I2C_Ma°î_ADD10
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4006 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_ADDRESS
(hi2c->
Devaddªss
);

4008  
HAL_OK
;

4009 
	}
}

4017 
HAL_SètusTy≥Def
 
	$I2C_Ma°î_ADDR
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4019 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_RX
)

4021 if((
hi2c
->
EvítCou¡
 =0UË&& (hi2c->
Mode
 =
HAL_I2C_MODE_MEM
))

4024 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4026 if((
hi2c
->
EvítCou¡
 =0UË&& (hi2c->
Inô
.
AddªssögMode
 =
I2C_ADDRESSINGMODE_10BIT
))

4029 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4032 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4034 
hi2c
->
EvítCou¡
++;

4038 if(
hi2c
->
X„rCou¡
 == 0U)

4041 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4044 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

4046 if(
hi2c
->
X„rCou¡
 == 1U)

4048 if(
hi2c
->
X„rO±i⁄s
 =
I2C_NO_OPTION_FRAME
)

4051 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4053 if((
hi2c
->
In°™˚
->
CR2
 & 
I2C_CR2_DMAEN
) == I2C_CR2_DMAEN)

4056 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4059 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4064 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4067 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

4071 if((
hi2c
->
X„rO±i⁄s
 !
I2C_FIRST_AND_LAST_FRAME
Ë&& (hi2c->X„rO±i⁄†!
I2C_LAST_FRAME
) \

4072 && (
hi2c
->
PªviousSèã
 !
I2C_STATE_MASTER_BUSY_RX
))

4074 if(
hi2c
->
X„rO±i⁄s
 !
I2C_NEXT_FRAME
)

4077 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4082 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4086 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4091 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4094 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4097 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

4100 if(
hi2c
->
X„rCou¡
 == 2U)

4102 if(
hi2c
->
X„rO±i⁄s
 !
I2C_NEXT_FRAME
)

4105 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4108 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_POS
);

4113 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4116 if((
hi2c
->
In°™˚
->
CR2
 & 
I2C_CR2_DMAEN
) == I2C_CR2_DMAEN)

4119 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_LAST
);

4123 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4128 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4130 if((
hi2c
->
In°™˚
->
CR2
 & 
I2C_CR2_DMAEN
) == I2C_CR2_DMAEN)

4133 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_LAST
);

4137 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4141 
hi2c
->
EvítCou¡
 = 0U;

4147 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4150  
HAL_OK
;

4151 
	}
}

4159 
HAL_SètusTy≥Def
 
	$I2C_SœveTønsmô_TXE
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4161 if(
hi2c
->
X„rCou¡
 != 0U)

4164 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

4165 
hi2c
->
X„rCou¡
--;

4167 if((
hi2c
->
X„rCou¡
 =0UË&& (hi2c->
Sèã
 =
HAL_I2C_STATE_BUSY_TX_LISTEN
))

4170 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_BUF
);

4173 
hi2c
->
PªviousSèã
 = 
I2C_STATE_SLAVE_BUSY_TX
;

4174 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_LISTEN
;

4177 
	`HAL_I2C_SœveTxC∂tCÆlback
(
hi2c
);

4180  
HAL_OK
;

4181 
	}
}

4189 
HAL_SètusTy≥Def
 
	$I2C_SœveTønsmô_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4191 if(
hi2c
->
X„rCou¡
 != 0U)

4194 
hi2c
->
In°™˚
->
DR
 = (*hi2c->
pBuffPå
++);

4195 
hi2c
->
X„rCou¡
--;

4197  
HAL_OK
;

4198 
	}
}

4206 
HAL_SètusTy≥Def
 
	$I2C_SœveRe˚ive_RXNE
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4208 if(
hi2c
->
X„rCou¡
 != 0U)

4211 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

4212 
hi2c
->
X„rCou¡
--;

4214 if((
hi2c
->
X„rCou¡
 =0UË&& (hi2c->
Sèã
 =
HAL_I2C_STATE_BUSY_RX_LISTEN
))

4217 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_BUF
);

4220 
hi2c
->
PªviousSèã
 = 
I2C_STATE_SLAVE_BUSY_RX
;

4221 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_LISTEN
;

4224 
	`HAL_I2C_SœveRxC∂tCÆlback
(
hi2c
);

4227  
HAL_OK
;

4228 
	}
}

4236 
HAL_SètusTy≥Def
 
	$I2C_SœveRe˚ive_BTF
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4238 if(
hi2c
->
X„rCou¡
 != 0U)

4241 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

4242 
hi2c
->
X„rCou¡
--;

4244  
HAL_OK
;

4245 
	}
}

4253 
HAL_SètusTy≥Def
 
	$I2C_Sœve_ADDR
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4255 
uöt8_t
 
Tøns„rDúe˘i⁄
 = 
I2C_DIRECTION_RECEIVE
;

4256 
uöt16_t
 
SœveAddrCode
 = 0U;

4259 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_TRA
Ë=
RESET
)

4261 
Tøns„rDúe˘i⁄
 = 
I2C_DIRECTION_TRANSMIT
;

4264 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_DUALF
Ë=
RESET
)

4266 
SœveAddrCode
 = 
hi2c
->
Inô
.
OwnAddªss1
;

4270 
SœveAddrCode
 = 
hi2c
->
Inô
.
OwnAddªss2
;

4274 
	`HAL_I2C_AddrCÆlback
(
hi2c
, 
Tøns„rDúe˘i⁄
, 
SœveAddrCode
);

4276  
HAL_OK
;

4277 
	}
}

4285 
HAL_SètusTy≥Def
 
	$I2C_Sœve_STOPF
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4288 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

4291 
	`__HAL_I2C_CLEAR_STOPFLAG
(
hi2c
);

4294 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4297 if((
hi2c
->
In°™˚
->
CR2
 & 
I2C_CR2_DMAEN
) == I2C_CR2_DMAEN)

4299 if((
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_RX
Ë|| (hi2c->Sèã =
HAL_I2C_STATE_BUSY_RX_LISTEN
))

4301 
hi2c
->
X„rCou¡
 = 
	`__HAL_DMA_GET_COUNTER
(hi2c->
hdm¨x
);

4305 
hi2c
->
X„rCou¡
 = 
	`__HAL_DMA_GET_COUNTER
(hi2c->
hdm©x
);

4310 if(
hi2c
->
X„rCou¡
 != 0U)

4313 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
SET
)

4316 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

4317 
hi2c
->
X„rCou¡
--;

4321 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_RXNE
Ë=
SET
)

4324 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

4325 
hi2c
->
X„rCou¡
--;

4329 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_AF
;

4332 if(
hi2c
->
Eº‹Code
 !
HAL_I2C_ERROR_NONE
)

4335 
	`I2C_ITEº‹
(
hi2c
);

4339 if((
hi2c
->
Sèã
 =
HAL_I2C_STATE_LISTEN
 ) || (hi2c->Sèã =
HAL_I2C_STATE_BUSY_RX_LISTEN
) || \

4340 (
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_TX_LISTEN
))

4342 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

4343 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

4344 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4345 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4348 
	`HAL_I2C_Li°íC∂tCÆlback
(
hi2c
);

4352 if((
hi2c
->
PªviousSèã
 =
I2C_STATE_SLAVE_BUSY_RX
Ë|| (hi2c->
Sèã
 =
HAL_I2C_STATE_BUSY_RX
))

4354 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

4355 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4356 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4358 
	`HAL_I2C_SœveRxC∂tCÆlback
(
hi2c
);

4362  
HAL_OK
;

4363 
	}
}

4370 
HAL_SètusTy≥Def
 
	$I2C_Sœve_AF
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4372 if(((
hi2c
->
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (hi2c->X„rO±i⁄†=
I2C_LAST_FRAME
)) && \

4373 (
hi2c
->
Sèã
 =
HAL_I2C_STATE_LISTEN
))

4375 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

4378 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

4381 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

4384 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4386 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

4387 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4388 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4391 
	`HAL_I2C_Li°íC∂tCÆlback
(
hi2c
);

4393 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_TX
)

4395 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

4396 
hi2c
->
PªviousSèã
 = 
I2C_STATE_SLAVE_BUSY_TX
;

4397 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4398 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4401 
	`__HAL_I2C_DISABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_BUF
 | 
I2C_IT_ERR
);

4404 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

4407 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4409 
	`HAL_I2C_SœveTxC∂tCÆlback
(
hi2c
);

4415 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

4418  
HAL_OK
;

4419 
	}
}

4426 
	$I2C_ITEº‹
(
I2C_H™dÀTy≥Def
 *
hi2c
)

4429 
uöt32_t
 
CuºítSèã
 = 
hi2c
->
Sèã
;

4431 if((
CuºítSèã
 =
HAL_I2C_STATE_BUSY_TX_LISTEN
Ë|| (CuºítSèã =
HAL_I2C_STATE_BUSY_RX_LISTEN
))

4434 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

4435 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_LISTEN
;

4441 if((
hi2c
->
Sèã
 !
HAL_I2C_STATE_ABORT
Ë&& ((hi2c->
In°™˚
->
CR2
 & 
I2C_CR2_DMAEN
) != I2C_CR2_DMAEN))

4443 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4445 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

4446 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4450 
hi2c
->
In°™˚
->
CR1
 &~
I2C_CR1_POS
;

4453 if((
hi2c
->
In°™˚
->
CR2
 & 
I2C_CR2_DMAEN
) == I2C_CR2_DMAEN)

4455 
hi2c
->
In°™˚
->
CR2
 &~
I2C_CR2_DMAEN
;

4457 if(
hi2c
->
hdm©x
->
Sèã
 !
HAL_DMA_STATE_READY
)

4461 
hi2c
->
hdm©x
->
X„rAb‹tCÆlback
 = 
I2C_DMAAb‹t
;

4463 if(
	`HAL_DMA_Ab‹t_IT
(
hi2c
->
hdm©x
Ë!
HAL_OK
)

4466 
	`__HAL_I2C_DISABLE
(
hi2c
);

4468 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4471 
hi2c
->
hdm©x
->
	`X„rAb‹tCÆlback
(hi2c->hdmatx);

4478 
hi2c
->
hdm¨x
->
X„rAb‹tCÆlback
 = 
I2C_DMAAb‹t
;

4480 if(
	`HAL_DMA_Ab‹t_IT
(
hi2c
->
hdm¨x
Ë!
HAL_OK
)

4483 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_RXNE
Ë=
SET
)

4486 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

4490 
	`__HAL_I2C_DISABLE
(
hi2c
);

4492 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4495 
hi2c
->
hdm¨x
->
	`X„rAb‹tCÆlback
(hi2c->hdmarx);

4499 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_ABORT
)

4501 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4502 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

4505 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_RXNE
Ë=
SET
)

4508 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

4512 
	`__HAL_I2C_DISABLE
(
hi2c
);

4515 
	`HAL_I2C_Ab‹tC∂tCÆlback
(
hi2c
);

4520 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_RXNE
Ë=
SET
)

4523 (*
hi2c
->
pBuffPå
++Ëhi2c->
In°™˚
->
DR
;

4527 
	`HAL_I2C_Eº‹CÆlback
(
hi2c
);

4532 if((
hi2c
->
Sèã
 =
HAL_I2C_STATE_LISTEN
Ë&& ((hi2c->
Eº‹Code
 & 
HAL_I2C_ERROR_AF
) == HAL_I2C_ERROR_AF))

4534 
hi2c
->
X„rO±i⁄s
 = 
I2C_NO_OPTION_FRAME
;

4535 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

4536 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4537 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4540 
	`HAL_I2C_Li°íC∂tCÆlback
(
hi2c
);

4542 
	}
}

4553 
HAL_SètusTy≥Def
 
	$I2C_Ma°îReque°Wrôe
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

4556 if((
hi2c
->
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (hi2c->X„rO±i⁄†=
I2C_FIRST_FRAME
Ë|| (hi2c->X„rO±i⁄†=
I2C_NO_OPTION_FRAME
))

4559 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4561 if(
hi2c
->
PªviousSèã
 =
I2C_STATE_MASTER_BUSY_RX
)

4564 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4568 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_SB
, 
RESET
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4570  
HAL_TIMEOUT
;

4573 if(
hi2c
->
Inô
.
AddªssögMode
 =
I2C_ADDRESSINGMODE_7BIT
)

4576 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_WRITE
(
DevAddªss
);

4581 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_HEADER_WRITE
(
DevAddªss
);

4584 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADD10
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4586 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4588  
HAL_ERROR
;

4592  
HAL_TIMEOUT
;

4597 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_ADDRESS
(
DevAddªss
);

4601 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4603 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4605  
HAL_ERROR
;

4609  
HAL_TIMEOUT
;

4613  
HAL_OK
;

4614 
	}
}

4626 
HAL_SètusTy≥Def
 
	$I2C_Ma°îReque°Ród
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

4629 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4632 if((
hi2c
->
X„rO±i⁄s
 =
I2C_FIRST_AND_LAST_FRAME
Ë|| (hi2c->X„rO±i⁄†=
I2C_FIRST_FRAME
Ë|| (hi2c->X„rO±i⁄†=
I2C_NO_OPTION_FRAME
))

4635 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4637 if(
hi2c
->
PªviousSèã
 =
I2C_STATE_MASTER_BUSY_TX
)

4640 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4644 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_SB
, 
RESET
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4646  
HAL_TIMEOUT
;

4649 if(
hi2c
->
Inô
.
AddªssögMode
 =
I2C_ADDRESSINGMODE_7BIT
)

4652 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_READ
(
DevAddªss
);

4657 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_HEADER_WRITE
(
DevAddªss
);

4660 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADD10
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4662 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4664  
HAL_ERROR
;

4668  
HAL_TIMEOUT
;

4673 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_ADDRESS
(
DevAddªss
);

4676 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4678 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4680  
HAL_ERROR
;

4684  
HAL_TIMEOUT
;

4689 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4692 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4695 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_SB
, 
RESET
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4697  
HAL_TIMEOUT
;

4701 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_10BIT_HEADER_READ
(
DevAddªss
);

4705 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4707 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4709  
HAL_ERROR
;

4713  
HAL_TIMEOUT
;

4717  
HAL_OK
;

4718 
	}
}

4732 
HAL_SètusTy≥Def
 
	$I2C_Reque°Mem‹yWrôe
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

4735 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4738 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_SB
, 
RESET
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4740  
HAL_TIMEOUT
;

4744 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_WRITE
(
DevAddªss
);

4747 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4749 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4751  
HAL_ERROR
;

4755  
HAL_TIMEOUT
;

4760 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4763 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4765 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4768 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

4769  
HAL_ERROR
;

4773  
HAL_TIMEOUT
;

4778 if(
MemAddSize
 =
I2C_MEMADD_SIZE_8BIT
)

4781 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_MEM_ADD_LSB
(
MemAddªss
);

4787 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_MEM_ADD_MSB
(
MemAddªss
);

4790 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4792 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4795 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

4796  
HAL_ERROR
;

4800  
HAL_TIMEOUT
;

4805 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_MEM_ADD_LSB
(
MemAddªss
);

4808  
HAL_OK
;

4809 
	}
}

4823 
HAL_SètusTy≥Def
 
	$I2C_Reque°Mem‹yRód
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt16_t
 
DevAddªss
, uöt16_à
MemAddªss
, uöt16_à
MemAddSize
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

4826 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4829 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4832 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_SB
, 
RESET
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4834  
HAL_TIMEOUT
;

4838 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_WRITE
(
DevAddªss
);

4841 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4843 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4845  
HAL_ERROR
;

4849  
HAL_TIMEOUT
;

4854 
	`__HAL_I2C_CLEAR_ADDRFLAG
(
hi2c
);

4857 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4859 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4862 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

4863  
HAL_ERROR
;

4867  
HAL_TIMEOUT
;

4872 if(
MemAddSize
 =
I2C_MEMADD_SIZE_8BIT
)

4875 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_MEM_ADD_LSB
(
MemAddªss
);

4881 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_MEM_ADD_MSB
(
MemAddªss
);

4884 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4886 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4889 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

4890  
HAL_ERROR
;

4894  
HAL_TIMEOUT
;

4899 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_MEM_ADD_LSB
(
MemAddªss
);

4903 if(
	`I2C_WaôOnTXEFœgU¡ûTimeout
(
hi2c
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4905 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4908 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

4909  
HAL_ERROR
;

4913  
HAL_TIMEOUT
;

4918 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_START
);

4921 if(
	`I2C_WaôOnFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_SB
, 
RESET
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4923  
HAL_TIMEOUT
;

4927 
hi2c
->
In°™˚
->
DR
 = 
	`I2C_7BIT_ADD_READ
(
DevAddªss
);

4930 if(
	`I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
hi2c
, 
I2C_FLAG_ADDR
, 
Timeout
, 
Tick°¨t
Ë!
HAL_OK
)

4932 if(
hi2c
->
Eº‹Code
 =
HAL_I2C_ERROR_AF
)

4934  
HAL_ERROR
;

4938  
HAL_TIMEOUT
;

4942  
HAL_OK
;

4943 
	}
}

4950 
	$I2C_DMAX„rC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
)

4952 
I2C_H™dÀTy≥Def
* 
hi2c
 = (I2C_H™dÀTy≥Def*)((
DMA_H™dÀTy≥Def
*)
hdma
)->
P¨ít
;

4954 if((
hi2c
->
Sèã
 =
HAL_I2C_STATE_BUSY_TX
Ë|| ((hi2c->Sèã =
HAL_I2C_STATE_BUSY_RX
Ë&& (hi2c->
Mode
 =
HAL_I2C_MODE_SLAVE
)))

4957 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_DMAEN
);

4959 
hi2c
->
X„rCou¡
 = 0U;

4962 
	`__HAL_I2C_ENABLE_IT
(
hi2c
, 
I2C_IT_EVT
 | 
I2C_IT_ERR
);

4967 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

4970 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
,
I2C_CR1_STOP
);

4973 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_LAST
);

4976 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR2
, 
I2C_CR2_DMAEN
);

4978 
hi2c
->
X„rCou¡
 = 0U;

4981 if(
hi2c
->
Eº‹Code
 !
HAL_I2C_ERROR_NONE
)

4983 
	`HAL_I2C_Eº‹CÆlback
(
hi2c
);

4987 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

4989 if(
hi2c
->
Mode
 =
HAL_I2C_MODE_MEM
)

4991 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4993 
	`HAL_I2C_MemRxC∂tCÆlback
(
hi2c
);

4997 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

4999 
	`HAL_I2C_Ma°îRxC∂tCÆlback
(
hi2c
);

5003 
	}
}

5010 
	$I2C_DMAEº‹
(
DMA_H™dÀTy≥Def
 *
hdma
)

5012 
I2C_H™dÀTy≥Def
* 
hi2c
 = (I2C_H™dÀTy≥Def*)((
DMA_H™dÀTy≥Def
*)
hdma
)->
P¨ít
;

5015 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

5017 
hi2c
->
X„rCou¡
 = 0U;

5019 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

5020 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

5022 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_DMA
;

5024 
	`HAL_I2C_Eº‹CÆlback
(
hi2c
);

5025 
	}
}

5033 
	$I2C_DMAAb‹t
(
DMA_H™dÀTy≥Def
 *
hdma
)

5035 
I2C_H™dÀTy≥Def
* 
hi2c
 = ( I2C_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

5038 
	`CLEAR_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_ACK
);

5040 
hi2c
->
X„rCou¡
 = 0U;

5043 
hi2c
->
hdm©x
->
X„rAb‹tCÆlback
 = 
NULL
;

5044 
hi2c
->
hdm¨x
->
X„rAb‹tCÆlback
 = 
NULL
;

5047 if(
hi2c
->
Sèã
 =
HAL_I2C_STATE_ABORT
)

5049 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

5050 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

5051 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

5054 
	`__HAL_I2C_DISABLE
(
hi2c
);

5057 
	`HAL_I2C_Ab‹tC∂tCÆlback
(
hi2c
);

5061 
hi2c
->
Sèã
 = 
HAL_I2C_STATE_READY
;

5062 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

5065 
	`__HAL_I2C_DISABLE
(
hi2c
);

5068 
	`HAL_I2C_Eº‹CÆlback
(
hi2c
);

5070 
	}
}

5082 
HAL_SètusTy≥Def
 
	$I2C_WaôOnFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Fœg
, 
FœgSètus
 
Sètus
, uöt32_à
Timeout
, uöt32_à
Tick°¨t
)

5084 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
Fœg
Ë=
Sètus
)

5087 if(
Timeout
 !
HAL_MAX_DELAY
)

5089 if((
Timeout
 =0U)||((
	`HAL_GëTick
(Ë- 
Tick°¨t
 ) > Timeout))

5091 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5092 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5093 
hi2c
->
Mode
 = 
HAL_I2C_MODE_NONE
;

5096 
	`__HAL_UNLOCK
(
hi2c
);

5097  
HAL_TIMEOUT
;

5101  
HAL_OK
;

5102 
	}
}

5113 
HAL_SètusTy≥Def
 
	$I2C_WaôOnMa°îAddªssFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Fœg
, uöt32_à
Timeout
, uöt32_à
Tick°¨t
)

5115 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
Fœg
Ë=
RESET
)

5117 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_AF
Ë=
SET
)

5120 
	`SET_BIT
(
hi2c
->
In°™˚
->
CR1
, 
I2C_CR1_STOP
);

5123 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

5125 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_AF
;

5126 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5127 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5130 
	`__HAL_UNLOCK
(
hi2c
);

5132  
HAL_ERROR
;

5136 if(
Timeout
 !
HAL_MAX_DELAY
)

5138 if((
Timeout
 =0U)||((
	`HAL_GëTick
(Ë- 
Tick°¨t
 ) > Timeout))

5140 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5141 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5144 
	`__HAL_UNLOCK
(
hi2c
);

5146  
HAL_TIMEOUT
;

5150  
HAL_OK
;

5151 
	}
}

5161 
HAL_SètusTy≥Def
 
	$I2C_WaôOnTXEFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

5163 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_TXE
Ë=
RESET
)

5166 if(
	`I2C_IsAcknowÀdgeFaûed
(
hi2c
Ë!
HAL_OK
)

5168  
HAL_ERROR
;

5172 if(
Timeout
 !
HAL_MAX_DELAY
)

5174 if((
Timeout
 =0UË|| ((
	`HAL_GëTick
()-
Tick°¨t
) > Timeout))

5176 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_TIMEOUT
;

5177 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5178 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5181 
	`__HAL_UNLOCK
(
hi2c
);

5183  
HAL_TIMEOUT
;

5187  
HAL_OK
;

5188 
	}
}

5198 
HAL_SètusTy≥Def
 
	$I2C_WaôOnBTFFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

5200 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_BTF
Ë=
RESET
)

5203 if(
	`I2C_IsAcknowÀdgeFaûed
(
hi2c
Ë!
HAL_OK
)

5205  
HAL_ERROR
;

5209 if(
Timeout
 !
HAL_MAX_DELAY
)

5211 if((
Timeout
 =0UË|| ((
	`HAL_GëTick
()-
Tick°¨t
) > Timeout))

5213 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_TIMEOUT
;

5214 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5215 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5218 
	`__HAL_UNLOCK
(
hi2c
);

5220  
HAL_TIMEOUT
;

5224  
HAL_OK
;

5225 
	}
}

5235 
HAL_SètusTy≥Def
 
	$I2C_WaôOnSTOPFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

5237 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_STOPF
Ë=
RESET
)

5240 if(
	`I2C_IsAcknowÀdgeFaûed
(
hi2c
Ë!
HAL_OK
)

5242  
HAL_ERROR
;

5246 if((
Timeout
 =0UË|| ((
	`HAL_GëTick
()-
Tick°¨t
) > Timeout))

5248 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_TIMEOUT
;

5249 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5250 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5253 
	`__HAL_UNLOCK
(
hi2c
);

5255  
HAL_TIMEOUT
;

5258  
HAL_OK
;

5259 
	}
}

5269 
HAL_SètusTy≥Def
 
	$I2C_WaôOnRXNEFœgU¡ûTimeout
(
I2C_H™dÀTy≥Def
 *
hi2c
, 
uöt32_t
 
Timeout
, uöt32_à
Tick°¨t
)

5272 
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_RXNE
Ë=
RESET
)

5275 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_STOPF
Ë=
SET
)

5278 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_STOPF
);

5280 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_NONE
;

5281 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5282 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5285 
	`__HAL_UNLOCK
(
hi2c
);

5287  
HAL_ERROR
;

5291 if((
Timeout
 =0UË|| ((
	`HAL_GëTick
()-
Tick°¨t
) > Timeout))

5293 
hi2c
->
Eº‹Code
 |
HAL_I2C_ERROR_TIMEOUT
;

5294 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5297 
	`__HAL_UNLOCK
(
hi2c
);

5299  
HAL_TIMEOUT
;

5302  
HAL_OK
;

5303 
	}
}

5311 
HAL_SètusTy≥Def
 
	$I2C_IsAcknowÀdgeFaûed
(
I2C_H™dÀTy≥Def
 *
hi2c
)

5313 if(
	`__HAL_I2C_GET_FLAG
(
hi2c
, 
I2C_FLAG_AF
Ë=
SET
)

5316 
	`__HAL_I2C_CLEAR_FLAG
(
hi2c
, 
I2C_FLAG_AF
);

5318 
hi2c
->
Eº‹Code
 = 
HAL_I2C_ERROR_AF
;

5319 
hi2c
->
PªviousSèã
 = 
I2C_STATE_NONE
;

5320 
hi2c
->
Sèã

HAL_I2C_STATE_READY
;

5323 
	`__HAL_UNLOCK
(
hi2c
);

5325  
HAL_ERROR
;

5327  
HAL_OK
;

5328 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pcd.c

75 
	~"°m32l1xx_hÆ.h
"

86 #ifde‡
HAL_PCD_MODULE_ENABLED


94 
	#BTABLE_ADDRESS
 (0x000)

	)

105 
HAL_SètusTy≥Def
 
PCD_EP_ISR_H™dÀr
(
PCD_H™dÀTy≥Def
 *
hpcd
);

106 
PCD_WrôePMA
(
USB_Ty≥Def
 *
USBx
, 
uöt8_t
 *
pbU§Buf
, 
uöt16_t
 
wPMABufAddr
, uöt16_à
wNByãs
);

107 
PCD_RódPMA
(
USB_Ty≥Def
 *
USBx
, 
uöt8_t
 *
pbU§Buf
, 
uöt16_t
 
wPMABufAddr
, uöt16_à
wNByãs
);

138 
HAL_SètusTy≥Def
 
	$HAL_PCD_Inô
(
PCD_H™dÀTy≥Def
 *
hpcd
)

140 
uöt32_t
 
i
 = 0;

142 
uöt32_t
 
wI¡îru±_Mask
 = 0;

145 if(
hpcd
 =
NULL
)

147  
HAL_ERROR
;

151 
	`as£π_∑øm
(
	`IS_PCD_ALL_INSTANCE
(
hpcd
->
In°™˚
));

153 if(
hpcd
->
Sèã
 =
HAL_PCD_STATE_RESET
)

156 
hpcd
->
Lock
 = 
HAL_UNLOCKED
;

159 
	`HAL_PCD_M•Inô
(
hpcd
);

162 
hpcd
->
Sèã
 = 
HAL_PCD_STATE_BUSY
;

165 
i
 = 0; i < 
hpcd
->
Inô
.
dev_ídpoöts
 ; i++)

168 
hpcd
->
IN_ï
[
i
].
is_ö
 = 1;

169 
hpcd
->
IN_ï
[
i
].
num
 = i;

171 
hpcd
->
IN_ï
[
i
].
ty≥
 = 
PCD_EP_TYPE_CTRL
;

172 
hpcd
->
IN_ï
[
i
].
max∑ckë
 = 0;

173 
hpcd
->
IN_ï
[
i
].
x„r_buff
 = 0;

174 
hpcd
->
IN_ï
[
i
].
x„r_Àn
 = 0;

177 
i
 = 0; i < 
hpcd
->
Inô
.
dev_ídpoöts
 ; i++)

179 
hpcd
->
OUT_ï
[
i
].
is_ö
 = 0;

180 
hpcd
->
OUT_ï
[
i
].
num
 = i;

182 
hpcd
->
OUT_ï
[
i
].
ty≥
 = 
PCD_EP_TYPE_CTRL
;

183 
hpcd
->
OUT_ï
[
i
].
max∑ckë
 = 0;

184 
hpcd
->
OUT_ï
[
i
].
x„r_buff
 = 0;

185 
hpcd
->
OUT_ï
[
i
].
x„r_Àn
 = 0;

190 
hpcd
->
In°™˚
->
CNTR
 = 
USB_CNTR_FRES
;

193 
hpcd
->
In°™˚
->
CNTR
 = 0;

196 
hpcd
->
In°™˚
->
ISTR
 = 0;

199 
hpcd
->
In°™˚
->
BTABLE
 = 
BTABLE_ADDRESS
;

202 
wI¡îru±_Mask
 = 
USB_CNTR_CTRM
 | 
USB_CNTR_WKUPM
 | 
USB_CNTR_SUSPM
 | 
USB_CNTR_ERRM
 \

203 | 
USB_CNTR_ESOFM
 | 
USB_CNTR_RESETM
;

206 
hpcd
->
In°™˚
->
CNTR
 = 
wI¡îru±_Mask
;

208 
hpcd
->
USB_Addªss
 = 0;

209 
hpcd
->
Sèã

HAL_PCD_STATE_READY
;

211  
HAL_OK
;

212 
	}
}

219 
HAL_SètusTy≥Def
 
	$HAL_PCD_DeInô
(
PCD_H™dÀTy≥Def
 *
hpcd
)

222 if(
hpcd
 =
NULL
)

224  
HAL_ERROR
;

227 
hpcd
->
Sèã
 = 
HAL_PCD_STATE_BUSY
;

230 
	`HAL_PCD_St›
(
hpcd
);

233 
	`HAL_PCD_M•DeInô
(
hpcd
);

235 
hpcd
->
Sèã
 = 
HAL_PCD_STATE_RESET
;

237  
HAL_OK
;

238 
	}
}

245 
__wók
 
	$HAL_PCD_M•Inô
(
PCD_H™dÀTy≥Def
 *
hpcd
)

248 
	`UNUSED
(
hpcd
);

253 
	}
}

260 
__wók
 
	$HAL_PCD_M•DeInô
(
PCD_H™dÀTy≥Def
 *
hpcd
)

263 
	`UNUSED
(
hpcd
);

268 
	}
}

294 
HAL_SètusTy≥Def
 
	$HAL_PCD_Sèπ
(
PCD_H™dÀTy≥Def
 *
hpcd
)

296 
	`HAL_PCDEx_SëC⁄√˘i⁄Sèã
 (
hpcd
, 1);

298  
HAL_OK
;

299 
	}
}

306 
HAL_SètusTy≥Def
 
	$HAL_PCD_St›
(
PCD_H™dÀTy≥Def
 *
hpcd
)

308 
	`__HAL_LOCK
(
hpcd
);

311 
hpcd
->
In°™˚
->
CNTR
 = 
USB_CNTR_FRES
;

314 
hpcd
->
In°™˚
->
ISTR
 = 0;

317 
hpcd
->
In°™˚
->
CNTR
 = (
USB_CNTR_FRES
 | 
USB_CNTR_PDWN
);

319 
	`__HAL_UNLOCK
(
hpcd
);

320  
HAL_OK
;

321 
	}
}

338 
HAL_SètusTy≥Def
 
	$PCD_EP_ISR_H™dÀr
(
PCD_H™dÀTy≥Def
 *
hpcd
)

340 
PCD_EPTy≥Def
 *
ï
;

341 
uöt16_t
 
cou¡
=0;

342 
uöt8_t
 
EPödex
;

343 
__IO
 
uöt16_t
 
wI°r
;

344 
__IO
 
uöt16_t
 
wEPVÆ
 = 0;

347 ((
wI°r
 = 
hpcd
->
In°™˚
->
ISTR
Ë& 
USB_ISTR_CTR
) != 0)

350 
EPödex
 = (
uöt8_t
)(
wI°r
 & 
USB_ISTR_EP_ID
);

352 i‡(
EPödex
 == 0)

357 i‡((
wI°r
 & 
USB_ISTR_DIR
) == 0)

363 
	`PCD_CLEAR_TX_EP_CTR
(
hpcd
->
In°™˚
, 
PCD_ENDP0
);

364 
ï
 = &
hpcd
->
IN_ï
[0];

366 
ï
->
x„r_cou¡
 = 
	`PCD_GET_EP_TX_CNT
(
hpcd
->
In°™˚
,Ép->
num
);

367 
ï
->
x„r_buff
 +ï->
x„r_cou¡
;

370 
	`HAL_PCD_D©aInSègeCÆlback
(
hpcd
, 0);

373 if((
hpcd
->
USB_Addªss
 > 0)&& ( 
ï
->
x„r_Àn
 == 0))

375 
hpcd
->
In°™˚
->
DADDR
 = (hpcd->
USB_Addªss
 | 
USB_DADDR_EF
);

376 
hpcd
->
USB_Addªss
 = 0;

386 
ï
 = &
hpcd
->
OUT_ï
[0];

387 
wEPVÆ
 = 
	`PCD_GET_ENDPOINT
(
hpcd
->
In°™˚
, 
PCD_ENDP0
);

389 i‡((
wEPVÆ
 & 
USB_EP_SETUP
) != 0)

392 
ï
->
x„r_cou¡
 = 
	`PCD_GET_EP_RX_CNT
(
hpcd
->
In°™˚
,Ép->
num
);

393 
	`PCD_RódPMA
(
hpcd
->
In°™˚
, (
uöt8_t
*)hpcd->
Sëup
 ,
ï
->
pmØdªss
 ,Ép->
x„r_cou¡
);

395 
	`PCD_CLEAR_RX_EP_CTR
(
hpcd
->
In°™˚
, 
PCD_ENDP0
);

398 
	`HAL_PCD_SëupSègeCÆlback
(
hpcd
);

401 i‡((
wEPVÆ
 & 
USB_EP_CTR_RX
) != 0)

403 
	`PCD_CLEAR_RX_EP_CTR
(
hpcd
->
In°™˚
, 
PCD_ENDP0
);

405 
ï
->
x„r_cou¡
 = 
	`PCD_GET_EP_RX_CNT
(
hpcd
->
In°™˚
,Ép->
num
);

407 i‡(
ï
->
x„r_cou¡
 != 0)

409 
	`PCD_RódPMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØdªss
,Ép->
x„r_cou¡
);

410 
ï
->
x„r_buff
+Ûp->
x„r_cou¡
;

414 
	`HAL_PCD_D©aOutSègeCÆlback
(
hpcd
, 0);

416 
	`PCD_SET_EP_RX_CNT
(
hpcd
->
In°™˚
, 
PCD_ENDP0
, 
ï
->
max∑ckë
);

417 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
PCD_ENDP0
, 
USB_EP_RX_VALID
);

427 
wEPVÆ
 = 
	`PCD_GET_ENDPOINT
(
hpcd
->
In°™˚
, 
EPödex
);

428 i‡((
wEPVÆ
 & 
USB_EP_CTR_RX
) != 0)

431 
	`PCD_CLEAR_RX_EP_CTR
(
hpcd
->
In°™˚
, 
EPödex
);

432 
ï
 = &
hpcd
->
OUT_ï
[
EPödex
];

435 i‡(
ï
->
doubÀbuf„r
 == 0)

437 
cou¡
 = 
	`PCD_GET_EP_RX_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
);

438 i‡(
cou¡
 != 0)

440 
	`PCD_RódPMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØdªss
, 
cou¡
);

445 i‡(
	`PCD_GET_ENDPOINT
(
hpcd
->
In°™˚
, 
ï
->
num
Ë& 
USB_EP_DTOG_RX
)

448 
cou¡
 = 
	`PCD_GET_EP_DBUF0_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
);

449 i‡(
cou¡
 != 0)

451 
	`PCD_RódPMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØddr0
, 
cou¡
);

457 
cou¡
 = 
	`PCD_GET_EP_DBUF1_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
);

458 i‡(
cou¡
 != 0)

460 
	`PCD_RódPMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØddr1
, 
cou¡
);

463 
	`PCD_FªeU£rBuf„r
(
hpcd
->
In°™˚
, 
ï
->
num
, 
PCD_EP_DBUF_OUT
);

466 
ï
->
x„r_cou¡
+=
cou¡
;

467 
ï
->
x„r_buff
+=
cou¡
;

469 i‡((
ï
->
x„r_Àn
 =0Ë|| (
cou¡
 <Ép->
max∑ckë
))

472 
	`HAL_PCD_D©aOutSègeCÆlback
(
hpcd
, 
ï
->
num
);

476 
	`HAL_PCD_EP_Re˚ive
(
hpcd
, 
ï
->
num
,Ép->
x„r_buff
,Ép->
x„r_Àn
);

481 i‡((
wEPVÆ
 & 
USB_EP_CTR_TX
) != 0)

483 
ï
 = &
hpcd
->
IN_ï
[
EPödex
];

486 
	`PCD_CLEAR_TX_EP_CTR
(
hpcd
->
In°™˚
, 
EPödex
);

489 i‡(
ï
->
doubÀbuf„r
 == 0)

491 
ï
->
x„r_cou¡
 = 
	`PCD_GET_EP_TX_CNT
(
hpcd
->
In°™˚
,Ép->
num
);

492 i‡(
ï
->
x„r_cou¡
 != 0)

494 
	`PCD_WrôePMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØdªss
,Ép->
x„r_cou¡
);

499 i‡(
	`PCD_GET_ENDPOINT
(
hpcd
->
In°™˚
, 
ï
->
num
Ë& 
USB_EP_DTOG_TX
)

502 
ï
->
x„r_cou¡
 = 
	`PCD_GET_EP_DBUF0_CNT
(
hpcd
->
In°™˚
,Ép->
num
);

503 i‡(
ï
->
x„r_cou¡
 != 0)

505 
	`PCD_WrôePMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØddr0
,Ép->
x„r_cou¡
);

511 
ï
->
x„r_cou¡
 = 
	`PCD_GET_EP_DBUF1_CNT
(
hpcd
->
In°™˚
,Ép->
num
);

512 i‡(
ï
->
x„r_cou¡
 != 0)

514 
	`PCD_WrôePMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØddr1
,Ép->
x„r_cou¡
);

517 
	`PCD_FªeU£rBuf„r
(
hpcd
->
In°™˚
, 
ï
->
num
, 
PCD_EP_DBUF_IN
);

520 
ï
->
x„r_cou¡
 = 
	`PCD_GET_EP_TX_CNT
(
hpcd
->
In°™˚
,Ép->
num
);

521 
ï
->
x„r_buff
+Ûp->
x„r_cou¡
;

524 i‡(
ï
->
x„r_Àn
 == 0)

527 
	`HAL_PCD_D©aInSègeCÆlback
(
hpcd
, 
ï
->
num
);

531 
	`HAL_PCD_EP_Tønsmô
(
hpcd
, 
ï
->
num
,Ép->
x„r_buff
,Ép->
x„r_Àn
);

536  
HAL_OK
;

537 
	}
}

547 
	$PCD_WrôePMA
(
USB_Ty≥Def
 *
USBx
, 
uöt8_t
 *
pbU§Buf
, 
uöt16_t
 
wPMABufAddr
, uöt16_à
wNByãs
)

549 
uöt32_t
 
n
 = (
wNByãs
 + 1) >> 1;

550 
uöt32_t
 
i
, 
ãmp1
, 
ãmp2
;

551 
uöt16_t
 *
pdwVÆ
;

552 
pdwVÆ
 = (
uöt16_t
 *)(
wPMABufAddr
 * 2 + (
uöt32_t
)
USBx
 + 0x400);

553 
i
 = 
n
; i != 0; i--)

555 
ãmp1
 = (
uöt16_t
Ë* 
pbU§Buf
;

556 
pbU§Buf
++;

557 
ãmp2
 = 
ãmp1
 | (
uöt16_t
Ë* 
pbU§Buf
 << 8;

558 *
pdwVÆ
++ = 
ãmp2
;

559 
pdwVÆ
++;

560 
pbU§Buf
++;

562 
	}
}

572 
	$PCD_RódPMA
(
USB_Ty≥Def
 *
USBx
, 
uöt8_t
 *
pbU§Buf
, 
uöt16_t
 
wPMABufAddr
, uöt16_à
wNByãs
)

574 
uöt32_t
 
n
 = (
wNByãs
 + 1) >> 1;

575 
uöt32_t
 
i
;

576 
uöt32_t
 *
pdwVÆ
;

577 
pdwVÆ
 = (
uöt32_t
 *)(
wPMABufAddr
 * 2 + (uöt32_t)
USBx
 + 0x400);

578 
i
 = 
n
; i != 0; i--)

580 *(
uöt16_t
*)
pbU§Buf
++ = *
pdwVÆ
++;

581 
pbU§Buf
++;

583 
	}
}

602 
	$HAL_PCD_IRQH™dÀr
(
PCD_H™dÀTy≥Def
 *
hpcd
)

604 
uöt32_t
 
wI¡îru±_Mask
 = 0;

606 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_CTR
))

610 
	`PCD_EP_ISR_H™dÀr
(
hpcd
);

613 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_RESET
))

615 
	`__HAL_PCD_CLEAR_FLAG
(
hpcd
, 
USB_ISTR_RESET
);

616 
	`HAL_PCD_Re£tCÆlback
(
hpcd
);

617 
	`HAL_PCD_SëAddªss
(
hpcd
, 0);

620 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_PMAOVR
))

622 
	`__HAL_PCD_CLEAR_FLAG
(
hpcd
, 
USB_ISTR_PMAOVR
);

624 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_ERR
))

626 
	`__HAL_PCD_CLEAR_FLAG
(
hpcd
, 
USB_ISTR_ERR
);

629 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_WKUP
))

631 
hpcd
->
In°™˚
->
CNTR
 &~(
USB_CNTR_LPMODE
);

634 
wI¡îru±_Mask
 = 
USB_CNTR_CTRM
 | 
USB_CNTR_WKUPM
 | 
USB_CNTR_SUSPM
 | 
USB_CNTR_ERRM
 \

635 | 
USB_CNTR_ESOFM
 | 
USB_CNTR_RESETM
;

638 
hpcd
->
In°™˚
->
CNTR
 = 
wI¡îru±_Mask
;

640 
	`HAL_PCD_ResumeCÆlback
(
hpcd
);

642 
	`__HAL_PCD_CLEAR_FLAG
(
hpcd
, 
USB_ISTR_WKUP
);

645 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_SUSP
))

648 
	`__HAL_PCD_CLEAR_FLAG
(
hpcd
, 
USB_ISTR_SUSP
);

651 
hpcd
->
In°™˚
->
CNTR
 |
USB_CNTR_FSUSP
;

652 
hpcd
->
In°™˚
->
CNTR
 |
USB_CNTR_LPMODE
;

653 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_WKUP
) == 0)

655 
	`HAL_PCD_Su•ídCÆlback
(
hpcd
);

659 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_SOF
))

661 
	`__HAL_PCD_CLEAR_FLAG
(
hpcd
, 
USB_ISTR_SOF
);

662 
	`HAL_PCD_SOFCÆlback
(
hpcd
);

665 i‡(
	`__HAL_PCD_GET_FLAG
 (
hpcd
, 
USB_ISTR_ESOF
))

668 
	`__HAL_PCD_CLEAR_FLAG
(
hpcd
, 
USB_ISTR_ESOF
);

670 
	}
}

678 
__wók
 
	$HAL_PCD_D©aOutSègeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

681 
	`UNUSED
(
hpcd
);

682 
	`UNUSED
(
ïnum
);

687 
	}
}

695 
__wók
 
	$HAL_PCD_D©aInSègeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

698 
	`UNUSED
(
hpcd
);

699 
	`UNUSED
(
ïnum
);

704 
	}
}

710 
__wók
 
	$HAL_PCD_SëupSègeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

713 
	`UNUSED
(
hpcd
);

718 
	}
}

725 
__wók
 
	$HAL_PCD_SOFCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

728 
	`UNUSED
(
hpcd
);

733 
	}
}

740 
__wók
 
	$HAL_PCD_Re£tCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

743 
	`UNUSED
(
hpcd
);

748 
	}
}

756 
__wók
 
	$HAL_PCD_Su•ídCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

759 
	`UNUSED
(
hpcd
);

764 
	}
}

771 
__wók
 
	$HAL_PCD_ResumeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

774 
	`UNUSED
(
hpcd
);

779 
	}
}

787 
__wók
 
	$HAL_PCD_ISOOUTIncom∂ëeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

790 
	`UNUSED
(
hpcd
);

791 
	`UNUSED
(
ïnum
);

796 
	}
}

804 
__wók
 
	$HAL_PCD_ISOINIncom∂ëeCÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ïnum
)

807 
	`UNUSED
(
hpcd
);

808 
	`UNUSED
(
ïnum
);

813 
	}
}

820 
__wók
 
	$HAL_PCD_C⁄√˘CÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

823 
	`UNUSED
(
hpcd
);

828 
	}
}

835 
__wók
 
	$HAL_PCD_Disc⁄√˘CÆlback
(
PCD_H™dÀTy≥Def
 *
hpcd
)

838 
	`UNUSED
(
hpcd
);

843 
	}
}

868 
HAL_SètusTy≥Def
 
	$HAL_PCD_DevC⁄√˘
(
PCD_H™dÀTy≥Def
 *
hpcd
)

870 
	`__HAL_LOCK
(
hpcd
);

873 
	`HAL_PCDEx_SëC⁄√˘i⁄Sèã
 (
hpcd
, 1);

875 
	`__HAL_UNLOCK
(
hpcd
);

876  
HAL_OK
;

877 
	}
}

884 
HAL_SètusTy≥Def
 
	$HAL_PCD_DevDisc⁄√˘
(
PCD_H™dÀTy≥Def
 *
hpcd
)

886 
	`__HAL_LOCK
(
hpcd
);

889 
	`HAL_PCDEx_SëC⁄√˘i⁄Sèã
 (
hpcd
, 0);

891 
	`__HAL_UNLOCK
(
hpcd
);

892  
HAL_OK
;

893 
	}
}

901 
HAL_SètusTy≥Def
 
	$HAL_PCD_SëAddªss
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
addªss
)

903 
	`__HAL_LOCK
(
hpcd
);

905 if(
addªss
 == 0)

908 
hpcd
->
In°™˚
->
DADDR
 = 
USB_DADDR_EF
;

912 
hpcd
->
USB_Addªss
 = 
addªss
;

915 
	`__HAL_UNLOCK
(
hpcd
);

916  
HAL_OK
;

917 
	}
}

926 
HAL_SètusTy≥Def
 
	$HAL_PCD_EP_O≥n
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
, 
uöt16_t
 
ï_mps
, uöt8_à
ï_ty≥
)

928 
HAL_SètusTy≥Def
 
ªt
 = 
HAL_OK
;

929 
PCD_EPTy≥Def
 *
ï
;

931 i‡((
ï_addr
 & 0x80) == 0x80)

933 
ï
 = &
hpcd
->
IN_ï
[
ï_addr
 & 0x7F];

937 
ï
 = &
hpcd
->
OUT_ï
[
ï_addr
 & 0x7F];

939 
ï
->
num
 = 
ï_addr
 & 0x7F;

941 
ï
->
is_ö
 = (0x80 & 
ï_addr
) != 0;

942 
ï
->
max∑ckë
 = 
ï_mps
;

943 
ï
->
ty≥
 = 
ï_ty≥
;

945 
	`__HAL_LOCK
(
hpcd
);

948 
ï
->
ty≥
)

950 
PCD_EP_TYPE_CTRL
:

951 
	`PCD_SET_EPTYPE
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_CONTROL
);

953 
PCD_EP_TYPE_BULK
:

954 
	`PCD_SET_EPTYPE
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_BULK
);

956 
PCD_EP_TYPE_INTR
:

957 
	`PCD_SET_EPTYPE
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_INTERRUPT
);

959 
PCD_EP_TYPE_ISOC
:

960 
	`PCD_SET_EPTYPE
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_ISOCHRONOUS
);

966 
	`PCD_SET_EP_ADDRESS
(
hpcd
->
In°™˚
, 
ï
->
num
,Ép->num);

968 i‡(
ï
->
doubÀbuf„r
 == 0)

970 i‡(
ï
->
is_ö
)

973 
	`PCD_SET_EP_TX_ADDRESS
(
hpcd
->
In°™˚
, 
ï
->
num
,Ép->
pmØdªss
);

974 
	`PCD_CLEAR_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

976 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_NAK
);

981 
	`PCD_SET_EP_RX_ADDRESS
(
hpcd
->
In°™˚
, 
ï
->
num
,Ép->
pmØdªss
);

983 
	`PCD_SET_EP_RX_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
,Ép->
max∑ckë
);

984 
	`PCD_CLEAR_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

986 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_VALID
);

993 
	`PCD_SET_EP_DBUF
(
hpcd
->
In°™˚
, 
ï
->
num
);

995 
	`PCD_SET_EP_DBUF_ADDR
(
hpcd
->
In°™˚
, 
ï
->
num
,ï->
pmØddr0
,Ép->
pmØddr1
);

997 i‡(
ï
->
is_ö
==0)

1000 
	`PCD_CLEAR_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1001 
	`PCD_CLEAR_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1004 
	`PCD_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1006 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_VALID
);

1007 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_DIS
);

1012 
	`PCD_CLEAR_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1013 
	`PCD_CLEAR_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1014 
	`PCD_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1016 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_DIS
);

1017 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_DIS
);

1021 
	`__HAL_UNLOCK
(
hpcd
);

1022  
ªt
;

1023 
	}
}

1032 
HAL_SètusTy≥Def
 
	$HAL_PCD_EP_Clo£
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
)

1034 
PCD_EPTy≥Def
 *
ï
;

1036 i‡((
ï_addr
 & 0x80) == 0x80)

1038 
ï
 = &
hpcd
->
IN_ï
[
ï_addr
 & 0x7F];

1042 
ï
 = &
hpcd
->
OUT_ï
[
ï_addr
 & 0x7F];

1044 
ï
->
num
 = 
ï_addr
 & 0x7F;

1046 
ï
->
is_ö
 = (0x80 & 
ï_addr
) != 0;

1048 
	`__HAL_LOCK
(
hpcd
);

1050 i‡(
ï
->
doubÀbuf„r
 == 0)

1052 i‡(
ï
->
is_ö
)

1054 
	`PCD_CLEAR_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1056 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_DIS
);

1060 
	`PCD_CLEAR_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1062 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_DIS
);

1068 i‡(
ï
->
is_ö
==0)

1071 
	`PCD_CLEAR_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1072 
	`PCD_CLEAR_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1075 
	`PCD_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1077 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_DIS
);

1078 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_DIS
);

1083 
	`PCD_CLEAR_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1084 
	`PCD_CLEAR_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1085 
	`PCD_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1087 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_DIS
);

1088 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_DIS
);

1092 
	`__HAL_UNLOCK
(
hpcd
);

1093  
HAL_OK
;

1094 
	}
}

1105 
HAL_SètusTy≥Def
 
	$HAL_PCD_EP_Re˚ive
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
, uöt8_à*
pBuf
, 
uöt32_t
 
Àn
)

1108 
PCD_EPTy≥Def
 *
ï
;

1110 
ï
 = &
hpcd
->
OUT_ï
[
ï_addr
 & 0x7F];

1113 
ï
->
x„r_buff
 = 
pBuf
;

1114 
ï
->
x„r_Àn
 = 
Àn
;

1115 
ï
->
x„r_cou¡
 = 0;

1116 
ï
->
is_ö
 = 0;

1117 
ï
->
num
 = 
ï_addr
 & 0x7F;

1119 
	`__HAL_LOCK
(
hpcd
);

1122 i‡(
ï
->
x„r_Àn
 >Ép->
max∑ckë
)

1124 
Àn
=
ï
->
max∑ckë
;

1125 
ï
->
x„r_Àn
-=
Àn
;

1129 
Àn
=
ï
->
x„r_Àn
;

1130 
ï
->
x„r_Àn
 =0;

1134 i‡(
ï
->
doubÀbuf„r
 == 0)

1137 
	`PCD_SET_EP_RX_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
, 
Àn
);

1142 
	`PCD_SET_EP_DBUF_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
,Ép->
is_ö
, 
Àn
);

1145 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_VALID
);

1147 
	`__HAL_UNLOCK
(
hpcd
);

1149  
HAL_OK
;

1150 
	}
}

1158 
uöt16_t
 
	$HAL_PCD_EP_GëRxCou¡
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
)

1160  
hpcd
->
OUT_ï
[
ï_addr
 & 0x7F].
x„r_cou¡
;

1161 
	}
}

1170 
HAL_SètusTy≥Def
 
	$HAL_PCD_EP_Tønsmô
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
, uöt8_à*
pBuf
, 
uöt32_t
 
Àn
)

1172 
PCD_EPTy≥Def
 *
ï
;

1173 
uöt16_t
 
pmabuf„r
 = 0;

1175 
ï
 = &
hpcd
->
IN_ï
[
ï_addr
 & 0x7F];

1178 
ï
->
x„r_buff
 = 
pBuf
;

1179 
ï
->
x„r_Àn
 = 
Àn
;

1180 
ï
->
x„r_cou¡
 = 0;

1181 
ï
->
is_ö
 = 1;

1182 
ï
->
num
 = 
ï_addr
 & 0x7F;

1184 
	`__HAL_LOCK
(
hpcd
);

1187 i‡(
ï
->
x„r_Àn
 >Ép->
max∑ckë
)

1189 
Àn
=
ï
->
max∑ckë
;

1190 
ï
->
x„r_Àn
-=
Àn
;

1194 
Àn
=
ï
->
x„r_Àn
;

1195 
ï
->
x„r_Àn
 =0;

1199 i‡(
ï
->
doubÀbuf„r
 == 0)

1201 
	`PCD_WrôePMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
,Ép->
pmØdªss
, 
Àn
);

1202 
	`PCD_SET_EP_TX_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
, 
Àn
);

1207 
	`PCD_SET_EP_DBUF_CNT
(
hpcd
->
In°™˚
, 
ï
->
num
,Ép->
is_ö
, 
Àn
);

1210 i‡(
	`PCD_GET_ENDPOINT
(
hpcd
->
In°™˚
, 
ï
->
num
)& 
USB_EP_DTOG_TX
)

1212 
pmabuf„r
 = 
ï
->
pmØddr1
;

1216 
pmabuf„r
 = 
ï
->
pmØddr0
;

1219 
	`PCD_WrôePMA
(
hpcd
->
In°™˚
, 
ï
->
x„r_buff
, 
pmabuf„r
, 
Àn
);

1220 
	`PCD_FªeU£rBuf„r
(
hpcd
->
In°™˚
, 
ï
->
num
,Ép->
is_ö
);

1223 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_VALID
);

1225 
	`__HAL_UNLOCK
(
hpcd
);

1227  
HAL_OK
;

1228 
	}
}

1236 
HAL_SètusTy≥Def
 
	$HAL_PCD_EP_SëSèŒ
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
)

1238 
PCD_EPTy≥Def
 *
ï
;

1240 
	`__HAL_LOCK
(
hpcd
);

1242 i‡((0x80 & 
ï_addr
) == 0x80)

1244 
ï
 = &
hpcd
->
IN_ï
[
ï_addr
 & 0x7F];

1248 
ï
 = &
hpcd
->
OUT_ï
[
ï_addr
];

1251 
ï
->
is_°Æl
 = 1;

1252 
ï
->
num
 = 
ï_addr
 & 0x7F;

1253 
ï
->
is_ö
 = ((
ï_addr
 & 0x80) == 0x80);

1255 i‡(
ï
->
num
 == 0)

1258 
	`PCD_SET_EP_TXRX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_STALL
, 
USB_EP_TX_STALL
);

1262 i‡(
ï
->
is_ö
)

1264 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
 , 
USB_EP_TX_STALL
);

1268 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
 , 
USB_EP_RX_STALL
);

1271 
	`__HAL_UNLOCK
(
hpcd
);

1273  
HAL_OK
;

1274 
	}
}

1282 
HAL_SètusTy≥Def
 
	$HAL_PCD_EP_CÃSèŒ
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
)

1284 
PCD_EPTy≥Def
 *
ï
;

1286 i‡((0x80 & 
ï_addr
) == 0x80)

1288 
ï
 = &
hpcd
->
IN_ï
[
ï_addr
 & 0x7F];

1292 
ï
 = &
hpcd
->
OUT_ï
[
ï_addr
];

1295 
ï
->
is_°Æl
 = 0;

1296 
ï
->
num
 = 
ï_addr
 & 0x7F;

1297 
ï
->
is_ö
 = ((
ï_addr
 & 0x80) == 0x80);

1299 
	`__HAL_LOCK
(
hpcd
);

1301 i‡(
ï
->
is_ö
)

1303 
	`PCD_CLEAR_TX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1304 
	`PCD_SET_EP_TX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_TX_VALID
);

1308 
	`PCD_CLEAR_RX_DTOG
(
hpcd
->
In°™˚
, 
ï
->
num
);

1309 
	`PCD_SET_EP_RX_STATUS
(
hpcd
->
In°™˚
, 
ï
->
num
, 
USB_EP_RX_VALID
);

1311 
	`__HAL_UNLOCK
(
hpcd
);

1313  
HAL_OK
;

1314 
	}
}

1322 
HAL_SètusTy≥Def
 
	$HAL_PCD_EP_Flush
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
ï_addr
)

1324  
HAL_OK
;

1325 
	}
}

1332 
HAL_SètusTy≥Def
 
	$HAL_PCD_A˘iv©eRemŸeWakeup
(
PCD_H™dÀTy≥Def
 *
hpcd
)

1334 
hpcd
->
In°™˚
->
CNTR
 |
USB_CNTR_RESUME
;

1335  
HAL_OK
;

1336 
	}
}

1343 
HAL_SètusTy≥Def
 
	$HAL_PCD_DeA˘iv©eRemŸeWakeup
(
PCD_H™dÀTy≥Def
 *
hpcd
)

1345 
hpcd
->
In°™˚
->
CNTR
 &~(
USB_CNTR_RESUME
);

1346  
HAL_OK
;

1347 
	}
}

1374 
PCD_SèãTy≥Def
 
	$HAL_PCD_GëSèã
(
PCD_H™dÀTy≥Def
 *
hpcd
)

1376  
hpcd
->
Sèã
;

1377 
	}
}

1386 
__wók
 
	$HAL_PCDEx_SëC⁄√˘i⁄Sèã
(
PCD_H™dÀTy≥Def
 *
hpcd
, 
uöt8_t
 
°©e
)

1389 
	`UNUSED
(
hpcd
);

1390 
	`UNUSED
(
°©e
);

1395 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pcd_ex.c

43 
	~"°m32l1xx_hÆ.h
"

54 #ifde‡
HAL_PCD_MODULE_ENABLED


99 
HAL_SètusTy≥Def
 
	$HAL_PCDEx_PMAC⁄fig
(
PCD_H™dÀTy≥Def
 *
hpcd
,

100 
uöt16_t
 
ï_addr
,

101 
uöt16_t
 
ï_köd
,

102 
uöt32_t
 
pmØdªss
)

105 
PCD_EPTy≥Def
 *
ï
;

108 i‡((0x80 & 
ï_addr
) == 0x80)

110 
ï
 = &
hpcd
->
IN_ï
[
ï_addr
 & 0x7F];

114 
ï
 = &
hpcd
->
OUT_ï
[
ï_addr
];

118 i‡(
ï_köd
 =
PCD_SNG_BUF
)

121 
ï
->
doubÀbuf„r
 = 0;

123 
ï
->
pmØdªss
 = (
uöt16_t
)pmaadress;

128 
ï
->
doubÀbuf„r
 = 1;

130 
ï
->
pmØddr0
 = 
pmØdªss
 & 0xFFFF;

131 
ï
->
pmØddr1
 = (
pmØdªss
 & 0xFFFF0000U) >> 16;

134  
HAL_OK
;

135 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pwr.c

45 
	~"°m32l1xx_hÆ.h
"

56 #ifde‡
HAL_PWR_MODULE_ENABLED


60 
	#PVD_MODE_IT
 ((
uöt32_t
)0x00010000)

	)

61 
	#PVD_MODE_EVT
 ((
uöt32_t
)0x00020000)

	)

62 
	#PVD_RISING_EDGE
 ((
uöt32_t
)0x00000001)

	)

63 
	#PVD_FALLING_EDGE
 ((
uöt32_t
)0x00000002)

	)

103 
	$HAL_PWR_DeInô
()

105 
	`__HAL_RCC_PWR_FORCE_RESET
();

106 
	`__HAL_RCC_PWR_RELEASE_RESET
();

107 
	}
}

116 
	$HAL_PWR_E«bÀBkUpAc˚ss
()

119 *(
__IO
 
uöt32_t
 *Ë
CR_DBP_BB
 = (uöt32_t)
ENABLE
;

120 
	}
}

129 
	$HAL_PWR_DißbÀBkUpAc˚ss
()

132 *(
__IO
 
uöt32_t
 *Ë
CR_DBP_BB
 = (uöt32_t)
DISABLE
;

133 
	}
}

357 
	$HAL_PWR_C⁄figPVD
(
PWR_PVDTy≥Def
 *
sC⁄figPVD
)

360 
	`as£π_∑øm
(
	`IS_PWR_PVD_LEVEL
(
sC⁄figPVD
->
PVDLevñ
));

361 
	`as£π_∑øm
(
	`IS_PWR_PVD_MODE
(
sC⁄figPVD
->
Mode
));

364 
	`MODIFY_REG
(
PWR
->
CR
, 
PWR_CR_PLS
, 
sC⁄figPVD
->
PVDLevñ
);

367 
	`__HAL_PWR_PVD_EXTI_DISABLE_EVENT
();

368 
	`__HAL_PWR_PVD_EXTI_DISABLE_IT
();

369 
	`__HAL_PWR_PVD_EXTI_DISABLE_RISING_FALLING_EDGE
();

372 if((
sC⁄figPVD
->
Mode
 & 
PVD_MODE_IT
) == PVD_MODE_IT)

374 
	`__HAL_PWR_PVD_EXTI_ENABLE_IT
();

378 if((
sC⁄figPVD
->
Mode
 & 
PVD_MODE_EVT
) == PVD_MODE_EVT)

380 
	`__HAL_PWR_PVD_EXTI_ENABLE_EVENT
();

384 if((
sC⁄figPVD
->
Mode
 & 
PVD_RISING_EDGE
) == PVD_RISING_EDGE)

386 
	`__HAL_PWR_PVD_EXTI_ENABLE_RISING_EDGE
();

389 if((
sC⁄figPVD
->
Mode
 & 
PVD_FALLING_EDGE
) == PVD_FALLING_EDGE)

391 
	`__HAL_PWR_PVD_EXTI_ENABLE_FALLING_EDGE
();

393 
	}
}

399 
	$HAL_PWR_E«bÀPVD
()

402 *(
__IO
 
uöt32_t
 *Ë
CR_PVDE_BB
 = (uöt32_t)
ENABLE
;

403 
	}
}

409 
	$HAL_PWR_DißbÀPVD
()

412 *(
__IO
 
uöt32_t
 *Ë
CR_PVDE_BB
 = (uöt32_t)
DISABLE
;

413 
	}
}

424 
	$HAL_PWR_E«bÀWakeUpPö
(
uöt32_t
 
WakeUpPöx
)

427 
	`as£π_∑øm
(
	`IS_PWR_WAKEUP_PIN
(
WakeUpPöx
));

429 *(
__IO
 
uöt32_t
 *Ë
	`CSR_EWUP_BB
(
WakeUpPöx
Ë(uöt32_t)
ENABLE
;

430 
	}
}

441 
	$HAL_PWR_DißbÀWakeUpPö
(
uöt32_t
 
WakeUpPöx
)

444 
	`as£π_∑øm
(
	`IS_PWR_WAKEUP_PIN
(
WakeUpPöx
));

446 *(
__IO
 
uöt32_t
 *Ë
	`CSR_EWUP_BB
(
WakeUpPöx
Ë(uöt32_t)
DISABLE
;

447 
	}
}

464 
	$HAL_PWR_E¡îSLEEPMode
(
uöt32_t
 
Reguœt‹
, 
uöt8_t
 
SLEEPE¡ry
)

467 
	`as£π_∑øm
(
	`IS_PWR_REGULATOR
(
Reguœt‹
));

468 
	`as£π_∑øm
(
	`IS_PWR_SLEEP_ENTRY
(
SLEEPE¡ry
));

471 
	`MODIFY_REG
(
PWR
->
CR
, (
PWR_CR_PDDS
 | 
PWR_CR_LPSDSR
), 
Reguœt‹
);

474 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

477 if(
SLEEPE¡ry
 =
PWR_SLEEPENTRY_WFI
)

480 
	`__WFI
();

485 
	`__SEV
();

486 
	`__WFE
();

487 
	`__WFE
();

489 
	}
}

510 
	$HAL_PWR_E¡îSTOPMode
(
uöt32_t
 
Reguœt‹
, 
uöt8_t
 
STOPE¡ry
)

513 
	`as£π_∑øm
(
	`IS_PWR_REGULATOR
(
Reguœt‹
));

514 
	`as£π_∑øm
(
	`IS_PWR_STOP_ENTRY
(
STOPE¡ry
));

517 
	`MODIFY_REG
(
PWR
->
CR
, (
PWR_CR_PDDS
 | 
PWR_CR_LPSDSR
), 
Reguœt‹
);

520 
	`SET_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

523 if(
STOPE¡ry
 =
PWR_STOPENTRY_WFI
)

526 
	`__WFI
();

531 
	`__SEV
();

532 
	`__WFE
();

533 
	`__WFE
();

536 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

537 
	}
}

550 
	$HAL_PWR_E¡îSTANDBYMode
()

553 
	`SET_BIT
(
PWR
->
CR
, 
PWR_CR_PDDS
);

556 
	`SET_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SLEEPDEEP_Msk
));

559 #i‡
	`deföed
 ( 
__CC_ARM
)

560 
	`__f‹˚_°‹es
();

563 
	`__WFI
();

564 
	}
}

575 
	$HAL_PWR_E«bÀSÀïOnExô
()

578 
	`SET_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SLEEPONEXIT_Msk
));

579 
	}
}

588 
	$HAL_PWR_DißbÀSÀïOnExô
()

591 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SLEEPONEXIT_Msk
));

592 
	}
}

601 
	$HAL_PWR_E«bÀSEVOnPíd
()

604 
	`SET_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SEVONPEND_Msk
));

605 
	}
}

614 
	$HAL_PWR_DißbÀSEVOnPíd
()

617 
	`CLEAR_BIT
(
SCB
->
SCR
, ((
uöt32_t
)
SCB_SCR_SEVONPEND_Msk
));

618 
	}
}

627 
	$HAL_PWR_PVD_IRQH™dÀr
()

630 if(
	`__HAL_PWR_PVD_EXTI_GET_FLAG
(Ë!
RESET
)

633 
	`HAL_PWR_PVDCÆlback
();

636 
	`__HAL_PWR_PVD_EXTI_CLEAR_FLAG
();

638 
	}
}

644 
__wók
 
	$HAL_PWR_PVDCÆlback
()

649 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pwr_ex.c

44 
	~"°m32l1xx_hÆ.h
"

55 #ifde‡
HAL_PWR_MODULE_ENABLED


84 
uöt32_t
 
	$HAL_PWREx_GëVﬁègeR™ge
()

86  (
PWR
->
CR
 & 
PWR_CR_VOS
);

87 
	}
}

97 
	$HAL_PWREx_E«bÀFa°WakeUp
()

100 *(
__IO
 
uöt32_t
 *Ë
CR_FWU_BB
 = (uöt32_t)
ENABLE
;

101 
	}
}

107 
	$HAL_PWREx_DißbÀFa°WakeUp
()

110 *(
__IO
 
uöt32_t
 *Ë
CR_FWU_BB
 = (uöt32_t)
DISABLE
;

111 
	}
}

117 
	$HAL_PWREx_E«bÀU…øLowPowî
()

120 *(
__IO
 
uöt32_t
 *Ë
CR_ULP_BB
 = (uöt32_t)
ENABLE
;

121 
	}
}

127 
	$HAL_PWREx_DißbÀU…øLowPowî
()

130 *(
__IO
 
uöt32_t
 *Ë
CR_ULP_BB
 = (uöt32_t)
DISABLE
;

131 
	}
}

143 
	$HAL_PWREx_E«bÀLowPowîRunMode
()

146 *(
__IO
 
uöt32_t
 *Ë
CR_LPSDSR_BB
 = (uöt32_t)
ENABLE
;

147 *(
__IO
 
uöt32_t
 *Ë
CR_LPRUN_BB
 = (uöt32_t)
ENABLE
;

148 
	}
}

154 
HAL_SètusTy≥Def
 
	$HAL_PWREx_DißbÀLowPowîRunMode
()

157 *(
__IO
 
uöt32_t
 *Ë
CR_LPRUN_BB
 = (uöt32_t)
DISABLE
;

158 *(
__IO
 
uöt32_t
 *Ë
CR_LPSDSR_BB
 = (uöt32_t)
DISABLE
;

159  
HAL_OK
;

160 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rcc.c

82 
	~"°m32l1xx_hÆ.h
"

93 #ifde‡
HAL_RCC_MODULE_ENABLED


101 
	#RCC_CFGR_PLLMUL_BITNUMBER
 
	`POSITION_VAL
(
RCC_CFGR_PLLMUL
)

	)

102 
	#RCC_CFGR_PLLDIV_BITNUMBER
 
	`POSITION_VAL
(
RCC_CFGR_PLLDIV
)

	)

103 
	#RCC_CFGR_HPRE_BITNUMBER
 
	`POSITION_VAL
(
RCC_CFGR_HPRE
)

	)

104 
	#RCC_CFGR_PPRE1_BITNUMBER
 
	`POSITION_VAL
(
RCC_CFGR_PPRE1
)

	)

105 
	#RCC_CFGR_PPRE2_BITNUMBER
 
	`POSITION_VAL
(
RCC_CFGR_PPRE2
)

	)

107 
	#RCC_ICSCR_MSIRANGE_BITNUMBER
 
	`POSITION_VAL
(
RCC_ICSCR_MSIRANGE
)

	)

108 
	#RCC_ICSCR_MSITRIM_BITNUMBER
 
	`POSITION_VAL
(
RCC_ICSCR_MSITRIM
)

	)

117 
	#MCO1_CLK_ENABLE
(Ë
	`__HAL_RCC_GPIOA_CLK_ENABLE
()

	)

118 
	#MCO1_GPIO_PORT
 
GPIOA


	)

119 
	#MCO1_PIN
 
GPIO_PIN_8


	)

129 c⁄° 
uöt8_t
 
PLLMulTabÀ
[];

138 
HAL_SètusTy≥Def
 
RCC_SëFœshL©ícyFromMSIR™ge
(
uöt32_t
 
MSIønge
);

261 
	$HAL_RCC_DeInô
()

264 
	`SET_BIT
(
RCC
->
CR
, 
RCC_CR_MSION
);

267 
	`CLEAR_BIT
(
RCC
->
CFGR
, 
RCC_CFGR_SW
);

270 
	`CLEAR_BIT
(
RCC
->
CR
, 
RCC_CR_HSION
 | 
RCC_CR_HSEON
 | 
RCC_CR_CSSON
 | 
RCC_CR_PLLON
 | 
RCC_CR_HSEBYP
);

272 
	`CLEAR_REG
(
RCC
->
CFGR
);

275 
	`MODIFY_REG
(
RCC
->
ICSCR
, (
RCC_ICSCR_MSIRANGE
 | 
RCC_ICSCR_MSITRIM
), (((
uöt32_t
)0 << 
RCC_ICSCR_MSITRIM_BITNUMBER
Ë| 
RCC_ICSCR_MSIRANGE_5
));

278 
	`MODIFY_REG
(
RCC
->
ICSCR
, 
RCC_ICSCR_HSITRIM
, ((
uöt32_t
)0x10 << 
	`POSITION_VAL
(RCC_ICSCR_HSITRIM)));

281 
	`CLEAR_REG
(
RCC
->
CIR
);

284 
Sy°emC‹eClock
 = 
MSI_VALUE
;

285 
	}
}

301 
HAL_SètusTy≥Def
 
	$HAL_RCC_OscC⁄fig
(
RCC_OscInôTy≥Def
 *
RCC_OscInôSåu˘
)

303 
uöt32_t
 
tick°¨t
 = 0U;

306 
	`as£π_∑øm
(
RCC_OscInôSåu˘
 !
NULL
);

307 
	`as£π_∑øm
(
	`IS_RCC_OSCILLATORTYPE
(
RCC_OscInôSåu˘
->
Oscûœt‹Ty≥
));

310 if(((
RCC_OscInôSåu˘
->
Oscûœt‹Ty≥
Ë& 
RCC_OSCILLATORTYPE_HSE
) == RCC_OSCILLATORTYPE_HSE)

313 
	`as£π_∑øm
(
	`IS_RCC_HSE
(
RCC_OscInôSåu˘
->
HSESèã
));

316 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë=
RCC_SYSCLKSOURCE_STATUS_HSE
)

317 || ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë=
RCC_SYSCLKSOURCE_STATUS_PLLCLK
Ë&& (
	`__HAL_RCC_GET_PLL_OSCSOURCE
(Ë=
RCC_PLLSOURCE_HSE
)))

319 if((
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
Ë!
RESET
Ë&& (
RCC_OscInôSåu˘
->
HSESèã
 =
RCC_HSE_OFF
))

321  
HAL_ERROR
;

327 
	`__HAL_RCC_HSE_CONFIG
(
RCC_OscInôSåu˘
->
HSESèã
);

331 if(
RCC_OscInôSåu˘
->
HSESèã
 !
RCC_HSE_OFF
)

334 
tick°¨t
 = 
	`HAL_GëTick
();

337 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
Ë=
RESET
)

339 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
HSE_TIMEOUT_VALUE
)

341  
HAL_TIMEOUT
;

348 
tick°¨t
 = 
	`HAL_GëTick
();

351 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
Ë!
RESET
)

353 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
HSE_TIMEOUT_VALUE
)

355  
HAL_TIMEOUT
;

362 if(((
RCC_OscInôSåu˘
->
Oscûœt‹Ty≥
Ë& 
RCC_OSCILLATORTYPE_HSI
) == RCC_OSCILLATORTYPE_HSI)

365 
	`as£π_∑øm
(
	`IS_RCC_HSI
(
RCC_OscInôSåu˘
->
HSISèã
));

366 
	`as£π_∑øm
(
	`IS_RCC_CALIBRATION_VALUE
(
RCC_OscInôSåu˘
->
HSICÆibøti⁄VÆue
));

369 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë=
RCC_SYSCLKSOURCE_STATUS_HSI
)

370 || ((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë=
RCC_SYSCLKSOURCE_STATUS_PLLCLK
Ë&& (
	`__HAL_RCC_GET_PLL_OSCSOURCE
(Ë=
RCC_PLLSOURCE_HSI
)))

373 if((
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
Ë!
RESET
Ë&& (
RCC_OscInôSåu˘
->
HSISèã
 !
RCC_HSI_ON
))

375  
HAL_ERROR
;

381 
	`__HAL_RCC_HSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscInôSåu˘
->
HSICÆibøti⁄VÆue
);

387 if(
RCC_OscInôSåu˘
->
HSISèã
 !
RCC_HSI_OFF
)

390 
	`__HAL_RCC_HSI_ENABLE
();

393 
tick°¨t
 = 
	`HAL_GëTick
();

396 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
Ë=
RESET
)

398 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
HSI_TIMEOUT_VALUE
)

400  
HAL_TIMEOUT
;

405 
	`__HAL_RCC_HSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscInôSåu˘
->
HSICÆibøti⁄VÆue
);

410 
	`__HAL_RCC_HSI_DISABLE
();

413 
tick°¨t
 = 
	`HAL_GëTick
();

416 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
Ë!
RESET
)

418 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
HSI_TIMEOUT_VALUE
)

420  
HAL_TIMEOUT
;

427 if(((
RCC_OscInôSåu˘
->
Oscûœt‹Ty≥
Ë& 
RCC_OSCILLATORTYPE_MSI
) == RCC_OSCILLATORTYPE_MSI)

430 if((
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë=
RCC_CFGR_SWS_MSI
) )

432 if((
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_MSIRDY
Ë!
RESET
Ë&& (
RCC_OscInôSåu˘
->
MSISèã
 =
RCC_MSI_OFF
))

434  
HAL_ERROR
;

440 
	`as£π_∑øm
(
	`IS_RCC_MSICALIBRATION_VALUE
(
RCC_OscInôSåu˘
->
MSICÆibøti⁄VÆue
));

441 
	`as£π_∑øm
(
	`IS_RCC_MSI_CLOCK_RANGE
(
RCC_OscInôSåu˘
->
MSIClockR™ge
));

446 if(
RCC_OscInôSåu˘
->
MSIClockR™ge
 > 
	`__HAL_RCC_GET_MSI_RANGE
())

449 if(
	`RCC_SëFœshL©ícyFromMSIR™ge
(
RCC_OscInôSåu˘
->
MSIClockR™ge
Ë!
HAL_OK
)

451  
HAL_ERROR
;

455 
	`__HAL_RCC_MSI_RANGE_CONFIG
(
RCC_OscInôSåu˘
->
MSIClockR™ge
);

457 
	`__HAL_RCC_MSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscInôSåu˘
->
MSICÆibøti⁄VÆue
);

463 
	`__HAL_RCC_MSI_RANGE_CONFIG
(
RCC_OscInôSåu˘
->
MSIClockR™ge
);

465 
	`__HAL_RCC_MSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscInôSåu˘
->
MSICÆibøti⁄VÆue
);

468 if(
	`RCC_SëFœshL©ícyFromMSIR™ge
(
RCC_OscInôSåu˘
->
MSIClockR™ge
Ë!
HAL_OK
)

470  
HAL_ERROR
;

475 
Sy°emC‹eClock
 = (32768U * (1U << ((
RCC_OscInôSåu˘
->
MSIClockR™ge
 >> 
RCC_ICSCR_MSIRANGE_BITNUMBER
) + 1U)))

476 >> 
AHBPªscTabÀ
[((
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
Ë>> 
RCC_CFGR_HPRE_BITNUMBER
)];

479 
	`HAL_InôTick
 (
TICK_INT_PRIORITY
);

485 
	`as£π_∑øm
(
	`IS_RCC_MSI
(
RCC_OscInôSåu˘
->
MSISèã
));

488 if(
RCC_OscInôSåu˘
->
MSISèã
 !
RCC_MSI_OFF
)

491 
	`__HAL_RCC_MSI_ENABLE
();

494 
tick°¨t
 = 
	`HAL_GëTick
();

497 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_MSIRDY
Ë=
RESET
)

499 if((
	`HAL_GëTick
(Ë- 
tick°¨t
Ë> 
MSI_TIMEOUT_VALUE
)

501  
HAL_TIMEOUT
;

505 
	`as£π_∑øm
(
	`IS_RCC_MSICALIBRATION_VALUE
(
RCC_OscInôSåu˘
->
MSICÆibøti⁄VÆue
));

506 
	`as£π_∑øm
(
	`IS_RCC_MSI_CLOCK_RANGE
(
RCC_OscInôSåu˘
->
MSIClockR™ge
));

509 
	`__HAL_RCC_MSI_RANGE_CONFIG
(
RCC_OscInôSåu˘
->
MSIClockR™ge
);

511 
	`__HAL_RCC_MSI_CALIBRATIONVALUE_ADJUST
(
RCC_OscInôSåu˘
->
MSICÆibøti⁄VÆue
);

517 
	`__HAL_RCC_MSI_DISABLE
();

520 
tick°¨t
 = 
	`HAL_GëTick
();

523 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_MSIRDY
Ë!
RESET
)

525 if((
	`HAL_GëTick
(Ë- 
tick°¨t
Ë> 
MSI_TIMEOUT_VALUE
)

527  
HAL_TIMEOUT
;

534 if(((
RCC_OscInôSåu˘
->
Oscûœt‹Ty≥
Ë& 
RCC_OSCILLATORTYPE_LSI
) == RCC_OSCILLATORTYPE_LSI)

537 
	`as£π_∑øm
(
	`IS_RCC_LSI
(
RCC_OscInôSåu˘
->
LSISèã
));

540 if(
RCC_OscInôSåu˘
->
LSISèã
 !
RCC_LSI_OFF
)

543 
	`__HAL_RCC_LSI_ENABLE
();

546 
tick°¨t
 = 
	`HAL_GëTick
();

549 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSIRDY
Ë=
RESET
)

551 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
LSI_TIMEOUT_VALUE
)

553  
HAL_TIMEOUT
;

560 
	`__HAL_RCC_LSI_DISABLE
();

563 
tick°¨t
 = 
	`HAL_GëTick
();

566 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSIRDY
Ë!
RESET
)

568 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
LSI_TIMEOUT_VALUE
)

570  
HAL_TIMEOUT
;

576 if(((
RCC_OscInôSåu˘
->
Oscûœt‹Ty≥
Ë& 
RCC_OSCILLATORTYPE_LSE
) == RCC_OSCILLATORTYPE_LSE)

578 
FœgSètus
 
pwr˛kch™ged
 = 
RESET
;

581 
	`as£π_∑øm
(
	`IS_RCC_LSE
(
RCC_OscInôSåu˘
->
LSESèã
));

585 if(
	`__HAL_RCC_PWR_IS_CLK_DISABLED
())

587 
	`__HAL_RCC_PWR_CLK_ENABLE
();

588 
pwr˛kch™ged
 = 
SET
;

591 if(
	`HAL_IS_BIT_CLR
(
PWR
->
CR
, 
PWR_CR_DBP
))

594 
	`SET_BIT
(
PWR
->
CR
, 
PWR_CR_DBP
);

597 
tick°¨t
 = 
	`HAL_GëTick
();

599 
	`HAL_IS_BIT_CLR
(
PWR
->
CR
, 
PWR_CR_DBP
))

601 if((
	`HAL_GëTick
(Ë- 
tick°¨t
Ë> 
RCC_DBP_TIMEOUT_VALUE
)

603  
HAL_TIMEOUT
;

609 
	`__HAL_RCC_LSE_CONFIG
(
RCC_OscInôSåu˘
->
LSESèã
);

611 if(
RCC_OscInôSåu˘
->
LSESèã
 !
RCC_LSE_OFF
)

614 
tick°¨t
 = 
	`HAL_GëTick
();

617 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
Ë=
RESET
)

619 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

621  
HAL_TIMEOUT
;

628 
tick°¨t
 = 
	`HAL_GëTick
();

631 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
Ë!
RESET
)

633 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

635  
HAL_TIMEOUT
;

641 if(
pwr˛kch™ged
 =
SET
)

643 
	`__HAL_RCC_PWR_CLK_DISABLE
();

649 
	`as£π_∑øm
(
	`IS_RCC_PLL
(
RCC_OscInôSåu˘
->
PLL
.
PLLSèã
));

650 i‡((
RCC_OscInôSåu˘
->
PLL
.
PLLSèã
Ë!
RCC_PLL_NONE
)

653 if(
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë!
RCC_SYSCLKSOURCE_STATUS_PLLCLK
)

655 if((
RCC_OscInôSåu˘
->
PLL
.
PLLSèã
Ë=
RCC_PLL_ON
)

658 
	`as£π_∑øm
(
	`IS_RCC_PLLSOURCE
(
RCC_OscInôSåu˘
->
PLL
.
PLLSour˚
));

659 
	`as£π_∑øm
(
	`IS_RCC_PLL_MUL
(
RCC_OscInôSåu˘
->
PLL
.
PLLMUL
));

660 
	`as£π_∑øm
(
	`IS_RCC_PLL_DIV
(
RCC_OscInôSåu˘
->
PLL
.
PLLDIV
));

663 
	`__HAL_RCC_PLL_DISABLE
();

666 
tick°¨t
 = 
	`HAL_GëTick
();

669 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
Ë!
RESET
)

671 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
PLL_TIMEOUT_VALUE
)

673  
HAL_TIMEOUT
;

678 
	`__HAL_RCC_PLL_CONFIG
(
RCC_OscInôSåu˘
->
PLL
.
PLLSour˚
,

679 
RCC_OscInôSåu˘
->
PLL
.
PLLMUL
,

680 
RCC_OscInôSåu˘
->
PLL
.
PLLDIV
);

682 
	`__HAL_RCC_PLL_ENABLE
();

685 
tick°¨t
 = 
	`HAL_GëTick
();

688 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
Ë=
RESET
)

690 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
PLL_TIMEOUT_VALUE
)

692  
HAL_TIMEOUT
;

699 
	`__HAL_RCC_PLL_DISABLE
();

702 
tick°¨t
 = 
	`HAL_GëTick
();

705 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
Ë!
RESET
)

707 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
PLL_TIMEOUT_VALUE
)

709  
HAL_TIMEOUT
;

716  
HAL_ERROR
;

720  
HAL_OK
;

721 
	}
}

749 
HAL_SètusTy≥Def
 
	$HAL_RCC_ClockC⁄fig
(
RCC_ClkInôTy≥Def
 *
RCC_ClkInôSåu˘
, 
uöt32_t
 
FL©ícy
)

751 
uöt32_t
 
tick°¨t
 = 0U;

754 
	`as£π_∑øm
(
RCC_ClkInôSåu˘
 !
NULL
);

755 
	`as£π_∑øm
(
	`IS_RCC_CLOCKTYPE
(
RCC_ClkInôSåu˘
->
ClockTy≥
));

756 
	`as£π_∑øm
(
	`IS_FLASH_LATENCY
(
FL©ícy
));

763 if(
FL©ícy
 > (
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
))

766 
	`__HAL_FLASH_SET_LATENCY
(
FL©ícy
);

770 if((
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
Ë!
FL©ícy
)

772  
HAL_ERROR
;

777 if(((
RCC_ClkInôSåu˘
->
ClockTy≥
Ë& 
RCC_CLOCKTYPE_HCLK
) == RCC_CLOCKTYPE_HCLK)

779 
	`as£π_∑øm
(
	`IS_RCC_HCLK
(
RCC_ClkInôSåu˘
->
AHBCLKDividî
));

780 
	`MODIFY_REG
(
RCC
->
CFGR
, 
RCC_CFGR_HPRE
, 
RCC_ClkInôSåu˘
->
AHBCLKDividî
);

784 if(((
RCC_ClkInôSåu˘
->
ClockTy≥
Ë& 
RCC_CLOCKTYPE_SYSCLK
) == RCC_CLOCKTYPE_SYSCLK)

786 
	`as£π_∑øm
(
	`IS_RCC_SYSCLKSOURCE
(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
));

789 if(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
 =
RCC_SYSCLKSOURCE_HSE
)

792 if(
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSERDY
Ë=
RESET
)

794  
HAL_ERROR
;

798 if(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
 =
RCC_SYSCLKSOURCE_PLLCLK
)

801 if(
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_PLLRDY
Ë=
RESET
)

803  
HAL_ERROR
;

807 if(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
 =
RCC_SYSCLKSOURCE_HSI
)

810 if(
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_HSIRDY
Ë=
RESET
)

812  
HAL_ERROR
;

819 if(
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_MSIRDY
Ë=
RESET
)

821  
HAL_ERROR
;

824 
	`__HAL_RCC_SYSCLK_CONFIG
(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
);

827 
tick°¨t
 = 
	`HAL_GëTick
();

829 if(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
 =
RCC_SYSCLKSOURCE_HSE
)

831 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë!
RCC_SYSCLKSOURCE_STATUS_HSE
)

833 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

835  
HAL_TIMEOUT
;

839 if(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
 =
RCC_SYSCLKSOURCE_PLLCLK
)

841 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë!
RCC_SYSCLKSOURCE_STATUS_PLLCLK
)

843 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

845  
HAL_TIMEOUT
;

849 if(
RCC_ClkInôSåu˘
->
SYSCLKSour˚
 =
RCC_SYSCLKSOURCE_HSI
)

851 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë!
RCC_SYSCLKSOURCE_STATUS_HSI
)

853 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

855  
HAL_TIMEOUT
;

861 
	`__HAL_RCC_GET_SYSCLK_SOURCE
(Ë!
RCC_SYSCLKSOURCE_STATUS_MSI
)

863 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
CLOCKSWITCH_TIMEOUT_VALUE
)

865  
HAL_TIMEOUT
;

871 if(
FL©ícy
 < (
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
))

874 
	`__HAL_FLASH_SET_LATENCY
(
FL©ícy
);

878 if((
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
Ë!
FL©ícy
)

880  
HAL_ERROR
;

885 if(((
RCC_ClkInôSåu˘
->
ClockTy≥
Ë& 
RCC_CLOCKTYPE_PCLK1
) == RCC_CLOCKTYPE_PCLK1)

887 
	`as£π_∑øm
(
	`IS_RCC_PCLK
(
RCC_ClkInôSåu˘
->
APB1CLKDividî
));

888 
	`MODIFY_REG
(
RCC
->
CFGR
, 
RCC_CFGR_PPRE1
, 
RCC_ClkInôSåu˘
->
APB1CLKDividî
);

892 if(((
RCC_ClkInôSåu˘
->
ClockTy≥
Ë& 
RCC_CLOCKTYPE_PCLK2
) == RCC_CLOCKTYPE_PCLK2)

894 
	`as£π_∑øm
(
	`IS_RCC_PCLK
(
RCC_ClkInôSåu˘
->
APB2CLKDividî
));

895 
	`MODIFY_REG
(
RCC
->
CFGR
, 
RCC_CFGR_PPRE2
, ((
RCC_ClkInôSåu˘
->
APB2CLKDividî
) << 3));

899 
Sy°emC‹eClock
 = 
	`HAL_RCC_GëSysClockFªq
(Ë>> 
AHBPªscTabÀ
[(
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
)>> 
RCC_CFGR_HPRE_BITNUMBER
];

902 
	`HAL_InôTick
 (
TICK_INT_PRIORITY
);

904  
HAL_OK
;

905 
	}
}

951 
	$HAL_RCC_MCOC⁄fig
(
uöt32_t
 
RCC_MCOx
, uöt32_à
RCC_MCOSour˚
, uöt32_à
RCC_MCODiv
)

953 
GPIO_InôTy≥Def
 
gpio
 = {0};

956 
	`as£π_∑øm
(
	`IS_RCC_MCO
(
RCC_MCOx
));

957 
	`as£π_∑øm
(
	`IS_RCC_MCODIV
(
RCC_MCODiv
));

958 
	`as£π_∑øm
(
	`IS_RCC_MCO1SOURCE
(
RCC_MCOSour˚
));

961 
gpio
.
Mode
 = 
GPIO_MODE_AF_PP
;

962 
gpio
.
S≥ed
 = 
GPIO_SPEED_FREQ_HIGH
;

963 
gpio
.
PuŒ
 = 
GPIO_NOPULL
;

964 
gpio
.
Pö
 = 
MCO1_PIN
;

965 
gpio
.
A…î«ã
 = 
GPIO_AF0_MCO
;

968 
	`MCO1_CLK_ENABLE
();

970 
	`HAL_GPIO_Inô
(
MCO1_GPIO_PORT
, &
gpio
);

973 
	`__HAL_RCC_MCO1_CONFIG
(
RCC_MCOSour˚
, 
RCC_MCODiv
);

974 
	}
}

985 
	$HAL_RCC_E«bÀCSS
()

987 *(
__IO
 
uöt32_t
 *Ë
RCC_CR_CSSON_BB
 = (uöt32_t)
ENABLE
;

988 
	}
}

994 
	$HAL_RCC_DißbÀCSS
()

996 *(
__IO
 
uöt32_t
 *Ë
RCC_CR_CSSON_BB
 = (uöt32_t)
DISABLE
;

997 
	}
}

1029 
uöt32_t
 
	$HAL_RCC_GëSysClockFªq
()

1031 
uöt32_t
 
tm¥eg
 = 0, 
∂lm
 = 0, 
∂ld
 = 0, 
∂lvco
 = 0, 
msi˛kønge
 = 0;

1032 
uöt32_t
 
sys˛ock‰eq
 = 0;

1034 
tm¥eg
 = 
RCC
->
CFGR
;

1037 
tm¥eg
 & 
RCC_CFGR_SWS
)

1039 
RCC_SYSCLKSOURCE_STATUS_HSI
:

1041 
sys˛ock‰eq
 = 
HSI_VALUE
;

1044 
RCC_SYSCLKSOURCE_STATUS_HSE
:

1046 
sys˛ock‰eq
 = 
HSE_VALUE
;

1049 
RCC_SYSCLKSOURCE_STATUS_PLLCLK
:

1051 
∂lm
 = 
PLLMulTabÀ
[(
uöt32_t
)(
tm¥eg
 & 
RCC_CFGR_PLLMUL
Ë>> 
RCC_CFGR_PLLMUL_BITNUMBER
];

1052 
∂ld
 = ((
uöt32_t
)(
tm¥eg
 & 
RCC_CFGR_PLLDIV
Ë>> 
RCC_CFGR_PLLDIV_BITNUMBER
) + 1;

1053 i‡(
	`__HAL_RCC_GET_PLL_OSCSOURCE
(Ë!
RCC_PLLSOURCE_HSI
)

1056 
∂lvco
 = (
HSE_VALUE
 * 
∂lm
Ë/ 
∂ld
;

1061 
∂lvco
 = (
HSI_VALUE
 * 
∂lm
Ë/ 
∂ld
;

1063 
sys˛ock‰eq
 = 
∂lvco
;

1066 
RCC_SYSCLKSOURCE_STATUS_MSI
:

1069 
msi˛kønge
 = (
RCC
->
ICSCR
 & 
RCC_ICSCR_MSIRANGE
 ) >> 
RCC_ICSCR_MSIRANGE_BITNUMBER
;

1070 
sys˛ock‰eq
 = (32768 * (1 << (
msi˛kønge
 + 1)));

1074  
sys˛ock‰eq
;

1075 
	}
}

1086 
uöt32_t
 
	$HAL_RCC_GëHCLKFªq
()

1088  
Sy°emC‹eClock
;

1089 
	}
}

1097 
uöt32_t
 
	$HAL_RCC_GëPCLK1Fªq
()

1100  (
	`HAL_RCC_GëHCLKFªq
(Ë>> 
APBPªscTabÀ
[(
RCC
->
CFGR
 & 
RCC_CFGR_PPRE1
Ë>> 
RCC_CFGR_PPRE1_BITNUMBER
]);

1101 
	}
}

1109 
uöt32_t
 
	$HAL_RCC_GëPCLK2Fªq
()

1112  (
	`HAL_RCC_GëHCLKFªq
()>> 
APBPªscTabÀ
[(
RCC
->
CFGR
 & 
RCC_CFGR_PPRE2
Ë>> 
RCC_CFGR_PPRE2_BITNUMBER
]);

1113 
	}
}

1122 
	$HAL_RCC_GëOscC⁄fig
(
RCC_OscInôTy≥Def
 *
RCC_OscInôSåu˘
)

1125 
	`as£π_∑øm
(
RCC_OscInôSåu˘
 !
NULL
);

1128 
RCC_OscInôSåu˘
->
Oscûœt‹Ty≥
 = 
RCC_OSCILLATORTYPE_HSE
 | 
RCC_OSCILLATORTYPE_HSI
 \

1129 | 
RCC_OSCILLATORTYPE_LSE
 | 
RCC_OSCILLATORTYPE_LSI
 | 
RCC_OSCILLATORTYPE_MSI
;

1133 if((
RCC
->
CR
 &
RCC_CR_HSEBYP
) == RCC_CR_HSEBYP)

1135 
RCC_OscInôSåu˘
->
HSESèã
 = 
RCC_HSE_BYPASS
;

1137 if((
RCC
->
CR
 &
RCC_CR_HSEON
) == RCC_CR_HSEON)

1139 
RCC_OscInôSåu˘
->
HSESèã
 = 
RCC_HSE_ON
;

1143 
RCC_OscInôSåu˘
->
HSESèã
 = 
RCC_HSE_OFF
;

1147 if((
RCC
->
CR
 &
RCC_CR_HSION
) == RCC_CR_HSION)

1149 
RCC_OscInôSåu˘
->
HSISèã
 = 
RCC_HSI_ON
;

1153 
RCC_OscInôSåu˘
->
HSISèã
 = 
RCC_HSI_OFF
;

1156 
RCC_OscInôSåu˘
->
HSICÆibøti⁄VÆue
 = (
uöt32_t
)((
RCC
->
ICSCR
 & 
RCC_ICSCR_HSITRIM
Ë>> 
	`POSITION_VAL
(RCC_ICSCR_HSITRIM));

1159 if((
RCC
->
CR
 &
RCC_CR_MSION
) == RCC_CR_MSION)

1161 
RCC_OscInôSåu˘
->
MSISèã
 = 
RCC_MSI_ON
;

1165 
RCC_OscInôSåu˘
->
MSISèã
 = 
RCC_MSI_OFF
;

1168 
RCC_OscInôSåu˘
->
MSICÆibøti⁄VÆue
 = (
uöt32_t
)((
RCC
->
ICSCR
 & 
RCC_ICSCR_MSITRIM
Ë>> 
RCC_ICSCR_MSITRIM_BITNUMBER
);

1169 
RCC_OscInôSåu˘
->
MSIClockR™ge
 = (
uöt32_t
)((
RCC
->
ICSCR
 & 
RCC_ICSCR_MSIRANGE
));

1172 if((
RCC
->
CSR
 &
RCC_CSR_LSEBYP
) == RCC_CSR_LSEBYP)

1174 
RCC_OscInôSåu˘
->
LSESèã
 = 
RCC_LSE_BYPASS
;

1176 if((
RCC
->
CSR
 &
RCC_CSR_LSEON
) == RCC_CSR_LSEON)

1178 
RCC_OscInôSåu˘
->
LSESèã
 = 
RCC_LSE_ON
;

1182 
RCC_OscInôSåu˘
->
LSESèã
 = 
RCC_LSE_OFF
;

1186 if((
RCC
->
CSR
 &
RCC_CSR_LSION
) == RCC_CSR_LSION)

1188 
RCC_OscInôSåu˘
->
LSISèã
 = 
RCC_LSI_ON
;

1192 
RCC_OscInôSåu˘
->
LSISèã
 = 
RCC_LSI_OFF
;

1197 if((
RCC
->
CR
 &
RCC_CR_PLLON
) == RCC_CR_PLLON)

1199 
RCC_OscInôSåu˘
->
PLL
.
PLLSèã
 = 
RCC_PLL_ON
;

1203 
RCC_OscInôSåu˘
->
PLL
.
PLLSèã
 = 
RCC_PLL_OFF
;

1205 
RCC_OscInôSåu˘
->
PLL
.
PLLSour˚
 = (
uöt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_PLLSRC
);

1206 
RCC_OscInôSåu˘
->
PLL
.
PLLMUL
 = (
uöt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_PLLMUL
);

1207 
RCC_OscInôSåu˘
->
PLL
.
PLLDIV
 = (
uöt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_PLLDIV
);

1208 
	}
}

1218 
	$HAL_RCC_GëClockC⁄fig
(
RCC_ClkInôTy≥Def
 *
RCC_ClkInôSåu˘
, 
uöt32_t
 *
pFL©ícy
)

1221 
	`as£π_∑øm
(
RCC_ClkInôSåu˘
 !
NULL
);

1222 
	`as£π_∑øm
(
pFL©ícy
 !
NULL
);

1225 
RCC_ClkInôSåu˘
->
ClockTy≥
 = 
RCC_CLOCKTYPE_SYSCLK
 | 
RCC_CLOCKTYPE_HCLK
 | 
RCC_CLOCKTYPE_PCLK1
 | 
RCC_CLOCKTYPE_PCLK2
;

1228 
RCC_ClkInôSåu˘
->
SYSCLKSour˚
 = (
uöt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_SW
);

1231 
RCC_ClkInôSåu˘
->
AHBCLKDividî
 = (
uöt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
);

1234 
RCC_ClkInôSåu˘
->
APB1CLKDividî
 = (
uöt32_t
)(
RCC
->
CFGR
 & 
RCC_CFGR_PPRE1
);

1237 
RCC_ClkInôSåu˘
->
APB2CLKDividî
 = (
uöt32_t
)((
RCC
->
CFGR
 & 
RCC_CFGR_PPRE2
) >> 3);

1240 *
pFL©ícy
 = (
uöt32_t
)(
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
);

1241 
	}
}

1248 
	$HAL_RCC_NMI_IRQH™dÀr
()

1251 if(
	`__HAL_RCC_GET_IT
(
RCC_IT_CSS
))

1254 
	`HAL_RCC_CSSCÆlback
();

1257 
	`__HAL_RCC_CLEAR_IT
(
RCC_IT_CSS
);

1259 
	}
}

1265 
__wók
 
	$HAL_RCC_CSSCÆlback
()

1270 
	}
}

1290 
HAL_SètusTy≥Def
 
	$RCC_SëFœshL©ícyFromMSIR™ge
(
uöt32_t
 
MSIønge
)

1292 
uöt32_t
 
vos
 = 0;

1293 
uöt32_t
 
œãncy
 = 
FLASH_LATENCY_0
;

1296 i‡(
	`READ_BIT
(
RCC
->
CFGR
, 
RCC_CFGR_HPRE
Ë=
RCC_SYSCLK_DIV1
)

1298 if(
	`__HAL_RCC_PWR_IS_CLK_ENABLED
())

1300 
vos
 = 
	`HAL_PWREx_GëVﬁègeR™ge
();

1304 
	`__HAL_RCC_PWR_CLK_ENABLE
();

1305 
vos
 = 
	`HAL_PWREx_GëVﬁègeR™ge
();

1306 
	`__HAL_RCC_PWR_CLK_DISABLE
();

1310 if((
vos
 =
PWR_REGULATOR_VOLTAGE_SCALE3
Ë&& (
MSIønge
 =
RCC_MSIRANGE_6
))

1312 
œãncy
 = 
FLASH_LATENCY_1
;

1316 
	`__HAL_FLASH_SET_LATENCY
(
œãncy
);

1320 if((
FLASH
->
ACR
 & 
FLASH_ACR_LATENCY
Ë!
œãncy
)

1322  
HAL_ERROR
;

1325  
HAL_OK
;

1326 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rcc_ex.c

43 
	~"°m32l1xx_hÆ.h
"

49 #ifde‡
HAL_RCC_MODULE_ENABLED


110 
HAL_SètusTy≥Def
 
	$HAL_RCCEx_PîùhCLKC⁄fig
(
RCC_PîùhCLKInôTy≥Def
 *
PîùhClkInô
)

112 
uöt32_t
 
tick°¨t
 = 0U;

113 
uöt32_t
 
ãmp_ªg
 = 0U;

116 
	`as£π_∑øm
(
	`IS_RCC_PERIPHCLOCK
(
PîùhClkInô
->
PîùhClockSñe˘i⁄
));

119 i‡((((
PîùhClkInô
->
PîùhClockSñe˘i⁄
Ë& 
RCC_PERIPHCLK_RTC
) == RCC_PERIPHCLK_RTC)

120 #i‡
	`deföed
(
LCD
)

121 || (((
PîùhClkInô
->
PîùhClockSñe˘i⁄
Ë& 
RCC_PERIPHCLK_LCD
) == RCC_PERIPHCLK_LCD)

126 if(((
PîùhClkInô
->
PîùhClockSñe˘i⁄
Ë& 
RCC_PERIPHCLK_RTC
) == RCC_PERIPHCLK_RTC)

128 
	`as£π_∑øm
(
	`IS_RCC_RTCCLKSOURCE
(
PîùhClkInô
->
RTCClockSñe˘i⁄
));

131 #i‡
	`deföed
(
LCD
)

132 if(((
PîùhClkInô
->
PîùhClockSñe˘i⁄
Ë& 
RCC_PERIPHCLK_LCD
) == RCC_PERIPHCLK_LCD)

134 
	`as£π_∑øm
(
	`IS_RCC_RTCCLKSOURCE
(
PîùhClkInô
->
LCDClockSñe˘i⁄
));

138 
FœgSètus
 
pwr˛kch™ged
 = 
RESET
;

143 if(
	`__HAL_RCC_PWR_IS_CLK_DISABLED
())

145 
	`__HAL_RCC_PWR_CLK_ENABLE
();

146 
pwr˛kch™ged
 = 
SET
;

149 if(
	`HAL_IS_BIT_CLR
(
PWR
->
CR
, 
PWR_CR_DBP
))

152 
	`SET_BIT
(
PWR
->
CR
, 
PWR_CR_DBP
);

155 
tick°¨t
 = 
	`HAL_GëTick
();

157 
	`HAL_IS_BIT_CLR
(
PWR
->
CR
, 
PWR_CR_DBP
))

159 if((
	`HAL_GëTick
(Ë- 
tick°¨t
Ë> 
RCC_DBP_TIMEOUT_VALUE
)

161  
HAL_TIMEOUT
;

167 
ãmp_ªg
 = (
RCC
->
CR
 & 
RCC_CR_RTCPRE
);

168 i‡((
ãmp_ªg
 !(
PîùhClkInô
->
RTCClockSñe˘i⁄
 & 
RCC_CR_RTCPRE
))

169 #i‡
	`deföed
 (
LCD
)

170 || (
ãmp_ªg
 !(
PîùhClkInô
->
LCDClockSñe˘i⁄
 & 
RCC_CR_RTCPRE
))

174 i‡(((
PîùhClkInô
->
RTCClockSñe˘i⁄
 & 
RCC_CSR_RTCSEL
Ë=
RCC_CSR_RTCSEL_HSE
Ë&& 
	`HAL_IS_BIT_SET
(
RCC
->
CR
, 
RCC_CR_HSERDY
))

177  
HAL_ERROR
;

182 
ãmp_ªg
 = (
RCC
->
CSR
 & 
RCC_CSR_RTCSEL
);

184 if((
ãmp_ªg
 !0x00000000UË&& ((—emp_ªg !(
PîùhClkInô
->
RTCClockSñe˘i⁄
 & 
RCC_CSR_RTCSEL
)) \

185 && (((
PîùhClkInô
->
PîùhClockSñe˘i⁄
Ë& 
RCC_PERIPHCLK_RTC
) == RCC_PERIPHCLK_RTC))

186 #i‡
	`deföed
(
LCD
)

187 || ((
ãmp_ªg
 !(
PîùhClkInô
->
LCDClockSñe˘i⁄
 & 
RCC_CSR_RTCSEL
)) \

188 && (((
PîùhClkInô
->
PîùhClockSñe˘i⁄
Ë& 
RCC_PERIPHCLK_LCD
) == RCC_PERIPHCLK_LCD))

193 
ãmp_ªg
 = (
RCC
->
CSR
 & ~(
RCC_CSR_RTCSEL
));

196 
	`__HAL_RCC_BACKUPRESET_FORCE
();

197 
	`__HAL_RCC_BACKUPRESET_RELEASE
();

200 
RCC
->
CSR
 = 
ãmp_ªg
;

203 i‡(
	`HAL_IS_BIT_SET
(
ãmp_ªg
, 
RCC_CSR_LSEON
))

206 
tick°¨t
 = 
	`HAL_GëTick
();

209 
	`__HAL_RCC_GET_FLAG
(
RCC_FLAG_LSERDY
Ë=
RESET
)

211 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RCC_LSE_TIMEOUT_VALUE
)

213  
HAL_TIMEOUT
;

218 
	`__HAL_RCC_RTC_CONFIG
(
PîùhClkInô
->
RTCClockSñe˘i⁄
);

221 if(
pwr˛kch™ged
 =
SET
)

223 
	`__HAL_RCC_PWR_CLK_DISABLE
();

227  
HAL_OK
;

228 
	}
}

236 
	$HAL_RCCEx_GëPîùhCLKC⁄fig
(
RCC_PîùhCLKInôTy≥Def
 *
PîùhClkInô
)

238 
uöt32_t
 
§c˛k
 = 0;

241 
PîùhClkInô
->
PîùhClockSñe˘i⁄
 = 
RCC_PERIPHCLK_RTC
;

242 #i‡
	`deföed
(
LCD
)

243 
PîùhClkInô
->
PîùhClockSñe˘i⁄
 |
RCC_PERIPHCLK_LCD
;

247 
§c˛k
 = 
	`__HAL_RCC_GET_RTC_SOURCE
();

248 i‡(
§c˛k
 !
RCC_RTCCLKSOURCE_HSE_DIV2
)

251 
PîùhClkInô
->
RTCClockSñe˘i⁄
 = 
§c˛k
;

256 
PîùhClkInô
->
RTCClockSñe˘i⁄
 = 
§c˛k
 | (
	`READ_BIT
(
RCC
->
CR
, 
RCC_CR_RTCPRE
));

258 #i‡
	`deföed
(
LCD
)

259 
PîùhClkInô
->
LCDClockSñe˘i⁄
 = PîùhClkInô->
RTCClockSñe˘i⁄
;

261 
	}
}

273 
uöt32_t
 
	$HAL_RCCEx_GëPîùhCLKFªq
(
uöt32_t
 
PîùhClk
)

275 
uöt32_t
 
ãmp_ªg
 = 0U, 
˛k¥ediv
 = 0U, 
‰equícy
 = 0U;

276 
uöt32_t
 
§c˛k
 = 0U;

279 
	`as£π_∑øm
(
	`IS_RCC_PERIPHCLOCK
(
PîùhClk
));

281 
PîùhClk
)

283 
RCC_PERIPHCLK_RTC
:

284 #i‡
	`deföed
(
LCD
)

285 
RCC_PERIPHCLK_LCD
:

289 
ãmp_ªg
 = 
RCC
->
CSR
;

292 
§c˛k
 = 
	`__HAL_RCC_GET_RTC_SOURCE
();

295 i‡((
§c˛k
 =
RCC_RTCCLKSOURCE_LSE
Ë&& (
	`HAL_IS_BIT_SET
(
ãmp_ªg
, 
RCC_CSR_LSERDY
)))

297 
‰equícy
 = 
LSE_VALUE
;

300 i‡((
§c˛k
 =
RCC_RTCCLKSOURCE_LSI
Ë&& (
	`HAL_IS_BIT_SET
(
ãmp_ªg
, 
RCC_CSR_LSIRDY
)))

302 
‰equícy
 = 
LSI_VALUE
;

305 i‡((
§c˛k
 =
RCC_RTCCLKSOURCE_HSE_DIVX
Ë&& (
	`HAL_IS_BIT_SET
(
RCC
->
CR
, 
RCC_CR_HSERDY
)))

308 
˛k¥ediv
 = 
	`__HAL_RCC_GET_RTC_HSE_PRESCALER
();

310 
˛k¥ediv
)

312 
RCC_RTC_HSE_DIV_16
:

314 
‰equícy
 = 
HSE_VALUE
 / 16U;

317 
RCC_RTC_HSE_DIV_8
:

319 
‰equícy
 = 
HSE_VALUE
 / 8U;

322 
RCC_RTC_HSE_DIV_4
:

324 
‰equícy
 = 
HSE_VALUE
 / 4U;

329 
‰equícy
 = 
HSE_VALUE
 / 2U;

337 
‰equícy
 = 0U;

346 (
‰equícy
);

347 
	}
}

349 #i‡
deföed
(
RCC_LSECSS_SUPPORT
)

362 
	$HAL_RCCEx_E«bÀLSECSS
()

364 *(
__IO
 
uöt32_t
 *Ë
CSR_LSECSSON_BB
 = (uöt32_t)
ENABLE
;

365 
	}
}

375 
	$HAL_RCCEx_DißbÀLSECSS
()

378 *(
__IO
 
uöt32_t
 *Ë
CSR_LSECSSON_BB
 = (uöt32_t)
DISABLE
;

381 
	`__HAL_RCC_DISABLE_IT
(
RCC_IT_LSECSS
);

382 
	}
}

389 
	$HAL_RCCEx_E«bÀLSECSS_IT
()

392 *(
__IO
 
uöt32_t
 *Ë
CSR_LSECSSON_BB
 = (uöt32_t)
ENABLE
;

395 
	`__HAL_RCC_ENABLE_IT
(
RCC_IT_LSECSS
);

398 
	`__HAL_RCC_LSECSS_EXTI_ENABLE_IT
();

399 
	`__HAL_RCC_LSECSS_EXTI_ENABLE_RISING_EDGE
();

400 
	}
}

406 
	$HAL_RCCEx_LSECSS_IRQH™dÀr
()

409 if(
	`__HAL_RCC_GET_IT
(
RCC_IT_LSECSS
))

412 
	`HAL_RCCEx_LSECSS_CÆlback
();

415 
	`__HAL_RCC_CLEAR_IT
(
RCC_IT_LSECSS
);

417 
	}
}

423 
__wók
 
	$HAL_RCCEx_LSECSS_CÆlback
()

428 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rtc.c

133 
	~"°m32l1xx_hÆ.h
"

144 #ifde‡
HAL_RTC_MODULE_ENABLED


196 
HAL_SètusTy≥Def
 
	$HAL_RTC_Inô
(
RTC_H™dÀTy≥Def
 *
hπc
)

199 if(
hπc
 =
NULL
)

201  
HAL_ERROR
;

205 
	`as£π_∑øm
(
	`IS_RTC_ALL_INSTANCE
(
hπc
->
In°™˚
));

206 
	`as£π_∑øm
(
	`IS_RTC_HOUR_FORMAT
(
hπc
->
Inô
.
HourF‹m©
));

207 
	`as£π_∑øm
(
	`IS_RTC_ASYNCH_PREDIV
(
hπc
->
Inô
.
AsynchPªdiv
));

208 
	`as£π_∑øm
(
	`IS_RTC_SYNCH_PREDIV
(
hπc
->
Inô
.
SynchPªdiv
));

209 
	`as£π_∑øm
(
	`IS_RTC_OUTPUT
(
hπc
->
Inô
.
OutPut
));

210 
	`as£π_∑øm
(
	`IS_RTC_OUTPUT_POL
(
hπc
->
Inô
.
OutPutPﬁ¨ôy
));

211 
	`as£π_∑øm
(
	`IS_RTC_OUTPUT_TYPE
(
hπc
->
Inô
.
OutPutTy≥
));

213 if(
hπc
->
Sèã
 =
HAL_RTC_STATE_RESET
)

216 
hπc
->
Lock
 = 
HAL_UNLOCKED
;

219 
	`HAL_RTC_M•Inô
(
hπc
);

223 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

226 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

229 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

232 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

235 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

237  
HAL_ERROR
;

242 
hπc
->
In°™˚
->
CR
 &((
uöt32_t
)~(
RTC_CR_FMT
 | 
RTC_CR_OSEL
 | 
RTC_CR_POL
));

244 
hπc
->
In°™˚
->
CR
 |(
uöt32_t
)(hπc->
Inô
.
HourF‹m©
 | hπc->Inô.
OutPut
 | hπc->Inô.
OutPutPﬁ¨ôy
);

247 
hπc
->
In°™˚
->
PRER
 = (
uöt32_t
)(hπc->
Inô
.
SynchPªdiv
);

248 
hπc
->
In°™˚
->
PRER
 |(
uöt32_t
)(hπc->
Inô
.
AsynchPªdiv
 << 16);

251 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)~
RTC_ISR_INIT
;

253 
hπc
->
In°™˚
->
TAFCR
 &(
uöt32_t
)~
RTC_TAFCR_ALARMOUTTYPE
;

254 
hπc
->
In°™˚
->
TAFCR
 |(
uöt32_t
)(hπc->
Inô
.
OutPutTy≥
);

257 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

260 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

262  
HAL_OK
;

264 
	}
}

273 
__wók
 
HAL_SètusTy≥Def
 
	$HAL_RTC_DeInô
(
RTC_H™dÀTy≥Def
 *
hπc
)

276 
	`UNUSED
(
hπc
);

282  
HAL_ERROR
;

283 
	}
}

291 
__wók
 
	$HAL_RTC_M•Inô
(
RTC_H™dÀTy≥Def
* 
hπc
)

294 
	`UNUSED
(
hπc
);

299 
	}
}

307 
__wók
 
	$HAL_RTC_M•DeInô
(
RTC_H™dÀTy≥Def
* 
hπc
)

310 
	`UNUSED
(
hπc
);

315 
	}
}

346 
HAL_SètusTy≥Def
 
	$HAL_RTC_SëTime
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_TimeTy≥Def
 *
sTime
, 
uöt32_t
 
F‹m©
)

348 
uöt32_t
 
tm¥eg
 = 0;

351 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

352 
	`as£π_∑øm
(
	`IS_RTC_DAYLIGHT_SAVING
(
sTime
->
DayLightSavög
));

353 
	`as£π_∑øm
(
	`IS_RTC_STORE_OPERATION
(
sTime
->
St‹eO≥øti⁄
));

356 
	`__HAL_LOCK
(
hπc
);

358 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

360 if(
F‹m©
 =
RTC_FORMAT_BIN
)

362 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_FMT
Ë!(
uöt32_t
)
RESET
)

364 
	`as£π_∑øm
(
	`IS_RTC_HOUR12
(
sTime
->
Hours
));

365 
	`as£π_∑øm
(
	`IS_RTC_HOURFORMAT12
(
sTime
->
TimeF‹m©
));

369 
sTime
->
TimeF‹m©
 = 0x00;

370 
	`as£π_∑øm
(
	`IS_RTC_HOUR24
(
sTime
->
Hours
));

372 
	`as£π_∑øm
(
	`IS_RTC_MINUTES
(
sTime
->
Möuãs
));

373 
	`as£π_∑øm
(
	`IS_RTC_SECONDS
(
sTime
->
Sec⁄ds
));

375 
tm¥eg
 = (
uöt32_t
)(((uöt32_t)
	`RTC_ByãToBcd2
(
sTime
->
Hours
) << 16) | \

376 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sTime
->
Möuãs
) << 8) | \

377 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sTime
->
Sec⁄ds
)) | \

378 (((
uöt32_t
)
sTime
->
TimeF‹m©
) << 16));

382 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_FMT
Ë!(
uöt32_t
)
RESET
)

384 
tm¥eg
 = 
	`RTC_Bcd2ToByã
(
sTime
->
Hours
);

385 
	`as£π_∑øm
(
	`IS_RTC_HOUR12
(
tm¥eg
));

386 
	`as£π_∑øm
(
	`IS_RTC_HOURFORMAT12
(
sTime
->
TimeF‹m©
));

390 
sTime
->
TimeF‹m©
 = 0x00;

391 
	`as£π_∑øm
(
	`IS_RTC_HOUR24
(
	`RTC_Bcd2ToByã
(
sTime
->
Hours
)));

393 
	`as£π_∑øm
(
	`IS_RTC_MINUTES
(
	`RTC_Bcd2ToByã
(
sTime
->
Möuãs
)));

394 
	`as£π_∑øm
(
	`IS_RTC_SECONDS
(
	`RTC_Bcd2ToByã
(
sTime
->
Sec⁄ds
)));

395 
tm¥eg
 = (((
uöt32_t
)(
sTime
->
Hours
) << 16) | \

396 ((
uöt32_t
)(
sTime
->
Möuãs
) << 8) | \

397 ((
uöt32_t
)
sTime
->
Sec⁄ds
) | \

398 ((
uöt32_t
)(
sTime
->
TimeF‹m©
) << 16));

402 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

405 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

408 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

411 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

414 
	`__HAL_UNLOCK
(
hπc
);

416  
HAL_ERROR
;

421 
hπc
->
In°™˚
->
TR
 = (
uöt32_t
)(
tm¥eg
 & 
RTC_TR_RESERVED_MASK
);

424 
hπc
->
In°™˚
->
CR
 &(
uöt32_t
)~
RTC_CR_BCK
;

427 
hπc
->
In°™˚
->
CR
 |(
uöt32_t
)(
sTime
->
DayLightSavög
 | sTime->
St‹eO≥øti⁄
);

430 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)~
RTC_ISR_INIT
;

433 if(
	`HAL_RTC_WaôF‹Synchro
(
hπc
Ë!
HAL_OK
)

436 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

438 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

441 
	`__HAL_UNLOCK
(
hπc
);

443  
HAL_ERROR
;

447 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

449 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

451 
	`__HAL_UNLOCK
(
hπc
);

453  
HAL_OK
;

455 
	}
}

469 
HAL_SètusTy≥Def
 
	$HAL_RTC_SëD©e
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_D©eTy≥Def
 *
sD©e
, 
uöt32_t
 
F‹m©
)

471 
uöt32_t
 
d©ëm¥eg
 = 0;

474 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

477 
	`__HAL_LOCK
(
hπc
);

479 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

481 if((
F‹m©
 =
RTC_FORMAT_BIN
Ë&& ((
sD©e
->
M⁄th
 & 0x10) == 0x10))

483 
sD©e
->
M⁄th
 = (
uöt8_t
)((sDate->Month & (uint8_t)~(0x10)) + (uint8_t)0x0A);

486 
	`as£π_∑øm
(
	`IS_RTC_WEEKDAY
(
sD©e
->
WìkDay
));

488 if(
F‹m©
 =
RTC_FORMAT_BIN
)

490 
	`as£π_∑øm
(
	`IS_RTC_YEAR
(
sD©e
->
Yór
));

491 
	`as£π_∑øm
(
	`IS_RTC_MONTH
(
sD©e
->
M⁄th
));

492 
	`as£π_∑øm
(
	`IS_RTC_DATE
(
sD©e
->
D©e
));

494 
d©ëm¥eg
 = (((
uöt32_t
)
	`RTC_ByãToBcd2
(
sD©e
->
Yór
) << 16) | \

495 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sD©e
->
M⁄th
) << 8) | \

496 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sD©e
->
D©e
)) | \

497 ((
uöt32_t
)
sD©e
->
WìkDay
 << 13));

501 
	`as£π_∑øm
(
	`IS_RTC_YEAR
(
	`RTC_Bcd2ToByã
(
sD©e
->
Yór
)));

502 
d©ëm¥eg
 = 
	`RTC_Bcd2ToByã
(
sD©e
->
M⁄th
);

503 
	`as£π_∑øm
(
	`IS_RTC_MONTH
(
d©ëm¥eg
));

504 
d©ëm¥eg
 = 
	`RTC_Bcd2ToByã
(
sD©e
->
D©e
);

505 
	`as£π_∑øm
(
	`IS_RTC_DATE
(
d©ëm¥eg
));

507 
d©ëm¥eg
 = ((((
uöt32_t
)
sD©e
->
Yór
) << 16) | \

508 (((
uöt32_t
)
sD©e
->
M⁄th
) << 8) | \

509 ((
uöt32_t
)
sD©e
->
D©e
) | \

510 (((
uöt32_t
)
sD©e
->
WìkDay
) << 13));

514 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

517 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

520 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

523 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

526 
	`__HAL_UNLOCK
(
hπc
);

528  
HAL_ERROR
;

533 
hπc
->
In°™˚
->
DR
 = (
uöt32_t
)(
d©ëm¥eg
 & 
RTC_DR_RESERVED_MASK
);

536 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)~
RTC_ISR_INIT
;

539 if(
	`HAL_RTC_WaôF‹Synchro
(
hπc
Ë!
HAL_OK
)

542 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

544 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

547 
	`__HAL_UNLOCK
(
hπc
);

549  
HAL_ERROR
;

553 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

555 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
 ;

558 
	`__HAL_UNLOCK
(
hπc
);

560  
HAL_OK
;

562 
	}
}

578 
HAL_SètusTy≥Def
 
	$HAL_RTC_GëD©e
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_D©eTy≥Def
 *
sD©e
, 
uöt32_t
 
F‹m©
)

580 
uöt32_t
 
d©ëm¥eg
 = 0;

583 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

586 
d©ëm¥eg
 = (
uöt32_t
)(
hπc
->
In°™˚
->
DR
 & 
RTC_DR_RESERVED_MASK
);

589 
sD©e
->
Yór
 = (
uöt8_t
)((
d©ëm¥eg
 & (
RTC_DR_YT
 | 
RTC_DR_YU
)) >> 16);

590 
sD©e
->
M⁄th
 = (
uöt8_t
)((
d©ëm¥eg
 & (
RTC_DR_MT
 | 
RTC_DR_MU
)) >> 8);

591 
sD©e
->
D©e
 = (
uöt8_t
)(
d©ëm¥eg
 & (
RTC_DR_DT
 | 
RTC_DR_DU
));

592 
sD©e
->
WìkDay
 = (
uöt8_t
)((
d©ëm¥eg
 & (
RTC_DR_WDU
)) >> 13);

595 if(
F‹m©
 =
RTC_FORMAT_BIN
)

598 
sD©e
->
Yór
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sDate->Year);

599 
sD©e
->
M⁄th
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sDate->Month);

600 
sD©e
->
D©e
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sDate->Date);

602  
HAL_OK
;

603 
	}
}

633 
HAL_SètusTy≥Def
 
	$HAL_RTC_Dó˘iv©eAœrm
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Aœrm
)

635 
uöt32_t
 
tick°¨t
 = 0;

638 
	`as£π_∑øm
(
	`IS_RTC_ALARM
(
Aœrm
));

641 
	`__HAL_LOCK
(
hπc
);

643 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

646 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

648 if(
Aœrm
 =
RTC_ALARM_A
)

651 
	`__HAL_RTC_ALARMA_DISABLE
(
hπc
);

654 
	`__HAL_RTC_ALARM_DISABLE_IT
(
hπc
, 
RTC_IT_ALRA
);

656 
tick°¨t
 = 
	`HAL_GëTick
();

659 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRAWF
Ë=
RESET
)

661 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

664 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

666 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

669 
	`__HAL_UNLOCK
(
hπc
);

671  
HAL_TIMEOUT
;

678 
	`__HAL_RTC_ALARMB_DISABLE
(
hπc
);

681 
	`__HAL_RTC_ALARM_DISABLE_IT
(
hπc
,
RTC_IT_ALRB
);

683 
tick°¨t
 = 
	`HAL_GëTick
();

686 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRBWF
Ë=
RESET
)

688 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

691 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

693 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

696 
	`__HAL_UNLOCK
(
hπc
);

698  
HAL_TIMEOUT
;

703 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

705 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

708 
	`__HAL_UNLOCK
(
hπc
);

710  
HAL_OK
;

711 
	}
}

719 
	$HAL_RTC_AœrmIRQH™dÀr
(
RTC_H™dÀTy≥Def
* 
hπc
)

722 if(
	`__HAL_RTC_ALARM_GET_IT_SOURCE
(
hπc
, 
RTC_IT_ALRA
Ë!
RESET
)

725 if(
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRAF
Ë!
RESET
)

728 
	`HAL_RTC_AœrmAEvítCÆlback
(
hπc
);

731 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_ALRAF
);

736 if(
	`__HAL_RTC_ALARM_GET_IT_SOURCE
(
hπc
, 
RTC_IT_ALRB
Ë!
RESET
)

739 if(
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRBF
Ë!
RESET
)

742 
	`HAL_RTCEx_AœrmBEvítCÆlback
(
hπc
);

745 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_ALRBF
);

750 
	`__HAL_RTC_ALARM_EXTI_CLEAR_FLAG
();

753 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

754 
	}
}

762 
__wók
 
	$HAL_RTC_AœrmAEvítCÆlback
(
RTC_H™dÀTy≥Def
 *
hπc
)

765 
	`UNUSED
(
hπc
);

770 
	}
}

779 
HAL_SètusTy≥Def
 
	$HAL_RTC_PﬁlF‹AœrmAEvít
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Timeout
)

782 
uöt32_t
 
tick°¨t
 = 
	`HAL_GëTick
();

784 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRAF
Ë=
RESET
)

786 if(
Timeout
 !
HAL_MAX_DELAY
)

788 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

790 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

791  
HAL_TIMEOUT
;

797 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_ALRAF
);

800 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

802  
HAL_OK
;

803 
	}
}

829 
HAL_RTCSèãTy≥Def
 
	$HAL_RTC_GëSèã
(
RTC_H™dÀTy≥Def
* 
hπc
)

831  
hπc
->
Sèã
;

832 
	}
}

854 
HAL_SètusTy≥Def
 
	$RTC_E¡îInôMode
(
RTC_H™dÀTy≥Def
* 
hπc
)

856 
uöt32_t
 
tick°¨t
 = 0;

859 if((
hπc
->
In°™˚
->
ISR
 & 
RTC_ISR_INITF
Ë=(
uöt32_t
)
RESET
)

862 
hπc
->
In°™˚
->
ISR
 = (
uöt32_t
)
RTC_INIT_MASK
;

864 
tick°¨t
 = 
	`HAL_GëTick
();

866 (
hπc
->
In°™˚
->
ISR
 & 
RTC_ISR_INITF
Ë=(
uöt32_t
)
RESET
)

868 if((
	`HAL_GëTick
(Ë- 
tick°¨t
Ë> 
RTC_TIMEOUT_VALUE
)

870  
HAL_TIMEOUT
;

875  
HAL_OK
;

876 
	}
}

883 
uöt8_t
 
	$RTC_ByãToBcd2
(
uöt8_t
 
VÆue
)

885 
uöt32_t
 
bcdhigh
 = 0;

887 
VÆue
 >= 10)

889 
bcdhigh
++;

890 
VÆue
 -= 10;

893  ((
uöt8_t
)(
bcdhigh
 << 4Ë| 
VÆue
);

894 
	}
}

901 
uöt8_t
 
	$RTC_Bcd2ToByã
(
uöt8_t
 
VÆue
)

903 
uöt32_t
 
tmp
 = 0;

904 
tmp
 = ((
uöt8_t
)(
VÆue
 & (uint8_t)0xF0) >> (uint8_t)0x4) * 10;

905  (
tmp
 + (
VÆue
 & (
uöt8_t
)0x0F));

906 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rtc_ex.c

94 
	~"°m32l1xx_hÆ.h
"

104 #ifde‡
HAL_RTC_MODULE_ENABLED


129 
HAL_SètusTy≥Def
 
	$HAL_RTC_DeInô
(
RTC_H™dÀTy≥Def
 *
hπc
)

131 
uöt32_t
 
tick°¨t
 = 0;

134 
	`as£π_∑øm
(
	`IS_RTC_ALL_INSTANCE
(
hπc
->
In°™˚
));

137 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

140 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

143 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

146 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

149 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

151  
HAL_ERROR
;

156 
hπc
->
In°™˚
->
TR
 = (
uöt32_t
)0x00000000;

157 
hπc
->
In°™˚
->
DR
 = (
uöt32_t
)0x00002101;

159 
hπc
->
In°™˚
->
CR
 &(
uöt32_t
)0x00000007;

161 
tick°¨t
 = 
	`HAL_GëTick
();

164 ((
hπc
->
In°™˚
->
ISR
Ë& 
RTC_ISR_WUTWF
Ë=(
uöt32_t
)
RESET
)

166 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

169 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

172 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

174  
HAL_TIMEOUT
;

179 
hπc
->
In°™˚
->
CR
 &(
uöt32_t
)0x00000000;

180 
hπc
->
In°™˚
->
WUTR
 = (
uöt32_t
)0x0000FFFF;

181 
hπc
->
In°™˚
->
PRER
 = (
uöt32_t
)0x007F00FF;

182 
hπc
->
In°™˚
->
CALIBR
 = (
uöt32_t
)0x00000000;

183 
hπc
->
In°™˚
->
ALRMAR
 = (
uöt32_t
)0x00000000;

184 
hπc
->
In°™˚
->
ALRMBR
 = (
uöt32_t
)0x00000000;

185 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

186 
hπc
->
In°™˚
->
SHIFTR
 = (
uöt32_t
)0x00000000;

187 
hπc
->
In°™˚
->
CALR
 = (
uöt32_t
)0x00000000;

188 
hπc
->
In°™˚
->
ALRMASSR
 = (
uöt32_t
)0x00000000;

189 
hπc
->
In°™˚
->
ALRMBSSR
 = (
uöt32_t
)0x00000000;

192 
hπc
->
In°™˚
->
ISR
 = (
uöt32_t
)0x00000000;

195 
hπc
->
In°™˚
->
TAFCR
 = 0x00000000;

198 if(
	`HAL_RTC_WaôF‹Synchro
(
hπc
Ë!
HAL_OK
)

201 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

203 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

205  
HAL_ERROR
;

210 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

213 
	`HAL_RTC_M•DeInô
(
hπc
);

215 
hπc
->
Sèã
 = 
HAL_RTC_STATE_RESET
;

218 
	`__HAL_UNLOCK
(
hπc
);

220  
HAL_OK
;

221 
	}
}

253 
HAL_SètusTy≥Def
 
	$HAL_RTC_GëTime
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_TimeTy≥Def
 *
sTime
, 
uöt32_t
 
F‹m©
)

255 
uöt32_t
 
tm¥eg
 = 0;

258 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

260 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

262 
sTime
->
SubSec⁄ds
 = (
uöt32_t
)((
hπc
->
In°™˚
->
SSR
Ë& 
RTC_SSR_SS
);

265 
sTime
->
Sec⁄dFø˘i⁄
 = (
uöt32_t
)(
hπc
->
In°™˚
->
PRER
 & 
RTC_PRER_PREDIV_S
);

269 
tm¥eg
 = (
uöt32_t
)(
hπc
->
In°™˚
->
TR
 & 
RTC_TR_RESERVED_MASK
);

272 
sTime
->
Hours
 = (
uöt8_t
)((
tm¥eg
 & (
RTC_TR_HT
 | 
RTC_TR_HU
)) >> 16);

273 
sTime
->
Möuãs
 = (
uöt8_t
)((
tm¥eg
 & (
RTC_TR_MNT
 | 
RTC_TR_MNU
)) >>8);

274 
sTime
->
Sec⁄ds
 = (
uöt8_t
)(
tm¥eg
 & (
RTC_TR_ST
 | 
RTC_TR_SU
));

275 
sTime
->
TimeF‹m©
 = (
uöt8_t
)((
tm¥eg
 & (
RTC_TR_PM
)) >> 16);

278 if(
F‹m©
 =
RTC_FORMAT_BIN
)

281 
sTime
->
Hours
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTime->Hours);

282 
sTime
->
Möuãs
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTime->Minutes);

283 
sTime
->
Sec⁄ds
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTime->Seconds);

286  
HAL_OK
;

287 
	}
}

308 
HAL_SètusTy≥Def
 
	$HAL_RTC_SëAœrm
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_AœrmTy≥Def
 *
sAœrm
, 
uöt32_t
 
F‹m©
)

310 
uöt32_t
 
tick°¨t
 = 0;

311 
uöt32_t
 
tm¥eg
 = 0;

313 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

314 
uöt32_t
 
sub£c⁄dtm¥eg
 = 0;

318 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

319 
	`as£π_∑øm
(
	`IS_RTC_ALARM
(
sAœrm
->
Aœrm
));

320 
	`as£π_∑øm
(
	`IS_RTC_ALARM_MASK
(
sAœrm
->
AœrmMask
));

321 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_SEL
(
sAœrm
->
AœrmD©eWìkDaySñ
));

322 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

323 
	`as£π_∑øm
(
	`IS_RTC_ALARM_SUB_SECOND_VALUE
(
sAœrm
->
AœrmTime
.
SubSec⁄ds
));

324 
	`as£π_∑øm
(
	`IS_RTC_ALARM_SUB_SECOND_MASK
(
sAœrm
->
AœrmSubSec⁄dMask
));

328 
	`__HAL_LOCK
(
hπc
);

330 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

332 if(
F‹m©
 =
RTC_FORMAT_BIN
)

334 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_FMT
Ë!(
uöt32_t
)
RESET
)

336 
	`as£π_∑øm
(
	`IS_RTC_HOUR12
(
sAœrm
->
AœrmTime
.
Hours
));

337 
	`as£π_∑øm
(
	`IS_RTC_HOURFORMAT12
(
sAœrm
->
AœrmTime
.
TimeF‹m©
));

341 
sAœrm
->
AœrmTime
.
TimeF‹m©
 = 0x00;

342 
	`as£π_∑øm
(
	`IS_RTC_HOUR24
(
sAœrm
->
AœrmTime
.
Hours
));

344 
	`as£π_∑øm
(
	`IS_RTC_MINUTES
(
sAœrm
->
AœrmTime
.
Möuãs
));

345 
	`as£π_∑øm
(
	`IS_RTC_SECONDS
(
sAœrm
->
AœrmTime
.
Sec⁄ds
));

347 if(
sAœrm
->
AœrmD©eWìkDaySñ
 =
RTC_ALARMDATEWEEKDAYSEL_DATE
)

349 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
sAœrm
->
AœrmD©eWìkDay
));

353 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
sAœrm
->
AœrmD©eWìkDay
));

356 
tm¥eg
 = (((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmTime
.
Hours
) << 16) | \

357 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmTime
.
Möuãs
) << 8) | \

358 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmTime
.
Sec⁄ds
)) | \

359 ((
uöt32_t
)(
sAœrm
->
AœrmTime
.
TimeF‹m©
) << 16) | \

360 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmD©eWìkDay
) << 24) | \

361 ((
uöt32_t
)
sAœrm
->
AœrmD©eWìkDaySñ
) | \

362 ((
uöt32_t
)
sAœrm
->
AœrmMask
));

366 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_FMT
Ë!(
uöt32_t
)
RESET
)

368 
tm¥eg
 = 
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Hours
);

369 
	`as£π_∑øm
(
	`IS_RTC_HOUR12
(
tm¥eg
));

370 
	`as£π_∑øm
(
	`IS_RTC_HOURFORMAT12
(
sAœrm
->
AœrmTime
.
TimeF‹m©
));

374 
sAœrm
->
AœrmTime
.
TimeF‹m©
 = 0x00;

375 
	`as£π_∑øm
(
	`IS_RTC_HOUR24
(
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Hours
)));

378 
	`as£π_∑øm
(
	`IS_RTC_MINUTES
(
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Möuãs
)));

379 
	`as£π_∑øm
(
	`IS_RTC_SECONDS
(
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Sec⁄ds
)));

381 if(
sAœrm
->
AœrmD©eWìkDaySñ
 =
RTC_ALARMDATEWEEKDAYSEL_DATE
)

383 
tm¥eg
 = 
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmD©eWìkDay
);

384 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
tm¥eg
));

388 
tm¥eg
 = 
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmD©eWìkDay
);

389 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
tm¥eg
));

392 
tm¥eg
 = (((
uöt32_t
)(
sAœrm
->
AœrmTime
.
Hours
) << 16) | \

393 ((
uöt32_t
)(
sAœrm
->
AœrmTime
.
Möuãs
) << 8) | \

394 ((
uöt32_t
Ë
sAœrm
->
AœrmTime
.
Sec⁄ds
) | \

395 ((
uöt32_t
)(
sAœrm
->
AœrmTime
.
TimeF‹m©
) << 16) | \

396 ((
uöt32_t
)(
sAœrm
->
AœrmD©eWìkDay
) << 24) | \

397 ((
uöt32_t
)
sAœrm
->
AœrmD©eWìkDaySñ
) | \

398 ((
uöt32_t
)
sAœrm
->
AœrmMask
));

401 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

403 
sub£c⁄dtm¥eg
 = (
uöt32_t
)((uöt32_t)(
sAœrm
->
AœrmTime
.
SubSec⁄ds
Ë| (uöt32_t)(sAœrm->
AœrmSubSec⁄dMask
));

407 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

410 if(
sAœrm
->
Aœrm
 =
RTC_ALARM_A
)

413 
	`__HAL_RTC_ALARMA_DISABLE
(
hπc
);

416 
	`__HAL_RTC_ALARM_DISABLE_IT
(
hπc
, 
RTC_IT_ALRA
);

418 
tick°¨t
 = 
	`HAL_GëTick
();

420 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRAWF
Ë=
RESET
)

422 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

425 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

427 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

430 
	`__HAL_UNLOCK
(
hπc
);

432  
HAL_TIMEOUT
;

436 
hπc
->
In°™˚
->
ALRMAR
 = (
uöt32_t
)
tm¥eg
;

437 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

439 
hπc
->
In°™˚
->
ALRMASSR
 = 
sub£c⁄dtm¥eg
;

442 
	`__HAL_RTC_ALARMA_ENABLE
(
hπc
);

447 
	`__HAL_RTC_ALARMB_DISABLE
(
hπc
);

450 
	`__HAL_RTC_ALARM_DISABLE_IT
(
hπc
, 
RTC_IT_ALRB
);

452 
tick°¨t
 = 
	`HAL_GëTick
();

454 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRBWF
Ë=
RESET
)

456 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

459 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

461 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

464 
	`__HAL_UNLOCK
(
hπc
);

466  
HAL_TIMEOUT
;

470 
hπc
->
In°™˚
->
ALRMBR
 = (
uöt32_t
)
tm¥eg
;

471 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

473 
hπc
->
In°™˚
->
ALRMBSSR
 = 
sub£c⁄dtm¥eg
;

476 
	`__HAL_RTC_ALARMB_ENABLE
(
hπc
);

480 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

483 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

486 
	`__HAL_UNLOCK
(
hπc
);

488  
HAL_OK
;

489 
	}
}

505 
HAL_SètusTy≥Def
 
	$HAL_RTC_SëAœrm_IT
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_AœrmTy≥Def
 *
sAœrm
, 
uöt32_t
 
F‹m©
)

507 
uöt32_t
 
tick°¨t
 = 0;

508 
uöt32_t
 
tm¥eg
 = 0;

509 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

510 
uöt32_t
 
sub£c⁄dtm¥eg
 = 0;

514 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

515 
	`as£π_∑øm
(
	`IS_RTC_ALARM
(
sAœrm
->
Aœrm
));

516 
	`as£π_∑øm
(
	`IS_RTC_ALARM_MASK
(
sAœrm
->
AœrmMask
));

517 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_SEL
(
sAœrm
->
AœrmD©eWìkDaySñ
));

518 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

519 
	`as£π_∑øm
(
	`IS_RTC_ALARM_SUB_SECOND_VALUE
(
sAœrm
->
AœrmTime
.
SubSec⁄ds
));

520 
	`as£π_∑øm
(
	`IS_RTC_ALARM_SUB_SECOND_MASK
(
sAœrm
->
AœrmSubSec⁄dMask
));

524 
	`__HAL_LOCK
(
hπc
);

526 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

528 if(
F‹m©
 =
RTC_FORMAT_BIN
)

530 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_FMT
Ë!(
uöt32_t
)
RESET
)

532 
	`as£π_∑øm
(
	`IS_RTC_HOUR12
(
sAœrm
->
AœrmTime
.
Hours
));

533 
	`as£π_∑øm
(
	`IS_RTC_HOURFORMAT12
(
sAœrm
->
AœrmTime
.
TimeF‹m©
));

537 
sAœrm
->
AœrmTime
.
TimeF‹m©
 = 0x00;

538 
	`as£π_∑øm
(
	`IS_RTC_HOUR24
(
sAœrm
->
AœrmTime
.
Hours
));

540 
	`as£π_∑øm
(
	`IS_RTC_MINUTES
(
sAœrm
->
AœrmTime
.
Möuãs
));

541 
	`as£π_∑øm
(
	`IS_RTC_SECONDS
(
sAœrm
->
AœrmTime
.
Sec⁄ds
));

543 if(
sAœrm
->
AœrmD©eWìkDaySñ
 =
RTC_ALARMDATEWEEKDAYSEL_DATE
)

545 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
sAœrm
->
AœrmD©eWìkDay
));

549 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
sAœrm
->
AœrmD©eWìkDay
));

551 
tm¥eg
 = (((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmTime
.
Hours
) << 16) | \

552 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmTime
.
Möuãs
) << 8) | \

553 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmTime
.
Sec⁄ds
)) | \

554 ((
uöt32_t
)(
sAœrm
->
AœrmTime
.
TimeF‹m©
) << 16) | \

555 ((
uöt32_t
)
	`RTC_ByãToBcd2
(
sAœrm
->
AœrmD©eWìkDay
) << 24) | \

556 ((
uöt32_t
)
sAœrm
->
AœrmD©eWìkDaySñ
) | \

557 ((
uöt32_t
)
sAœrm
->
AœrmMask
));

561 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_FMT
Ë!(
uöt32_t
)
RESET
)

563 
tm¥eg
 = 
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Hours
);

564 
	`as£π_∑øm
(
	`IS_RTC_HOUR12
(
tm¥eg
));

565 
	`as£π_∑øm
(
	`IS_RTC_HOURFORMAT12
(
sAœrm
->
AœrmTime
.
TimeF‹m©
));

569 
sAœrm
->
AœrmTime
.
TimeF‹m©
 = 0x00;

570 
	`as£π_∑øm
(
	`IS_RTC_HOUR24
(
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Hours
)));

573 
	`as£π_∑øm
(
	`IS_RTC_MINUTES
(
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Möuãs
)));

574 
	`as£π_∑øm
(
	`IS_RTC_SECONDS
(
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmTime
.
Sec⁄ds
)));

576 if(
sAœrm
->
AœrmD©eWìkDaySñ
 =
RTC_ALARMDATEWEEKDAYSEL_DATE
)

578 
tm¥eg
 = 
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmD©eWìkDay
);

579 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_DATE
(
tm¥eg
));

583 
tm¥eg
 = 
	`RTC_Bcd2ToByã
(
sAœrm
->
AœrmD©eWìkDay
);

584 
	`as£π_∑øm
(
	`IS_RTC_ALARM_DATE_WEEKDAY_WEEKDAY
(
tm¥eg
));

586 
tm¥eg
 = (((
uöt32_t
)(
sAœrm
->
AœrmTime
.
Hours
) << 16) | \

587 ((
uöt32_t
)(
sAœrm
->
AœrmTime
.
Möuãs
) << 8) | \

588 ((
uöt32_t
Ë
sAœrm
->
AœrmTime
.
Sec⁄ds
) | \

589 ((
uöt32_t
)(
sAœrm
->
AœrmTime
.
TimeF‹m©
) << 16) | \

590 ((
uöt32_t
)(
sAœrm
->
AœrmD©eWìkDay
) << 24) | \

591 ((
uöt32_t
)
sAœrm
->
AœrmD©eWìkDaySñ
) | \

592 ((
uöt32_t
)
sAœrm
->
AœrmMask
));

594 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

596 
sub£c⁄dtm¥eg
 = (
uöt32_t
)((uöt32_t)(
sAœrm
->
AœrmTime
.
SubSec⁄ds
Ë| (uöt32_t)(sAœrm->
AœrmSubSec⁄dMask
));

600 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

603 if(
sAœrm
->
Aœrm
 =
RTC_ALARM_A
)

606 
	`__HAL_RTC_ALARMA_DISABLE
(
hπc
);

609 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_ALRAF
);

611 
tick°¨t
 = 
	`HAL_GëTick
();

613 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRAWF
Ë=
RESET
)

615 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

618 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

620 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

623 
	`__HAL_UNLOCK
(
hπc
);

625  
HAL_TIMEOUT
;

629 
hπc
->
In°™˚
->
ALRMAR
 = (
uöt32_t
)
tm¥eg
;

630 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

632 
hπc
->
In°™˚
->
ALRMASSR
 = 
sub£c⁄dtm¥eg
;

635 
	`__HAL_RTC_ALARMA_ENABLE
(
hπc
);

637 
	`__HAL_RTC_ALARM_ENABLE_IT
(
hπc
,
RTC_IT_ALRA
);

642 
	`__HAL_RTC_ALARMB_DISABLE
(
hπc
);

645 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_ALRBF
);

647 
tick°¨t
 = 
	`HAL_GëTick
();

649 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRBWF
Ë=
RESET
)

651 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

654 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

656 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

659 
	`__HAL_UNLOCK
(
hπc
);

661  
HAL_TIMEOUT
;

665 
hπc
->
In°™˚
->
ALRMBR
 = (
uöt32_t
)
tm¥eg
;

666 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

668 
hπc
->
In°™˚
->
ALRMBSSR
 = 
sub£c⁄dtm¥eg
;

671 
	`__HAL_RTC_ALARMB_ENABLE
(
hπc
);

673 
	`__HAL_RTC_ALARM_ENABLE_IT
(
hπc
, 
RTC_IT_ALRB
);

677 
	`__HAL_RTC_ALARM_EXTI_ENABLE_IT
();

679 
	`__HAL_RTC_ALARM_EXTI_ENABLE_RISING_EDGE
();

682 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

684 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

687 
	`__HAL_UNLOCK
(
hπc
);

689  
HAL_OK
;

690 
	}
}

707 
HAL_SètusTy≥Def
 
	$HAL_RTC_GëAœrm
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_AœrmTy≥Def
 *
sAœrm
, 
uöt32_t
 
Aœrm
, uöt32_à
F‹m©
)

709 
uöt32_t
 
tm¥eg
 = 0;

710 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

711 
uöt32_t
 
sub£c⁄dtm¥eg
 = 0;

715 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

716 
	`as£π_∑øm
(
	`IS_RTC_ALARM
(
Aœrm
));

718 if(
Aœrm
 =
RTC_ALARM_A
)

721 
sAœrm
->
Aœrm
 = 
RTC_ALARM_A
;

723 
tm¥eg
 = (
uöt32_t
)(
hπc
->
In°™˚
->
ALRMAR
);

724 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

725 
sub£c⁄dtm¥eg
 = (
uöt32_t
)((
hπc
->
In°™˚
->
ALRMASSR
Ë& 
RTC_ALRMASSR_SS
);

730 
sAœrm
->
Aœrm
 = 
RTC_ALARM_B
;

732 
tm¥eg
 = (
uöt32_t
)(
hπc
->
In°™˚
->
ALRMBR
);

733 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

734 
sub£c⁄dtm¥eg
 = (
uöt32_t
)((
hπc
->
In°™˚
->
ALRMBSSR
Ë& 
RTC_ALRMBSSR_SS
);

739 
sAœrm
->
AœrmTime
.
Hours
 = (
uöt32_t
)((
tm¥eg
 & (
RTC_ALRMAR_HT
 | 
RTC_ALRMAR_HU
)) >> 16);

740 
sAœrm
->
AœrmTime
.
Möuãs
 = (
uöt32_t
)((
tm¥eg
 & (
RTC_ALRMAR_MNT
 | 
RTC_ALRMAR_MNU
)) >> 8);

741 
sAœrm
->
AœrmTime
.
Sec⁄ds
 = (
uöt32_t
)(
tm¥eg
 & (
RTC_ALRMAR_ST
 | 
RTC_ALRMAR_SU
));

742 
sAœrm
->
AœrmTime
.
TimeF‹m©
 = (
uöt32_t
)((
tm¥eg
 & 
RTC_ALRMAR_PM
) >> 16);

743 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

744 
sAœrm
->
AœrmTime
.
SubSec⁄ds
 = (
uöt32_t
Ë
sub£c⁄dtm¥eg
;

746 
sAœrm
->
AœrmD©eWìkDay
 = (
uöt32_t
)((
tm¥eg
 & (
RTC_ALRMAR_DT
 | 
RTC_ALRMAR_DU
)) >> 24);

747 
sAœrm
->
AœrmD©eWìkDaySñ
 = (
uöt32_t
)(
tm¥eg
 & 
RTC_ALRMAR_WDSEL
);

748 
sAœrm
->
AœrmMask
 = (
uöt32_t
)(
tm¥eg
 & 
RTC_ALARMMASK_ALL
);

750 if(
F‹m©
 =
RTC_FORMAT_BIN
)

752 
sAœrm
->
AœrmTime
.
Hours
 = 
	`RTC_Bcd2ToByã
(sAlarm->AlarmTime.Hours);

753 
sAœrm
->
AœrmTime
.
Möuãs
 = 
	`RTC_Bcd2ToByã
(sAlarm->AlarmTime.Minutes);

754 
sAœrm
->
AœrmTime
.
Sec⁄ds
 = 
	`RTC_Bcd2ToByã
(sAlarm->AlarmTime.Seconds);

755 
sAœrm
->
AœrmD©eWìkDay
 = 
	`RTC_Bcd2ToByã
(sAlarm->AlarmDateWeekDay);

758  
HAL_OK
;

759 
	}
}

796 
HAL_SètusTy≥Def
 
	$HAL_RTC_WaôF‹Synchro
(
RTC_H™dÀTy≥Def
* 
hπc
)

798 
uöt32_t
 
tick°¨t
 = 0;

800 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

802 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_BYPSHAD
Ë=
RESET
)

806 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)
RTC_RSF_MASK
;

808 
tick°¨t
 = 
	`HAL_GëTick
();

811 (
hπc
->
In°™˚
->
ISR
 & 
RTC_ISR_RSF
Ë=(
uöt32_t
)
RESET
)

813 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

815  
HAL_TIMEOUT
;

820  
HAL_OK
;

821 
	}
}

872 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëTimeSèmp
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
TimeSèmpEdge
)

874 
uöt32_t
 
tm¥eg
 = 0;

877 
	`as£π_∑øm
(
	`IS_TIMESTAMP_EDGE
(
TimeSèmpEdge
));

880 
	`__HAL_LOCK
(
hπc
);

882 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

885 
tm¥eg
 = (
uöt32_t
)(
hπc
->
In°™˚
->
CR
 & (uöt32_t)~(
RTC_CR_TSEDGE
 | 
RTC_CR_TSE
));

887 
tm¥eg
|
TimeSèmpEdge
;

890 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

893 
hπc
->
In°™˚
->
CR
 = (
uöt32_t
)
tm¥eg
;

895 
	`__HAL_RTC_TIMESTAMP_ENABLE
(
hπc
);

898 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

901 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

904 
	`__HAL_UNLOCK
(
hπc
);

906  
HAL_OK
;

907 
	}
}

923 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëTimeSèmp_IT
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
TimeSèmpEdge
)

925 
uöt32_t
 
tm¥eg
 = 0;

928 
	`as£π_∑øm
(
	`IS_TIMESTAMP_EDGE
(
TimeSèmpEdge
));

931 
	`__HAL_LOCK
(
hπc
);

933 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

936 
tm¥eg
 = (
uöt32_t
)(
hπc
->
In°™˚
->
CR
 & (uöt32_t)~(
RTC_CR_TSEDGE
 | 
RTC_CR_TSE
));

938 
tm¥eg
 |
TimeSèmpEdge
;

941 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

944 
hπc
->
In°™˚
->
CR
 = (
uöt32_t
)
tm¥eg
;

946 
	`__HAL_RTC_TIMESTAMP_ENABLE
(
hπc
);

949 
	`__HAL_RTC_TIMESTAMP_ENABLE_IT
(
hπc
,
RTC_IT_TS
);

952 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_ENABLE_IT
();

954 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_ENABLE_RISING_EDGE
();

957 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

959 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

962 
	`__HAL_UNLOCK
(
hπc
);

964  
HAL_OK
;

965 
	}
}

973 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_Dó˘iv©eTimeSèmp
(
RTC_H™dÀTy≥Def
 *
hπc
)

975 
uöt32_t
 
tm¥eg
 = 0;

978 
	`__HAL_LOCK
(
hπc
);

980 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

983 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

986 
	`__HAL_RTC_TIMESTAMP_DISABLE_IT
(
hπc
, 
RTC_IT_TS
);

989 
tm¥eg
 = (
uöt32_t
)(
hπc
->
In°™˚
->
CR
 & (uöt32_t)~(
RTC_CR_TSEDGE
 | 
RTC_CR_TSE
));

992 
hπc
->
In°™˚
->
CR
 = (
uöt32_t
)
tm¥eg
;

995 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

997 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1000 
	`__HAL_UNLOCK
(
hπc
);

1002  
HAL_OK
;

1003 
	}
}

1017 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_GëTimeSèmp
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_TimeTy≥Def
* 
sTimeSèmp
, 
RTC_D©eTy≥Def
* 
sTimeSèmpD©e
, 
uöt32_t
 
F‹m©
)

1019 
uöt32_t
 
tm±ime
 = 0, 
tmpd©e
 = 0;

1022 
	`as£π_∑øm
(
	`IS_RTC_FORMAT
(
F‹m©
));

1025 
tm±ime
 = (
uöt32_t
)(
hπc
->
In°™˚
->
TSTR
 & 
RTC_TR_RESERVED_MASK
);

1026 
tmpd©e
 = (
uöt32_t
)(
hπc
->
In°™˚
->
TSDR
 & 
RTC_DR_RESERVED_MASK
);

1029 
sTimeSèmp
->
Hours
 = (
uöt8_t
)((
tm±ime
 & (
RTC_TR_HT
 | 
RTC_TR_HU
)) >> 16);

1030 
sTimeSèmp
->
Möuãs
 = (
uöt8_t
)((
tm±ime
 & (
RTC_TR_MNT
 | 
RTC_TR_MNU
)) >> 8);

1031 
sTimeSèmp
->
Sec⁄ds
 = (
uöt8_t
)(
tm±ime
 & (
RTC_TR_ST
 | 
RTC_TR_SU
));

1032 
sTimeSèmp
->
TimeF‹m©
 = (
uöt8_t
)((
tm±ime
 & (
RTC_TR_PM
)) >> 16);

1033 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1034 
sTimeSèmp
->
SubSec⁄ds
 = (
uöt32_t
)((
hπc
->
In°™˚
->
TSSSR
Ë& 
RTC_TSSSR_SS
);

1038 
sTimeSèmpD©e
->
Yór
 = 0;

1039 
sTimeSèmpD©e
->
M⁄th
 = (
uöt8_t
)((
tmpd©e
 & (
RTC_DR_MT
 | 
RTC_DR_MU
)) >> 8);

1040 
sTimeSèmpD©e
->
D©e
 = (
uöt8_t
)(
tmpd©e
 & (
RTC_DR_DT
 | 
RTC_DR_DU
));

1041 
sTimeSèmpD©e
->
WìkDay
 = (
uöt8_t
)((
tmpd©e
 & (
RTC_DR_WDU
)) >> 13);

1044 if(
F‹m©
 =
RTC_FORMAT_BIN
)

1047 
sTimeSèmp
->
Hours
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTimeStamp->Hours);

1048 
sTimeSèmp
->
Möuãs
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTimeStamp->Minutes);

1049 
sTimeSèmp
->
Sec⁄ds
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTimeStamp->Seconds);

1052 
sTimeSèmpD©e
->
M⁄th
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTimeStampDate->Month);

1053 
sTimeSèmpD©e
->
D©e
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTimeStampDate->Date);

1054 
sTimeSèmpD©e
->
WìkDay
 = (
uöt8_t
)
	`RTC_Bcd2ToByã
(sTimeStampDate->WeekDay);

1058 
	`__HAL_RTC_TIMESTAMP_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_TSF
);

1060  
HAL_OK
;

1061 
	}
}

1071 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëTam≥r
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_Tam≥rTy≥Def
* 
sTam≥r
)

1073 
uöt32_t
 
tm¥eg
 = 0;

1076 
	`as£π_∑øm
(
	`IS_RTC_TAMPER
(
sTam≥r
->
Tam≥r
));

1077 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_TRIGGER
(
sTam≥r
->
Triggî
));

1078 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1079 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_FILTER
(
sTam≥r
->
Fûãr
));

1080 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_SAMPLING_FREQ
(
sTam≥r
->
Sam∂ögFªquícy
));

1081 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_PRECHARGE_DURATION
(
sTam≥r
->
Pªch¨geDuøti⁄
));

1082 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_PULLUP_STATE
(
sTam≥r
->
Tam≥rPuŒUp
));

1083 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_TIMESTAMPONTAMPER_DETECTION
(
sTam≥r
->
TimeSèmpOnTam≥rDëe˘i⁄
));

1087 
	`__HAL_LOCK
(
hπc
);

1089 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

1091 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1092 if((
sTam≥r
->
Triggî
 =
RTC_TAMPERTRIGGER_RISINGEDGE
))

1095 
sTam≥r
->
Triggî
 = 
RTC_TAMPERTRIGGER_RISINGEDGE
;

1099 
sTam≥r
->
Triggî
 = (
uöt32_t
)(sTam≥r->
Tam≥r
 << 1);

1102 
tm¥eg
 = ((
uöt32_t
)
sTam≥r
->
Tam≥r
 | (uöt32_t)sTam≥r->
Triggî
 | (uöt32_t)sTam≥r->
Fûãr
 |\

1103 (
uöt32_t
)
sTam≥r
->
Sam∂ögFªquícy
 | (uöt32_t)sTam≥r->
Pªch¨geDuøti⁄
 |\

1104 (
uöt32_t
)
sTam≥r
->
Tam≥rPuŒUp
 | sTam≥r->
TimeSèmpOnTam≥rDëe˘i⁄
);

1106 
hπc
->
In°™˚
->
TAFCR
 &(
uöt32_t
)~((uöt32_t)
sTam≥r
->
Tam≥r
 | (uöt32_t)(sTam≥r->Tam≥∏<< 1Ë| (uöt32_t)
RTC_TAFCR_TAMPTS
 |\

1107 (
uöt32_t
)
RTC_TAFCR_TAMPFREQ
 | (uöt32_t)
RTC_TAFCR_TAMPFLT
 | (uöt32_t)
RTC_TAFCR_TAMPPRCH
 |\

1108 (
uöt32_t
)
RTC_TAFCR_TAMPPUDIS
 | (uöt32_t)
RTC_TAFCR_TAMPIE
);

1110 
tm¥eg
 = ((
uöt32_t
)
sTam≥r
->
Tam≥r
 | (uöt32_t)(sTam≥r->
Triggî
));

1112 
hπc
->
In°™˚
->
TAFCR
 &(
uöt32_t
)~((uöt32_t)
RTC_TAFCR_TAMP1E
 | (uöt32_t)
RTC_TAFCR_TAMP1TRG
);

1115 
hπc
->
In°™˚
->
TAFCR
 |
tm¥eg
;

1117 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1120 
	`__HAL_UNLOCK
(
hπc
);

1122  
HAL_OK
;

1123 
	}
}

1133 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëTam≥r_IT
(
RTC_H™dÀTy≥Def
 *
hπc
, 
RTC_Tam≥rTy≥Def
* 
sTam≥r
)

1135 
uöt32_t
 
tm¥eg
 = 0;

1138 
	`as£π_∑øm
(
	`IS_RTC_TAMPER
(
sTam≥r
->
Tam≥r
));

1139 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_TRIGGER
(
sTam≥r
->
Triggî
));

1140 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1141 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_FILTER
(
sTam≥r
->
Fûãr
));

1142 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_SAMPLING_FREQ
(
sTam≥r
->
Sam∂ögFªquícy
));

1143 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_PRECHARGE_DURATION
(
sTam≥r
->
Pªch¨geDuøti⁄
));

1144 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_PULLUP_STATE
(
sTam≥r
->
Tam≥rPuŒUp
));

1145 
	`as£π_∑øm
(
	`IS_RTC_TAMPER_TIMESTAMPONTAMPER_DETECTION
(
sTam≥r
->
TimeSèmpOnTam≥rDëe˘i⁄
));

1149 
	`__HAL_LOCK
(
hπc
);

1151 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

1153 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1155 if((
sTam≥r
->
Triggî
 =
RTC_TAMPERTRIGGER_RISINGEDGE
))

1157 
sTam≥r
->
Triggî
 = 
RTC_TAMPERTRIGGER_RISINGEDGE
;

1161 
sTam≥r
->
Triggî
 = (
uöt32_t
Ë(sTam≥r->
Tam≥r
<<1);

1164 
tm¥eg
 = ((
uöt32_t
)
sTam≥r
->
Tam≥r
 | (uöt32_t)sTam≥r->
Triggî
 | (uöt32_t)sTam≥r->
Fûãr
 |\

1165 (
uöt32_t
)
sTam≥r
->
Sam∂ögFªquícy
 | (uöt32_t)sTam≥r->
Pªch¨geDuøti⁄
 |\

1166 (
uöt32_t
)
sTam≥r
->
Tam≥rPuŒUp
 | sTam≥r->
TimeSèmpOnTam≥rDëe˘i⁄
);

1168 
hπc
->
In°™˚
->
TAFCR
 &(
uöt32_t
)~((uöt32_t)
sTam≥r
->
Tam≥r
 | (uöt32_t)(sTam≥r->Tam≥∏<< 1Ë| (uöt32_t)
RTC_TAFCR_TAMPTS
 |\

1169 (
uöt32_t
)
RTC_TAFCR_TAMPFREQ
 | (uöt32_t)
RTC_TAFCR_TAMPFLT
 | (uöt32_t)
RTC_TAFCR_TAMPPRCH
 |\

1170 (
uöt32_t
)
RTC_TAFCR_TAMPPUDIS
);

1172 
tm¥eg
 = ((
uöt32_t
)
sTam≥r
->
Tam≥r
 | (uöt32_t)sTam≥r->
Triggî
);

1174 
hπc
->
In°™˚
->
TAFCR
 &(
uöt32_t
)~((uöt32_t)
RTC_TAFCR_TAMP1E
 | (uöt32_t)
RTC_TAFCR_TAMP1TRG
 | (uöt32_t)
RTC_TAFCR_TAMPIE
);

1176 
hπc
->
In°™˚
->
TAFCR
 |
tm¥eg
;

1179 
hπc
->
In°™˚
->
TAFCR
 |(
uöt32_t
)
RTC_TAFCR_TAMPIE
;

1182 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_ENABLE_IT
();

1184 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_ENABLE_RISING_EDGE
();

1186 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1189 
	`__HAL_UNLOCK
(
hπc
);

1191  
HAL_OK
;

1192 
	}
}

1202 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_Dó˘iv©eTam≥r
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Tam≥r
)

1204 
	`as£π_∑øm
(
	`IS_RTC_TAMPER
(
Tam≥r
));

1207 
	`__HAL_LOCK
(
hπc
);

1209 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

1212 
hπc
->
In°™˚
->
TAFCR
 &(
uöt32_t
)~
Tam≥r
;

1214 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1217 
	`__HAL_UNLOCK
(
hπc
);

1219  
HAL_OK
;

1220 
	}
}

1228 
	$HAL_RTCEx_Tam≥rTimeSèmpIRQH™dÀr
(
RTC_H™dÀTy≥Def
 *
hπc
)

1231 if(
	`__HAL_RTC_TIMESTAMP_GET_IT_SOURCE
(
hπc
, 
RTC_IT_TS
Ë!
RESET
)

1234 if(
	`__HAL_RTC_TIMESTAMP_GET_FLAG
(
hπc
, 
RTC_FLAG_TSF
Ë!
RESET
)

1237 
	`HAL_RTCEx_TimeSèmpEvítCÆlback
(
hπc
);

1240 
	`__HAL_RTC_TIMESTAMP_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_TSF
);

1245 if(
	`__HAL_RTC_TAMPER_GET_IT_SOURCE
(
hπc
, 
RTC_IT_TAMP
 | 
RTC_IT_TAMP1
Ë!
RESET
)

1248 if(
	`__HAL_RTC_TAMPER_GET_FLAG
(
hπc
, 
RTC_FLAG_TAMP1F
Ë!
RESET
)

1251 
	`HAL_RTCEx_Tam≥r1EvítCÆlback
(
hπc
);

1254 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_TAMP1F
);

1258 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1260 if(
	`__HAL_RTC_TAMPER_GET_IT_SOURCE
(
hπc
, 
RTC_IT_TAMP
 | 
RTC_IT_TAMP2
Ë!
RESET
)

1263 if(
	`__HAL_RTC_TAMPER_GET_FLAG
(
hπc
, 
RTC_FLAG_TAMP2F
Ë!
RESET
)

1266 
	`HAL_RTCEx_Tam≥r2EvítCÆlback
(
hπc
);

1269 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_TAMP2F
);

1274 if(
	`__HAL_RTC_TAMPER_GET_IT_SOURCE
(
hπc
, 
RTC_IT_TAMP
 | 
RTC_IT_TAMP3
Ë!
RESET
)

1277 if(
	`__HAL_RTC_TAMPER_GET_FLAG
(
hπc
, 
RTC_FLAG_TAMP3F
Ë!
RESET
)

1280 
	`HAL_RTCEx_Tam≥r3EvítCÆlback
(
hπc
);

1283 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_TAMP3F
);

1289 
	`__HAL_RTC_TAMPER_TIMESTAMP_EXTI_CLEAR_FLAG
();

1292 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1293 
	}
}

1301 
__wók
 
	$HAL_RTCEx_TimeSèmpEvítCÆlback
(
RTC_H™dÀTy≥Def
 *
hπc
)

1304 
	`UNUSED
(
hπc
);

1309 
	}
}

1317 
__wók
 
	$HAL_RTCEx_Tam≥r1EvítCÆlback
(
RTC_H™dÀTy≥Def
 *
hπc
)

1320 
	`UNUSED
(
hπc
);

1325 
	}
}

1327 #i‡
deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1334 
__wók
 
	$HAL_RTCEx_Tam≥r2EvítCÆlback
(
RTC_H™dÀTy≥Def
 *
hπc
)

1337 
	`UNUSED
(
hπc
);

1342 
	}
}

1349 
__wók
 
	$HAL_RTCEx_Tam≥r3EvítCÆlback
(
RTC_H™dÀTy≥Def
 *
hπc
)

1352 
	`UNUSED
(
hπc
);

1357 
	}
}

1367 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_PﬁlF‹TimeSèmpEvít
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Timeout
)

1369 
uöt32_t
 
tick°¨t
 = 
	`HAL_GëTick
();

1371 
	`__HAL_RTC_TIMESTAMP_GET_FLAG
(
hπc
, 
RTC_FLAG_TSF
Ë=
RESET
)

1373 if(
	`__HAL_RTC_TIMESTAMP_GET_FLAG
(
hπc
, 
RTC_FLAG_TSOVF
Ë!
RESET
)

1376 
	`__HAL_RTC_TIMESTAMP_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_TSOVF
);

1379 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

1381  
HAL_ERROR
;

1384 if(
Timeout
 !
HAL_MAX_DELAY
)

1386 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1388 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1389  
HAL_TIMEOUT
;

1395 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1397  
HAL_OK
;

1398 
	}
}

1407 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_PﬁlF‹Tam≥r1Evít
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Timeout
)

1409 
uöt32_t
 
tick°¨t
 = 
	`HAL_GëTick
();

1412 
	`__HAL_RTC_TAMPER_GET_FLAG
(
hπc
,
RTC_FLAG_TAMP1F
)=
RESET
)

1414 if(
Timeout
 !
HAL_MAX_DELAY
)

1416 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1418 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1419  
HAL_TIMEOUT
;

1425 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
hπc
,
RTC_FLAG_TAMP1F
);

1428 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1430  
HAL_OK
;

1431 
	}
}

1433 #i‡
deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

1441 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_PﬁlF‹Tam≥r2Evít
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Timeout
)

1443 
uöt32_t
 
tick°¨t
 = 
	`HAL_GëTick
();

1446 
	`__HAL_RTC_TAMPER_GET_FLAG
(
hπc
,
RTC_FLAG_TAMP2F
Ë=
RESET
)

1448 if(
Timeout
 !
HAL_MAX_DELAY
)

1450 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1452 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1453  
HAL_TIMEOUT
;

1459 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
hπc
,
RTC_FLAG_TAMP2F
);

1462 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1464  
HAL_OK
;

1465 
	}
}

1473 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_PﬁlF‹Tam≥r3Evít
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Timeout
)

1475 
uöt32_t
 
tick°¨t
 = 
	`HAL_GëTick
();

1478 
	`__HAL_RTC_TAMPER_GET_FLAG
(
hπc
,
RTC_FLAG_TAMP3F
Ë=
RESET
)

1480 if(
Timeout
 !
HAL_MAX_DELAY
)

1482 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1484 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1485  
HAL_TIMEOUT
;

1491 
	`__HAL_RTC_TAMPER_CLEAR_FLAG
(
hπc
,
RTC_FLAG_TAMP3F
);

1494 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1496  
HAL_OK
;

1497 
	}
}

1525 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëWakeUpTimî
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
WakeUpCou¡î
, uöt32_à
WakeUpClock
)

1527 
uöt32_t
 
tick°¨t
 = 0;

1530 
	`as£π_∑øm
(
	`IS_RTC_WAKEUP_CLOCK
(
WakeUpClock
));

1531 
	`as£π_∑øm
(
	`IS_RTC_WAKEUP_COUNTER
(
WakeUpCou¡î
));

1534 
	`__HAL_LOCK
(
hπc
);

1536 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

1539 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

1542 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_WUTE
Ë!
RESET
){

1543 
tick°¨t
 = 
	`HAL_GëTick
();

1546 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
hπc
, 
RTC_FLAG_WUTWF
Ë=
SET
)

1548 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

1551 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1553 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1556 
	`__HAL_UNLOCK
(
hπc
);

1558  
HAL_TIMEOUT
;

1563 
	`__HAL_RTC_WAKEUPTIMER_DISABLE
(
hπc
);

1565 
tick°¨t
 = 
	`HAL_GëTick
();

1568 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
hπc
, 
RTC_FLAG_WUTWF
Ë=
RESET
)

1570 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

1573 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1575 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1578 
	`__HAL_UNLOCK
(
hπc
);

1580  
HAL_TIMEOUT
;

1585 
hπc
->
In°™˚
->
CR
 &(
uöt32_t
)~
RTC_CR_WUCKSEL
;

1588 
hπc
->
In°™˚
->
CR
 |(
uöt32_t
)
WakeUpClock
;

1591 
hπc
->
In°™˚
->
WUTR
 = (
uöt32_t
)
WakeUpCou¡î
;

1594 
	`__HAL_RTC_WAKEUPTIMER_ENABLE
(
hπc
);

1597 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1599 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1602 
	`__HAL_UNLOCK
(
hπc
);

1604  
HAL_OK
;

1605 
	}
}

1614 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëWakeUpTimî_IT
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
WakeUpCou¡î
, uöt32_à
WakeUpClock
)

1616 
uöt32_t
 
tick°¨t
 = 0;

1619 
	`as£π_∑øm
(
	`IS_RTC_WAKEUP_CLOCK
(
WakeUpClock
));

1620 
	`as£π_∑øm
(
	`IS_RTC_WAKEUP_COUNTER
(
WakeUpCou¡î
));

1623 
	`__HAL_LOCK
(
hπc
);

1625 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

1628 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

1631 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_WUTE
Ë!
RESET
){

1632 
tick°¨t
 = 
	`HAL_GëTick
();

1635 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
hπc
, 
RTC_FLAG_WUTWF
Ë=
SET
)

1637 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

1640 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1642 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1645 
	`__HAL_UNLOCK
(
hπc
);

1647  
HAL_TIMEOUT
;

1653 
	`__HAL_RTC_WAKEUPTIMER_DISABLE
(
hπc
);

1656 
	`__HAL_RTC_WAKEUPTIMER_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_WUTF
);

1658 
tick°¨t
 = 
	`HAL_GëTick
();

1661 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
hπc
, 
RTC_FLAG_WUTWF
Ë=
RESET
)

1663 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

1666 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1668 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1671 
	`__HAL_UNLOCK
(
hπc
);

1673  
HAL_TIMEOUT
;

1678 
hπc
->
In°™˚
->
WUTR
 = (
uöt32_t
)
WakeUpCou¡î
;

1681 
hπc
->
In°™˚
->
CR
 &(
uöt32_t
)~
RTC_CR_WUCKSEL
;

1684 
hπc
->
In°™˚
->
CR
 |(
uöt32_t
)
WakeUpClock
;

1687 
	`__HAL_RTC_WAKEUPTIMER_EXTI_ENABLE_IT
();

1689 
	`__HAL_RTC_WAKEUPTIMER_EXTI_ENABLE_RISING_EDGE
();

1692 
	`__HAL_RTC_WAKEUPTIMER_ENABLE_IT
(
hπc
,
RTC_IT_WUT
);

1695 
	`__HAL_RTC_WAKEUPTIMER_ENABLE
(
hπc
);

1698 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1700 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1703 
	`__HAL_UNLOCK
(
hπc
);

1705  
HAL_OK
;

1706 
	}
}

1714 
uöt32_t
 
	$HAL_RTCEx_Dó˘iv©eWakeUpTimî
(
RTC_H™dÀTy≥Def
 *
hπc
)

1716 
uöt32_t
 
tick°¨t
 = 0;

1719 
	`__HAL_LOCK
(
hπc
);

1721 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

1724 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

1727 
	`__HAL_RTC_WAKEUPTIMER_DISABLE
(
hπc
);

1730 
	`__HAL_RTC_WAKEUPTIMER_DISABLE_IT
(
hπc
,
RTC_IT_WUT
);

1732 
tick°¨t
 = 
	`HAL_GëTick
();

1734 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
hπc
, 
RTC_FLAG_WUTWF
Ë=
RESET
)

1736 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

1739 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1741 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1744 
	`__HAL_UNLOCK
(
hπc
);

1746  
HAL_TIMEOUT
;

1751 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1753 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1756 
	`__HAL_UNLOCK
(
hπc
);

1758  
HAL_OK
;

1759 
	}
}

1767 
uöt32_t
 
	$HAL_RTCEx_GëWakeUpTimî
(
RTC_H™dÀTy≥Def
 *
hπc
)

1770  ((
uöt32_t
)(
hπc
->
In°™˚
->
WUTR
 & 
RTC_WUTR_WUT
));

1771 
	}
}

1779 
	$HAL_RTCEx_WakeUpTimîIRQH™dÀr
(
RTC_H™dÀTy≥Def
 *
hπc
)

1782 if(
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
hπc
, 
RTC_FLAG_WUTF
Ë!
RESET
)

1785 
	`HAL_RTCEx_WakeUpTimîEvítCÆlback
(
hπc
);

1788 
	`__HAL_RTC_WAKEUPTIMER_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_WUTF
);

1793 
	`__HAL_RTC_WAKEUPTIMER_EXTI_CLEAR_FLAG
();

1796 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1797 
	}
}

1805 
__wók
 
	$HAL_RTCEx_WakeUpTimîEvítCÆlback
(
RTC_H™dÀTy≥Def
 *
hπc
)

1808 
	`UNUSED
(
hπc
);

1813 
	}
}

1822 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_PﬁlF‹WakeUpTimîEvít
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Timeout
)

1824 
uöt32_t
 
tick°¨t
 = 
	`HAL_GëTick
();

1826 
	`__HAL_RTC_WAKEUPTIMER_GET_FLAG
(
hπc
, 
RTC_FLAG_WUTF
Ë=
RESET
)

1828 if(
Timeout
 !
HAL_MAX_DELAY
)

1830 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1832 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

1834  
HAL_TIMEOUT
;

1840 
	`__HAL_RTC_WAKEUPTIMER_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_WUTF
);

1843 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1845  
HAL_OK
;

1846 
	}
}

1888 
	$HAL_RTCEx_BKUPWrôe
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
BackupRegi°î
, uöt32_à
D©a
)

1890 
uöt32_t
 
tmp
 = 0;

1893 
	`as£π_∑øm
(
	`IS_RTC_BKP
(
BackupRegi°î
));

1895 
tmp
 = (
uöt32_t
)&(
hπc
->
In°™˚
->
BKP0R
);

1896 
tmp
 +(
BackupRegi°î
 * 4);

1899 *(
__IO
 
uöt32_t
 *)
tmp
 = (uöt32_t)
D©a
;

1900 
	}
}

1911 
uöt32_t
 
	$HAL_RTCEx_BKUPRód
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
BackupRegi°î
)

1913 
uöt32_t
 
tmp
 = 0;

1916 
	`as£π_∑øm
(
	`IS_RTC_BKP
(
BackupRegi°î
));

1918 
tmp
 = (
uöt32_t
)&(
hπc
->
In°™˚
->
BKP0R
);

1919 
tmp
 +(
BackupRegi°î
 * 4);

1922  (*(
__IO
 
uöt32_t
 *)
tmp
);

1923 
	}
}

1942 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëCﬂr£CÆib
(
RTC_H™dÀTy≥Def
* 
hπc
, 
uöt32_t
 
CÆibSign
, uöt32_à
VÆue
)

1945 
	`as£π_∑øm
(
	`IS_RTC_CALIB_SIGN
(
CÆibSign
));

1946 
	`as£π_∑øm
(
	`IS_RTC_CALIB_VALUE
(
VÆue
));

1949 
	`__HAL_LOCK
(
hπc
);

1951 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

1954 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

1957 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

1960 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1963 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

1966 
	`__HAL_UNLOCK
(
hπc
);

1968  
HAL_ERROR
;

1973 
	`__HAL_RTC_COARSE_CALIB_ENABLE
(
hπc
);

1976 
hπc
->
In°™˚
->
CALIBR
 = (
uöt32_t
)(
CÆibSign
|
VÆue
);

1979 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)~
RTC_ISR_INIT
;

1983 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

1986 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

1989 
	`__HAL_UNLOCK
(
hπc
);

1991  
HAL_OK
;

1992 
	}
}

2000 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_Dó˘iv©eCﬂr£CÆib
(
RTC_H™dÀTy≥Def
* 
hπc
)

2003 
	`__HAL_LOCK
(
hπc
);

2005 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2008 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2011 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

2014 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2017 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

2020 
	`__HAL_UNLOCK
(
hπc
);

2022  
HAL_ERROR
;

2027 
	`__HAL_RTC_COARSE_CALIB_DISABLE
(
hπc
);

2030 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)~
RTC_ISR_INIT
;

2034 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2037 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2040 
	`__HAL_UNLOCK
(
hπc
);

2042  
HAL_OK
;

2043 
	}
}

2045 #i‡
deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

2066 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëSmoŸhCÆib
(
RTC_H™dÀTy≥Def
* 
hπc
, 
uöt32_t
 
SmoŸhCÆibPîiod
, uöt32_à
SmoŸhCÆibPlusPul£s
, uöt32_à
SmoŸhCÆibMöusPul£sVÆue
)

2068 
uöt32_t
 
tick°¨t
 = 0;

2071 
	`as£π_∑øm
(
	`IS_RTC_SMOOTH_CALIB_PERIOD
(
SmoŸhCÆibPîiod
));

2072 
	`as£π_∑øm
(
	`IS_RTC_SMOOTH_CALIB_PLUS
(
SmoŸhCÆibPlusPul£s
));

2073 
	`as£π_∑øm
(
	`IS_RTC_SMOOTH_CALIB_MINUS
(
SmoŸhCÆibMöusPul£sVÆue
));

2076 
	`__HAL_LOCK
(
hπc
);

2078 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2081 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2084 if((
hπc
->
In°™˚
->
ISR
 & 
RTC_ISR_RECALPF
Ë!
RESET
)

2086 
tick°¨t
 = 
	`HAL_GëTick
();

2089 (
hπc
->
In°™˚
->
ISR
 & 
RTC_ISR_RECALPF
Ë!
RESET
)

2091 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

2094 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2097 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

2100 
	`__HAL_UNLOCK
(
hπc
);

2102  
HAL_TIMEOUT
;

2108 
hπc
->
In°™˚
->
CALR
 = (
uöt32_t
)((uöt32_t)
SmoŸhCÆibPîiod
 | (uöt32_t)
SmoŸhCÆibPlusPul£s
 | (uöt32_t)
SmoŸhCÆibMöusPul£sVÆue
);

2111 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2114 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2117 
	`__HAL_UNLOCK
(
hπc
);

2119  
HAL_OK
;

2120 
	}
}

2135 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëSynchroShi·
(
RTC_H™dÀTy≥Def
* 
hπc
, 
uöt32_t
 
Shi·Add1S
, uöt32_à
Shi·SubFS
)

2137 
uöt32_t
 
tick°¨t
 = 0;

2140 
	`as£π_∑øm
(
	`IS_RTC_SHIFT_ADD1S
(
Shi·Add1S
));

2141 
	`as£π_∑øm
(
	`IS_RTC_SHIFT_SUBFS
(
Shi·SubFS
));

2144 
	`__HAL_LOCK
(
hπc
);

2146 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2149 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2151 
tick°¨t
 = 
	`HAL_GëTick
();

2154 (
hπc
->
In°™˚
->
ISR
 & 
RTC_ISR_SHPF
Ë!
RESET
)

2156 if((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > 
RTC_TIMEOUT_VALUE
)

2159 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2161 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

2164 
	`__HAL_UNLOCK
(
hπc
);

2166  
HAL_TIMEOUT
;

2171 if((
hπc
->
In°™˚
->
CR
 & 
RTC_CR_REFCKON
Ë=
RESET
)

2174 
hπc
->
In°™˚
->
SHIFTR
 = (
uöt32_t
)(uöt32_t)(
Shi·SubFS
Ë| (uöt32_t)(
Shi·Add1S
);

2177 if(
	`HAL_RTC_WaôF‹Synchro
(
hπc
Ë!
HAL_OK
)

2180 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2182 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

2185 
	`__HAL_UNLOCK
(
hπc
);

2187  
HAL_ERROR
;

2193 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2196 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

2199 
	`__HAL_UNLOCK
(
hπc
);

2201  
HAL_ERROR
;

2205 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2208 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2211 
	`__HAL_UNLOCK
(
hπc
);

2213  
HAL_OK
;

2214 
	}
}

2218 #i‡
deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

2229 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëCÆibøti⁄OutPut
(
RTC_H™dÀTy≥Def
* 
hπc
, 
uöt32_t
 
CÆibOuçut
)

2236 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëCÆibøti⁄OutPut
(
RTC_H™dÀTy≥Def
* 
hπc
)

2239 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

2241 
	`as£π_∑øm
(
	`IS_RTC_CALIB_OUTPUT
(
CÆibOuçut
));

2245 
	`__HAL_LOCK
(
hπc
);

2247 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2250 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2252 #i‡
	`deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

2254 
hπc
->
In°™˚
->
CR
 &(
uöt32_t
)~
RTC_CR_COSEL
;

2257 
hπc
->
In°™˚
->
CR
 |(
uöt32_t
)
CÆibOuçut
;

2260 
	`__HAL_RTC_CALIBRATION_OUTPUT_ENABLE
(
hπc
);

2263 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2266 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2269 
	`__HAL_UNLOCK
(
hπc
);

2271  
HAL_OK
;

2272 
	}
}

2280 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_Dó˘iv©eCÆibøti⁄OutPut
(
RTC_H™dÀTy≥Def
* 
hπc
)

2283 
	`__HAL_LOCK
(
hπc
);

2285 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2288 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2290 
	`__HAL_RTC_CALIBRATION_OUTPUT_DISABLE
(
hπc
);

2293 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2296 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2299 
	`__HAL_UNLOCK
(
hπc
);

2301  
HAL_OK
;

2302 
	}
}

2310 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_SëRefClock
(
RTC_H™dÀTy≥Def
* 
hπc
)

2313 
	`__HAL_LOCK
(
hπc
);

2315 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2318 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2321 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

2324 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2327 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

2330 
	`__HAL_UNLOCK
(
hπc
);

2332  
HAL_ERROR
;

2336 
	`__HAL_RTC_CLOCKREF_DETECTION_ENABLE
(
hπc
);

2339 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)~
RTC_ISR_INIT
;

2343 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2346 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2349 
	`__HAL_UNLOCK
(
hπc
);

2351  
HAL_OK
;

2352 
	}
}

2360 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_Dó˘iv©eRefClock
(
RTC_H™dÀTy≥Def
* 
hπc
)

2363 
	`__HAL_LOCK
(
hπc
);

2365 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2368 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2371 if(
	`RTC_E¡îInôMode
(
hπc
Ë!
HAL_OK
)

2374 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2377 
hπc
->
Sèã
 = 
HAL_RTC_STATE_ERROR
;

2380 
	`__HAL_UNLOCK
(
hπc
);

2382  
HAL_ERROR
;

2386 
	`__HAL_RTC_CLOCKREF_DETECTION_DISABLE
(
hπc
);

2389 
hπc
->
In°™˚
->
ISR
 &(
uöt32_t
)~
RTC_ISR_INIT
;

2393 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2396 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2399 
	`__HAL_UNLOCK
(
hπc
);

2401  
HAL_OK
;

2402 
	}
}

2404 #i‡
deföed
(
STM32L100xBA
Ë|| deföed (
STM32L151xBA
Ë|| deföed (
STM32L152xBA
Ë|| deföed(
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed(
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed(
STM32L151xE
Ë|| deföed(
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

2413 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_E«bÀBy∑ssShadow
(
RTC_H™dÀTy≥Def
* 
hπc
)

2416 
	`__HAL_LOCK
(
hπc
);

2418 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2421 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2424 
hπc
->
In°™˚
->
CR
 |(
uöt8_t
)
RTC_CR_BYPSHAD
;

2427 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2430 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2433 
	`__HAL_UNLOCK
(
hπc
);

2435  
HAL_OK
;

2436 
	}
}

2446 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_DißbÀBy∑ssShadow
(
RTC_H™dÀTy≥Def
* 
hπc
)

2449 
	`__HAL_LOCK
(
hπc
);

2451 
hπc
->
Sèã
 = 
HAL_RTC_STATE_BUSY
;

2454 
	`__HAL_RTC_WRITEPROTECTION_DISABLE
(
hπc
);

2457 
hπc
->
In°™˚
->
CR
 &(
uöt8_t
)~
RTC_CR_BYPSHAD
;

2460 
	`__HAL_RTC_WRITEPROTECTION_ENABLE
(
hπc
);

2463 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2466 
	`__HAL_UNLOCK
(
hπc
);

2468  
HAL_OK
;

2469 
	}
}

2497 
__wók
 
	$HAL_RTCEx_AœrmBEvítCÆlback
(
RTC_H™dÀTy≥Def
 *
hπc
)

2500 
	`UNUSED
(
hπc
);

2505 
	}
}

2514 
HAL_SètusTy≥Def
 
	$HAL_RTCEx_PﬁlF‹AœrmBEvít
(
RTC_H™dÀTy≥Def
 *
hπc
, 
uöt32_t
 
Timeout
)

2516 
uöt32_t
 
tick°¨t
 = 
	`HAL_GëTick
();

2518 
	`__HAL_RTC_ALARM_GET_FLAG
(
hπc
, 
RTC_FLAG_ALRBF
Ë=
RESET
)

2520 if(
Timeout
 !
HAL_MAX_DELAY
)

2522 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

2524 
hπc
->
Sèã
 = 
HAL_RTC_STATE_TIMEOUT
;

2525  
HAL_TIMEOUT
;

2531 
	`__HAL_RTC_ALARM_CLEAR_FLAG
(
hπc
, 
RTC_FLAG_ALRBF
);

2534 
hπc
->
Sèã
 = 
HAL_RTC_STATE_READY
;

2536  
HAL_OK
;

2537 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_spi.c

90 
	~"°m32l1xx_hÆ.h
"

101 #ifde‡
HAL_SPI_MODULE_ENABLED


108 
	#SPI_TIMEOUT_VALUE
 10

	)

120 
SPI_TxClo£IRQH™dÀr
(
__SPI_H™dÀTy≥Def
 *
h•i
);

121 
SPI_TxISR
(
__SPI_H™dÀTy≥Def
 *
h•i
);

122 
SPI_RxClo£IRQH™dÀr
(
__SPI_H™dÀTy≥Def
 *
h•i
);

123 
SPI_2LöesRxISR
(
__SPI_H™dÀTy≥Def
 *
h•i
);

124 
SPI_RxISR
(
__SPI_H™dÀTy≥Def
 *
h•i
);

125 
SPI_DMATønsmôC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
);

126 
SPI_DMARe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
);

127 
SPI_DMATønsmôRe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
);

128 
SPI_DMAHÆfTønsmôC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
);

129 
SPI_DMAHÆfRe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
);

130 
SPI_DMAHÆfTønsmôRe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
);

131 
SPI_DMAEº‹
(
__DMA_H™dÀTy≥Def
 *
hdma
);

132 
HAL_SètusTy≥Def
 
SPI_WaôOnFœgU¡ûTimeout
(
__SPI_H™dÀTy≥Def
 *
h•i
, 
uöt32_t
 
Fœg
, 
FœgSètus
 
Sètus
, uöt32_à
Timeout
);

183 
__wók
 
HAL_SètusTy≥Def
 
	$HAL_SPI_Inô
(
SPI_H™dÀTy≥Def
 *
h•i
)

186 
	`UNUSED
(
h•i
);

188  
HAL_ERROR
;

189 
	}
}

197 
HAL_SètusTy≥Def
 
	$HAL_SPI_DeInô
(
SPI_H™dÀTy≥Def
 *
h•i
)

200 if(
h•i
 =
NULL
)

202  
HAL_ERROR
;

206 
	`__HAL_SPI_DISABLE
(
h•i
);

209 
	`HAL_SPI_M•DeInô
(
h•i
);

211 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

212 
h•i
->
Sèã
 = 
HAL_SPI_STATE_RESET
;

215 
	`__HAL_UNLOCK
(
h•i
);

217  
HAL_OK
;

218 
	}
}

226 
__wók
 
	$HAL_SPI_M•Inô
(
SPI_H™dÀTy≥Def
 *
h•i
)

229 
	`UNUSED
(
h•i
);

234 
	}
}

242 
__wók
 
	$HAL_SPI_M•DeInô
(
SPI_H™dÀTy≥Def
 *
h•i
)

245 
	`UNUSED
(
h•i
);

250 
	}
}

297 
HAL_SètusTy≥Def
 
	$HAL_SPI_Tønsmô
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
Timeout
)

300 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
)

302 if((
pD©a
 =
NULL
 ) || (
Size
 == 0))

304  
HAL_ERROR
;

308 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_2LINES_OR_1LINE
(
h•i
->
Inô
.
Dúe˘i⁄
));

311 
	`__HAL_LOCK
(
h•i
);

314 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_TX
;

315 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

317 
h•i
->
pTxBuffPå
 = 
pD©a
;

318 
h•i
->
TxX„rSize
 = 
Size
;

319 
h•i
->
TxX„rCou¡
 = 
Size
;

322 
h•i
->
TxISR
 = 0;

323 
h•i
->
RxISR
 = 0;

324 
h•i
->
pRxBuffPå
 = 
NULL
;

325 
h•i
->
RxX„rSize
 = 0;

326 
h•i
->
RxX„rCou¡
 = 0;

329 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

331 
	`SPI_RESET_CRC
(
h•i
);

334 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)

337 
	`SPI_1LINE_TX
(
h•i
);

341 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

344 
	`__HAL_SPI_ENABLE
(
h•i
);

348 if(
h•i
->
Inô
.
D©aSize
 =
SPI_DATASIZE_8BIT
)

350 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_SLAVE
)|| (h•i->
TxX„rCou¡
 == 0x01))

352 
h•i
->
In°™˚
->
DR
 = (*h•i->
pTxBuffPå
++);

353 
h•i
->
TxX„rCou¡
--;

355 
h•i
->
TxX„rCou¡
 > 0)

358 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

360  
HAL_TIMEOUT
;

362 
h•i
->
In°™˚
->
DR
 = (*h•i->
pTxBuffPå
++);

363 
h•i
->
TxX„rCou¡
--;

366 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

368 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

374 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_SLAVE
Ë|| (h•i->
TxX„rCou¡
 == 0x01))

376 
h•i
->
In°™˚
->
DR
 = *((
uöt16_t
*)h•i->
pTxBuffPå
);

377 
h•i
->
pTxBuffPå
+=2;

378 
h•i
->
TxX„rCou¡
--;

380 
h•i
->
TxX„rCou¡
 > 0)

383 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

385  
HAL_TIMEOUT
;

387 
h•i
->
In°™˚
->
DR
 = *((
uöt16_t
*)h•i->
pTxBuffPå
);

388 
h•i
->
pTxBuffPå
+=2;

389 
h•i
->
TxX„rCou¡
--;

392 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

394 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

399 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

401 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

402  
HAL_TIMEOUT
;

406 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_BSY
, 
SET
, 
Timeout
Ë!
HAL_OK
)

408 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

409  
HAL_TIMEOUT
;

413 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
)

415 
	`__HAL_SPI_CLEAR_OVRFLAG
(
h•i
);

418 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

421 
	`__HAL_UNLOCK
(
h•i
);

423  
HAL_OK
;

427  
HAL_BUSY
;

429 
	}
}

440 
HAL_SètusTy≥Def
 
	$HAL_SPI_Re˚ive
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
Timeout
)

442 
__IO
 
uöt16_t
 
tm¥eg
 = 0;

444 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
)

446 if((
pD©a
 =
NULL
 ) || (
Size
 == 0))

448  
HAL_ERROR
;

452 
	`__HAL_LOCK
(
h•i
);

455 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_RX
;

456 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

458 
h•i
->
pRxBuffPå
 = 
pD©a
;

459 
h•i
->
RxX„rSize
 = 
Size
;

460 
h•i
->
RxX„rCou¡
 = 
Size
;

463 
h•i
->
RxISR
 = 0;

464 
h•i
->
TxISR
 = 0;

465 
h•i
->
pTxBuffPå
 = 
NULL
;

466 
h•i
->
TxX„rSize
 = 0;

467 
h•i
->
TxX„rCou¡
 = 0;

470 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)

472 
	`SPI_1LINE_RX
(
h•i
);

476 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

478 
	`SPI_RESET_CRC
(
h•i
);

481 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_MASTER
Ë&& (h•i->Inô.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
))

484 
	`__HAL_UNLOCK
(
h•i
);

487  
	`HAL_SPI_TønsmôRe˚ive
(
h•i
, 
pD©a
,ÖD©a, 
Size
, 
Timeout
);

491 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

494 
	`__HAL_SPI_ENABLE
(
h•i
);

498 if(
h•i
->
Inô
.
D©aSize
 =
SPI_DATASIZE_8BIT
)

500 
h•i
->
RxX„rCou¡
 > 1)

503 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

505  
HAL_TIMEOUT
;

508 (*
h•i
->
pRxBuffPå
++Ëh•i->
In°™˚
->
DR
;

509 
h•i
->
RxX„rCou¡
--;

512 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

514 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

520 
h•i
->
RxX„rCou¡
 > 1)

523 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

525  
HAL_TIMEOUT
;

528 *((
uöt16_t
*)
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

529 
h•i
->
pRxBuffPå
+=2;

530 
h•i
->
RxX„rCou¡
--;

533 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

535 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

540 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

542  
HAL_TIMEOUT
;

546 if(
h•i
->
Inô
.
D©aSize
 =
SPI_DATASIZE_8BIT
)

548 (*
h•i
->
pRxBuffPå
++Ëh•i->
In°™˚
->
DR
;

553 *((
uöt16_t
*)
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

554 
h•i
->
pRxBuffPå
+=2;

556 
h•i
->
RxX„rCou¡
--;

559 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

561 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

563 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

564  
HAL_TIMEOUT
;

568 
tm¥eg
 = 
h•i
->
In°™˚
->
DR
;

569 
	`UNUSED
(
tm¥eg
);

572 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_MASTER
)&&((h•i->Inô.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)||(h•i->Inô.Dúe˘i⁄ =
SPI_DIRECTION_2LINES_RXONLY
)))

575 
	`__HAL_SPI_DISABLE
(
h•i
);

578 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

581 if((
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
Ë&& (
	`__HAL_SPI_GET_FLAG
(h•i, 
SPI_FLAG_CRCERR
Ë!
RESET
))

583 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

586 
	`SPI_RESET_CRC
(
h•i
);

589 
	`__HAL_UNLOCK
(
h•i
);

591  
HAL_ERROR
;

595 
	`__HAL_UNLOCK
(
h•i
);

597  
HAL_OK
;

601  
HAL_BUSY
;

603 
	}
}

615 
HAL_SètusTy≥Def
 
	$HAL_SPI_TønsmôRe˚ive
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pTxD©a
, uöt8_à*
pRxD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
Timeout
)

617 
__IO
 
uöt16_t
 
tm¥eg
 = 0;

619 if((
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
Ë|| (h•i->Sèã =
HAL_SPI_STATE_BUSY_RX
))

621 if((
pTxD©a
 =
NULL
 ) || (
pRxD©a
 =NULL ) || (
Size
 == 0))

623  
HAL_ERROR
;

627 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_2LINES
(
h•i
->
Inô
.
Dúe˘i⁄
));

630 
	`__HAL_LOCK
(
h•i
);

633 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
)

635 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_TX_RX
;

639 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

641 
h•i
->
pRxBuffPå
 = 
pRxD©a
;

642 
h•i
->
RxX„rSize
 = 
Size
;

643 
h•i
->
RxX„rCou¡
 = 
Size
;

645 
h•i
->
pTxBuffPå
 = 
pTxD©a
;

646 
h•i
->
TxX„rSize
 = 
Size
;

647 
h•i
->
TxX„rCou¡
 = 
Size
;

650 
h•i
->
RxISR
 = 0;

651 
h•i
->
TxISR
 = 0;

654 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

656 
	`SPI_RESET_CRC
(
h•i
);

660 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

663 
	`__HAL_SPI_ENABLE
(
h•i
);

667 if(
h•i
->
Inô
.
D©aSize
 =
SPI_DATASIZE_16BIT
)

669 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_SLAVE
Ë|| ((h•i->Inô.Modê=
SPI_MODE_MASTER
Ë&& (h•i->
TxX„rCou¡
 == 0x01)))

671 
h•i
->
In°™˚
->
DR
 = *((
uöt16_t
*)h•i->
pTxBuffPå
);

672 
h•i
->
pTxBuffPå
+=2;

673 
h•i
->
TxX„rCou¡
--;

675 if(
h•i
->
TxX„rCou¡
 == 0)

678 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

680 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

684 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

686  
HAL_TIMEOUT
;

689 *((
uöt16_t
*)
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

690 
h•i
->
pRxBuffPå
+=2;

691 
h•i
->
RxX„rCou¡
--;

695 
h•i
->
TxX„rCou¡
 > 0)

698 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

700  
HAL_TIMEOUT
;

703 
h•i
->
In°™˚
->
DR
 = *((
uöt16_t
*)h•i->
pTxBuffPå
);

704 
h•i
->
pTxBuffPå
+=2;

705 
h•i
->
TxX„rCou¡
--;

708 if((
h•i
->
TxX„rCou¡
 =0Ë&& (h•i->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
))

710 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

714 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

716  
HAL_TIMEOUT
;

719 *((
uöt16_t
*)
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

720 
h•i
->
pRxBuffPå
+=2;

721 
h•i
->
RxX„rCou¡
--;

724 if(
h•i
->
Inô
.
Mode
 =
SPI_MODE_SLAVE
)

727 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

729  
HAL_TIMEOUT
;

732 *((
uöt16_t
*)
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

733 
h•i
->
pRxBuffPå
+=2;

734 
h•i
->
RxX„rCou¡
--;

741 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_SLAVE
Ë|| ((h•i->Inô.Modê=
SPI_MODE_MASTER
Ë&& (h•i->
TxX„rCou¡
 == 0x01)))

743 
h•i
->
In°™˚
->
DR
 = (*h•i->
pTxBuffPå
++);

744 
h•i
->
TxX„rCou¡
--;

746 if(
h•i
->
TxX„rCou¡
 == 0)

749 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

751 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

755 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

757  
HAL_TIMEOUT
;

760 (*
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

761 
h•i
->
RxX„rCou¡
--;

765 
h•i
->
TxX„rCou¡
 > 0)

768 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

770  
HAL_TIMEOUT
;

773 
h•i
->
In°™˚
->
DR
 = (*h•i->
pTxBuffPå
++);

774 
h•i
->
TxX„rCou¡
--;

777 if((
h•i
->
TxX„rCou¡
 =0Ë&& (h•i->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
))

779 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

783 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

785  
HAL_TIMEOUT
;

788 (*
h•i
->
pRxBuffPå
++Ëh•i->
In°™˚
->
DR
;

789 
h•i
->
RxX„rCou¡
--;

791 if(
h•i
->
Inô
.
Mode
 =
SPI_MODE_SLAVE
)

794 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

796  
HAL_TIMEOUT
;

799 (*
h•i
->
pRxBuffPå
++Ëh•i->
In°™˚
->
DR
;

800 
h•i
->
RxX„rCou¡
--;

806 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

809 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

811 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

812  
HAL_TIMEOUT
;

815 
tm¥eg
 = 
h•i
->
In°™˚
->
DR
;

816 
	`UNUSED
(
tm¥eg
);

820 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_BSY
, 
SET
, 
Timeout
Ë!
HAL_OK
)

822 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

823  
HAL_TIMEOUT
;

826 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

829 if((
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
Ë&& (
	`__HAL_SPI_GET_FLAG
(h•i, 
SPI_FLAG_CRCERR
Ë!
RESET
))

831 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

834 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

836 
	`SPI_RESET_CRC
(
h•i
);

840 
	`__HAL_UNLOCK
(
h•i
);

842  
HAL_ERROR
;

846 
	`__HAL_UNLOCK
(
h•i
);

848  
HAL_OK
;

852  
HAL_BUSY
;

854 
	}
}

864 
HAL_SètusTy≥Def
 
	$HAL_SPI_Tønsmô_IT
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

866 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
)

868 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0))

870  
HAL_ERROR
;

874 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_2LINES_OR_1LINE
(
h•i
->
Inô
.
Dúe˘i⁄
));

877 
	`__HAL_LOCK
(
h•i
);

880 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_TX
;

881 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

883 
h•i
->
TxISR
 = &
SPI_TxISR
;

884 
h•i
->
pTxBuffPå
 = 
pD©a
;

885 
h•i
->
TxX„rSize
 = 
Size
;

886 
h•i
->
TxX„rCou¡
 = 
Size
;

889 
h•i
->
RxISR
 = 0;

890 
h•i
->
pRxBuffPå
 = 
NULL
;

891 
h•i
->
RxX„rSize
 = 0;

892 
h•i
->
RxX„rCou¡
 = 0;

895 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)

897 
	`SPI_1LINE_TX
(
h•i
);

901 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

903 
	`SPI_RESET_CRC
(
h•i
);

906 i‡(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
)

908 
	`__HAL_SPI_ENABLE_IT
(
h•i
, (
SPI_IT_TXE
));

912 
	`__HAL_SPI_ENABLE_IT
(
h•i
, (
SPI_IT_TXE
 | 
SPI_IT_ERR
));

915 
	`__HAL_UNLOCK
(
h•i
);

918 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

921 
	`__HAL_SPI_ENABLE
(
h•i
);

924  
HAL_OK
;

928  
HAL_BUSY
;

930 
	}
}

940 
HAL_SètusTy≥Def
 
	$HAL_SPI_Re˚ive_IT
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

942 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
)

944 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0))

946  
HAL_ERROR
;

950 
	`__HAL_LOCK
(
h•i
);

953 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_RX
;

954 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

956 
h•i
->
RxISR
 = &
SPI_RxISR
;

957 
h•i
->
pRxBuffPå
 = 
pD©a
;

958 
h•i
->
RxX„rSize
 = 
Size
;

959 
h•i
->
RxX„rCou¡
 = 
Size
 ;

962 
h•i
->
TxISR
 = 0;

963 
h•i
->
pTxBuffPå
 = 
NULL
;

964 
h•i
->
TxX„rSize
 = 0;

965 
h•i
->
TxX„rCou¡
 = 0;

968 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)

970 
	`SPI_1LINE_RX
(
h•i
);

972 if((
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
Ë&& (h•i->Inô.
Mode
 =
SPI_MODE_MASTER
))

975 
	`__HAL_UNLOCK
(
h•i
);

978  
	`HAL_SPI_TønsmôRe˚ive_IT
(
h•i
, 
pD©a
,ÖD©a, 
Size
);

982 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

984 
	`SPI_RESET_CRC
(
h•i
);

988 
	`__HAL_SPI_ENABLE_IT
(
h•i
, (
SPI_IT_RXNE
 | 
SPI_IT_ERR
));

991 
	`__HAL_UNLOCK
(
h•i
);

998 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

1001 
	`__HAL_SPI_ENABLE
(
h•i
);

1004  
HAL_OK
;

1008  
HAL_BUSY
;

1010 
	}
}

1021 
HAL_SètusTy≥Def
 
	$HAL_SPI_TønsmôRe˚ive_IT
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pTxD©a
, uöt8_à*
pRxD©a
, 
uöt16_t
 
Size
)

1024 if((
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
) || \

1025 ((
h•i
->
Inô
.
Mode
 =
SPI_MODE_MASTER
Ë&& (h•i->Inô.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
Ë&& (h•i->
Sèã
 =
HAL_SPI_STATE_BUSY_RX
)))

1027 if((
pTxD©a
 =
NULL
 ) || (
pRxD©a
 =NULL ) || (
Size
 == 0))

1029  
HAL_ERROR
;

1033 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_2LINES
(
h•i
->
Inô
.
Dúe˘i⁄
));

1036 
	`__HAL_LOCK
(
h•i
);

1039 if(
h•i
->
Sèã
 !
HAL_SPI_STATE_BUSY_RX
)

1041 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_TX_RX
;

1045 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

1047 
h•i
->
TxISR
 = &
SPI_TxISR
;

1048 
h•i
->
pTxBuffPå
 = 
pTxD©a
;

1049 
h•i
->
TxX„rSize
 = 
Size
;

1050 
h•i
->
TxX„rCou¡
 = 
Size
;

1052 
h•i
->
RxISR
 = &
SPI_2LöesRxISR
;

1053 
h•i
->
pRxBuffPå
 = 
pRxD©a
;

1054 
h•i
->
RxX„rSize
 = 
Size
;

1055 
h•i
->
RxX„rCou¡
 = 
Size
;

1058 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

1060 
	`SPI_RESET_CRC
(
h•i
);

1064 
	`__HAL_SPI_ENABLE_IT
(
h•i
, (
SPI_IT_TXE
 | 
SPI_IT_RXNE
 | 
SPI_IT_ERR
));

1067 
	`__HAL_UNLOCK
(
h•i
);

1070 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

1073 
	`__HAL_SPI_ENABLE
(
h•i
);

1076  
HAL_OK
;

1080  
HAL_BUSY
;

1082 
	}
}

1092 
HAL_SètusTy≥Def
 
	$HAL_SPI_Tønsmô_DMA
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

1094 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
)

1096 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0))

1098  
HAL_ERROR
;

1102 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_2LINES_OR_1LINE
(
h•i
->
Inô
.
Dúe˘i⁄
));

1105 
	`__HAL_LOCK
(
h•i
);

1108 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_TX
;

1109 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

1111 
h•i
->
pTxBuffPå
 = 
pD©a
;

1112 
h•i
->
TxX„rSize
 = 
Size
;

1113 
h•i
->
TxX„rCou¡
 = 
Size
;

1116 
h•i
->
TxISR
 = 0;

1117 
h•i
->
RxISR
 = 0;

1118 
h•i
->
pRxBuffPå
 = 
NULL
;

1119 
h•i
->
RxX„rSize
 = 0;

1120 
h•i
->
RxX„rCou¡
 = 0;

1123 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)

1125 
	`SPI_1LINE_TX
(
h•i
);

1129 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

1131 
	`SPI_RESET_CRC
(
h•i
);

1135 
h•i
->
hdm©x
->
X„rHÆfC∂tCÆlback
 = 
SPI_DMAHÆfTønsmôC∂t
;

1138 
h•i
->
hdm©x
->
X„rC∂tCÆlback
 = 
SPI_DMATønsmôC∂t
;

1141 
h•i
->
hdm©x
->
X„rEº‹CÆlback
 = 
SPI_DMAEº‹
;

1144 
	`HAL_DMA_Sèπ_IT
(
h•i
->
hdm©x
, (
uöt32_t
)h•i->
pTxBuffPå
, (uöt32_t)&h•i->
In°™˚
->
DR
, h•i->
TxX„rCou¡
);

1147 
	`SET_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

1150 
	`__HAL_UNLOCK
(
h•i
);

1153 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

1156 
	`__HAL_SPI_ENABLE
(
h•i
);

1159  
HAL_OK
;

1163  
HAL_BUSY
;

1165 
	}
}

1176 
HAL_SètusTy≥Def
 
	$HAL_SPI_Re˚ive_DMA
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

1178 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
)

1180 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0))

1182  
HAL_ERROR
;

1186 
	`__HAL_LOCK
(
h•i
);

1189 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_RX
;

1190 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

1192 
h•i
->
pRxBuffPå
 = 
pD©a
;

1193 
h•i
->
RxX„rSize
 = 
Size
;

1194 
h•i
->
RxX„rCou¡
 = 
Size
;

1197 
h•i
->
RxISR
 = 0;

1198 
h•i
->
TxISR
 = 0;

1199 
h•i
->
pTxBuffPå
 = 
NULL
;

1200 
h•i
->
TxX„rSize
 = 0;

1201 
h•i
->
TxX„rCou¡
 = 0;

1204 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)

1206 
	`SPI_1LINE_RX
(
h•i
);

1208 if((
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
)&&(h•i->Inô.
Mode
 =
SPI_MODE_MASTER
))

1211 
	`__HAL_UNLOCK
(
h•i
);

1214  
	`HAL_SPI_TønsmôRe˚ive_DMA
(
h•i
, 
pD©a
,ÖD©a, 
Size
);

1218 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

1220 
	`SPI_RESET_CRC
(
h•i
);

1224 
h•i
->
hdm¨x
->
X„rHÆfC∂tCÆlback
 = 
SPI_DMAHÆfRe˚iveC∂t
;

1227 
h•i
->
hdm¨x
->
X„rC∂tCÆlback
 = 
SPI_DMARe˚iveC∂t
;

1230 
h•i
->
hdm¨x
->
X„rEº‹CÆlback
 = 
SPI_DMAEº‹
;

1233 
	`HAL_DMA_Sèπ_IT
(
h•i
->
hdm¨x
, (
uöt32_t
)&h•i->
In°™˚
->
DR
, (uöt32_t)h•i->
pRxBuffPå
, h•i->
RxX„rCou¡
);

1236 
	`SET_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_RXDMAEN
);

1239 
	`__HAL_UNLOCK
(
h•i
);

1242 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

1245 
	`__HAL_SPI_ENABLE
(
h•i
);

1248  
HAL_OK
;

1252  
HAL_BUSY
;

1254 
	}
}

1266 
HAL_SètusTy≥Def
 
	$HAL_SPI_TønsmôRe˚ive_DMA
(
SPI_H™dÀTy≥Def
 *
h•i
, 
uöt8_t
 *
pTxD©a
, uöt8_à*
pRxD©a
, 
uöt16_t
 
Size
)

1268 if((
h•i
->
Sèã
 =
HAL_SPI_STATE_READY
) || \

1269 ((
h•i
->
Inô
.
Mode
 =
SPI_MODE_MASTER
Ë&& (h•i->Inô.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
Ë&& (h•i->
Sèã
 =
HAL_SPI_STATE_BUSY_RX
)))

1271 if((
pTxD©a
 =
NULL
 ) || (
pRxD©a
 =NULL ) || (
Size
 == 0))

1273  
HAL_ERROR
;

1277 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_2LINES
(
h•i
->
Inô
.
Dúe˘i⁄
));

1280 
	`__HAL_LOCK
(
h•i
);

1283 if(
h•i
->
Sèã
 !
HAL_SPI_STATE_BUSY_RX
)

1285 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY_TX_RX
;

1289 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

1291 
h•i
->
pTxBuffPå
 = (
uöt8_t
*)
pTxD©a
;

1292 
h•i
->
TxX„rSize
 = 
Size
;

1293 
h•i
->
TxX„rCou¡
 = 
Size
;

1295 
h•i
->
pRxBuffPå
 = (
uöt8_t
*)
pRxD©a
;

1296 
h•i
->
RxX„rSize
 = 
Size
;

1297 
h•i
->
RxX„rCou¡
 = 
Size
;

1300 
h•i
->
RxISR
 = 0;

1301 
h•i
->
TxISR
 = 0;

1304 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

1306 
	`SPI_RESET_CRC
(
h•i
);

1310 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_BUSY_RX
)

1313 
h•i
->
hdm¨x
->
X„rHÆfC∂tCÆlback
 = 
SPI_DMAHÆfRe˚iveC∂t
;

1315 
h•i
->
hdm¨x
->
X„rC∂tCÆlback
 = 
SPI_DMARe˚iveC∂t
;

1320 
h•i
->
hdm¨x
->
X„rHÆfC∂tCÆlback
 = 
SPI_DMAHÆfTønsmôRe˚iveC∂t
;

1322 
h•i
->
hdm¨x
->
X„rC∂tCÆlback
 = 
SPI_DMATønsmôRe˚iveC∂t
;

1326 
h•i
->
hdm¨x
->
X„rEº‹CÆlback
 = 
SPI_DMAEº‹
;

1329 
	`HAL_DMA_Sèπ_IT
(
h•i
->
hdm¨x
, (
uöt32_t
)&h•i->
In°™˚
->
DR
, (uöt32_t)h•i->
pRxBuffPå
, h•i->
RxX„rCou¡
);

1332 
	`SET_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_RXDMAEN
);

1336 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_BUSY_TX_RX
)

1339 
h•i
->
hdm©x
->
X„rEº‹CÆlback
 = 
SPI_DMAEº‹
;

1343 
h•i
->
hdm©x
->
X„rEº‹CÆlback
 = 
NULL
;

1347 
	`HAL_DMA_Sèπ_IT
(
h•i
->
hdm©x
, (
uöt32_t
)h•i->
pTxBuffPå
, (uöt32_t)&h•i->
In°™˚
->
DR
, h•i->
TxX„rCou¡
);

1350 if((
h•i
->
In°™˚
->
CR1
 &
SPI_CR1_SPE
) != SPI_CR1_SPE)

1353 
	`__HAL_SPI_ENABLE
(
h•i
);

1357 
	`SET_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

1360 
	`__HAL_UNLOCK
(
h•i
);

1362  
HAL_OK
;

1366  
HAL_BUSY
;

1368 
	}
}

1377 
HAL_SètusTy≥Def
 
	$HAL_SPI_DMAPau£
(
SPI_H™dÀTy≥Def
 *
h•i
)

1380 
	`__HAL_LOCK
(
h•i
);

1383 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

1384 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_RXDMAEN
);

1387 
	`__HAL_UNLOCK
(
h•i
);

1389  
HAL_OK
;

1390 
	}
}

1398 
HAL_SètusTy≥Def
 
	$HAL_SPI_DMAResume
(
SPI_H™dÀTy≥Def
 *
h•i
)

1401 
	`__HAL_LOCK
(
h•i
);

1404 
	`SET_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

1405 
	`SET_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_RXDMAEN
);

1408 
	`__HAL_UNLOCK
(
h•i
);

1410  
HAL_OK
;

1411 
	}
}

1419 
HAL_SètusTy≥Def
 
	$HAL_SPI_DMASt›
(
SPI_H™dÀTy≥Def
 *
h•i
)

1428 if(
h•i
->
hdm©x
 !
NULL
)

1430 
	`HAL_DMA_Ab‹t
(
h•i
->
hdm©x
);

1433 if(
h•i
->
hdm¨x
 !
NULL
)

1435 
	`HAL_DMA_Ab‹t
(
h•i
->
hdm¨x
);

1439 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

1440 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_RXDMAEN
);

1442 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1444  
HAL_OK
;

1445 
	}
}

1453 
	$HAL_SPI_IRQH™dÀr
(
SPI_H™dÀTy≥Def
 *
h•i
)

1456 if((
	`__HAL_SPI_GET_IT_SOURCE
(
h•i
, 
SPI_IT_RXNE
Ë!
RESET
Ë&& (
	`__HAL_SPI_GET_FLAG
(h•i, 
SPI_FLAG_RXNE
Ë!RESETË&& (__HAL_SPI_GET_FLAG(h•i, 
SPI_FLAG_OVR
) == RESET))

1458 
h•i
->
	`RxISR
(hspi);

1463 if((
	`__HAL_SPI_GET_IT_SOURCE
(
h•i
, 
SPI_IT_TXE
Ë!
RESET
Ë&& (
	`__HAL_SPI_GET_FLAG
(h•i, 
SPI_FLAG_TXE
) != RESET))

1465 
h•i
->
	`TxISR
(hspi);

1469 if(
	`__HAL_SPI_GET_IT_SOURCE
(
h•i
, 
SPI_IT_ERR
Ë!
RESET
)

1472 if(
	`__HAL_SPI_GET_FLAG
(
h•i
, 
SPI_FLAG_CRCERR
Ë!
RESET
)

1474 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

1475 
	`__HAL_SPI_CLEAR_CRCERRFLAG
(
h•i
);

1478 if(
	`__HAL_SPI_GET_FLAG
(
h•i
, 
SPI_FLAG_MODF
Ë!
RESET
)

1480 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_MODF
);

1481 
	`__HAL_SPI_CLEAR_MODFFLAG
(
h•i
);

1485 if(
	`__HAL_SPI_GET_FLAG
(
h•i
, 
SPI_FLAG_OVR
Ë!
RESET
)

1487 if(
h•i
->
Sèã
 !
HAL_SPI_STATE_BUSY_TX
)

1489 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_OVR
);

1490 
	`__HAL_SPI_CLEAR_OVRFLAG
(
h•i
);

1495 if(
	`__HAL_SPI_GET_FLAG
(
h•i
, 
SPI_FLAG_FRE
Ë!
RESET
)

1497 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FRE
);

1498 
	`__HAL_SPI_CLEAR_FREFLAG
(
h•i
);

1502 if(
h•i
->
Eº‹Code
!=
HAL_SPI_ERROR_NONE
)

1504 
	`__HAL_SPI_DISABLE_IT
(
h•i
, 
SPI_IT_RXNE
 | 
SPI_IT_TXE
 | 
SPI_IT_ERR
);

1505 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1506 
	`HAL_SPI_Eº‹CÆlback
(
h•i
);

1509 
	}
}

1517 
__wók
 
	$HAL_SPI_TxC∂tCÆlback
(
SPI_H™dÀTy≥Def
 *
h•i
)

1520 
	`UNUSED
(
h•i
);

1525 
	}
}

1533 
__wók
 
	$HAL_SPI_RxC∂tCÆlback
(
SPI_H™dÀTy≥Def
 *
h•i
)

1536 
	`UNUSED
(
h•i
);

1541 
	}
}

1549 
__wók
 
	$HAL_SPI_TxRxC∂tCÆlback
(
SPI_H™dÀTy≥Def
 *
h•i
)

1552 
	`UNUSED
(
h•i
);

1557 
	}
}

1565 
__wók
 
	$HAL_SPI_TxHÆfC∂tCÆlback
(
SPI_H™dÀTy≥Def
 *
h•i
)

1568 
	`UNUSED
(
h•i
);

1573 
	}
}

1581 
__wók
 
	$HAL_SPI_RxHÆfC∂tCÆlback
(
SPI_H™dÀTy≥Def
 *
h•i
)

1584 
	`UNUSED
(
h•i
);

1589 
	}
}

1597 
__wók
 
	$HAL_SPI_TxRxHÆfC∂tCÆlback
(
SPI_H™dÀTy≥Def
 *
h•i
)

1600 
	`UNUSED
(
h•i
);

1605 
	}
}

1613 
__wók
 
	$HAL_SPI_Eº‹CÆlback
(
SPI_H™dÀTy≥Def
 *
h•i
)

1616 
	`UNUSED
(
h•i
);

1623 
	}
}

1650 
HAL_SPI_SèãTy≥Def
 
	$HAL_SPI_GëSèã
(
SPI_H™dÀTy≥Def
 *
h•i
)

1652  
h•i
->
Sèã
;

1653 
	}
}

1661 
uöt32_t
 
	$HAL_SPI_GëEº‹
(
SPI_H™dÀTy≥Def
 *
h•i
)

1663  
h•i
->
Eº‹Code
;

1664 
	}
}

1687 
	$SPI_TxClo£IRQH™dÀr
(
__SPI_H™dÀTy≥Def
 *
h•i
)

1690 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

1692 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

1696 
	`__HAL_SPI_DISABLE_IT
(
h•i
, (
SPI_IT_TXE
 ));

1699 if(
	`__HAL_SPI_GET_IT_SOURCE
(
h•i
, 
SPI_IT_RXNE
Ë=
RESET
)

1701 
	`__HAL_SPI_DISABLE_IT
(
h•i
, (
SPI_IT_ERR
));

1704 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_BSY
, 
SET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

1706 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

1710 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
)

1712 
	`__HAL_SPI_CLEAR_OVRFLAG
(
h•i
);

1716 if(
h•i
->
Eº‹Code
 =
HAL_SPI_ERROR_NONE
)

1719 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_BUSY_TX_RX
)

1722 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1723 
	`HAL_SPI_TxRxC∂tCÆlback
(
h•i
);

1728 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1729 
	`HAL_SPI_TxC∂tCÆlback
(
h•i
);

1735 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1737 
	`HAL_SPI_Eº‹CÆlback
(
h•i
);

1740 
	}
}

1748 
	$SPI_TxISR
(
__SPI_H™dÀTy≥Def
 *
h•i
)

1751 if(
h•i
->
Inô
.
D©aSize
 =
SPI_DATASIZE_8BIT
)

1753 
h•i
->
In°™˚
->
DR
 = (*h•i->
pTxBuffPå
++);

1758 
h•i
->
In°™˚
->
DR
 = *((
uöt16_t
*)h•i->
pTxBuffPå
);

1759 
h•i
->
pTxBuffPå
+=2;

1761 
h•i
->
TxX„rCou¡
--;

1763 if(
h•i
->
TxX„rCou¡
 == 0)

1765 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

1768 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

1770 
	`SPI_TxClo£IRQH™dÀr
(
h•i
);

1772 
	}
}

1780 
	$SPI_RxClo£IRQH™dÀr
(
__SPI_H™dÀTy≥Def
 *
h•i
)

1782 
__IO
 
uöt16_t
 
tm¥eg
 = 0;

1784 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

1787 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

1789 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

1793 
tm¥eg
 = 
h•i
->
In°™˚
->
DR
;

1794 
	`UNUSED
(
tm¥eg
);

1797 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
SET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

1799 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

1803 if(
	`__HAL_SPI_GET_FLAG
(
h•i
, 
SPI_FLAG_CRCERR
Ë!
RESET
)

1805 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

1808 
	`SPI_RESET_CRC
(
h•i
);

1813 
	`__HAL_SPI_DISABLE_IT
(
h•i
, (
SPI_IT_RXNE
));

1816 if(
	`__HAL_SPI_GET_IT_SOURCE
(
h•i
, 
SPI_IT_TXE
Ë=
RESET
)

1819 
	`__HAL_SPI_DISABLE_IT
(
h•i
, (
SPI_IT_ERR
));

1821 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_MASTER
)&&((h•i->Inô.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)||(h•i->Inô.Dúe˘i⁄ =
SPI_DIRECTION_2LINES_RXONLY
)))

1824 
	`__HAL_SPI_DISABLE
(
h•i
);

1828 if(
h•i
->
Eº‹Code
 =
HAL_SPI_ERROR_NONE
)

1831 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_BUSY_TX_RX
)

1834 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1835 
	`HAL_SPI_TxRxC∂tCÆlback
(
h•i
);

1840 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1841 
	`HAL_SPI_RxC∂tCÆlback
(
h•i
);

1847 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1849 
	`HAL_SPI_Eº‹CÆlback
(
h•i
);

1852 
	}
}

1860 
	$SPI_2LöesRxISR
(
__SPI_H™dÀTy≥Def
 *
h•i
)

1863 if(
h•i
->
Inô
.
D©aSize
 =
SPI_DATASIZE_8BIT
)

1865 (*
h•i
->
pRxBuffPå
++Ëh•i->
In°™˚
->
DR
;

1870 *((
uöt16_t
*)
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

1871 
h•i
->
pRxBuffPå
+=2;

1873 
h•i
->
RxX„rCou¡
--;

1875 if(
h•i
->
RxX„rCou¡
==0)

1877 
	`SPI_RxClo£IRQH™dÀr
(
h•i
);

1879 
	}
}

1887 
	$SPI_RxISR
(
__SPI_H™dÀTy≥Def
 *
h•i
)

1890 if(
h•i
->
Inô
.
D©aSize
 =
SPI_DATASIZE_8BIT
)

1892 (*
h•i
->
pRxBuffPå
++Ëh•i->
In°™˚
->
DR
;

1897 *((
uöt16_t
*)
h•i
->
pRxBuffPå
Ëh•i->
In°™˚
->
DR
;

1898 
h•i
->
pRxBuffPå
+=2;

1900 
h•i
->
RxX„rCou¡
--;

1903 if((
h•i
->
RxX„rCou¡
 =1Ë&& (h•i->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
))

1906 
	`SET_BIT
(
h•i
->
In°™˚
->
CR1
, 
SPI_CR1_CRCNEXT
);

1909 if(
h•i
->
RxX„rCou¡
 == 0)

1911 
	`SPI_RxClo£IRQH™dÀr
(
h•i
);

1913 
	}
}

1921 
	$SPI_DMATønsmôC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
)

1923 
SPI_H™dÀTy≥Def
* 
h•i
 = ( SPI_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

1926 if((
hdma
->
In°™˚
->
CCR
 & 
DMA_CIRCULAR
) == 0)

1929 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

1931 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

1935 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

1938 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_BSY
, 
SET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

1940 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

1943 
h•i
->
TxX„rCou¡
 = 0;

1944 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

1948 if(
h•i
->
Inô
.
Dúe˘i⁄
 =
SPI_DIRECTION_2LINES
)

1950 
	`__HAL_SPI_CLEAR_OVRFLAG
(
h•i
);

1954 if(
h•i
->
Eº‹Code
 !
HAL_SPI_ERROR_NONE
)

1956 
	`HAL_SPI_Eº‹CÆlback
(
h•i
);

1960 
	`HAL_SPI_TxC∂tCÆlback
(
h•i
);

1962 
	}
}

1970 
	$SPI_DMARe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
)

1972 
__IO
 
uöt16_t
 
tm¥eg
 = 0;

1974 
SPI_H™dÀTy≥Def
* 
h•i
 = ( SPI_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

1977 if((
hdma
->
In°™˚
->
CCR
 & 
DMA_CIRCULAR
) == 0)

1979 if((
h•i
->
Inô
.
Mode
 =
SPI_MODE_MASTER
)&&((h•i->Inô.
Dúe˘i⁄
 =
SPI_DIRECTION_1LINE
)||(h•i->Inô.Dúe˘i⁄ =
SPI_DIRECTION_2LINES_RXONLY
)))

1982 
	`__HAL_SPI_DISABLE
(
h•i
);

1986 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_RXDMAEN
);

1989 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

1992 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

1995 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

1997 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

2001 
tm¥eg
 = 
h•i
->
In°™˚
->
DR
;

2002 
	`UNUSED
(
tm¥eg
);

2005 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
SET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

2007 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

2011 if(
	`__HAL_SPI_GET_FLAG
(
h•i
, 
SPI_FLAG_CRCERR
Ë!
RESET
)

2013 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

2014 
	`__HAL_SPI_CLEAR_CRCERRFLAG
(
h•i
);

2018 
h•i
->
RxX„rCou¡
 = 0;

2019 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

2022 if(
h•i
->
Eº‹Code
 !
HAL_SPI_ERROR_NONE
)

2024 
	`HAL_SPI_Eº‹CÆlback
(
h•i
);

2028 
	`HAL_SPI_RxC∂tCÆlback
(
h•i
);

2033 
	`HAL_SPI_RxC∂tCÆlback
(
h•i
);

2035 
	}
}

2043 
	$SPI_DMATønsmôRe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
)

2045 
__IO
 
uöt16_t
 
tm¥eg
 = 0;

2047 
SPI_H™dÀTy≥Def
* 
h•i
 = ( SPI_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2049 if((
hdma
->
In°™˚
->
CCR
 & 
DMA_CIRCULAR
) == 0)

2052 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

2055 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
SET
, 
SPI_TIMEOUT_VALUE
Ë=
HAL_OK
)

2058 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_RXNE
, 
RESET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

2060 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

2064 
tm¥eg
 = 
h•i
->
In°™˚
->
DR
;

2065 
	`UNUSED
(
tm¥eg
);

2068 if(
	`__HAL_SPI_GET_FLAG
(
h•i
, 
SPI_FLAG_CRCERR
Ë!
RESET
)

2070 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_CRC
);

2071 
	`__HAL_SPI_CLEAR_CRCERRFLAG
(
h•i
);

2076 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_TXE
, 
RESET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

2078 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

2082 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_TXDMAEN
);

2085 if(
	`SPI_WaôOnFœgU¡ûTimeout
(
h•i
, 
SPI_FLAG_BSY
, 
SET
, 
SPI_TIMEOUT_VALUE
Ë!
HAL_OK
)

2087 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_FLAG
);

2091 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
CR2
, 
SPI_CR2_RXDMAEN
);

2093 
h•i
->
TxX„rCou¡
 = 0;

2094 
h•i
->
RxX„rCou¡
 = 0;

2096 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

2099 if(
h•i
->
Eº‹Code
 !
HAL_SPI_ERROR_NONE
)

2101 
	`HAL_SPI_Eº‹CÆlback
(
h•i
);

2105 
	`HAL_SPI_TxRxC∂tCÆlback
(
h•i
);

2110 
	`HAL_SPI_TxRxC∂tCÆlback
(
h•i
);

2112 
	}
}

2120 
	$SPI_DMAHÆfTønsmôC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
)

2122 
SPI_H™dÀTy≥Def
* 
h•i
 = ( SPI_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2124 
	`HAL_SPI_TxHÆfC∂tCÆlback
(
h•i
);

2125 
	}
}

2133 
	$SPI_DMAHÆfRe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
)

2135 
SPI_H™dÀTy≥Def
* 
h•i
 = ( SPI_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2137 
	`HAL_SPI_RxHÆfC∂tCÆlback
(
h•i
);

2138 
	}
}

2146 
	$SPI_DMAHÆfTønsmôRe˚iveC∂t
(
__DMA_H™dÀTy≥Def
 *
hdma
)

2148 
SPI_H™dÀTy≥Def
* 
h•i
 = ( SPI_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2150 
	`HAL_SPI_TxRxHÆfC∂tCÆlback
(
h•i
);

2151 
	}
}

2159 
	$SPI_DMAEº‹
(
__DMA_H™dÀTy≥Def
 *
hdma
)

2161 
SPI_H™dÀTy≥Def
* 
h•i
 = (SPI_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

2162 
h•i
->
TxX„rCou¡
 = 0;

2163 
h•i
->
RxX„rCou¡
 = 0;

2164 
h•i
->
Sèã

HAL_SPI_STATE_READY
;

2165 
	`SET_BIT
(
h•i
->
Eº‹Code
, 
HAL_SPI_ERROR_DMA
);

2166 
	`HAL_SPI_Eº‹CÆlback
(
h•i
);

2167 
	}
}

2178 
HAL_SètusTy≥Def
 
	$SPI_WaôOnFœgU¡ûTimeout
(
__SPI_H™dÀTy≥Def
 *
h•i
, 
uöt32_t
 
Fœg
, 
FœgSètus
 
Sètus
, uöt32_à
Timeout
)

2180 
uöt32_t
 
tick°¨t
 = 0;

2183 
tick°¨t
 = 
	`HAL_GëTick
();

2186 if(
Sètus
 =
RESET
)

2188 
	`__HAL_SPI_GET_FLAG
(
h•i
, 
Fœg
Ë=
RESET
)

2190 if(
Timeout
 !
HAL_MAX_DELAY
)

2192 if((
Timeout
 =0Ë|| ((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

2199 
	`__HAL_SPI_DISABLE_IT
(
h•i
, (
SPI_IT_TXE
 | 
SPI_IT_RXNE
 | 
SPI_IT_ERR
));

2202 
	`__HAL_SPI_DISABLE
(
h•i
);

2205 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

2207 
	`SPI_RESET_CRC
(
h•i
);

2210 
h•i
->
Sèã

HAL_SPI_STATE_READY
;

2213 
	`__HAL_UNLOCK
(
h•i
);

2215  
HAL_TIMEOUT
;

2222 
	`__HAL_SPI_GET_FLAG
(
h•i
, 
Fœg
Ë!
RESET
)

2224 if(
Timeout
 !
HAL_MAX_DELAY
)

2226 if((
Timeout
 =0Ë|| ((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

2233 
	`__HAL_SPI_DISABLE_IT
(
h•i
, (
SPI_IT_TXE
 | 
SPI_IT_RXNE
 | 
SPI_IT_ERR
));

2236 
	`__HAL_SPI_DISABLE
(
h•i
);

2239 if(
h•i
->
Inô
.
CRCCÆcuœti⁄
 =
SPI_CRCCALCULATION_ENABLE
)

2241 
	`SPI_RESET_CRC
(
h•i
);

2244 
h•i
->
Sèã

HAL_SPI_STATE_READY
;

2247 
	`__HAL_UNLOCK
(
h•i
);

2249  
HAL_TIMEOUT
;

2254  
HAL_OK
;

2255 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_spi_ex.c

44 
	~"°m32l1xx_hÆ.h
"

53 #ifde‡
HAL_SPI_MODULE_ENABLED


78 
HAL_SètusTy≥Def
 
	$HAL_SPI_Inô
(
SPI_H™dÀTy≥Def
 *
h•i
)

81 if(
h•i
 =
NULL
)

83  
HAL_ERROR
;

87 
	`as£π_∑øm
(
	`IS_SPI_ALL_INSTANCE
(
h•i
->
In°™˚
));

88 
	`as£π_∑øm
(
	`IS_SPI_MODE
(
h•i
->
Inô
.
Mode
));

89 
	`as£π_∑øm
(
	`IS_SPI_DIRECTION_MODE
(
h•i
->
Inô
.
Dúe˘i⁄
));

90 
	`as£π_∑øm
(
	`IS_SPI_DATASIZE
(
h•i
->
Inô
.
D©aSize
));

91 
	`as£π_∑øm
(
	`IS_SPI_CPOL
(
h•i
->
Inô
.
CLKPﬁ¨ôy
));

92 
	`as£π_∑øm
(
	`IS_SPI_CPHA
(
h•i
->
Inô
.
CLKPha£
));

93 
	`as£π_∑øm
(
	`IS_SPI_NSS
(
h•i
->
Inô
.
NSS
));

94 
	`as£π_∑øm
(
	`IS_SPI_BAUDRATE_PRESCALER
(
h•i
->
Inô
.
BaudR©ePªsˇÀr
));

95 
	`as£π_∑øm
(
	`IS_SPI_FIRST_BIT
(
h•i
->
Inô
.
Fú°Bô
));

96 
	`as£π_∑øm
(
	`IS_SPI_TIMODE
(
h•i
->
Inô
.
TIMode
));

97 
	`as£π_∑øm
(
	`IS_SPI_CRC_CALCULATION
(
h•i
->
Inô
.
CRCCÆcuœti⁄
));

98 
	`as£π_∑øm
(
	`IS_SPI_CRC_POLYNOMIAL
(
h•i
->
Inô
.
CRCPﬁynomül
));

100 if(
h•i
->
Sèã
 =
HAL_SPI_STATE_RESET
)

103 
h•i
->
Lock
 = 
HAL_UNLOCKED
;

106 
	`HAL_SPI_M•Inô
(
h•i
);

109 
h•i
->
Sèã
 = 
HAL_SPI_STATE_BUSY
;

112 
	`__HAL_SPI_DISABLE
(
h•i
);

117 
h•i
->
In°™˚
->
CR1
 = (h•i->
Inô
.
Mode
 | h•i->Inô.
Dúe˘i⁄
 | h•i->Inô.
D©aSize
 |

118 
h•i
->
Inô
.
CLKPﬁ¨ôy
 | h•i->Inô.
CLKPha£
 | (h•i->Inô.
NSS
 & 
SPI_CR1_SSM
) |

119 
h•i
->
Inô
.
BaudR©ePªsˇÀr
 | h•i->Inô.
Fú°Bô
 | h•i->Inô.
CRCCÆcuœti⁄
);

122 
h•i
->
In°™˚
->
CR2
 = (((h•i->
Inô
.
NSS
 >> 16Ë& 
SPI_CR2_SSOE
Ë| h•i->Inô.
TIMode
);

126 
h•i
->
In°™˚
->
CRCPR
 = h•i->
Inô
.
CRCPﬁynomül
;

128 #i‡
	`deföed
 (
STM32L100xC
Ë|| deföed (
STM32L151xC
Ë|| deföed (
STM32L152xC
Ë|| deföed (
STM32L162xC
Ë|| deföed (
STM32L151xCA
Ë|| deföed (
STM32L151xD
Ë|| deföed (
STM32L152xCA
Ë|| deföed (
STM32L152xD
Ë|| deföed (
STM32L162xCA
Ë|| deföed (
STM32L162xD
Ë|| deföed (
STM32L151xE
Ë|| deföed (
STM32L151xDX
Ë|| deföed (
STM32L152xE
Ë|| deföed (
STM32L152xDX
Ë|| deföed (
STM32L162xE
Ë|| deföed (
STM32L162xDX
)

130 
	`CLEAR_BIT
(
h•i
->
In°™˚
->
I2SCFGR
, 
SPI_I2SCFGR_I2SMOD
);

133 
h•i
->
Eº‹Code
 = 
HAL_SPI_ERROR_NONE
;

134 
h•i
->
Sèã
 = 
HAL_SPI_STATE_READY
;

136  
HAL_OK
;

137 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_uart.c

158 
	~"°m32l1xx_hÆ.h
"

168 #ifde‡
HAL_UART_MODULE_ENABLED


178 
UART_SëC⁄fig
 (
UART_H™dÀTy≥Def
 *
hu¨t
);

179 
HAL_SètusTy≥Def
 
UART_Tønsmô_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
);

180 
HAL_SètusTy≥Def
 
UART_EndTønsmô_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
);

181 
HAL_SètusTy≥Def
 
UART_Re˚ive_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
);

182 
UART_DMATønsmôC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
);

183 
UART_DMATxHÆfC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
);

184 
UART_DMARe˚iveC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
);

185 
UART_DMARxHÆfC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
);

186 
UART_DMAEº‹
(
DMA_H™dÀTy≥Def
 *
hdma
);

187 
HAL_SètusTy≥Def
 
UART_WaôOnFœgU¡ûTimeout
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt32_t
 
Fœg
, 
FœgSètus
 
Sètus
, uöt32_à
Timeout
);

250 
HAL_SètusTy≥Def
 
	$HAL_UART_Inô
(
UART_H™dÀTy≥Def
 *
hu¨t
)

253 if(
hu¨t
 =
NULL
)

255  
HAL_ERROR
;

259 if(
hu¨t
->
Inô
.
HwFlowCé
 !
UART_HWCONTROL_NONE
)

262 
	`as£π_∑øm
(
	`IS_UART_HWFLOW_INSTANCE
(
hu¨t
->
In°™˚
));

263 
	`as£π_∑øm
(
	`IS_UART_HARDWARE_FLOW_CONTROL
(
hu¨t
->
Inô
.
HwFlowCé
));

267 
	`as£π_∑øm
(
	`IS_UART_INSTANCE
(
hu¨t
->
In°™˚
));

269 
	`as£π_∑øm
(
	`IS_UART_WORD_LENGTH
(
hu¨t
->
Inô
.
W‹dLígth
));

270 
	`as£π_∑øm
(
	`IS_UART_OVERSAMPLING
(
hu¨t
->
Inô
.
OvîSam∂ög
));

272 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_RESET
)

275 
hu¨t
->
Lock
 = 
HAL_UNLOCKED
;

278 
	`HAL_UART_M•Inô
(
hu¨t
);

281 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

284 
	`__HAL_UART_DISABLE
(
hu¨t
);

287 
	`UART_SëC⁄fig
(
hu¨t
);

292 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR2
, (
USART_CR2_LINEN
 | 
USART_CR2_CLKEN
));

293 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_SCEN
 | 
USART_CR3_HDSEL
 | 
USART_CR3_IREN
));

296 
	`__HAL_UART_ENABLE
(
hu¨t
);

299 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

300 
hu¨t
->
Sèã

HAL_UART_STATE_READY
;

302  
HAL_OK
;

303 
	}
}

312 
HAL_SètusTy≥Def
 
	$HAL_HÆfDu∂ex_Inô
(
UART_H™dÀTy≥Def
 *
hu¨t
)

315 if(
hu¨t
 =
NULL
)

317  
HAL_ERROR
;

321 
	`as£π_∑øm
(
	`IS_UART_HALFDUPLEX_INSTANCE
(
hu¨t
->
In°™˚
));

322 
	`as£π_∑øm
(
	`IS_UART_WORD_LENGTH
(
hu¨t
->
Inô
.
W‹dLígth
));

323 
	`as£π_∑øm
(
	`IS_UART_OVERSAMPLING
(
hu¨t
->
Inô
.
OvîSam∂ög
));

325 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_RESET
)

328 
hu¨t
->
Lock
 = 
HAL_UNLOCKED
;

331 
	`HAL_UART_M•Inô
(
hu¨t
);

334 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

337 
	`__HAL_UART_DISABLE
(
hu¨t
);

340 
	`UART_SëC⁄fig
(
hu¨t
);

345 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR2
, (
USART_CR2_LINEN
 | 
USART_CR2_CLKEN
));

346 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_IREN
 | 
USART_CR3_SCEN
));

349 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_HDSEL
);

352 
	`__HAL_UART_ENABLE
(
hu¨t
);

355 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

356 
hu¨t
->
Sèã

HAL_UART_STATE_READY
;

358  
HAL_OK
;

359 
	}
}

372 
HAL_SètusTy≥Def
 
	$HAL_LIN_Inô
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt32_t
 
BªakDëe˘Lígth
)

375 if(
hu¨t
 =
NULL
)

377  
HAL_ERROR
;

381 
	`as£π_∑øm
(
	`IS_UART_LIN_INSTANCE
(
hu¨t
->
In°™˚
));

383 
	`as£π_∑øm
(
	`IS_UART_LIN_BREAK_DETECT_LENGTH
(
BªakDëe˘Lígth
));

384 
	`as£π_∑øm
(
	`IS_UART_LIN_WORD_LENGTH
(
hu¨t
->
Inô
.
W‹dLígth
));

385 
	`as£π_∑øm
(
	`IS_UART_LIN_OVERSAMPLING
(
hu¨t
->
Inô
.
OvîSam∂ög
));

387 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_RESET
)

390 
hu¨t
->
Lock
 = 
HAL_UNLOCKED
;

393 
	`HAL_UART_M•Inô
(
hu¨t
);

396 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

399 
	`__HAL_UART_DISABLE
(
hu¨t
);

402 
	`UART_SëC⁄fig
(
hu¨t
);

407 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR2
, 
USART_CR2_CLKEN
);

408 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_HDSEL
 | 
USART_CR3_IREN
 | 
USART_CR3_SCEN
));

411 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR2
, 
USART_CR2_LINEN
);

414 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR2
, 
USART_CR2_LBDL
, 
BªakDëe˘Lígth
);

417 
	`__HAL_UART_ENABLE
(
hu¨t
);

420 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

421 
hu¨t
->
Sèã

HAL_UART_STATE_READY
;

423  
HAL_OK
;

424 
	}
}

438 
HAL_SètusTy≥Def
 
	$HAL_Mu…iPro˚ss‹_Inô
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt8_t
 
Addªss
, 
uöt32_t
 
WakeUpMëhod
)

441 if(
hu¨t
 =
NULL
)

443  
HAL_ERROR
;

447 
	`as£π_∑øm
(
	`IS_UART_MULTIPROCESSOR_INSTANCE
(
hu¨t
->
In°™˚
));

450 
	`as£π_∑øm
(
	`IS_UART_WAKEUPMETHOD
(
WakeUpMëhod
));

451 
	`as£π_∑øm
(
	`IS_UART_ADDRESS
(
Addªss
));

452 
	`as£π_∑øm
(
	`IS_UART_WORD_LENGTH
(
hu¨t
->
Inô
.
W‹dLígth
));

453 
	`as£π_∑øm
(
	`IS_UART_OVERSAMPLING
(
hu¨t
->
Inô
.
OvîSam∂ög
));

455 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_RESET
)

458 
hu¨t
->
Lock
 = 
HAL_UNLOCKED
;

461 
	`HAL_UART_M•Inô
(
hu¨t
);

464 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

467 
	`__HAL_UART_DISABLE
(
hu¨t
);

470 
	`UART_SëC⁄fig
(
hu¨t
);

475 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR2
, (
USART_CR2_LINEN
 | 
USART_CR2_CLKEN
));

476 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_SCEN
 | 
USART_CR3_HDSEL
 | 
USART_CR3_IREN
));

479 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR2
, 
USART_CR2_ADD
, 
Addªss
);

482 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR1
, 
USART_CR1_WAKE
, 
WakeUpMëhod
);

485 
	`__HAL_UART_ENABLE
(
hu¨t
);

488 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

489 
hu¨t
->
Sèã

HAL_UART_STATE_READY
;

491  
HAL_OK
;

492 
	}
}

500 
HAL_SètusTy≥Def
 
	$HAL_UART_DeInô
(
UART_H™dÀTy≥Def
 *
hu¨t
)

503 if(
hu¨t
 =
NULL
)

505  
HAL_ERROR
;

509 
	`as£π_∑øm
(
	`IS_UART_INSTANCE
(
hu¨t
->
In°™˚
));

511 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

514 
	`__HAL_UART_DISABLE
(
hu¨t
);

516 
hu¨t
->
In°™˚
->
CR1
 = 0x0;

517 
hu¨t
->
In°™˚
->
CR2
 = 0x0;

518 
hu¨t
->
In°™˚
->
CR3
 = 0x0;

521 
	`HAL_UART_M•DeInô
(
hu¨t
);

523 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

524 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_RESET
;

527 
	`__HAL_UNLOCK
(
hu¨t
);

529  
HAL_OK
;

530 
	}
}

538 
__wók
 
	$HAL_UART_M•Inô
(
UART_H™dÀTy≥Def
 *
hu¨t
)

541 
	`UNUSED
(
hu¨t
);

546 
	}
}

554 
__wók
 
	$HAL_UART_M•DeInô
(
UART_H™dÀTy≥Def
 *
hu¨t
)

557 
	`UNUSED
(
hu¨t
);

562 
	}
}

634 
HAL_SètusTy≥Def
 
	$HAL_UART_Tønsmô
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
Timeout
)

636 
uöt16_t
* 
tmp
;

637 
uöt32_t
 
tmp_°©e
 = 0;

639 
tmp_°©e
 = 
hu¨t
->
Sèã
;

640 if((
tmp_°©e
 =
HAL_UART_STATE_READY
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_RX
))

642 if((
pD©a
 =
NULL
Ë|| (
Size
 == 0))

644  
HAL_ERROR
;

648 
	`__HAL_LOCK
(
hu¨t
);

650 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

652 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_RX
)

654 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX_RX
;

658 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX
;

661 
hu¨t
->
TxX„rSize
 = 
Size
;

662 
hu¨t
->
TxX„rCou¡
 = 
Size
;

663 
hu¨t
->
TxX„rCou¡
 > 0)

665 
hu¨t
->
TxX„rCou¡
--;

666 if(
hu¨t
->
Inô
.
W‹dLígth
 =
UART_WORDLENGTH_9B
)

668 if(
	`UART_WaôOnFœgU¡ûTimeout
(
hu¨t
, 
UART_FLAG_TXE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

670  
HAL_TIMEOUT
;

672 
tmp
 = (
uöt16_t
*Ë
pD©a
;

673 
hu¨t
->
In°™˚
->
DR
 = (*
tmp
 & (
uöt16_t
)0x01FF);

674 if(
hu¨t
->
Inô
.
P¨ôy
 =
UART_PARITY_NONE
)

676 
pD©a
 +=2;

680 
pD©a
 +=1;

685 if(
	`UART_WaôOnFœgU¡ûTimeout
(
hu¨t
, 
UART_FLAG_TXE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

687  
HAL_TIMEOUT
;

689 
hu¨t
->
In°™˚
->
DR
 = (*
pD©a
++ & (
uöt8_t
)0xFF);

693 if(
	`UART_WaôOnFœgU¡ûTimeout
(
hu¨t
, 
UART_FLAG_TC
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

695  
HAL_TIMEOUT
;

699 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX_RX
)

701 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_RX
;

705 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

709 
	`__HAL_UNLOCK
(
hu¨t
);

711  
HAL_OK
;

715  
HAL_BUSY
;

717 
	}
}

728 
HAL_SètusTy≥Def
 
	$HAL_UART_Re˚ive
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
, 
uöt32_t
 
Timeout
)

730 
uöt16_t
* 
tmp
;

731 
uöt32_t
 
tmp_°©e
 = 0;

733 
tmp_°©e
 = 
hu¨t
->
Sèã
;

734 if((
tmp_°©e
 =
HAL_UART_STATE_READY
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_TX
))

736 if((
pD©a
 =
NULL
 ) || (
Size
 == 0))

738  
HAL_ERROR
;

742 
	`__HAL_LOCK
(
hu¨t
);

744 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

746 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX
)

748 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX_RX
;

752 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_RX
;

755 
hu¨t
->
RxX„rSize
 = 
Size
;

756 
hu¨t
->
RxX„rCou¡
 = 
Size
;

759 
hu¨t
->
RxX„rCou¡
 > 0)

761 
hu¨t
->
RxX„rCou¡
--;

762 if(
hu¨t
->
Inô
.
W‹dLígth
 =
UART_WORDLENGTH_9B
)

764 if(
	`UART_WaôOnFœgU¡ûTimeout
(
hu¨t
, 
UART_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

766  
HAL_TIMEOUT
;

768 
tmp
 = (
uöt16_t
*Ë
pD©a
 ;

769 if(
hu¨t
->
Inô
.
P¨ôy
 =
UART_PARITY_NONE
)

771 *
tmp
 = (
uöt16_t
)(
hu¨t
->
In°™˚
->
DR
 & (uint16_t)0x01FF);

772 
pD©a
 +=2;

776 *
tmp
 = (
uöt16_t
)(
hu¨t
->
In°™˚
->
DR
 & (uint16_t)0x00FF);

777 
pD©a
 +=1;

783 if(
	`UART_WaôOnFœgU¡ûTimeout
(
hu¨t
, 
UART_FLAG_RXNE
, 
RESET
, 
Timeout
Ë!
HAL_OK
)

785  
HAL_TIMEOUT
;

787 if(
hu¨t
->
Inô
.
P¨ôy
 =
UART_PARITY_NONE
)

789 *
pD©a
++ = (
uöt8_t
)(
hu¨t
->
In°™˚
->
DR
 & (uint8_t)0x00FF);

793 *
pD©a
++ = (
uöt8_t
)(
hu¨t
->
In°™˚
->
DR
 & (uint8_t)0x007F);

800 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX_RX
)

802 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX
;

806 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

809 
	`__HAL_UNLOCK
(
hu¨t
);

811  
HAL_OK
;

815  
HAL_BUSY
;

817 
	}
}

827 
HAL_SètusTy≥Def
 
	$HAL_UART_Tønsmô_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

829 
uöt32_t
 
tmp_°©e
 = 0;

831 
tmp_°©e
 = 
hu¨t
->
Sèã
;

832 if((
tmp_°©e
 =
HAL_UART_STATE_READY
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_RX
))

834 if((
pD©a
 =
NULL
 ) || (
Size
 == 0))

836  
HAL_ERROR
;

840 
	`__HAL_LOCK
(
hu¨t
);

842 
hu¨t
->
pTxBuffPå
 = 
pD©a
;

843 
hu¨t
->
TxX„rSize
 = 
Size
;

844 
hu¨t
->
TxX„rCou¡
 = 
Size
;

846 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

848 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_RX
)

850 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX_RX
;

854 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX
;

858 
	`__HAL_UNLOCK
(
hu¨t
);

861 
	`__HAL_UART_ENABLE_IT
(
hu¨t
, 
UART_IT_TXE
);

863  
HAL_OK
;

867  
HAL_BUSY
;

869 
	}
}

879 
HAL_SètusTy≥Def
 
	$HAL_UART_Re˚ive_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

881 
uöt32_t
 
tmp_°©e
 = 0;

883 
tmp_°©e
 = 
hu¨t
->
Sèã
;

884 if((
tmp_°©e
 =
HAL_UART_STATE_READY
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_TX
))

886 if((
pD©a
 =
NULL
 ) || (
Size
 == 0))

888  
HAL_ERROR
;

892 
	`__HAL_LOCK
(
hu¨t
);

894 
hu¨t
->
pRxBuffPå
 = 
pD©a
;

895 
hu¨t
->
RxX„rSize
 = 
Size
;

896 
hu¨t
->
RxX„rCou¡
 = 
Size
;

898 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

900 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX
)

902 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX_RX
;

906 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_RX
;

910 
	`__HAL_UNLOCK
(
hu¨t
);

913 
	`__HAL_UART_ENABLE_IT
(
hu¨t
, 
UART_IT_PE
);

916 
	`__HAL_UART_ENABLE_IT
(
hu¨t
, 
UART_IT_ERR
);

919 
	`__HAL_UART_ENABLE_IT
(
hu¨t
, 
UART_IT_RXNE
);

921  
HAL_OK
;

925  
HAL_BUSY
;

927 
	}
}

937 
HAL_SètusTy≥Def
 
	$HAL_UART_Tønsmô_DMA
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

939 
uöt32_t
 *
tmp
;

940 
uöt32_t
 
tmp_°©e
 = 0;

942 
tmp_°©e
 = 
hu¨t
->
Sèã
;

943 if((
tmp_°©e
 =
HAL_UART_STATE_READY
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_RX
))

945 if((
pD©a
 =
NULL
 ) || (
Size
 == 0))

947  
HAL_ERROR
;

951 
	`__HAL_LOCK
(
hu¨t
);

953 
hu¨t
->
pTxBuffPå
 = 
pD©a
;

954 
hu¨t
->
TxX„rSize
 = 
Size
;

955 
hu¨t
->
TxX„rCou¡
 = 
Size
;

957 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

959 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_RX
)

961 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX_RX
;

965 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX
;

969 
hu¨t
->
hdm©x
->
X„rC∂tCÆlback
 = 
UART_DMATønsmôC∂t
;

972 
hu¨t
->
hdm©x
->
X„rHÆfC∂tCÆlback
 = 
UART_DMATxHÆfC∂t
;

975 
hu¨t
->
hdm©x
->
X„rEº‹CÆlback
 = 
UART_DMAEº‹
;

978 
tmp
 = (
uöt32_t
*)&
pD©a
;

979 
	`HAL_DMA_Sèπ_IT
(
hu¨t
->
hdm©x
, *(
uöt32_t
*)
tmp
, (uöt32_t)&hu¨t->
In°™˚
->
DR
, 
Size
);

982 
	`__HAL_UART_CLEAR_FLAG
(
hu¨t
, 
UART_FLAG_TC
);

986 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAT
);

989 
	`__HAL_UNLOCK
(
hu¨t
);

991  
HAL_OK
;

995  
HAL_BUSY
;

997 
	}
}

1009 
HAL_SètusTy≥Def
 
	$HAL_UART_Re˚ive_DMA
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt8_t
 *
pD©a
, 
uöt16_t
 
Size
)

1011 
uöt32_t
 *
tmp
;

1012 
uöt32_t
 
tmp_°©e
 = 0;

1014 
tmp_°©e
 = 
hu¨t
->
Sèã
;

1015 if((
tmp_°©e
 =
HAL_UART_STATE_READY
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_TX
))

1017 if((
pD©a
 =
NULL
 ) || (
Size
 == 0))

1019  
HAL_ERROR
;

1023 
	`__HAL_LOCK
(
hu¨t
);

1025 
hu¨t
->
pRxBuffPå
 = 
pD©a
;

1026 
hu¨t
->
RxX„rSize
 = 
Size
;

1028 
hu¨t
->
Eº‹Code
 = 
HAL_UART_ERROR_NONE
;

1030 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX
)

1032 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX_RX
;

1036 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_RX
;

1040 
hu¨t
->
hdm¨x
->
X„rC∂tCÆlback
 = 
UART_DMARe˚iveC∂t
;

1043 
hu¨t
->
hdm¨x
->
X„rHÆfC∂tCÆlback
 = 
UART_DMARxHÆfC∂t
;

1046 
hu¨t
->
hdm¨x
->
X„rEº‹CÆlback
 = 
UART_DMAEº‹
;

1049 
tmp
 = (
uöt32_t
*)&
pD©a
;

1050 
	`HAL_DMA_Sèπ_IT
(
hu¨t
->
hdm¨x
, (
uöt32_t
)&hu¨t->
In°™˚
->
DR
, *(uöt32_t*)
tmp
, 
Size
);

1054 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAR
);

1057 
	`__HAL_UNLOCK
(
hu¨t
);

1059  
HAL_OK
;

1063  
HAL_BUSY
;

1065 
	}
}

1073 
HAL_SètusTy≥Def
 
	$HAL_UART_DMAPau£
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1076 
	`__HAL_LOCK
(
hu¨t
);

1078 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX
)

1081 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAT
);

1083 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_RX
)

1086 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAR
);

1088 i‡(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX_RX
)

1091 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_DMAT
 | 
USART_CR3_DMAR
));

1096 
	`__HAL_UNLOCK
(
hu¨t
);

1098  
HAL_ERROR
;

1102 
	`__HAL_UNLOCK
(
hu¨t
);

1104  
HAL_OK
;

1105 
	}
}

1113 
HAL_SètusTy≥Def
 
	$HAL_UART_DMAResume
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1116 
	`__HAL_LOCK
(
hu¨t
);

1118 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX
)

1121 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAT
);

1123 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_RX
)

1126 
	`__HAL_UART_CLEAR_OREFLAG
(
hu¨t
);

1128 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAR
);

1130 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX_RX
)

1133 
	`__HAL_UART_CLEAR_OREFLAG
(
hu¨t
);

1135 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_DMAT
 | 
USART_CR3_DMAR
));

1140 
	`__HAL_UNLOCK
(
hu¨t
);

1142  
HAL_ERROR
;

1146 
	`__HAL_UNLOCK
(
hu¨t
);

1148  
HAL_OK
;

1149 
	}
}

1157 
HAL_SètusTy≥Def
 
	$HAL_UART_DMASt›
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1166 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_DMAT
 | 
USART_CR3_DMAR
));

1169 if(
hu¨t
->
hdm©x
 !
NULL
)

1171 
	`HAL_DMA_Ab‹t
(
hu¨t
->
hdm©x
);

1174 if(
hu¨t
->
hdm¨x
 !
NULL
)

1176 
	`HAL_DMA_Ab‹t
(
hu¨t
->
hdm¨x
);

1179 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1181  
HAL_OK
;

1182 
	}
}

1190 
	$HAL_UART_IRQH™dÀr
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1192 
uöt32_t
 
tmp_Êag
 = 0, 
tmp_ô_sour˚
 = 0;

1194 
tmp_Êag
 = 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
UART_FLAG_PE
);

1195 
tmp_ô_sour˚
 = 
	`__HAL_UART_GET_IT_SOURCE
(
hu¨t
, 
UART_IT_PE
);

1197 if((
tmp_Êag
 !
RESET
Ë&& (
tmp_ô_sour˚
 != RESET))

1199 
hu¨t
->
Eº‹Code
 |
HAL_UART_ERROR_PE
;

1202 
tmp_Êag
 = 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
UART_FLAG_FE
);

1203 
tmp_ô_sour˚
 = 
	`__HAL_UART_GET_IT_SOURCE
(
hu¨t
, 
UART_IT_ERR
);

1205 if((
tmp_Êag
 !
RESET
Ë&& (
tmp_ô_sour˚
 != RESET))

1207 
hu¨t
->
Eº‹Code
 |
HAL_UART_ERROR_FE
;

1210 
tmp_Êag
 = 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
UART_FLAG_NE
);

1212 if((
tmp_Êag
 !
RESET
Ë&& (
tmp_ô_sour˚
 != RESET))

1214 
hu¨t
->
Eº‹Code
 |
HAL_UART_ERROR_NE
;

1217 
tmp_Êag
 = 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
UART_FLAG_ORE
);

1219 if((
tmp_Êag
 !
RESET
Ë&& (
tmp_ô_sour˚
 != RESET))

1221 
hu¨t
->
Eº‹Code
 |
HAL_UART_ERROR_ORE
;

1224 
tmp_Êag
 = 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
UART_FLAG_RXNE
);

1225 
tmp_ô_sour˚
 = 
	`__HAL_UART_GET_IT_SOURCE
(
hu¨t
, 
UART_IT_RXNE
);

1227 if((
tmp_Êag
 !
RESET
Ë&& (
tmp_ô_sour˚
 != RESET))

1229 
	`UART_Re˚ive_IT
(
hu¨t
);

1232 
tmp_Êag
 = 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
UART_FLAG_TXE
);

1233 
tmp_ô_sour˚
 = 
	`__HAL_UART_GET_IT_SOURCE
(
hu¨t
, 
UART_IT_TXE
);

1235 if((
tmp_Êag
 !
RESET
Ë&& (
tmp_ô_sour˚
 != RESET))

1237 
	`UART_Tønsmô_IT
(
hu¨t
);

1240 
tmp_Êag
 = 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
UART_FLAG_TC
);

1241 
tmp_ô_sour˚
 = 
	`__HAL_UART_GET_IT_SOURCE
(
hu¨t
, 
UART_IT_TC
);

1243 if((
tmp_Êag
 !
RESET
Ë&& (
tmp_ô_sour˚
 != RESET))

1245 
	`UART_EndTønsmô_IT
(
hu¨t
);

1248 if(
hu¨t
->
Eº‹Code
 !
HAL_UART_ERROR_NONE
)

1251 
	`__HAL_UART_CLEAR_PEFLAG
(
hu¨t
);

1254 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1256 
	`HAL_UART_Eº‹CÆlback
(
hu¨t
);

1258 
	}
}

1266 
__wók
 
	$HAL_UART_TxC∂tCÆlback
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1269 
	`UNUSED
(
hu¨t
);

1274 
	}
}

1282 
__wók
 
	$HAL_UART_TxHÆfC∂tCÆlback
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1285 
	`UNUSED
(
hu¨t
);

1290 
	}
}

1298 
__wók
 
	$HAL_UART_RxC∂tCÆlback
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1301 
	`UNUSED
(
hu¨t
);

1306 
	}
}

1314 
__wók
 
	$HAL_UART_RxHÆfC∂tCÆlback
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1317 
	`UNUSED
(
hu¨t
);

1322 
	}
}

1330 
__wók
 
	$HAL_UART_Eº‹CÆlback
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1333 
	`UNUSED
(
hu¨t
);

1338 
	}
}

1369 
HAL_SètusTy≥Def
 
	$HAL_LIN_SídBªak
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1372 
	`as£π_∑øm
(
	`IS_UART_LIN_INSTANCE
(
hu¨t
->
In°™˚
));

1375 
	`__HAL_LOCK
(
hu¨t
);

1377 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

1380 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR1
, 
USART_CR1_SBK
);

1382 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1385 
	`__HAL_UNLOCK
(
hu¨t
);

1387  
HAL_OK
;

1388 
	}
}

1396 
HAL_SètusTy≥Def
 
	$HAL_Mu…iPro˚ss‹_E¡îMuãMode
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1399 
	`as£π_∑øm
(
	`IS_UART_INSTANCE
(
hu¨t
->
In°™˚
));

1402 
	`__HAL_LOCK
(
hu¨t
);

1404 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

1407 
	`SET_BIT
(
hu¨t
->
In°™˚
->
CR1
, 
USART_CR1_RWU
);

1409 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1412 
	`__HAL_UNLOCK
(
hu¨t
);

1414  
HAL_OK
;

1415 
	}
}

1423 
HAL_SètusTy≥Def
 
	$HAL_Mu…iPro˚ss‹_ExôMuãMode
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1426 
	`as£π_∑øm
(
	`IS_UART_INSTANCE
(
hu¨t
->
In°™˚
));

1429 
	`__HAL_LOCK
(
hu¨t
);

1431 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

1434 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR1
, 
USART_CR1_RWU
);

1436 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1439 
	`__HAL_UNLOCK
(
hu¨t
);

1441  
HAL_OK
;

1442 
	}
}

1450 
HAL_SètusTy≥Def
 
	$HAL_HÆfDu∂ex_E«bÀTønsmôãr
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1453 
	`__HAL_LOCK
(
hu¨t
);

1455 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

1460 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR1
, (
uöt32_t
)(
USART_CR1_TE
 | 
USART_CR1_RE
), USART_CR1_TE);

1462 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1465 
	`__HAL_UNLOCK
(
hu¨t
);

1467  
HAL_OK
;

1468 
	}
}

1476 
HAL_SètusTy≥Def
 
	$HAL_HÆfDu∂ex_E«bÀRe˚ivî
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1479 
	`__HAL_LOCK
(
hu¨t
);

1481 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY
;

1486 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR1
, (
uöt32_t
)(
USART_CR1_TE
 | 
USART_CR1_RE
), USART_CR1_RE);

1488 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1491 
	`__HAL_UNLOCK
(
hu¨t
);

1493  
HAL_OK
;

1494 
	}
}

1524 
HAL_UART_SèãTy≥Def
 
	$HAL_UART_GëSèã
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1526  
hu¨t
->
Sèã
;

1527 
	}
}

1535 
uöt32_t
 
	$HAL_UART_GëEº‹
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1537  
hu¨t
->
Eº‹Code
;

1538 
	}
}

1558 
	$UART_DMATønsmôC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
)

1560 
UART_H™dÀTy≥Def
* 
hu¨t
 = ( UART_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

1562 i‡–
	`HAL_IS_BIT_CLR
(
hdma
->
In°™˚
->
CCR
, 
DMA_CCR_CIRC
) )

1564 
hu¨t
->
TxX„rCou¡
 = 0;

1568 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAT
);

1571 
	`__HAL_UART_ENABLE_IT
(
hu¨t
, 
UART_IT_TC
);

1576 
	`HAL_UART_TxC∂tCÆlback
(
hu¨t
);

1578 
	}
}

1586 
	$UART_DMATxHÆfC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
)

1588 
UART_H™dÀTy≥Def
* 
hu¨t
 = (UART_H™dÀTy≥Def*)((
DMA_H™dÀTy≥Def
*)
hdma
)->
P¨ít
;

1590 
	`HAL_UART_TxHÆfC∂tCÆlback
(
hu¨t
);

1591 
	}
}

1599 
	$UART_DMARe˚iveC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
)

1601 
UART_H™dÀTy≥Def
* 
hu¨t
 = ( UART_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

1603 i‡–
	`HAL_IS_BIT_CLR
(
hdma
->
In°™˚
->
CCR
, 
DMA_CCR_CIRC
) )

1605 
hu¨t
->
RxX„rCou¡
 = 0;

1609 
	`CLEAR_BIT
(
hu¨t
->
In°™˚
->
CR3
, 
USART_CR3_DMAR
);

1612 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX_RX
)

1614 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX
;

1618 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1621 
	`HAL_UART_RxC∂tCÆlback
(
hu¨t
);

1622 
	}
}

1630 
	$UART_DMARxHÆfC∂t
(
DMA_H™dÀTy≥Def
 *
hdma
)

1632 
UART_H™dÀTy≥Def
* 
hu¨t
 = (UART_H™dÀTy≥Def*)((
DMA_H™dÀTy≥Def
*)
hdma
)->
P¨ít
;

1634 
	`HAL_UART_RxHÆfC∂tCÆlback
(
hu¨t
);

1635 
	}
}

1643 
	$UART_DMAEº‹
(
DMA_H™dÀTy≥Def
 *
hdma
)

1645 
UART_H™dÀTy≥Def
* 
hu¨t
 = ( UART_H™dÀTy≥Def* )((
DMA_H™dÀTy≥Def
* )
hdma
)->
P¨ít
;

1646 
hu¨t
->
RxX„rCou¡
 = 0;

1647 
hu¨t
->
TxX„rCou¡
 = 0;

1648 
hu¨t
->
Sèã

HAL_UART_STATE_READY
;

1649 
hu¨t
->
Eº‹Code
 |
HAL_UART_ERROR_DMA
;

1650 
	`HAL_UART_Eº‹CÆlback
(
hu¨t
);

1651 
	}
}

1662 
HAL_SètusTy≥Def
 
	$UART_WaôOnFœgU¡ûTimeout
(
UART_H™dÀTy≥Def
 *
hu¨t
, 
uöt32_t
 
Fœg
, 
FœgSètus
 
Sètus
, uöt32_à
Timeout
)

1664 
uöt32_t
 
tick°¨t
 = 0;

1667 
tick°¨t
 = 
	`HAL_GëTick
();

1670 if(
Sètus
 =
RESET
)

1672 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
Fœg
Ë=
RESET
)

1675 if(
Timeout
 !
HAL_MAX_DELAY
)

1677 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1680 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_TXE
);

1681 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_RXNE
);

1682 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_PE
);

1683 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_ERR
);

1685 
hu¨t
->
Sèã

HAL_UART_STATE_READY
;

1688 
	`__HAL_UNLOCK
(
hu¨t
);

1690  
HAL_TIMEOUT
;

1697 
	`__HAL_UART_GET_FLAG
(
hu¨t
, 
Fœg
Ë!
RESET
)

1700 if(
Timeout
 !
HAL_MAX_DELAY
)

1702 if((
Timeout
 =0)||((
	`HAL_GëTick
(Ë- 
tick°¨t
 ) > Timeout))

1705 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_TXE
);

1706 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_RXNE
);

1707 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_PE
);

1708 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_ERR
);

1710 
hu¨t
->
Sèã

HAL_UART_STATE_READY
;

1713 
	`__HAL_UNLOCK
(
hu¨t
);

1715  
HAL_TIMEOUT
;

1720  
HAL_OK
;

1721 
	}
}

1729 
HAL_SètusTy≥Def
 
	$UART_Tønsmô_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1731 
uöt16_t
* 
tmp
;

1732 
uöt32_t
 
tmp_°©e
 = 0;

1734 
tmp_°©e
 = 
hu¨t
->
Sèã
;

1735 if((
tmp_°©e
 =
HAL_UART_STATE_BUSY_TX
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_TX_RX
))

1737 if(
hu¨t
->
Inô
.
W‹dLígth
 =
UART_WORDLENGTH_9B
)

1739 
tmp
 = (
uöt16_t
*Ë
hu¨t
->
pTxBuffPå
;

1740 
hu¨t
->
In°™˚
->
DR
 = (
uöt16_t
)(*
tmp
 & (uint16_t)0x01FF);

1741 if(
hu¨t
->
Inô
.
P¨ôy
 =
UART_PARITY_NONE
)

1743 
hu¨t
->
pTxBuffPå
 += 2;

1747 
hu¨t
->
pTxBuffPå
 += 1;

1752 
hu¨t
->
In°™˚
->
DR
 = (
uöt8_t
)(*hu¨t->
pTxBuffPå
++ & (uint8_t)0x00FF);

1755 if(--
hu¨t
->
TxX„rCou¡
 == 0)

1758 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_TXE
);

1761 
	`__HAL_UART_ENABLE_IT
(
hu¨t
, 
UART_IT_TC
);

1763  
HAL_OK
;

1767  
HAL_BUSY
;

1769 
	}
}

1778 
HAL_SètusTy≥Def
 
	$UART_EndTønsmô_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1781 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_TC
);

1784 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX_RX
)

1786 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_RX
;

1790 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1793 
	`HAL_UART_TxC∂tCÆlback
(
hu¨t
);

1795  
HAL_OK
;

1796 
	}
}

1804 
HAL_SètusTy≥Def
 
	$UART_Re˚ive_IT
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1806 
uöt16_t
* 
tmp
;

1807 
uöt32_t
 
tmp_°©e
 = 0;

1809 
tmp_°©e
 = 
hu¨t
->
Sèã
;

1810 if((
tmp_°©e
 =
HAL_UART_STATE_BUSY_RX
Ë|| (tmp_°©ê=
HAL_UART_STATE_BUSY_TX_RX
))

1812 if(
hu¨t
->
Inô
.
W‹dLígth
 =
UART_WORDLENGTH_9B
)

1814 
tmp
 = (
uöt16_t
*Ë
hu¨t
->
pRxBuffPå
;

1815 if(
hu¨t
->
Inô
.
P¨ôy
 =
UART_PARITY_NONE
)

1817 *
tmp
 = (
uöt16_t
)(
hu¨t
->
In°™˚
->
DR
 & (uint16_t)0x01FF);

1818 
hu¨t
->
pRxBuffPå
 += 2;

1822 *
tmp
 = (
uöt16_t
)(
hu¨t
->
In°™˚
->
DR
 & (uint16_t)0x00FF);

1823 
hu¨t
->
pRxBuffPå
 += 1;

1828 if(
hu¨t
->
Inô
.
P¨ôy
 =
UART_PARITY_NONE
)

1830 *
hu¨t
->
pRxBuffPå
++ = (
uöt8_t
)(hu¨t->
In°™˚
->
DR
 & (uint8_t)0x00FF);

1834 *
hu¨t
->
pRxBuffPå
++ = (
uöt8_t
)(hu¨t->
In°™˚
->
DR
 & (uint8_t)0x007F);

1838 if(--
hu¨t
->
RxX„rCou¡
 == 0)

1840 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_RXNE
);

1843 if(
hu¨t
->
Sèã
 =
HAL_UART_STATE_BUSY_TX_RX
)

1845 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_BUSY_TX
;

1850 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_PE
);

1853 
	`__HAL_UART_DISABLE_IT
(
hu¨t
, 
UART_IT_ERR
);

1855 
hu¨t
->
Sèã
 = 
HAL_UART_STATE_READY
;

1857 
	`HAL_UART_RxC∂tCÆlback
(
hu¨t
);

1859  
HAL_OK
;

1861  
HAL_OK
;

1865  
HAL_BUSY
;

1867 
	}
}

1875 
	$UART_SëC⁄fig
(
UART_H™dÀTy≥Def
 *
hu¨t
)

1877 
uöt32_t
 
tm¥eg
 = 0x00;

1880 
	`as£π_∑øm
(
	`IS_UART_BAUDRATE
(
hu¨t
->
Inô
.
BaudR©e
));

1881 
	`as£π_∑øm
(
	`IS_UART_STOPBITS
(
hu¨t
->
Inô
.
St›Bôs
));

1882 
	`as£π_∑øm
(
	`IS_UART_PARITY
(
hu¨t
->
Inô
.
P¨ôy
));

1883 
	`as£π_∑øm
(
	`IS_UART_MODE
(
hu¨t
->
Inô
.
Mode
));

1888 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR2
, 
USART_CR2_STOP
, hu¨t->
Inô
.
St›Bôs
);

1896 
tm¥eg
 = (
uöt32_t
)
hu¨t
->
Inô
.
W‹dLígth
 | hu¨t->Inô.
P¨ôy
 | hu¨t->Inô.
Mode
 | hu¨t->Inô.
OvîSam∂ög
;

1897 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR1
,

1898 (
uöt32_t
)(
USART_CR1_M
 | 
USART_CR1_PCE
 | 
USART_CR1_PS
 | 
USART_CR1_TE
 | 
USART_CR1_RE
 | 
USART_CR1_OVER8
),

1899 
tm¥eg
);

1903 
	`MODIFY_REG
(
hu¨t
->
In°™˚
->
CR3
, (
USART_CR3_RTSE
 | 
USART_CR3_CTSE
), hu¨t->
Inô
.
HwFlowCé
);

1906 if(
hu¨t
->
Inô
.
OvîSam∂ög
 =
UART_OVERSAMPLING_8
)

1909 if((
hu¨t
->
In°™˚
 =
USART1
))

1911 
hu¨t
->
In°™˚
->
BRR
 = 
	`UART_BRR_SAMPLING8
(
	`HAL_RCC_GëPCLK2Fªq
(), hu¨t->
Inô
.
BaudR©e
);

1915 
hu¨t
->
In°™˚
->
BRR
 = 
	`UART_BRR_SAMPLING8
(
	`HAL_RCC_GëPCLK1Fªq
(), hu¨t->
Inô
.
BaudR©e
);

1921 if((
hu¨t
->
In°™˚
 =
USART1
))

1923 
hu¨t
->
In°™˚
->
BRR
 = 
	`UART_BRR_SAMPLING16
(
	`HAL_RCC_GëPCLK2Fªq
(), hu¨t->
Inô
.
BaudR©e
);

1927 
hu¨t
->
In°™˚
->
BRR
 = 
	`UART_BRR_SAMPLING16
(
	`HAL_RCC_GëPCLK1Fªq
(), hu¨t->
Inô
.
BaudR©e
);

1930 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Class\CDC\Src\usbd_cdc.c

62 
	~"usbd_cdc.h
"

63 
	~"usbd_desc.h
"

64 
	~"usbd_˘Ãeq.h
"

107 
uöt8_t
 
USBD_CDC_Inô
 (
USBD_H™dÀTy≥Def
 *
pdev
,

108 
uöt8_t
 
cfgidx
);

110 
uöt8_t
 
USBD_CDC_DeInô
 (
USBD_H™dÀTy≥Def
 *
pdev
,

111 
uöt8_t
 
cfgidx
);

113 
uöt8_t
 
USBD_CDC_Sëup
 (
USBD_H™dÀTy≥Def
 *
pdev
,

114 
USBD_SëupReqTy≥def
 *
ªq
);

116 
uöt8_t
 
USBD_CDC_D©aIn
 (
USBD_H™dÀTy≥Def
 *
pdev
,

117 
uöt8_t
 
ïnum
);

119 
uöt8_t
 
USBD_CDC_D©aOut
 (
USBD_H™dÀTy≥Def
 *
pdev
,

120 
uöt8_t
 
ïnum
);

122 
uöt8_t
 
USBD_CDC_EP0_RxRódy
 (
USBD_H™dÀTy≥Def
 *
pdev
);

124 
uöt8_t
 *
USBD_CDC_GëFSCfgDesc
 (
uöt16_t
 *
Àngth
);

126 
uöt8_t
 *
USBD_CDC_GëHSCfgDesc
 (
uöt16_t
 *
Àngth
);

128 
uöt8_t
 *
USBD_CDC_GëOthîS≥edCfgDesc
 (
uöt16_t
 *
Àngth
);

130 
uöt8_t
 *
USBD_CDC_GëOthîS≥edCfgDesc
 (
uöt16_t
 *
Àngth
);

132 
uöt8_t
 *
USBD_CDC_GëDevi˚QuÆifõrDes¸ùt‹
 (
uöt16_t
 *
Àngth
);

135 
__ALIGN_BEGIN
 
uöt8_t
 
	gUSBD_CDC_Devi˚QuÆifõrDesc
[
USB_LEN_DEV_QUALIFIER_DESC
] 
	g__ALIGN_END
 =

137 
USB_LEN_DEV_QUALIFIER_DESC
,

138 
USB_DESC_TYPE_DEVICE_QUALIFIER
,

159 
USBD_CœssTy≥Def
 
	gUSBD_CDC
 =

161 
USBD_CDC_Inô
,

162 
USBD_CDC_DeInô
,

163 
USBD_CDC_Sëup
,

164 
NULL
,

165 
USBD_CDC_EP0_RxRódy
,

166 
USBD_CDC_D©aIn
,

167 
USBD_CDC_D©aOut
,

168 
NULL
,

169 
NULL
,

170 
NULL
,

171 
USBD_CDC_GëHSCfgDesc
,

172 
USBD_CDC_GëFSCfgDesc
,

173 
USBD_CDC_GëOthîS≥edCfgDesc
,

174 
USBD_CDC_GëDevi˚QuÆifõrDes¸ùt‹
,

178 
__ALIGN_BEGIN
 
uöt8_t
 
	gUSBD_CDC_CfgHSDesc
[
USB_CDC_CONFIG_DESC_SIZ
] 
	g__ALIGN_END
 =

182 
USB_DESC_TYPE_CONFIGURATION
,

183 
USB_CDC_CONFIG_DESC_SIZ
,

195 
USB_DESC_TYPE_INTERFACE
,

234 
USB_DESC_TYPE_ENDPOINT
,

235 
CDC_CMD_EP
,

237 
LOBYTE
(
CDC_CMD_PACKET_SIZE
),

238 
HIBYTE
(
CDC_CMD_PACKET_SIZE
),

244 
USB_DESC_TYPE_INTERFACE
,

255 
USB_DESC_TYPE_ENDPOINT
,

256 
CDC_OUT_EP
,

258 
LOBYTE
(
CDC_DATA_HS_MAX_PACKET_SIZE
),

259 
HIBYTE
(
CDC_DATA_HS_MAX_PACKET_SIZE
),

264 
USB_DESC_TYPE_ENDPOINT
,

265 
CDC_IN_EP
,

267 
LOBYTE
(
CDC_DATA_HS_MAX_PACKET_SIZE
),

268 
HIBYTE
(
CDC_DATA_HS_MAX_PACKET_SIZE
),

274 
__ALIGN_BEGIN
 
uöt8_t
 
	gUSBD_CDC_CfgFSDesc
[
USB_CDC_CONFIG_DESC_SIZ
] 
	g__ALIGN_END
 =

278 
USB_DESC_TYPE_CONFIGURATION
,

279 
USB_CDC_CONFIG_DESC_SIZ
,

291 
USB_DESC_TYPE_INTERFACE
,

330 
USB_DESC_TYPE_ENDPOINT
,

331 
CDC_CMD_EP
,

333 
LOBYTE
(
CDC_CMD_PACKET_SIZE
),

334 
HIBYTE
(
CDC_CMD_PACKET_SIZE
),

340 
USB_DESC_TYPE_INTERFACE
,

351 
USB_DESC_TYPE_ENDPOINT
,

352 
CDC_OUT_EP
,

354 
LOBYTE
(
CDC_DATA_FS_MAX_PACKET_SIZE
),

355 
HIBYTE
(
CDC_DATA_FS_MAX_PACKET_SIZE
),

360 
USB_DESC_TYPE_ENDPOINT
,

361 
CDC_IN_EP
,

363 
LOBYTE
(
CDC_DATA_FS_MAX_PACKET_SIZE
),

364 
HIBYTE
(
CDC_DATA_FS_MAX_PACKET_SIZE
),

368 
__ALIGN_BEGIN
 
uöt8_t
 
	gUSBD_CDC_OthîS≥edCfgDesc
[
USB_CDC_CONFIG_DESC_SIZ
] 
	g__ALIGN_END
 =

371 
USB_DESC_TYPE_OTHER_SPEED_CONFIGURATION
,

372 
USB_CDC_CONFIG_DESC_SIZ
,

382 
USB_DESC_TYPE_INTERFACE
,

421 
USB_DESC_TYPE_ENDPOINT
 ,

422 
CDC_CMD_EP
,

424 
LOBYTE
(
CDC_CMD_PACKET_SIZE
),

425 
HIBYTE
(
CDC_CMD_PACKET_SIZE
),

432 
USB_DESC_TYPE_INTERFACE
,

443 
USB_DESC_TYPE_ENDPOINT
,

444 
CDC_OUT_EP
,

452 
USB_DESC_TYPE_ENDPOINT
,

453 
CDC_IN_EP
,

475 
uöt8_t
 
	$USBD_CDC_Inô
 (
USBD_H™dÀTy≥Def
 *
pdev
,

476 
uöt8_t
 
cfgidx
)

478 
uöt8_t
 
ªt
 = 0;

479 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
;

481 if(
pdev
->
dev_•ìd
 =
USBD_SPEED_HIGH
 )

484 
	`USBD_LL_O≥nEP
(
pdev
,

485 
CDC_IN_EP
,

486 
USBD_EP_TYPE_BULK
,

487 
CDC_DATA_HS_IN_PACKET_SIZE
);

490 
	`USBD_LL_O≥nEP
(
pdev
,

491 
CDC_OUT_EP
,

492 
USBD_EP_TYPE_BULK
,

493 
CDC_DATA_HS_OUT_PACKET_SIZE
);

499 
	`USBD_LL_O≥nEP
(
pdev
,

500 
CDC_IN_EP
,

501 
USBD_EP_TYPE_BULK
,

502 
CDC_DATA_FS_IN_PACKET_SIZE
);

505 
	`USBD_LL_O≥nEP
(
pdev
,

506 
CDC_OUT_EP
,

507 
USBD_EP_TYPE_BULK
,

508 
CDC_DATA_FS_OUT_PACKET_SIZE
);

511 
	`USBD_LL_O≥nEP
(
pdev
,

512 
CDC_CMD_EP
,

513 
USBD_EP_TYPE_INTR
,

514 
CDC_CMD_PACKET_SIZE
);

517 
pdev
->
pCœssD©a
 = 
	`USBD_mÆloc
( (
USBD_CDC_H™dÀTy≥Def
));

519 if(
pdev
->
pCœssD©a
 =
NULL
)

521 
ªt
 = 1;

525 
hcdc
 = (
USBD_CDC_H™dÀTy≥Def
*Ë
pdev
->
pCœssD©a
;

528 ((
USBD_CDC_ItfTy≥Def
 *)
pdev
->
pU£rD©a
)->
	`Inô
();

531 
hcdc
->
TxSèã
 =0;

532 
hcdc
->
RxSèã
 =0;

534 if(
pdev
->
dev_•ìd
 =
USBD_SPEED_HIGH
 )

537 
	`USBD_LL_Pª∑ªRe˚ive
(
pdev
,

538 
CDC_OUT_EP
,

539 
hcdc
->
RxBuf„r
,

540 
CDC_DATA_HS_OUT_PACKET_SIZE
);

545 
	`USBD_LL_Pª∑ªRe˚ive
(
pdev
,

546 
CDC_OUT_EP
,

547 
hcdc
->
RxBuf„r
,

548 
CDC_DATA_FS_OUT_PACKET_SIZE
);

553  
ªt
;

554 
	}
}

563 
uöt8_t
 
	$USBD_CDC_DeInô
 (
USBD_H™dÀTy≥Def
 *
pdev
,

564 
uöt8_t
 
cfgidx
)

566 
uöt8_t
 
ªt
 = 0;

569 
	`USBD_LL_Clo£EP
(
pdev
,

570 
CDC_IN_EP
);

573 
	`USBD_LL_Clo£EP
(
pdev
,

574 
CDC_OUT_EP
);

577 
	`USBD_LL_Clo£EP
(
pdev
,

578 
CDC_CMD_EP
);

582 if(
pdev
->
pCœssD©a
 !
NULL
)

584 ((
USBD_CDC_ItfTy≥Def
 *)
pdev
->
pU£rD©a
)->
	`DeInô
();

585 
	`USBD_‰ì
(
pdev
->
pCœssD©a
);

586 
pdev
->
pCœssD©a
 = 
NULL
;

589  
ªt
;

590 
	}
}

599 
uöt8_t
 
	$USBD_CDC_Sëup
 (
USBD_H™dÀTy≥Def
 *
pdev
,

600 
USBD_SëupReqTy≥def
 *
ªq
)

602 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

603 
uöt8_t
 
iÁ…
 = 0;

605 
ªq
->
bmReque°
 & 
USB_REQ_TYPE_MASK
)

607 
USB_REQ_TYPE_CLASS
 :

608 i‡(
ªq
->
wLígth
)

610 i‡(
ªq
->
bmReque°
 & 0x80)

612 ((
USBD_CDC_ItfTy≥Def
 *)
pdev
->
pU£rD©a
)->
	`C⁄åﬁ
(
ªq
->
bReque°
,

613 (
uöt8_t
 *)
hcdc
->
d©a
,

614 
ªq
->
wLígth
);

615 
	`USBD_CéSídD©a
 (
pdev
,

616 (
uöt8_t
 *)
hcdc
->
d©a
,

617 
ªq
->
wLígth
);

621 
hcdc
->
CmdOpCode
 = 
ªq
->
bReque°
;

622 
hcdc
->
CmdLígth
 = 
ªq
->
wLígth
;

624 
	`USBD_CéPª∑ªRx
 (
pdev
,

625 (
uöt8_t
 *)
hcdc
->
d©a
,

626 
ªq
->
wLígth
);

632 ((
USBD_CDC_ItfTy≥Def
 *)
pdev
->
pU£rD©a
)->
	`C⁄åﬁ
(
ªq
->
bReque°
,

633 (
uöt8_t
*)
ªq
,

638 
USB_REQ_TYPE_STANDARD
:

639 
ªq
->
bReque°
)

641 
USB_REQ_GET_INTERFACE
 :

642 
	`USBD_CéSídD©a
 (
pdev
,

643 &
iÁ…
,

647 
USB_REQ_SET_INTERFACE
 :

654  
USBD_OK
;

655 
	}
}

664 #ifde‡
USB_NON_BLOCKING


665 vﬁ©ûê
bussy_cou¡
;

668 
uöt8_t
 
	$USBD_CDC_D©aIn
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ïnum
)

670 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

672 if(
pdev
->
pCœssD©a
 !
NULL
)

675 
hcdc
->
TxSèã
 = 0;

676 #ifde‡
USB_NON_BLOCKING


677 
bussy_cou¡
 = 0;

679  
USBD_OK
;

683  
USBD_FAIL
;

685 
	}
}

694 
uöt8_t
 
	$USBD_CDC_D©aOut
 (
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ïnum
)

696 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

699 
hcdc
->
RxLígth
 = 
	`USBD_LL_GëRxD©aSize
 (
pdev
, 
ïnum
);

703 if(
pdev
->
pCœssD©a
 !
NULL
)

705 ((
USBD_CDC_ItfTy≥Def
 *)
pdev
->
pU£rD©a
)->
	`Re˚ive
(
hcdc
->
RxBuf„r
, &hcdc->
RxLígth
);

707  
USBD_OK
;

711  
USBD_FAIL
;

713 
	}
}

724 
uöt8_t
 
	$USBD_CDC_EP0_RxRódy
 (
USBD_H™dÀTy≥Def
 *
pdev
)

726 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

728 if((
pdev
->
pU£rD©a
 !
NULL
Ë&& (
hcdc
->
CmdOpCode
 != 0xFF))

730 ((
USBD_CDC_ItfTy≥Def
 *)
pdev
->
pU£rD©a
)->
	`C⁄åﬁ
(
hcdc
->
CmdOpCode
,

731 (
uöt8_t
 *)
hcdc
->
d©a
,

732 
hcdc
->
CmdLígth
);

733 
hcdc
->
CmdOpCode
 = 0xFF;

736  
USBD_OK
;

737 
	}
}

746 
uöt8_t
 *
	$USBD_CDC_GëFSCfgDesc
 (
uöt16_t
 *
Àngth
)

748 *
Àngth
 =  (
USBD_CDC_CfgFSDesc
);

749  
USBD_CDC_CfgFSDesc
;

750 
	}
}

759 
uöt8_t
 *
	$USBD_CDC_GëHSCfgDesc
 (
uöt16_t
 *
Àngth
)

761 *
Àngth
 =  (
USBD_CDC_CfgHSDesc
);

762  
USBD_CDC_CfgHSDesc
;

763 
	}
}

772 
uöt8_t
 *
	$USBD_CDC_GëOthîS≥edCfgDesc
 (
uöt16_t
 *
Àngth
)

774 *
Àngth
 =  (
USBD_CDC_OthîS≥edCfgDesc
);

775  
USBD_CDC_OthîS≥edCfgDesc
;

776 
	}
}

784 
uöt8_t
 *
	$USBD_CDC_GëDevi˚QuÆifõrDes¸ùt‹
 (
uöt16_t
 *
Àngth
)

786 *
Àngth
 =  (
USBD_CDC_Devi˚QuÆifõrDesc
);

787  
USBD_CDC_Devi˚QuÆifõrDesc
;

788 
	}
}

796 
uöt8_t
 
	$USBD_CDC_Regi°îI¡îÁ˚
 (
USBD_H™dÀTy≥Def
 *
pdev
,

797 
USBD_CDC_ItfTy≥Def
 *
f›s
)

799 
uöt8_t
 
ªt
 = 
USBD_FAIL
;

801 if(
f›s
 !
NULL
)

803 
pdev
->
pU£rD©a

f›s
;

804 
ªt
 = 
USBD_OK
;

807  
ªt
;

808 
	}
}

816 
uöt8_t
 
	$USBD_CDC_SëTxBuf„r
 (
USBD_H™dÀTy≥Def
 *
pdev
,

817 
uöt8_t
 *
pbuff
,

818 
uöt16_t
 
Àngth
)

820 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

822 
hcdc
->
TxBuf„r
 = 
pbuff
;

823 
hcdc
->
TxLígth
 = 
Àngth
;

825  
USBD_OK
;

826 
	}
}

835 
uöt8_t
 
	$USBD_CDC_SëRxBuf„r
 (
USBD_H™dÀTy≥Def
 *
pdev
,

836 
uöt8_t
 *
pbuff
)

838 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

840 
hcdc
->
RxBuf„r
 = 
pbuff
;

842  
USBD_OK
;

843 
	}
}

852 
uöt8_t
 
	$USBD_CDC_TønsmôPackë
(
USBD_H™dÀTy≥Def
 *
pdev
)

854 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

856 if(
pdev
->
pCœssD©a
 !
NULL
)

858 if(
hcdc
->
TxSèã
 == 0)

861 
hcdc
->
TxSèã
 = 1;

864 
	`USBD_LL_Tønsmô
(
pdev
,

865 
CDC_IN_EP
,

866 
hcdc
->
TxBuf„r
,

867 
hcdc
->
TxLígth
);

869  
USBD_OK
;

873  
USBD_BUSY
;

878  
USBD_FAIL
;

880 
	}
}

889 
uöt8_t
 
	$USBD_CDC_Re˚ivePackë
(
USBD_H™dÀTy≥Def
 *
pdev
)

891 
USBD_CDC_H™dÀTy≥Def
 *
hcdc
 = (USBD_CDC_H™dÀTy≥Def*Ë
pdev
->
pCœssD©a
;

894 if(
pdev
->
pCœssD©a
 !
NULL
)

896 if(
pdev
->
dev_•ìd
 =
USBD_SPEED_HIGH
 )

899 
	`USBD_LL_Pª∑ªRe˚ive
(
pdev
,

900 
CDC_OUT_EP
,

901 
hcdc
->
RxBuf„r
,

902 
CDC_DATA_HS_OUT_PACKET_SIZE
);

907 
	`USBD_LL_Pª∑ªRe˚ive
(
pdev
,

908 
CDC_OUT_EP
,

909 
hcdc
->
RxBuf„r
,

910 
CDC_DATA_FS_OUT_PACKET_SIZE
);

912  
USBD_OK
;

916  
USBD_FAIL
;

918 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Core\Src\usbd_core.c

29 
	~"usbd_c‹e.h
"

96 
USBD_SètusTy≥Def
 
	$USBD_Inô
(
USBD_H™dÀTy≥Def
 *
pdev
, 
USBD_Des¸ùt‹sTy≥Def
 *
pdesc
, 
uöt8_t
 
id
)

99 if(
pdev
 =
NULL
)

101 
	`USBD_EºLog
("Invalid Device handle");

102  
USBD_FAIL
;

106 if(
pdev
->
pCœss
 !
NULL
)

108 
pdev
->
pCœss
 = 
NULL
;

112 if(
pdesc
 !
NULL
)

114 
pdev
->
pDesc
 = 
pdesc
;

118 
pdev
->
dev_°©e
 = 
USBD_STATE_DEFAULT
;

119 
pdev
->
id
 = id;

121 
	`USBD_LL_Inô
(
pdev
);

123  
USBD_OK
;

124 
	}
}

132 
USBD_SètusTy≥Def
 
	$USBD_DeInô
(
USBD_H™dÀTy≥Def
 *
pdev
)

135 
pdev
->
dev_°©e
 = 
USBD_STATE_DEFAULT
;

138 
pdev
->
pCœss
->
	`DeInô
’dev,Ödev->
dev_c⁄fig
);

141 
	`USBD_LL_St›
(
pdev
);

144 
	`USBD_LL_DeInô
(
pdev
);

146  
USBD_OK
;

147 
	}
}

157 
USBD_SètusTy≥Def
 
	$USBD_Regi°îCœss
(
USBD_H™dÀTy≥Def
 *
pdev
, 
USBD_CœssTy≥Def
 *
p˛ass
)

159 
USBD_SètusTy≥Def
 
°©us
 = 
USBD_OK
;

160 if(
p˛ass
 != 0)

163 
pdev
->
pCœss
 = 
p˛ass
;

164 
°©us
 = 
USBD_OK
;

168 
	`USBD_EºLog
("Invalid Class handle");

169 
°©us
 = 
USBD_FAIL
;

172  
°©us
;

173 
	}
}

181 
USBD_SètusTy≥Def
 
	$USBD_Sèπ
 (
USBD_H™dÀTy≥Def
 *
pdev
)

185 
	`USBD_LL_Sèπ
(
pdev
);

187  
USBD_OK
;

188 
	}
}

196 
USBD_SètusTy≥Def
 
	$USBD_St›
 (
USBD_H™dÀTy≥Def
 *
pdev
)

199 
pdev
->
pCœss
->
	`DeInô
’dev,Ödev->
dev_c⁄fig
);

202 
	`USBD_LL_St›
(
pdev
);

204  
USBD_OK
;

205 
	}
}

213 
USBD_SètusTy≥Def
 
	$USBD_RunTe°Mode
 (
USBD_H™dÀTy≥Def
 *
pdev
)

215  
USBD_OK
;

216 
	}
}

227 
USBD_SètusTy≥Def
 
	$USBD_SëCœssC⁄fig
(
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
cfgidx
)

229 
USBD_SètusTy≥Def
 
ªt
 = 
USBD_FAIL
;

231 if(
pdev
->
pCœss
 !
NULL
)

234 if(
pdev
->
pCœss
->
	`Inô
’dev, 
cfgidx
) == 0)

236 
ªt
 = 
USBD_OK
;

239  
ªt
;

240 
	}
}

249 
USBD_SètusTy≥Def
 
	$USBD_CÃCœssC⁄fig
(
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
cfgidx
)

252 
pdev
->
pCœss
->
	`DeInô
’dev, 
cfgidx
);

253  
USBD_OK
;

254 
	}
}

263 
USBD_SètusTy≥Def
 
	$USBD_LL_SëupSège
(
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 *
p£tup
)

266 
	`USBD_P¨£SëupReque°
(&
pdev
->
ªque°
, 
p£tup
);

268 
pdev
->
ï0_°©e
 = 
USBD_EP0_SETUP
;

269 
pdev
->
ï0_d©a_Àn
 =Ödev->
ªque°
.
wLígth
;

271 
pdev
->
ªque°
.
bmReque°
 & 0x1F)

273 
USB_REQ_RECIPIENT_DEVICE
:

274 
	`USBD_StdDevReq
 (
pdev
, &pdev->
ªque°
);

277 
USB_REQ_RECIPIENT_INTERFACE
:

278 
	`USBD_StdItfReq
(
pdev
, &pdev->
ªque°
);

281 
USB_REQ_RECIPIENT_ENDPOINT
:

282 
	`USBD_StdEPReq
(
pdev
, &pdev->
ªque°
);

286 
	`USBD_LL_SèŒEP
(
pdev
 ,Ödev->
ªque°
.
bmReque°
 & 0x80);

289  
USBD_OK
;

290 
	}
}

299 
USBD_SètusTy≥Def
 
	$USBD_LL_D©aOutSège
(
USBD_H™dÀTy≥Def
 *
pdev
 , 
uöt8_t
 
ïnum
, uöt8_à*
pd©a
)

301 
USBD_EndpoötTy≥Def
 *
≥p
;

303 if(
ïnum
 == 0)

305 
≥p
 = &
pdev
->
ï_out
[0];

307 i‡–
pdev
->
ï0_°©e
 =
USBD_EP0_DATA_OUT
)

309 if(
≥p
->
ªm_Àngth
 >Öï->
max∑ckë
)

311 
≥p
->
ªm_Àngth
 -≥p->
max∑ckë
;

313 
	`USBD_CéC⁄töueRx
 (
pdev
,

314 
pd©a
,

315 
	`MIN
(
≥p
->
ªm_Àngth
 ,≥p->
max∑ckë
));

319 if((
pdev
->
pCœss
->
EP0_RxRódy
 !
NULL
)&&

320 (
pdev
->
dev_°©e
 =
USBD_STATE_CONFIGURED
))

322 
pdev
->
pCœss
->
	`EP0_RxRódy
(pdev);

324 
	`USBD_CéSídSètus
(
pdev
);

328 if((
pdev
->
pCœss
->
D©aOut
 !
NULL
)&&

329 (
pdev
->
dev_°©e
 =
USBD_STATE_CONFIGURED
))

331 
pdev
->
pCœss
->
	`D©aOut
’dev, 
ïnum
);

333  
USBD_OK
;

334 
	}
}

343 
USBD_SètusTy≥Def
 
	$USBD_LL_D©aInSège
(
USBD_H™dÀTy≥Def
 *
pdev
 ,
uöt8_t
 
ïnum
, uöt8_à*
pd©a
)

345 
USBD_EndpoötTy≥Def
 *
≥p
;

347 if(
ïnum
 == 0)

349 
≥p
 = &
pdev
->
ï_ö
[0];

351 i‡–
pdev
->
ï0_°©e
 =
USBD_EP0_DATA_IN
)

353 if(
≥p
->
ªm_Àngth
 >Öï->
max∑ckë
)

355 
≥p
->
ªm_Àngth
 -≥p->
max∑ckë
;

357 
	`USBD_CéC⁄töueSídD©a
 (
pdev
,

358 
pd©a
,

359 
≥p
->
ªm_Àngth
);

362 
	`USBD_LL_Pª∑ªRe˚ive
 (
pdev
,

364 
NULL
,

369 if((
≥p
->
tŸÆ_Àngth
 %Öï->
max∑ckë
 == 0) &&

370 (
≥p
->
tŸÆ_Àngth
 >≥p->
max∑ckë
) &&

371 (
≥p
->
tŸÆ_Àngth
 < 
pdev
->
ï0_d©a_Àn
 ))

374 
	`USBD_CéC⁄töueSídD©a
(
pdev
 , 
NULL
, 0);

375 
pdev
->
ï0_d©a_Àn
 = 0;

378 
	`USBD_LL_Pª∑ªRe˚ive
 (
pdev
,

380 
NULL
,

385 if((
pdev
->
pCœss
->
EP0_TxSít
 !
NULL
)&&

386 (
pdev
->
dev_°©e
 =
USBD_STATE_CONFIGURED
))

388 
pdev
->
pCœss
->
	`EP0_TxSít
(pdev);

390 
	`USBD_CéRe˚iveSètus
(
pdev
);

394 i‡(
pdev
->
dev_ã°_mode
 == 1)

396 
	`USBD_RunTe°Mode
(
pdev
);

397 
pdev
->
dev_ã°_mode
 = 0;

400 if((
pdev
->
pCœss
->
D©aIn
 !
NULL
)&&

401 (
pdev
->
dev_°©e
 =
USBD_STATE_CONFIGURED
))

403 
pdev
->
pCœss
->
	`D©aIn
’dev, 
ïnum
);

405  
USBD_OK
;

406 
	}
}

415 
USBD_SètusTy≥Def
 
	$USBD_LL_Re£t
(
USBD_H™dÀTy≥Def
 *
pdev
)

418 
	`USBD_LL_O≥nEP
(
pdev
,

420 
USBD_EP_TYPE_CTRL
,

421 
USB_MAX_EP0_SIZE
);

423 
pdev
->
ï_out
[0].
max∑ckë
 = 
USB_MAX_EP0_SIZE
;

426 
	`USBD_LL_O≥nEP
(
pdev
,

428 
USBD_EP_TYPE_CTRL
,

429 
USB_MAX_EP0_SIZE
);

431 
pdev
->
ï_ö
[0].
max∑ckë
 = 
USB_MAX_EP0_SIZE
;

433 
pdev
->
dev_°©e
 = 
USBD_STATE_DEFAULT
;

435 i‡(
pdev
->
pCœssD©a
)

436 
pdev
->
pCœss
->
	`DeInô
’dev,Ödev->
dev_c⁄fig
);

439  
USBD_OK
;

440 
	}
}

451 
USBD_SètusTy≥Def
 
	$USBD_LL_SëS≥ed
(
USBD_H™dÀTy≥Def
 *
pdev
, 
USBD_S≥edTy≥Def
 
•ìd
)

453 
pdev
->
dev_•ìd
 = 
•ìd
;

454  
USBD_OK
;

455 
	}
}

464 
USBD_SètusTy≥Def
 
	$USBD_LL_Su•íd
(
USBD_H™dÀTy≥Def
 *
pdev
)

466 
pdev
->
dev_ﬁd_°©e
 =Ödev->
dev_°©e
;

467 
pdev
->
dev_°©e
 = 
USBD_STATE_SUSPENDED
;

468  
USBD_OK
;

469 
	}
}

478 
USBD_SètusTy≥Def
 
	$USBD_LL_Resume
(
USBD_H™dÀTy≥Def
 *
pdev
)

480 
pdev
->
dev_°©e
 =Ödev->
dev_ﬁd_°©e
;

481  
USBD_OK
;

482 
	}
}

491 
USBD_SètusTy≥Def
 
	$USBD_LL_SOF
(
USBD_H™dÀTy≥Def
 *
pdev
)

493 if(
pdev
->
dev_°©e
 =
USBD_STATE_CONFIGURED
)

495 if(
pdev
->
pCœss
->
SOF
 !
NULL
)

497 
pdev
->
pCœss
->
	`SOF
(pdev);

500  
USBD_OK
;

501 
	}
}

509 
USBD_SètusTy≥Def
 
	$USBD_LL_IsoINIncom∂ëe
(
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ïnum
)

511  
USBD_OK
;

512 
	}
}

520 
USBD_SètusTy≥Def
 
	$USBD_LL_IsoOUTIncom∂ëe
(
USBD_H™dÀTy≥Def
 *
pdev
, 
uöt8_t
 
ïnum
)

522  
USBD_OK
;

523 
	}
}

531 
USBD_SètusTy≥Def
 
	$USBD_LL_DevC⁄√˘ed
(
USBD_H™dÀTy≥Def
 *
pdev
)

533  
USBD_OK
;

534 
	}
}

542 
USBD_SètusTy≥Def
 
	$USBD_LL_DevDisc⁄√˘ed
(
USBD_H™dÀTy≥Def
 *
pdev
)

545 
pdev
->
dev_°©e
 = 
USBD_STATE_DEFAULT
;

546 
pdev
->
pCœss
->
	`DeInô
’dev,Ödev->
dev_c⁄fig
);

548  
USBD_OK
;

549 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Core\Src\usbd_ctlreq.c

29 
	~"usbd_˘Ãeq.h
"

30 
	~"usbd_i‹eq.h
"

79 
USBD_GëDes¸ùt‹
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

80 
USBD_SëupReqTy≥def
 *
ªq
);

82 
USBD_SëAddªss
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

83 
USBD_SëupReqTy≥def
 *
ªq
);

85 
USBD_SëC⁄fig
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

86 
USBD_SëupReqTy≥def
 *
ªq
);

88 
USBD_GëC⁄fig
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

89 
USBD_SëupReqTy≥def
 *
ªq
);

91 
USBD_GëSètus
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

92 
USBD_SëupReqTy≥def
 *
ªq
);

94 
USBD_SëFótuª
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

95 
USBD_SëupReqTy≥def
 *
ªq
);

97 
USBD_CÃFótuª
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

98 
USBD_SëupReqTy≥def
 *
ªq
);

100 
uöt8_t
 
USBD_GëLí
(uöt8_à*
buf
);

119 
USBD_SètusTy≥Def
 
	$USBD_StdDevReq
 (
USBD_H™dÀTy≥Def
 *
pdev
 , 
USBD_SëupReqTy≥def
 *
ªq
)

121 
USBD_SètusTy≥Def
 
ªt
 = 
USBD_OK
;

123 
ªq
->
bReque°
)

125 
USB_REQ_GET_DESCRIPTOR
:

127 
	`USBD_GëDes¸ùt‹
 (
pdev
, 
ªq
) ;

130 
USB_REQ_SET_ADDRESS
:

131 
	`USBD_SëAddªss
(
pdev
, 
ªq
);

134 
USB_REQ_SET_CONFIGURATION
:

135 
	`USBD_SëC⁄fig
 (
pdev
 , 
ªq
);

138 
USB_REQ_GET_CONFIGURATION
:

139 
	`USBD_GëC⁄fig
 (
pdev
 , 
ªq
);

142 
USB_REQ_GET_STATUS
:

143 
	`USBD_GëSètus
 (
pdev
 , 
ªq
);

147 
USB_REQ_SET_FEATURE
:

148 
	`USBD_SëFótuª
 (
pdev
 , 
ªq
);

151 
USB_REQ_CLEAR_FEATURE
:

152 
	`USBD_CÃFótuª
 (
pdev
 , 
ªq
);

156 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

160  
ªt
;

161 
	}
}

170 
USBD_SètusTy≥Def
 
	$USBD_StdItfReq
 (
USBD_H™dÀTy≥Def
 *
pdev
 , 
USBD_SëupReqTy≥def
 *
ªq
)

172 
USBD_SètusTy≥Def
 
ªt
 = 
USBD_OK
;

174 
pdev
->
dev_°©e
)

176 
USBD_STATE_CONFIGURED
:

178 i‡(
	`LOBYTE
(
ªq
->
wIndex
Ë<
USBD_MAX_NUM_INTERFACES
)

180 
pdev
->
pCœss
->
	`Sëup
 (pdev, 
ªq
);

182 if((
ªq
->
wLígth
 =0)&& (
ªt
 =
USBD_OK
))

184 
	`USBD_CéSídSètus
(
pdev
);

189 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

194 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

197  
USBD_OK
;

198 
	}
}

207 
USBD_SètusTy≥Def
 
	$USBD_StdEPReq
 (
USBD_H™dÀTy≥Def
 *
pdev
 , 
USBD_SëupReqTy≥def
 *
ªq
)

210 
uöt8_t
 
ï_addr
;

211 
USBD_SètusTy≥Def
 
ªt
 = 
USBD_OK
;

212 
USBD_EndpoötTy≥Def
 *
≥p
;

213 
ï_addr
 = 
	`LOBYTE
(
ªq
->
wIndex
);

216 i‡((
ªq
->
bmReque°
 & 0x60) == 0x20)

218 
pdev
->
pCœss
->
	`Sëup
 (pdev, 
ªq
);

220  
USBD_OK
;

223 
ªq
->
bReque°
)

226 
USB_REQ_SET_FEATURE
 :

228 
pdev
->
dev_°©e
)

230 
USBD_STATE_ADDRESSED
:

231 i‡((
ï_addr
 != 0x00) && (ep_addr != 0x80))

233 
	`USBD_LL_SèŒEP
(
pdev
 , 
ï_addr
);

237 
USBD_STATE_CONFIGURED
:

238 i‡(
ªq
->
wVÆue
 =
USB_FEATURE_EP_HALT
)

240 i‡((
ï_addr
 != 0x00) && (ep_addr != 0x80))

242 
	`USBD_LL_SèŒEP
(
pdev
 , 
ï_addr
);

246 
pdev
->
pCœss
->
	`Sëup
 (pdev, 
ªq
);

247 
	`USBD_CéSídSètus
(
pdev
);

252 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

257 
USB_REQ_CLEAR_FEATURE
 :

259 
pdev
->
dev_°©e
)

261 
USBD_STATE_ADDRESSED
:

262 i‡((
ï_addr
 != 0x00) && (ep_addr != 0x80))

264 
	`USBD_LL_SèŒEP
(
pdev
 , 
ï_addr
);

268 
USBD_STATE_CONFIGURED
:

269 i‡(
ªq
->
wVÆue
 =
USB_FEATURE_EP_HALT
)

271 i‡((
ï_addr
 & 0x7F) != 0x00)

273 
	`USBD_LL_CÀ¨SèŒEP
(
pdev
 , 
ï_addr
);

274 
pdev
->
pCœss
->
	`Sëup
 (pdev, 
ªq
);

276 
	`USBD_CéSídSètus
(
pdev
);

281 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

286 
USB_REQ_GET_STATUS
:

287 
pdev
->
dev_°©e
)

289 
USBD_STATE_ADDRESSED
:

290 i‡((
ï_addr
 & 0x7F) != 0x00)

292 
	`USBD_LL_SèŒEP
(
pdev
 , 
ï_addr
);

296 
USBD_STATE_CONFIGURED
:

297 
≥p
 = ((
ï_addr
 & 0x80Ë=0x80Ë? &
pdev
->
ï_ö
[ep_addr & 0x7F]:\

298 &
pdev
->
ï_out
[
ï_addr
 & 0x7F];

299 if(
	`USBD_LL_IsSèŒEP
(
pdev
, 
ï_addr
))

301 
≥p
->
°©us
 = 0x0001;

305 
≥p
->
°©us
 = 0x0000;

308 
	`USBD_CéSídD©a
 (
pdev
,

309 (
uöt8_t
 *)&
≥p
->
°©us
,

314 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

322  
ªt
;

323 
	}
}

331 
	$USBD_GëDes¸ùt‹
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

332 
USBD_SëupReqTy≥def
 *
ªq
)

334 
uöt16_t
 
Àn
;

335 
uöt8_t
 *
pbuf
;

338 
ªq
->
wVÆue
 >> 8)

340 #i‡(
USBD_LPM_ENABLED
 == 1)

341 
USB_DESC_TYPE_BOS
:

342 
pbuf
 = 
pdev
->
pDesc
->
	`GëBOSDes¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

345 
USB_DESC_TYPE_DEVICE
:

346 
pbuf
 = 
pdev
->
pDesc
->
	`GëDevi˚Des¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

349 
USB_DESC_TYPE_CONFIGURATION
:

350 if(
pdev
->
dev_•ìd
 =
USBD_SPEED_HIGH
 )

352 
pbuf
 = (
uöt8_t
 *)
pdev
->
pCœss
->
	`GëHSC⁄figDes¸ùt‹
(&
Àn
);

353 
pbuf
[1] = 
USB_DESC_TYPE_CONFIGURATION
;

357 
pbuf
 = (
uöt8_t
 *)
pdev
->
pCœss
->
	`GëFSC⁄figDes¸ùt‹
(&
Àn
);

358 
pbuf
[1] = 
USB_DESC_TYPE_CONFIGURATION
;

362 
USB_DESC_TYPE_STRING
:

363 (
uöt8_t
)(
ªq
->
wVÆue
))

365 
USBD_IDX_LANGID_STR
:

366 
pbuf
 = 
pdev
->
pDesc
->
	`GëL™gIDSåDes¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

369 
USBD_IDX_MFC_STR
:

370 
pbuf
 = 
pdev
->
pDesc
->
	`GëM™uÁ˘uªrSåDes¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

373 
USBD_IDX_PRODUCT_STR
:

374 
pbuf
 = 
pdev
->
pDesc
->
	`GëProdu˘SåDes¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

377 
USBD_IDX_SERIAL_STR
:

378 
pbuf
 = 
pdev
->
pDesc
->
	`GëSîülSåDes¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

381 
USBD_IDX_CONFIG_STR
:

382 
pbuf
 = 
pdev
->
pDesc
->
	`GëC⁄figuøti⁄SåDes¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

385 
USBD_IDX_INTERFACE_STR
:

386 
pbuf
 = 
pdev
->
pDesc
->
	`GëI¡îÁ˚SåDes¸ùt‹
’dev->
dev_•ìd
, &
Àn
);

390 #i‡(
USBD_SUPPORT_USER_STRING
 == 1)

391 
pbuf
 = 
pdev
->
pCœss
->
	`GëU§SåDes¸ùt‹
’dev, (
ªq
->
wVÆue
Ë, &
Àn
);

394 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

399 
USB_DESC_TYPE_DEVICE_QUALIFIER
:

401 if(
pdev
->
dev_•ìd
 =
USBD_SPEED_HIGH
 )

403 
pbuf
 = (
uöt8_t
 *)
pdev
->
pCœss
->
	`GëDevi˚QuÆifõrDes¸ùt‹
(&
Àn
);

408 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

412 
USB_DESC_TYPE_OTHER_SPEED_CONFIGURATION
:

413 if(
pdev
->
dev_•ìd
 =
USBD_SPEED_HIGH
 )

415 
pbuf
 = (
uöt8_t
 *)
pdev
->
pCœss
->
	`GëOthîS≥edC⁄figDes¸ùt‹
(&
Àn
);

416 
pbuf
[1] = 
USB_DESC_TYPE_OTHER_SPEED_CONFIGURATION
;

421 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

426 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

430 if((
Àn
 !0)&& (
ªq
->
wLígth
 != 0))

433 
Àn
 = 
	`MIN
÷í , 
ªq
->
wLígth
);

435 
	`USBD_CéSídD©a
 (
pdev
,

436 
pbuf
,

437 
Àn
);

440 
	}
}

449 
	$USBD_SëAddªss
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

450 
USBD_SëupReqTy≥def
 *
ªq
)

452 
uöt8_t
 
dev_addr
;

454 i‡((
ªq
->
wIndex
 =0Ë&& (ªq->
wLígth
 == 0))

456 
dev_addr
 = (
uöt8_t
)(
ªq
->
wVÆue
) & 0x7F;

458 i‡(
pdev
->
dev_°©e
 =
USBD_STATE_CONFIGURED
)

460 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

464 
pdev
->
dev_addªss
 = 
dev_addr
;

465 
	`USBD_LL_SëUSBAddªss
(
pdev
, 
dev_addr
);

466 
	`USBD_CéSídSètus
(
pdev
);

468 i‡(
dev_addr
 != 0)

470 
pdev
->
dev_°©e
 = 
USBD_STATE_ADDRESSED
;

474 
pdev
->
dev_°©e
 = 
USBD_STATE_DEFAULT
;

480 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

482 
	}
}

491 
	$USBD_SëC⁄fig
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

492 
USBD_SëupReqTy≥def
 *
ªq
)

495 
uöt8_t
 
cfgidx
;

497 
cfgidx
 = (
uöt8_t
)(
ªq
->
wVÆue
);

499 i‡(
cfgidx
 > 
USBD_MAX_NUM_CONFIGURATION
 )

501 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

505 
pdev
->
dev_°©e
)

507 
USBD_STATE_ADDRESSED
:

508 i‡(
cfgidx
)

510 
pdev
->
dev_c⁄fig
 = 
cfgidx
;

511 
pdev
->
dev_°©e
 = 
USBD_STATE_CONFIGURED
;

512 if(
	`USBD_SëCœssC⁄fig
(
pdev
 , 
cfgidx
Ë=
USBD_FAIL
)

514 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

517 
	`USBD_CéSídSètus
(
pdev
);

521 
	`USBD_CéSídSètus
(
pdev
);

525 
USBD_STATE_CONFIGURED
:

526 i‡(
cfgidx
 == 0)

528 
pdev
->
dev_°©e
 = 
USBD_STATE_ADDRESSED
;

529 
pdev
->
dev_c⁄fig
 = 
cfgidx
;

530 
	`USBD_CÃCœssC⁄fig
(
pdev
 , 
cfgidx
);

531 
	`USBD_CéSídSètus
(
pdev
);

534 i‡(
cfgidx
 !
pdev
->
dev_c⁄fig
)

537 
	`USBD_CÃCœssC⁄fig
(
pdev
 ,Ödev->
dev_c⁄fig
);

540 
pdev
->
dev_c⁄fig
 = 
cfgidx
;

541 if(
	`USBD_SëCœssC⁄fig
(
pdev
 , 
cfgidx
Ë=
USBD_FAIL
)

543 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

546 
	`USBD_CéSídSètus
(
pdev
);

550 
	`USBD_CéSídSètus
(
pdev
);

555 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

559 
	}
}

568 
	$USBD_GëC⁄fig
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

569 
USBD_SëupReqTy≥def
 *
ªq
)

572 i‡(
ªq
->
wLígth
 != 1)

574 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

578 
pdev
->
dev_°©e
 )

580 
USBD_STATE_ADDRESSED
:

581 
pdev
->
dev_deÁu…_c⁄fig
 = 0;

582 
	`USBD_CéSídD©a
 (
pdev
,

583 (
uöt8_t
 *)&
pdev
->
dev_deÁu…_c⁄fig
,

587 
USBD_STATE_CONFIGURED
:

589 
	`USBD_CéSídD©a
 (
pdev
,

590 (
uöt8_t
 *)&
pdev
->
dev_c⁄fig
,

595 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

599 
	}
}

608 
	$USBD_GëSètus
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

609 
USBD_SëupReqTy≥def
 *
ªq
)

613 
pdev
->
dev_°©e
)

615 
USBD_STATE_ADDRESSED
:

616 
USBD_STATE_CONFIGURED
:

618 #i‡–
USBD_SELF_POWERED
 == 1)

619 
pdev
->
dev_c⁄fig_°©us
 = 
USB_CONFIG_SELF_POWERED
;

621 
pdev
->
dev_c⁄fig_°©us
 = 0;

624 i‡(
pdev
->
dev_ªmŸe_wakeup
)

626 
pdev
->
dev_c⁄fig_°©us
 |
USB_CONFIG_REMOTE_WAKEUP
;

629 
	`USBD_CéSídD©a
 (
pdev
,

630 (
uöt8_t
 *)& 
pdev
->
dev_c⁄fig_°©us
,

635 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

638 
	}
}

648 
	$USBD_SëFótuª
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

649 
USBD_SëupReqTy≥def
 *
ªq
)

652 i‡(
ªq
->
wVÆue
 =
USB_FEATURE_REMOTE_WAKEUP
)

654 
pdev
->
dev_ªmŸe_wakeup
 = 1;

655 
pdev
->
pCœss
->
	`Sëup
 (pdev, 
ªq
);

656 
	`USBD_CéSídSètus
(
pdev
);

659 
	}
}

669 
	$USBD_CÃFótuª
(
USBD_H™dÀTy≥Def
 *
pdev
 ,

670 
USBD_SëupReqTy≥def
 *
ªq
)

672 
pdev
->
dev_°©e
)

674 
USBD_STATE_ADDRESSED
:

675 
USBD_STATE_CONFIGURED
:

676 i‡(
ªq
->
wVÆue
 =
USB_FEATURE_REMOTE_WAKEUP
)

678 
pdev
->
dev_ªmŸe_wakeup
 = 0;

679 
pdev
->
pCœss
->
	`Sëup
 (pdev, 
ªq
);

680 
	`USBD_CéSídSètus
(
pdev
);

685 
	`USBD_CéEº‹
(
pdev
 , 
ªq
);

688 
	}
}

698 
	$USBD_P¨£SëupReque°
(
USBD_SëupReqTy≥def
 *
ªq
, 
uöt8_t
 *
pd©a
)

700 
ªq
->
bmReque°
 = *(
uöt8_t
 *Ë(
pd©a
);

701 
ªq
->
bReque°
 = *(
uöt8_t
 *Ë(
pd©a
 + 1);

702 
ªq
->
wVÆue
 = 
	`SWAPBYTE
 (
pd©a
 + 2);

703 
ªq
->
wIndex
 = 
	`SWAPBYTE
 (
pd©a
 + 4);

704 
ªq
->
wLígth
 = 
	`SWAPBYTE
 (
pd©a
 + 6);

706 
	}
}

716 
	$USBD_CéEº‹
–
USBD_H™dÀTy≥Def
 *
pdev
 ,

717 
USBD_SëupReqTy≥def
 *
ªq
)

719 
	`USBD_LL_SèŒEP
(
pdev
 , 0x80);

720 
	`USBD_LL_SèŒEP
(
pdev
 , 0);

721 
	}
}

732 
	$USBD_GëSåög
(
uöt8_t
 *
desc
, uöt8_à*
unicode
, 
uöt16_t
 *
Àn
)

734 
uöt8_t
 
idx
 = 0;

736 i‡(
desc
 !
NULL
)

738 *
Àn
 = 
	`USBD_GëLí
(
desc
) * 2 + 2;

739 
unicode
[
idx
++] = *
Àn
;

740 
unicode
[
idx
++] = 
USB_DESC_TYPE_STRING
;

742 *
desc
 != '\0')

744 
unicode
[
idx
++] = *
desc
++;

745 
unicode
[
idx
++] = 0x00;

748 
	}
}

756 
uöt8_t
 
	$USBD_GëLí
(
uöt8_t
 *
buf
)

758 
uöt8_t
 
Àn
 = 0;

760 *
buf
 != '\0')

762 
Àn
++;

763 
buf
++;

766  
Àn
;

767 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Core\Src\usbd_ioreq.c

29 
	~"usbd_i‹eq.h
"

95 
USBD_SètusTy≥Def
 
	$USBD_CéSídD©a
 (
USBD_H™dÀTy≥Def
 *
pdev
,

96 
uöt8_t
 *
pbuf
,

97 
uöt16_t
 
Àn
)

100 
pdev
->
ï0_°©e
 = 
USBD_EP0_DATA_IN
;

101 
pdev
->
ï_ö
[0].
tŸÆ_Àngth
 = 
Àn
;

102 
pdev
->
ï_ö
[0].
ªm_Àngth
 = 
Àn
;

104 
	`USBD_LL_Tønsmô
 (
pdev
, 0x00, 
pbuf
, 
Àn
);

106  
USBD_OK
;

107 
	}
}

117 
USBD_SètusTy≥Def
 
	$USBD_CéC⁄töueSídD©a
 (
USBD_H™dÀTy≥Def
 *
pdev
,

118 
uöt8_t
 *
pbuf
,

119 
uöt16_t
 
Àn
)

122 
	`USBD_LL_Tønsmô
 (
pdev
, 0x00, 
pbuf
, 
Àn
);

124  
USBD_OK
;

125 
	}
}

135 
USBD_SètusTy≥Def
 
	$USBD_CéPª∑ªRx
 (
USBD_H™dÀTy≥Def
 *
pdev
,

136 
uöt8_t
 *
pbuf
,

137 
uöt16_t
 
Àn
)

140 
pdev
->
ï0_°©e
 = 
USBD_EP0_DATA_OUT
;

141 
pdev
->
ï_out
[0].
tŸÆ_Àngth
 = 
Àn
;

142 
pdev
->
ï_out
[0].
ªm_Àngth
 = 
Àn
;

144 
	`USBD_LL_Pª∑ªRe˚ive
 (
pdev
,

146 
pbuf
,

147 
Àn
);

149  
USBD_OK
;

150 
	}
}

160 
USBD_SètusTy≥Def
 
	$USBD_CéC⁄töueRx
 (
USBD_H™dÀTy≥Def
 *
pdev
,

161 
uöt8_t
 *
pbuf
,

162 
uöt16_t
 
Àn
)

165 
	`USBD_LL_Pª∑ªRe˚ive
 (
pdev
,

167 
pbuf
,

168 
Àn
);

169  
USBD_OK
;

170 
	}
}

177 
USBD_SètusTy≥Def
 
	$USBD_CéSídSètus
 (
USBD_H™dÀTy≥Def
 *
pdev
)

181 
pdev
->
ï0_°©e
 = 
USBD_EP0_STATUS_IN
;

184 
	`USBD_LL_Tønsmô
 (
pdev
, 0x00, 
NULL
, 0);

186  
USBD_OK
;

187 
	}
}

195 
USBD_SètusTy≥Def
 
	$USBD_CéRe˚iveSètus
 (
USBD_H™dÀTy≥Def
 *
pdev
)

198 
pdev
->
ï0_°©e
 = 
USBD_EP0_STATUS_OUT
;

201 
	`USBD_LL_Pª∑ªRe˚ive
 ( 
pdev
,

203 
NULL
,

206  
USBD_OK
;

207 
	}
}

217 
uöt16_t
 
	$USBD_GëRxCou¡
 (
USBD_H™dÀTy≥Def
 *
pdev
 , 
uöt8_t
 
ï_addr
)

219  
	`USBD_LL_GëRxD©aSize
(
pdev
, 
ï_addr
);

220 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\sysIrqHandlers.c

15 
	~"bﬂrd.h
"

22 
	$NMI_H™dÀr
( )

24 
	}
}

31 #i‡
deföed
–
HARD_FAULT_HANDLER_ENABLED
 )

32 
	$H¨dFau…_H™dÀr_C
–*
¨gs
 )

34 vﬁ©ûê
°acked_r0
;

35 vﬁ©ûê
°acked_r1
;

36 vﬁ©ûê
°acked_r2
;

37 vﬁ©ûê
°acked_r3
;

38 vﬁ©ûê
°acked_r12
;

39 vﬁ©ûê
°acked_Ã
;

40 vﬁ©ûê
°acked_pc
;

41 vﬁ©ûê
°acked_p§
;

43 
°acked_r0
 = ( ( Ë
¨gs
[0] );

44 
°acked_r1
 = ( ( Ë
¨gs
[1] );

45 
°acked_r2
 = ( ( Ë
¨gs
[2] );

46 
°acked_r3
 = ( ( Ë
¨gs
[3] );

48 
°acked_r12
 = ( ( Ë
¨gs
[4] );

49 
°acked_Ã
 = ( ( Ë
¨gs
[5] );

50 
°acked_pc
 = ( ( Ë
¨gs
[6] );

51 
°acked_p§
 = ( ( Ë
¨gs
[7] );

53 –)
°acked_r0
;

54 –)
°acked_r1
;

55 –)
°acked_r2
;

56 –)
°acked_r3
;

58 –)
°acked_r12
;

59 –)
°acked_Ã
 ;

60 –)
°acked_pc
 ;

61 –)
°acked_p§
;

64 
	}
}

66 #i‡
deföed
(
__CC_ARM
)

67 
__asm
 
	$H¨dFau…_H™dÀr
()

69 
TST
 
LR
, #4

70 
ITE
 
EQ


71 
MRSEQ
 
r0
, 
MSP


72 
MRSNE
 
r0
, 
PSP


73 
B
 
	`__˝p
(
H¨dFau…_H™dÀr_C
)

74 
	}
}

75 #ñi‡
deföed
(
__ICCARM__
)

76 
	$H¨dFau…_H™dÀr
()

78 
	`__asm
("TST LR, #4");

79 
	`__asm
("ITE EQ");

80 
	`__asm
("MRSEQÑ0, MSP");

81 
	`__asm
("MRSNEÑ0, PSP");

82 
	`__asm
("B HardFault_Handler_C");

83 
	}
}

84 #ñi‡
deföed
(
__GNUC__
)

85 
	$H¨dFau…_H™dÀr
()

87 
__asm
 volatile( "TST LR, #4" );

88 
__asm
 volatile( "ITE EQ" );

89 
__asm
 volatile( "MRSEQ R0, MSP" );

90 
__asm
 volatile( "MRSNE R0, PSP" );

91 
__asm
 volatile( "B HardFault_Handler_C" );

92 
	}
}

94 #w¨nög 
NŸ
 
suµ‹ãd
 
compûî
 
ty≥


104 
	$MemM™age_H™dÀr
( )

110 
	}
}

117 
	$BusFau…_H™dÀr
( )

123 
	}
}

130 
	$UßgeFau…_H™dÀr
( )

136 
	}
}

143 
	$DebugM⁄_H™dÀr
( )

145 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\utilities.c

15 
	~<°dlib.h
>

16 
	~<°dio.h
>

17 
	~"bﬂrd.h
"

18 
	~"utûôõs.h
"

26 
	#RAND_LOCAL_MAX
 2147483647L

	)

28 
uöt32_t
 
	g√xt
 = 1;

30 
öt32_t
 
	$ønd1
( )

32  ( ( 
√xt
 =Çexà* 1103515245L + 12345L ) % 
RAND_LOCAL_MAX
 );

33 
	}
}

35 
	$§™d1
–
uöt32_t
 
£ed
 )

37 
√xt
 = 
£ed
;

38 
	}
}

41 
öt32_t
 
	$øndr
–
öt32_t
 
mö
, i¡32_à
max
 )

43  ( 
öt32_t
 )
	`ønd1
–Ë% ( 
max
 - 
mö
 + 1 ) + min;

44 
	}
}

46 
	$mem˝y1
–
uöt8_t
 *
d°
, c⁄° uöt8_à*
§c
, 
uöt16_t
 
size
 )

48  
size
-- )

50 *
d°
++ = *
§c
++;

52 
	}
}

54 
	$mem˝yr
–
uöt8_t
 *
d°
, c⁄° uöt8_à*
§c
, 
uöt16_t
 
size
 )

56 
d°
 = d° + ( 
size
 - 1 );

57  
size
-- )

59 *
d°
-- = *
§c
++;

61 
	}
}

63 
	$mem£t1
–
uöt8_t
 *
d°
, uöt8_à
vÆue
, 
uöt16_t
 
size
 )

65  
size
-- )

67 *
d°
++ = 
vÆue
;

69 
	}
}

71 
öt8_t
 
	$NibbÀ2HexCh¨
–
uöt8_t
 
a
 )

73 if–
a
 < 10 )

75  '0' + 
a
;

77 if–
a
 < 16 )

79  'A' + ( 
a
 - 10 );

85 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\radio\radio.h

15 #i‚de‡
__RADIO_H__


16 
	#__RADIO_H__


	)

23 
	mMODEM_FSK
 = 0,

24 
	mMODEM_LORA
,

25 }
	tRadioModems_t
;

32 
	mRF_IDLE
 = 0,

33 
	mRF_RX_RUNNING
,

34 
	mRF_TX_RUNNING
,

35 
	mRF_CAD
,

36 }
	tRadioSèã_t
;

46 –*
	mTxD⁄e
 )( );

50 –*
	mTxTimeout
 )( );

61 –*
	mRxD⁄e
 )–
uöt8_t
 *
	m∑ylﬂd
, 
uöt16_t
 
	msize
, 
öt16_t
 
	mrssi
, 
öt8_t
 
	m¢r
 );

65 –*
	mRxTimeout
 )( );

69 –*
	mRxEº‹
 )( );

75 –*
	mFhssCh™geCh™√l
 )–
uöt8_t
 
	mcuºítCh™√l
 );

82 –*
	mCadD⁄e
 ) ( 
boﬁ
 
	mch™√lA˘ivôyDëe˘ed
 );

83 }
	tRadioEvíts_t
;

88 
	sRadio_s


95 –*
	mInô
 )–
RadioEvíts_t
 *
	mevíts
 );

101 
RadioSèã_t
 ( *
GëSètus
 )( );

107 –*
	mSëModem
 )–
RadioModems_t
 
	mmodem
 );

113 –*
	mSëCh™√l
 )–
uöt32_t
 
	m‰eq
 );

123 
boﬁ
 ( *
IsCh™√lFªe
 )–
RadioModems_t
 
	mmodem
, 
uöt32_t
 
	m‰eq
, 
öt16_t
 
	mrssiThªsh
 );

134 
uöt32_t
 ( *
R™dom
 )( );

174 –*
	mSëRxC⁄fig
 )–
RadioModems_t
 
	mmodem
, 
uöt32_t
 
	mb™dwidth
,

175 
uöt32_t
 
	md©¨©e
, 
uöt8_t
 
	mcodî©e
,

176 
uöt32_t
 
	mb™dwidthAfc
, 
uöt16_t
 
	m¥ómbÀLí
,

177 
uöt16_t
 
	msymbTimeout
, 
boﬁ
 
	mfixLí
,

178 
uöt8_t
 
	m∑ylﬂdLí
,

179 
boﬁ
 
	m¸cOn
, boﬁ 
	mFªqH›On
, 
uöt8_t
 
	mH›Pîiod
,

180 
boﬁ
 
	miqInvîãd
, boﬁ 
	mrxC⁄töuous
 );

216 –*
	mSëTxC⁄fig
 )–
RadioModems_t
 
	mmodem
, 
öt8_t
 
	mpowî
, 
uöt32_t
 
	mfdev
,

217 
uöt32_t
 
	mb™dwidth
, uöt32_à
	md©¨©e
,

218 
uöt8_t
 
	mcodî©e
, 
uöt16_t
 
	m¥ómbÀLí
,

219 
boﬁ
 
	mfixLí
, boﬁ 
	m¸cOn
, boﬁ 
	mFªqH›On
,

220 
uöt8_t
 
	mH›Pîiod
, 
boﬁ
 
	miqInvîãd
, 
uöt32_t
 
	mtimeout
 );

227 
boﬁ
 ( *
CheckRfFªquícy
 )–
uöt32_t
 
	m‰equícy
 );

238 
uöt32_t
 ( *
TimeOnAú
 )–
RadioModems_t
 
	mmodem
, 
uöt8_t
 
	mpktLí
 );

246 –*
	mSíd
 )–
uöt8_t
 *
	mbuf„r
, uöt8_à
	msize
 );

250 –*
	mSÀï
 )( );

254 –*
	mSèndby
 )( );

260 –*
	mRx
 )–
uöt32_t
 
	mtimeout
 );

264 –*
	mSèπCad
 )( );

272 –*
	mSëTxC⁄töuousWave
 )–
uöt32_t
 
	m‰eq
, 
öt8_t
 
	mpowî
, 
uöt16_t
 
	mtime
 );

278 
öt16_t
 ( *
Rssi
 )–
RadioModems_t
 
	mmodem
 );

285 –*
	mWrôe
 )–
uöt8_t
 
	maddr
, uöt8_à
	md©a
 );

292 
uöt8_t
 ( *
Ród
 )–uöt8_à
	maddr
 );

300 –*
	mWrôeBuf„r
 )–
uöt8_t
 
	maddr
, uöt8_à*
	mbuf„r
, uöt8_à
	msize
 );

308 –*
	mRódBuf„r
 )–
uöt8_t
 
	maddr
, uöt8_à*
	mbuf„r
, uöt8_à
	msize
 );

315 –*
	mSëMaxPaylﬂdLígth
 )–
RadioModems_t
 
	mmodem
, 
uöt8_t
 
	mmax
 );

323 –*
	mSëPublicNëw‹k
 )–
boﬁ
 
	míabÀ
 );

332 c⁄° 
Radio_s
 
Radio
;

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\radio\sx1272\sx1272.c

15 
	~<m©h.h
>

16 
	~<°rög.h
>

17 
	~"bﬂrd.h
"

18 
	~"ødio.h
"

19 
	~"sx1272.h
"

20 
	~"sx1272-bﬂrd.h
"

31 
RadioModems_t
 
	mModem
;

32 
uöt8_t
 
	mAddr
;

33 
uöt8_t
 
	mVÆue
;

34 }
	tRadioRegi°îs_t
;

41 
uöt32_t
 
	mb™dwidth
;

42 
uöt8_t
 
	mRegVÆue
;

43 }
	tFskB™dwidth_t
;

54 
SX1272Re£t
( );

60 
SX1272SëTx
–
uöt32_t
 
timeout
 );

68 
SX1272WrôeFifo
–
uöt8_t
 *
buf„r
, uöt8_à
size
 );

76 
SX1272RódFifo
–
uöt8_t
 *
buf„r
, uöt8_à
size
 );

83 
SX1272SëOpMode
–
uöt8_t
 
›Mode
 );

92 
SX1272OnDio0Irq
( );

97 
SX1272OnDio1Irq
( );

102 
SX1272OnDio2Irq
( );

107 
SX1272OnDio3Irq
( );

112 
SX1272OnDio4Irq
( );

117 
SX1272OnDio5Irq
( );

122 
SX1272OnTimeoutIrq
( );

133 c⁄° 
RadioRegi°îs_t
 
	gRadioRegsInô
[] = 
RADIO_INIT_REGISTERS_VALUE
;

138 
	#RSSI_OFFSET
 -139

	)

143 c⁄° 
FskB™dwidth_t
 
	gFskB™dwidths
[] =

176 
RadioEvíts_t
 *
	gRadioEvíts
;

181 
uöt8_t
 
	gRxTxBuf„r
[
RX_BUFFER_SIZE
];

190 
SX1272_t
 
	gSX1272
;

195 
DioIrqH™dÀr
 *
	gDioIrq
[] = { 
SX1272OnDio0Irq
, 
SX1272OnDio1Irq
,

196 
SX1272OnDio2Irq
, 
SX1272OnDio3Irq
,

197 
SX1272OnDio4Irq
, 
NULL
 };

202 
TimîEvít_t
 
	gTxTimeoutTimî
;

203 
TimîEvít_t
 
	gRxTimeoutTimî
;

204 
TimîEvít_t
 
	gRxTimeoutSyncW‹d
;

210 
	$SX1272Inô
–
RadioEvíts_t
 *
evíts
 )

212 
uöt8_t
 
i
;

214 
RadioEvíts
 = 
evíts
;

217 
	`TimîInô
–&
TxTimeoutTimî
, 
SX1272OnTimeoutIrq
 );

218 
	`TimîInô
–&
RxTimeoutTimî
, 
SX1272OnTimeoutIrq
 );

219 
	`TimîInô
–&
RxTimeoutSyncW‹d
, 
SX1272OnTimeoutIrq
 );

221 
	`SX1272Re£t
( );

223 
	`SX1272SëOpMode
–
RF_OPMODE_SLEEP
 );

225 
	`SX1272IoIrqInô
–
DioIrq
 );

227  
i
 = 0; i < –
RadioRegsInô
 ) / –
RadioRegi°îs_t
 ); i++ )

229 
	`SX1272SëModem
–
RadioRegsInô
[
i
].
Modem
 );

230 
	`SX1272Wrôe
–
RadioRegsInô
[
i
].
Addr
, RadioRegsInô[i].
VÆue
 );

233 
	`SX1272SëModem
–
MODEM_FSK
 );

235 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

236 
	}
}

238 
RadioSèã_t
 
	$SX1272GëSètus
( )

240  
SX1272
.
Sëtögs
.
Sèã
;

241 
	}
}

243 
	$SX1272SëCh™√l
–
uöt32_t
 
‰eq
 )

245 
SX1272
.
Sëtögs
.
Ch™√l
 = 
‰eq
;

246 
‰eq
 = ( 
uöt32_t
 )––)‰eq / ( )
FREQ_STEP
 );

247 
	`SX1272Wrôe
–
REG_FRFMSB
, ( 
uöt8_t
 )––
‰eq
 >> 16 ) & 0xFF ) );

248 
	`SX1272Wrôe
–
REG_FRFMID
, ( 
uöt8_t
 )––
‰eq
 >> 8 ) & 0xFF ) );

249 
	`SX1272Wrôe
–
REG_FRFLSB
, ( 
uöt8_t
 )–
‰eq
 & 0xFF ) );

250 
	}
}

252 
boﬁ
 
	$SX1272IsCh™√lFªe
–
RadioModems_t
 
modem
, 
uöt32_t
 
‰eq
, 
öt16_t
 
rssiThªsh
 )

254 
öt16_t
 
rssi
 = 0;

256 
	`SX1272SëModem
–
modem
 );

258 
	`SX1272SëCh™√l
–
‰eq
 );

260 
	`SX1272SëOpMode
–
RF_OPMODE_RECEIVER
 );

262 
	`DñayMs
( 1 );

264 
rssi
 = 
	`SX1272RódRssi
–
modem
 );

266 
	`SX1272SëSÀï
( );

268 if–
rssi
 > 
rssiThªsh
 )

270  
Ál£
;

272  
åue
;

273 
	}
}

275 
uöt32_t
 
	$SX1272R™dom
( )

277 
uöt8_t
 
i
;

278 
uöt32_t
 
∫d
 = 0;

284 
	`SX1272SëModem
–
MODEM_LORA
 );

287 
	`SX1272Wrôe
–
REG_LR_IRQFLAGSMASK
, 
RFLR_IRQFLAGS_RXTIMEOUT
 |

288 
RFLR_IRQFLAGS_RXDONE
 |

289 
RFLR_IRQFLAGS_PAYLOADCRCERROR
 |

290 
RFLR_IRQFLAGS_VALIDHEADER
 |

291 
RFLR_IRQFLAGS_TXDONE
 |

292 
RFLR_IRQFLAGS_CADDONE
 |

293 
RFLR_IRQFLAGS_FHSSCHANGEDCHANNEL
 |

294 
RFLR_IRQFLAGS_CADDETECTED
 );

297 
	`SX1272SëOpMode
–
RF_OPMODE_RECEIVER
 );

299  
i
 = 0; i < 32; i++ )

301 
	`DñayMs
( 1 );

303 
∫d
 |––
uöt32_t
 )
	`SX1272Ród
–
REG_LR_RSSIWIDEBAND
 ) & 0x01 ) << 
i
;

306 
	`SX1272SëSÀï
( );

308  
∫d
;

309 
	}
}

317 
uöt8_t
 
	$GëFskB™dwidthRegVÆue
–
uöt32_t
 
b™dwidth
 )

319 
uöt8_t
 
i
;

321  
i
 = 0; i < ( –
FskB™dwidths
 ) / –
FskB™dwidth_t
 ) ) - 1; i++ )

323 if––
b™dwidth
 >
FskB™dwidths
[
i
].bandwidth ) && ( bandwidth < FskBandwidths[i + 1].bandwidth ) )

325  
FskB™dwidths
[
i
].
RegVÆue
;

330 
	}
}

332 
	$SX1272SëRxC⁄fig
–
RadioModems_t
 
modem
, 
uöt32_t
 
b™dwidth
,

333 
uöt32_t
 
d©¨©e
, 
uöt8_t
 
codî©e
,

334 
uöt32_t
 
b™dwidthAfc
, 
uöt16_t
 
¥ómbÀLí
,

335 
uöt16_t
 
symbTimeout
, 
boﬁ
 
fixLí
,

336 
uöt8_t
 
∑ylﬂdLí
,

337 
boﬁ
 
¸cOn
, boﬁ 
‰eqH›On
, 
uöt8_t
 
h›Pîiod
,

338 
boﬁ
 
iqInvîãd
, boﬁ 
rxC⁄töuous
 )

340 
	`SX1272SëModem
–
modem
 );

342  
modem
 )

344 
MODEM_FSK
:

346 
SX1272
.
Sëtögs
.
Fsk
.
B™dwidth
 = 
b™dwidth
;

347 
SX1272
.
Sëtögs
.
Fsk
.
D©¨©e
 = 
d©¨©e
;

348 
SX1272
.
Sëtögs
.
Fsk
.
B™dwidthAfc
 = 
b™dwidthAfc
;

349 
SX1272
.
Sëtögs
.
Fsk
.
FixLí
 = 
fixLí
;

350 
SX1272
.
Sëtögs
.
Fsk
.
PaylﬂdLí
 = 
∑ylﬂdLí
;

351 
SX1272
.
Sëtögs
.
Fsk
.
CrcOn
 = 
¸cOn
;

352 
SX1272
.
Sëtögs
.
Fsk
.
IqInvîãd
 = 
iqInvîãd
;

353 
SX1272
.
Sëtögs
.
Fsk
.
RxC⁄töuous
 = 
rxC⁄töuous
;

354 
SX1272
.
Sëtögs
.
Fsk
.
PªambÀLí
 = 
¥ómbÀLí
;

356 
d©¨©e
 = ( 
uöt16_t
 )––)
XTAL_FREQ
 / ( )datarate );

357 
	`SX1272Wrôe
–
REG_BITRATEMSB
, ( 
uöt8_t
 )–
d©¨©e
 >> 8 ) );

358 
	`SX1272Wrôe
–
REG_BITRATELSB
, ( 
uöt8_t
 )–
d©¨©e
 & 0xFF ) );

360 
	`SX1272Wrôe
–
REG_RXBW
, 
	`GëFskB™dwidthRegVÆue
–
b™dwidth
 ) );

361 
	`SX1272Wrôe
–
REG_AFCBW
, 
	`GëFskB™dwidthRegVÆue
–
b™dwidthAfc
 ) );

363 
	`SX1272Wrôe
–
REG_PREAMBLEMSB
, ( 
uöt8_t
 )––
¥ómbÀLí
 >> 8 ) & 0xFF ) );

364 
	`SX1272Wrôe
–
REG_PREAMBLELSB
, ( 
uöt8_t
 )–
¥ómbÀLí
 & 0xFF ) );

366 if–
fixLí
 == 1 )

368 
	`SX1272Wrôe
–
REG_PAYLOADLENGTH
, 
∑ylﬂdLí
 );

372 
	`SX1272Wrôe
–
REG_PAYLOADLENGTH
, 0xFF );

375 
	`SX1272Wrôe
–
REG_PACKETCONFIG1
,

376 –
	`SX1272Ród
–
REG_PACKETCONFIG1
 ) &

377 
RF_PACKETCONFIG1_CRC_MASK
 &

378 
RF_PACKETCONFIG1_PACKETFORMAT_MASK
 ) |

379 ––
fixLí
 =1 ) ? 
RF_PACKETCONFIG1_PACKETFORMAT_FIXED
 : 
RF_PACKETCONFIG1_PACKETFORMAT_VARIABLE
 ) |

380 –
¸cOn
 << 4 ) );

381 
	`SX1272Wrôe
–
REG_PACKETCONFIG2
, ( 
	`SX1272Ród
–REG_PACKETCONFIG2 ) | 
RF_PACKETCONFIG2_DATAMODE_PACKET
 ) );

384 
MODEM_LORA
:

386 
SX1272
.
Sëtögs
.
LoRa
.
B™dwidth
 = 
b™dwidth
;

387 
SX1272
.
Sëtögs
.
LoRa
.
D©¨©e
 = 
d©¨©e
;

388 
SX1272
.
Sëtögs
.
LoRa
.
Codî©e
 = 
codî©e
;

389 
SX1272
.
Sëtögs
.
LoRa
.
PªambÀLí
 = 
¥ómbÀLí
;

390 
SX1272
.
Sëtögs
.
LoRa
.
FixLí
 = 
fixLí
;

391 
SX1272
.
Sëtögs
.
LoRa
.
PaylﬂdLí
 = 
∑ylﬂdLí
;

392 
SX1272
.
Sëtögs
.
LoRa
.
CrcOn
 = 
¸cOn
;

393 
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 = 
‰eqH›On
;

394 
SX1272
.
Sëtögs
.
LoRa
.
H›Pîiod
 = 
h›Pîiod
;

395 
SX1272
.
Sëtögs
.
LoRa
.
IqInvîãd
 = 
iqInvîãd
;

396 
SX1272
.
Sëtögs
.
LoRa
.
RxC⁄töuous
 = 
rxC⁄töuous
;

398 if–
d©¨©e
 > 12 )

400 
d©¨©e
 = 12;

402 if–
d©¨©e
 < 6 )

404 
d©¨©e
 = 6;

407 if–––
b™dwidth
 =0 ) && ( ( 
d©¨©e
 == 11 ) || ( datarate == 12 ) ) ) ||

408 ––
b™dwidth
 =1 ) && ( 
d©¨©e
 == 12 ) ) )

410 
SX1272
.
Sëtögs
.
LoRa
.
LowD©¨©eO±imize
 = 0x01;

414 
SX1272
.
Sëtögs
.
LoRa
.
LowD©¨©eO±imize
 = 0x00;

417 
	`SX1272Wrôe
–
REG_LR_MODEMCONFIG1
,

418 –
	`SX1272Ród
–
REG_LR_MODEMCONFIG1
 ) &

419 
RFLR_MODEMCONFIG1_BW_MASK
 &

420 
RFLR_MODEMCONFIG1_CODINGRATE_MASK
 &

421 
RFLR_MODEMCONFIG1_IMPLICITHEADER_MASK
 &

422 
RFLR_MODEMCONFIG1_RXPAYLOADCRC_MASK
 &

423 
RFLR_MODEMCONFIG1_LOWDATARATEOPTIMIZE_MASK
 ) |

424 –
b™dwidth
 << 6 ) | ( 
codî©e
 << 3 ) |

425 –
fixLí
 << 2 ) | ( 
¸cOn
 << 1 ) |

426 
SX1272
.
Sëtögs
.
LoRa
.
LowD©¨©eO±imize
 );

428 
	`SX1272Wrôe
–
REG_LR_MODEMCONFIG2
,

429 –
	`SX1272Ród
–
REG_LR_MODEMCONFIG2
 ) &

430 
RFLR_MODEMCONFIG2_SF_MASK
 &

431 
RFLR_MODEMCONFIG2_SYMBTIMEOUTMSB_MASK
 ) |

432 –
d©¨©e
 << 4 ) |

433 ––
symbTimeout
 >> 8 ) & ~
RFLR_MODEMCONFIG2_SYMBTIMEOUTMSB_MASK
 ) );

435 
	`SX1272Wrôe
–
REG_LR_SYMBTIMEOUTLSB
, ( 
uöt8_t
 )–
symbTimeout
 & 0xFF ) );

437 
	`SX1272Wrôe
–
REG_LR_PREAMBLEMSB
, ( 
uöt8_t
 )––
¥ómbÀLí
 >> 8 ) & 0xFF ) );

438 
	`SX1272Wrôe
–
REG_LR_PREAMBLELSB
, ( 
uöt8_t
 )–
¥ómbÀLí
 & 0xFF ) );

440 if–
fixLí
 == 1 )

442 
	`SX1272Wrôe
–
REG_LR_PAYLOADLENGTH
, 
∑ylﬂdLí
 );

445 if–
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 =
åue
 )

447 
	`SX1272Wrôe
–
REG_LR_PLLHOP
, ( 
	`SX1272Ród
–REG_LR_PLLHOP ) & 
RFLR_PLLHOP_FASTHOP_MASK
 ) | 
RFLR_PLLHOP_FASTHOP_ON
 );

448 
	`SX1272Wrôe
–
REG_LR_HOPPERIOD
, 
SX1272
.
Sëtögs
.
LoRa
.
H›Pîiod
 );

451 if–
d©¨©e
 == 6 )

453 
	`SX1272Wrôe
–
REG_LR_DETECTOPTIMIZE
,

454 –
	`SX1272Ród
–
REG_LR_DETECTOPTIMIZE
 ) &

455 
RFLR_DETECTIONOPTIMIZE_MASK
 ) |

456 
RFLR_DETECTIONOPTIMIZE_SF6
 );

457 
	`SX1272Wrôe
–
REG_LR_DETECTIONTHRESHOLD
,

458 
RFLR_DETECTIONTHRESH_SF6
 );

462 
	`SX1272Wrôe
–
REG_LR_DETECTOPTIMIZE
,

463 –
	`SX1272Ród
–
REG_LR_DETECTOPTIMIZE
 ) &

464 
RFLR_DETECTIONOPTIMIZE_MASK
 ) |

465 
RFLR_DETECTIONOPTIMIZE_SF7_TO_SF12
 );

466 
	`SX1272Wrôe
–
REG_LR_DETECTIONTHRESHOLD
,

467 
RFLR_DETECTIONTHRESH_SF7_TO_SF12
 );

472 
	}
}

474 
	$SX1272SëTxC⁄fig
–
RadioModems_t
 
modem
, 
öt8_t
 
powî
, 
uöt32_t
 
fdev
,

475 
uöt32_t
 
b™dwidth
, uöt32_à
d©¨©e
,

476 
uöt8_t
 
codî©e
, 
uöt16_t
 
¥ómbÀLí
,

477 
boﬁ
 
fixLí
, boﬁ 
¸cOn
, boﬁ 
‰eqH›On
,

478 
uöt8_t
 
h›Pîiod
, 
boﬁ
 
iqInvîãd
, 
uöt32_t
 
timeout
 )

480 
	`SX1272SëModem
–
modem
 );

482 
	`SX1272SëRfTxPowî
–
powî
 );

484  
modem
 )

486 
MODEM_FSK
:

488 
SX1272
.
Sëtögs
.
Fsk
.
Powî
 = 
powî
;

489 
SX1272
.
Sëtögs
.
Fsk
.
Fdev
 = 
fdev
;

490 
SX1272
.
Sëtögs
.
Fsk
.
B™dwidth
 = 
b™dwidth
;

491 
SX1272
.
Sëtögs
.
Fsk
.
D©¨©e
 = 
d©¨©e
;

492 
SX1272
.
Sëtögs
.
Fsk
.
PªambÀLí
 = 
¥ómbÀLí
;

493 
SX1272
.
Sëtögs
.
Fsk
.
FixLí
 = 
fixLí
;

494 
SX1272
.
Sëtögs
.
Fsk
.
CrcOn
 = 
¸cOn
;

495 
SX1272
.
Sëtögs
.
Fsk
.
IqInvîãd
 = 
iqInvîãd
;

496 
SX1272
.
Sëtögs
.
Fsk
.
TxTimeout
 = 
timeout
;

498 
fdev
 = ( 
uöt16_t
 )––)fdev / ( )
FREQ_STEP
 );

499 
	`SX1272Wrôe
–
REG_FDEVMSB
, ( 
uöt8_t
 )–
fdev
 >> 8 ) );

500 
	`SX1272Wrôe
–
REG_FDEVLSB
, ( 
uöt8_t
 )–
fdev
 & 0xFF ) );

502 
d©¨©e
 = ( 
uöt16_t
 )––)
XTAL_FREQ
 / ( )datarate );

503 
	`SX1272Wrôe
–
REG_BITRATEMSB
, ( 
uöt8_t
 )–
d©¨©e
 >> 8 ) );

504 
	`SX1272Wrôe
–
REG_BITRATELSB
, ( 
uöt8_t
 )–
d©¨©e
 & 0xFF ) );

506 
	`SX1272Wrôe
–
REG_PREAMBLEMSB
, ( 
¥ómbÀLí
 >> 8 ) & 0x00FF );

507 
	`SX1272Wrôe
–
REG_PREAMBLELSB
, 
¥ómbÀLí
 & 0xFF );

509 
	`SX1272Wrôe
–
REG_PACKETCONFIG1
,

510 –
	`SX1272Ród
–
REG_PACKETCONFIG1
 ) &

511 
RF_PACKETCONFIG1_CRC_MASK
 &

512 
RF_PACKETCONFIG1_PACKETFORMAT_MASK
 ) |

513 ––
fixLí
 =1 ) ? 
RF_PACKETCONFIG1_PACKETFORMAT_FIXED
 : 
RF_PACKETCONFIG1_PACKETFORMAT_VARIABLE
 ) |

514 –
¸cOn
 << 4 ) );

515 
	`SX1272Wrôe
–
REG_PACKETCONFIG2
, ( 
	`SX1272Ród
–REG_PACKETCONFIG2 ) | 
RF_PACKETCONFIG2_DATAMODE_PACKET
 ) );

518 
MODEM_LORA
:

520 
SX1272
.
Sëtögs
.
LoRa
.
Powî
 = 
powî
;

521 
SX1272
.
Sëtögs
.
LoRa
.
B™dwidth
 = 
b™dwidth
;

522 
SX1272
.
Sëtögs
.
LoRa
.
D©¨©e
 = 
d©¨©e
;

523 
SX1272
.
Sëtögs
.
LoRa
.
Codî©e
 = 
codî©e
;

524 
SX1272
.
Sëtögs
.
LoRa
.
PªambÀLí
 = 
¥ómbÀLí
;

525 
SX1272
.
Sëtögs
.
LoRa
.
FixLí
 = 
fixLí
;

526 
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 = 
‰eqH›On
;

527 
SX1272
.
Sëtögs
.
LoRa
.
H›Pîiod
 = 
h›Pîiod
;

528 
SX1272
.
Sëtögs
.
LoRa
.
CrcOn
 = 
¸cOn
;

529 
SX1272
.
Sëtögs
.
LoRa
.
IqInvîãd
 = 
iqInvîãd
;

530 
SX1272
.
Sëtögs
.
LoRa
.
TxTimeout
 = 
timeout
;

532 if–
d©¨©e
 > 12 )

534 
d©¨©e
 = 12;

536 if–
d©¨©e
 < 6 )

538 
d©¨©e
 = 6;

540 if–––
b™dwidth
 =0 ) && ( ( 
d©¨©e
 == 11 ) || ( datarate == 12 ) ) ) ||

541 ––
b™dwidth
 =1 ) && ( 
d©¨©e
 == 12 ) ) )

543 
SX1272
.
Sëtögs
.
LoRa
.
LowD©¨©eO±imize
 = 0x01;

547 
SX1272
.
Sëtögs
.
LoRa
.
LowD©¨©eO±imize
 = 0x00;

550 if–
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 =
åue
 )

552 
	`SX1272Wrôe
–
REG_LR_PLLHOP
, ( 
	`SX1272Ród
–REG_LR_PLLHOP ) & 
RFLR_PLLHOP_FASTHOP_MASK
 ) | 
RFLR_PLLHOP_FASTHOP_ON
 );

553 
	`SX1272Wrôe
–
REG_LR_HOPPERIOD
, 
SX1272
.
Sëtögs
.
LoRa
.
H›Pîiod
 );

556 
	`SX1272Wrôe
–
REG_LR_MODEMCONFIG1
,

557 –
	`SX1272Ród
–
REG_LR_MODEMCONFIG1
 ) &

558 
RFLR_MODEMCONFIG1_BW_MASK
 &

559 
RFLR_MODEMCONFIG1_CODINGRATE_MASK
 &

560 
RFLR_MODEMCONFIG1_IMPLICITHEADER_MASK
 &

561 
RFLR_MODEMCONFIG1_RXPAYLOADCRC_MASK
 &

562 
RFLR_MODEMCONFIG1_LOWDATARATEOPTIMIZE_MASK
 ) |

563 –
b™dwidth
 << 6 ) | ( 
codî©e
 << 3 ) |

564 –
fixLí
 << 2 ) | ( 
¸cOn
 << 1 ) |

565 
SX1272
.
Sëtögs
.
LoRa
.
LowD©¨©eO±imize
 );

567 
	`SX1272Wrôe
–
REG_LR_MODEMCONFIG2
,

568 –
	`SX1272Ród
–
REG_LR_MODEMCONFIG2
 ) &

569 
RFLR_MODEMCONFIG2_SF_MASK
 ) |

570 –
d©¨©e
 << 4 ) );

573 
	`SX1272Wrôe
–
REG_LR_PREAMBLEMSB
, ( 
¥ómbÀLí
 >> 8 ) & 0x00FF );

574 
	`SX1272Wrôe
–
REG_LR_PREAMBLELSB
, 
¥ómbÀLí
 & 0xFF );

576 if–
d©¨©e
 == 6 )

578 
	`SX1272Wrôe
–
REG_LR_DETECTOPTIMIZE
,

579 –
	`SX1272Ród
–
REG_LR_DETECTOPTIMIZE
 ) &

580 
RFLR_DETECTIONOPTIMIZE_MASK
 ) |

581 
RFLR_DETECTIONOPTIMIZE_SF6
 );

582 
	`SX1272Wrôe
–
REG_LR_DETECTIONTHRESHOLD
,

583 
RFLR_DETECTIONTHRESH_SF6
 );

587 
	`SX1272Wrôe
–
REG_LR_DETECTOPTIMIZE
,

588 –
	`SX1272Ród
–
REG_LR_DETECTOPTIMIZE
 ) &

589 
RFLR_DETECTIONOPTIMIZE_MASK
 ) |

590 
RFLR_DETECTIONOPTIMIZE_SF7_TO_SF12
 );

591 
	`SX1272Wrôe
–
REG_LR_DETECTIONTHRESHOLD
,

592 
RFLR_DETECTIONTHRESH_SF7_TO_SF12
 );

597 
	}
}

599 
uöt32_t
 
	$SX1272GëTimeOnAú
–
RadioModems_t
 
modem
, 
uöt8_t
 
pktLí
 )

601 
uöt32_t
 
aúTime
 = 0;

603  
modem
 )

605 
MODEM_FSK
:

607 
aúTime
 = 
	`round
––8 * ( 
SX1272
.
Sëtögs
.
Fsk
.
PªambÀLí
 +

608 ––
	`SX1272Ród
–
REG_SYNCCONFIG
 ) & ~
RF_SYNCCONFIG_SYNCSIZE_MASK
 ) + 1 ) +

609 ––
SX1272
.
Sëtögs
.
Fsk
.
FixLí
 == 0x01 ) ? 0.0 : 1.0 ) +

610 –––
	`SX1272Ród
–
REG_PACKETCONFIG1
 ) & ~
RF_PACKETCONFIG1_ADDRSFILTERING_MASK
 ) != 0x00 ) ? 1.0 : 0 ) +

611 
pktLí
 +

612 ––
SX1272
.
Sëtögs
.
Fsk
.
CrcOn
 == 0x01 ) ? 2.0 : 0 ) ) /

613 
SX1272
.
Sëtögs
.
Fsk
.
D©¨©e
 ) * 1e3 );

616 
MODEM_LORA
:

618 
bw
 = 0.0;

619  
SX1272
.
Sëtögs
.
LoRa
.
B™dwidth
 )

622 
bw
 = 125e3;

625 
bw
 = 250e3;

628 
bw
 = 500e3;

633 
rs
 = 
bw
 / ( 1 << 
SX1272
.
Sëtögs
.
LoRa
.
D©¨©e
 );

634 
ts
 = 1 / 
rs
;

636 
tPªambÀ
 = ( 
SX1272
.
Sëtögs
.
LoRa
.
PªambÀLí
 + 4.25 ) * 
ts
;

638 
tmp
 = 
	`˚û
––8 * 
pktLí
 - 4 * 
SX1272
.
Sëtögs
.
LoRa
.
D©¨©e
 +

639 28 + 16 * 
SX1272
.
Sëtögs
.
LoRa
.
CrcOn
 -

640 –
SX1272
.
Sëtögs
.
LoRa
.
FixLí
 ? 20 : 0 ) ) /

641 –)–4 * ( 
SX1272
.
Sëtögs
.
LoRa
.
D©¨©e
 -

642 ––
SX1272
.
Sëtögs
.
LoRa
.
LowD©¨©eO±imize
 > 0 ) ? 2 : 0 ) ) ) ) *

643 –
SX1272
.
Sëtögs
.
LoRa
.
Codî©e
 + 4 );

644 
nPaylﬂd
 = 8 + ( ( 
tmp
 > 0 ) ?Åmp : 0 );

645 
tPaylﬂd
 = 
nPaylﬂd
 * 
ts
;

647 
tOnAú
 = 
tPªambÀ
 + 
tPaylﬂd
;

649 
aúTime
 = 
	`Êo‹
–
tOnAú
 * 1e3 + 0.999 );

653  
aúTime
;

654 
	}
}

656 
	$SX1272Síd
–
uöt8_t
 *
buf„r
, uöt8_à
size
 )

658 
uöt32_t
 
txTimeout
 = 0;

660  
SX1272
.
Sëtögs
.
Modem
 )

662 
MODEM_FSK
:

664 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 = 0;

665 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 = 
size
;

667 if–
SX1272
.
Sëtögs
.
Fsk
.
FixLí
 =
Ál£
 )

669 
	`SX1272WrôeFifo
––
uöt8_t
* )&
size
, 1 );

673 
	`SX1272Wrôe
–
REG_PAYLOADLENGTH
, 
size
 );

676 if––
size
 > 0 ) && ( size <= 64 ) )

678 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
ChunkSize
 = 
size
;

682 
	`mem˝y1
–
RxTxBuf„r
, 
buf„r
, 
size
 );

683 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
ChunkSize
 = 32;

687 
	`SX1272WrôeFifo
–
buf„r
, 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
ChunkSize
 );

688 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 +SX1272.Sëtögs.FskPackëH™dÀr.
ChunkSize
;

689 
txTimeout
 = 
SX1272
.
Sëtögs
.
Fsk
.
TxTimeout
;

692 
MODEM_LORA
:

694 if–
SX1272
.
Sëtögs
.
LoRa
.
IqInvîãd
 =
åue
 )

696 
	`SX1272Wrôe
–
REG_LR_INVERTIQ
, ( ( 
	`SX1272Ród
–REG_LR_INVERTIQ ) & 
RFLR_INVERTIQ_TX_MASK
 & 
RFLR_INVERTIQ_RX_MASK
 ) | 
RFLR_INVERTIQ_RX_OFF
 | 
RFLR_INVERTIQ_TX_ON
 ) );

697 
	`SX1272Wrôe
–
REG_LR_INVERTIQ2
, 
RFLR_INVERTIQ2_ON
 );

701 
	`SX1272Wrôe
–
REG_LR_INVERTIQ
, ( ( 
	`SX1272Ród
–REG_LR_INVERTIQ ) & 
RFLR_INVERTIQ_TX_MASK
 & 
RFLR_INVERTIQ_RX_MASK
 ) | 
RFLR_INVERTIQ_RX_OFF
 | 
RFLR_INVERTIQ_TX_OFF
 ) );

702 
	`SX1272Wrôe
–
REG_LR_INVERTIQ2
, 
RFLR_INVERTIQ2_OFF
 );

705 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
Size
 = 
size
;

708 
	`SX1272Wrôe
–
REG_LR_PAYLOADLENGTH
, 
size
 );

711 
	`SX1272Wrôe
–
REG_LR_FIFOTXBASEADDR
, 0 );

712 
	`SX1272Wrôe
–
REG_LR_FIFOADDRPTR
, 0 );

715 if––
	`SX1272Ród
–
REG_OPMODE
 ) & ~
RF_OPMODE_MASK
 ) =
RF_OPMODE_SLEEP
 )

717 
	`SX1272SëStby
( );

718 
	`DñayMs
( 1 );

721 
	`SX1272WrôeFifo
–
buf„r
, 
size
 );

722 
txTimeout
 = 
SX1272
.
Sëtögs
.
LoRa
.
TxTimeout
;

727 
	`SX1272SëTx
–
txTimeout
 );

728 
	}
}

730 
	$SX1272SëSÀï
( )

732 
	`TimîSt›
–&
RxTimeoutTimî
 );

733 
	`TimîSt›
–&
TxTimeoutTimî
 );

735 
	`SX1272SëOpMode
–
RF_OPMODE_SLEEP
 );

736 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

737 
	}
}

739 
	$SX1272SëStby
( )

741 
	`TimîSt›
–&
RxTimeoutTimî
 );

742 
	`TimîSt›
–&
TxTimeoutTimî
 );

744 
	`SX1272SëOpMode
–
RF_OPMODE_STANDBY
 );

745 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

746 
	}
}

748 
	$SX1272SëRx
–
uöt32_t
 
timeout
 )

750 
boﬁ
 
rxC⁄töuous
 = 
Ál£
;

752  
SX1272
.
Sëtögs
.
Modem
 )

754 
MODEM_FSK
:

756 
rxC⁄töuous
 = 
SX1272
.
Sëtögs
.
Fsk
.
RxC⁄töuous
;

764 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, ( 
	`SX1272Ród
–REG_DIOMAPPING1 ) & 
RF_DIOMAPPING1_DIO0_MASK
 &

765 
RF_DIOMAPPING1_DIO1_MASK
 &

766 
RF_DIOMAPPING1_DIO2_MASK
 ) |

767 
RF_DIOMAPPING1_DIO0_00
 |

768 
RF_DIOMAPPING1_DIO1_00
 |

769 
RF_DIOMAPPING1_DIO2_11
 );

771 
	`SX1272Wrôe
–
REG_DIOMAPPING2
, ( 
	`SX1272Ród
–REG_DIOMAPPING2 ) & 
RF_DIOMAPPING2_DIO4_MASK
 &

772 
RF_DIOMAPPING2_MAP_MASK
 ) |

773 
RF_DIOMAPPING2_DIO4_11
 |

774 
RF_DIOMAPPING2_MAP_PREAMBLEDETECT
 );

776 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
FifoThªsh
 = 
	`SX1272Ród
–
REG_FIFOTHRESH
 ) & 0x3F;

778 
	`SX1272Wrôe
–
REG_RXCONFIG
, 
RF_RXCONFIG_AFCAUTO_ON
 | 
RF_RXCONFIG_AGCAUTO_ON
 | 
RF_RXCONFIG_RXTRIGER_PREAMBLEDETECT
 );

780 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 = 
Ál£
;

781 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
SyncW‹dDëe˘ed
 = 
Ál£
;

782 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 = 0;

783 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 = 0;

786 
MODEM_LORA
:

788 if–
SX1272
.
Sëtögs
.
LoRa
.
IqInvîãd
 =
åue
 )

790 
	`SX1272Wrôe
–
REG_LR_INVERTIQ
, ( ( 
	`SX1272Ród
–REG_LR_INVERTIQ ) & 
RFLR_INVERTIQ_TX_MASK
 & 
RFLR_INVERTIQ_RX_MASK
 ) | 
RFLR_INVERTIQ_RX_ON
 | 
RFLR_INVERTIQ_TX_OFF
 ) );

791 
	`SX1272Wrôe
–
REG_LR_INVERTIQ2
, 
RFLR_INVERTIQ2_ON
 );

795 
	`SX1272Wrôe
–
REG_LR_INVERTIQ
, ( ( 
	`SX1272Ród
–REG_LR_INVERTIQ ) & 
RFLR_INVERTIQ_TX_MASK
 & 
RFLR_INVERTIQ_RX_MASK
 ) | 
RFLR_INVERTIQ_RX_OFF
 | 
RFLR_INVERTIQ_TX_OFF
 ) );

796 
	`SX1272Wrôe
–
REG_LR_INVERTIQ2
, 
RFLR_INVERTIQ2_OFF
 );

799 
rxC⁄töuous
 = 
SX1272
.
Sëtögs
.
LoRa
.
RxC⁄töuous
;

801 if–
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 =
åue
 )

803 
	`SX1272Wrôe
–
REG_LR_IRQFLAGSMASK
,

806 
RFLR_IRQFLAGS_VALIDHEADER
 |

807 
RFLR_IRQFLAGS_TXDONE
 |

808 
RFLR_IRQFLAGS_CADDONE
 |

810 
RFLR_IRQFLAGS_CADDETECTED
 );

813 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, ( 
	`SX1272Ród
–REG_DIOMAPPING1 ) & 
RFLR_DIOMAPPING1_DIO0_MASK
 & 
RFLR_DIOMAPPING1_DIO2_MASK
 ) | 
RFLR_DIOMAPPING1_DIO0_00
 | 
RFLR_DIOMAPPING1_DIO2_00
 );

817 
	`SX1272Wrôe
–
REG_LR_IRQFLAGSMASK
,

820 
RFLR_IRQFLAGS_VALIDHEADER
 |

821 
RFLR_IRQFLAGS_TXDONE
 |

822 
RFLR_IRQFLAGS_CADDONE
 |

823 
RFLR_IRQFLAGS_FHSSCHANGEDCHANNEL
 |

824 
RFLR_IRQFLAGS_CADDETECTED
 );

827 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, ( 
	`SX1272Ród
–REG_DIOMAPPING1 ) & 
RFLR_DIOMAPPING1_DIO0_MASK
 ) | 
RFLR_DIOMAPPING1_DIO0_00
 );

829 
	`SX1272Wrôe
–
REG_LR_FIFORXBASEADDR
, 0 );

830 
	`SX1272Wrôe
–
REG_LR_FIFOADDRPTR
, 0 );

835 
	`mem£t
–
RxTxBuf„r
, 0, ( 
size_t
 )
RX_BUFFER_SIZE
 );

837 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_RX_RUNNING
;

838 if–
timeout
 != 0 )

840 
	`TimîSëVÆue
–&
RxTimeoutTimî
, 
timeout
 );

841 
	`TimîSèπ
–&
RxTimeoutTimî
 );

844 if–
SX1272
.
Sëtögs
.
Modem
 =
MODEM_FSK
 )

846 
	`SX1272SëOpMode
–
RF_OPMODE_RECEIVER
 );

848 if–
rxC⁄töuous
 =
Ál£
 )

850 
	`TimîSëVÆue
–&
RxTimeoutSyncW‹d
, 
	`˚û
––8.0 * ( 
SX1272
.
Sëtögs
.
Fsk
.
PªambÀLí
 +

851 ––
	`SX1272Ród
–
REG_SYNCCONFIG
 ) &

852 ~
RF_SYNCCONFIG_SYNCSIZE_MASK
 ) +

854 –)
SX1272
.
Sëtögs
.
Fsk
.
D©¨©e
 ) * 1e3 ) + 4 );

855 
	`TimîSèπ
–&
RxTimeoutSyncW‹d
 );

860 if–
rxC⁄töuous
 =
åue
 )

862 
	`SX1272SëOpMode
–
RFLR_OPMODE_RECEIVER
 );

866 
	`SX1272SëOpMode
–
RFLR_OPMODE_RECEIVER_SINGLE
 );

869 
	}
}

871 
	$SX1272SëTx
–
uöt32_t
 
timeout
 )

873 
	`TimîSëVÆue
–&
TxTimeoutTimî
, 
timeout
 );

875  
SX1272
.
Sëtögs
.
Modem
 )

877 
MODEM_FSK
:

885 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, ( 
	`SX1272Ród
–REG_DIOMAPPING1 ) & 
RF_DIOMAPPING1_DIO0_MASK
 &

886 
RF_DIOMAPPING1_DIO1_MASK
 &

887 
RF_DIOMAPPING1_DIO2_MASK
 ) |

888 
RF_DIOMAPPING1_DIO1_01
 );

890 
	`SX1272Wrôe
–
REG_DIOMAPPING2
, ( 
	`SX1272Ród
–REG_DIOMAPPING2 ) & 
RF_DIOMAPPING2_DIO4_MASK
 &

891 
RF_DIOMAPPING2_MAP_MASK
 ) );

892 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
FifoThªsh
 = 
	`SX1272Ród
–
REG_FIFOTHRESH
 ) & 0x3F;

895 
MODEM_LORA
:

897 if–
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 =
åue
 )

899 
	`SX1272Wrôe
–
REG_LR_IRQFLAGSMASK
, 
RFLR_IRQFLAGS_RXTIMEOUT
 |

900 
RFLR_IRQFLAGS_RXDONE
 |

901 
RFLR_IRQFLAGS_PAYLOADCRCERROR
 |

902 
RFLR_IRQFLAGS_VALIDHEADER
 |

904 
RFLR_IRQFLAGS_CADDONE
 |

906 
RFLR_IRQFLAGS_CADDETECTED
 );

909 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, ( 
	`SX1272Ród
–REG_DIOMAPPING1 ) & 
RFLR_DIOMAPPING1_DIO0_MASK
 & 
RFLR_DIOMAPPING1_DIO2_MASK
 ) | 
RFLR_DIOMAPPING1_DIO0_01
 | 
RFLR_DIOMAPPING1_DIO2_00
 );

913 
	`SX1272Wrôe
–
REG_LR_IRQFLAGSMASK
, 
RFLR_IRQFLAGS_RXTIMEOUT
 |

914 
RFLR_IRQFLAGS_RXDONE
 |

915 
RFLR_IRQFLAGS_PAYLOADCRCERROR
 |

916 
RFLR_IRQFLAGS_VALIDHEADER
 |

918 
RFLR_IRQFLAGS_CADDONE
 |

919 
RFLR_IRQFLAGS_FHSSCHANGEDCHANNEL
 |

920 
RFLR_IRQFLAGS_CADDETECTED
 );

923 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, ( 
	`SX1272Ród
–REG_DIOMAPPING1 ) & 
RFLR_DIOMAPPING1_DIO0_MASK
 ) | 
RFLR_DIOMAPPING1_DIO0_01
 );

929 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_TX_RUNNING
;

930 
	`TimîSèπ
–&
TxTimeoutTimî
 );

931 
	`SX1272SëOpMode
–
RF_OPMODE_TRANSMITTER
 );

932 
	}
}

934 
	$SX1272SèπCad
( )

936  
SX1272
.
Sëtögs
.
Modem
 )

938 
MODEM_FSK
:

943 
MODEM_LORA
:

945 
	`SX1272Wrôe
–
REG_LR_IRQFLAGSMASK
, 
RFLR_IRQFLAGS_RXTIMEOUT
 |

946 
RFLR_IRQFLAGS_RXDONE
 |

947 
RFLR_IRQFLAGS_PAYLOADCRCERROR
 |

948 
RFLR_IRQFLAGS_VALIDHEADER
 |

949 
RFLR_IRQFLAGS_TXDONE
 |

951 
RFLR_IRQFLAGS_FHSSCHANGEDCHANNEL


956 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, ( 
	`SX1272Ród
–REG_DIOMAPPING1 ) & 
RFLR_DIOMAPPING1_DIO3_MASK
 ) | 
RFLR_DIOMAPPING1_DIO3_00
 );

958 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_CAD
;

959 
	`SX1272SëOpMode
–
RFLR_OPMODE_CAD
 );

965 
	}
}

967 
	$SX1272SëTxC⁄töuousWave
–
uöt32_t
 
‰eq
, 
öt8_t
 
powî
, 
uöt16_t
 
time
 )

969 
uöt32_t
 
timeout
 = ( uöt32_à)–
time
 * 1e3 );

971 
	`SX1272SëCh™√l
–
‰eq
 );

973 
	`SX1272SëTxC⁄fig
–
MODEM_FSK
, 
powî
, 0, 0, 4800, 0, 5, 
Ál£
, fÆ£, 0, 0, 0, 
timeout
 );

975 
	`SX1272Wrôe
–
REG_PACKETCONFIG2
, ( 
	`SX1272Ród
–REG_PACKETCONFIG2 ) & 
RF_PACKETCONFIG2_DATAMODE_MASK
 ) );

977 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, 
RF_DIOMAPPING1_DIO0_11
 | 
RF_DIOMAPPING1_DIO1_11
 );

978 
	`SX1272Wrôe
–
REG_DIOMAPPING2
, 
RF_DIOMAPPING2_DIO4_10
 | 
RF_DIOMAPPING2_DIO5_10
 );

980 
	`TimîSëVÆue
–&
TxTimeoutTimî
, 
timeout
 );

982 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_TX_RUNNING
;

983 
	`TimîSèπ
–&
TxTimeoutTimî
 );

984 
	`SX1272SëOpMode
–
RF_OPMODE_TRANSMITTER
 );

985 
	}
}

987 
öt16_t
 
	$SX1272RódRssi
–
RadioModems_t
 
modem
 )

989 
öt16_t
 
rssi
 = 0;

991  
modem
 )

993 
MODEM_FSK
:

994 
rssi
 = -–
	`SX1272Ród
–
REG_RSSIVALUE
 ) >> 1 );

996 
MODEM_LORA
:

997 
rssi
 = 
RSSI_OFFSET
 + 
	`SX1272Ród
–
REG_LR_RSSIVALUE
 );

1000 
rssi
 = -1;

1003  
rssi
;

1004 
	}
}

1006 
	$SX1272Re£t
( )

1009 
	`GpioInô
–&
SX1272
.
Re£t
, 
RADIO_RESET
, 
PIN_OUTPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 1 );

1012 
	`DñayMs
( 1 );

1015 
	`GpioInô
–&
SX1272
.
Re£t
, 
RADIO_RESET
, 
PIN_INPUT
, 
PIN_PUSH_PULL
, 
PIN_NO_PULL
, 1 );

1018 
	`DñayMs
( 6 );

1019 
	}
}

1021 
	$SX1272SëOpMode
–
uöt8_t
 
›Mode
 )

1023 if–
›Mode
 =
RF_OPMODE_SLEEP
 )

1025 
	`SX1272SëA¡SwLowPowî
–
åue
 );

1029 
	`SX1272SëA¡SwLowPowî
–
Ál£
 );

1030 
	`SX1272SëA¡Sw
–
›Mode
 );

1032 
	`SX1272Wrôe
–
REG_OPMODE
, ( 
	`SX1272Ród
–REG_OPMODE ) & 
RF_OPMODE_MASK
 ) | 
›Mode
 );

1033 
	}
}

1035 
	$SX1272SëModem
–
RadioModems_t
 
modem
 )

1037 
	`as£π_∑øm
––
SX1272
.
Spi
.Spi.
In°™˚
 !
NULL
 ) );

1039 if––
	`SX1272Ród
–
REG_OPMODE
 ) & 
RFLR_OPMODE_LONGRANGEMODE_ON
 ) != 0 )

1041 
SX1272
.
Sëtögs
.
Modem
 = 
MODEM_LORA
;

1045 
SX1272
.
Sëtögs
.
Modem
 = 
MODEM_FSK
;

1048 if–
SX1272
.
Sëtögs
.
Modem
 =
modem
 )

1053 
SX1272
.
Sëtögs
.
Modem
 = 
modem
;

1054  
SX1272
.
Sëtögs
.
Modem
 )

1057 
MODEM_FSK
:

1058 
	`SX1272SëSÀï
( );

1059 
	`SX1272Wrôe
–
REG_OPMODE
, ( 
	`SX1272Ród
–REG_OPMODE ) & 
RFLR_OPMODE_LONGRANGEMODE_MASK
 ) | 
RFLR_OPMODE_LONGRANGEMODE_OFF
 );

1061 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, 0x00 );

1062 
	`SX1272Wrôe
–
REG_DIOMAPPING2
, 0x30 );

1064 
MODEM_LORA
:

1065 
	`SX1272SëSÀï
( );

1066 
	`SX1272Wrôe
–
REG_OPMODE
, ( 
	`SX1272Ród
–REG_OPMODE ) & 
RFLR_OPMODE_LONGRANGEMODE_MASK
 ) | 
RFLR_OPMODE_LONGRANGEMODE_ON
 );

1068 
	`SX1272Wrôe
–
REG_DIOMAPPING1
, 0x00 );

1069 
	`SX1272Wrôe
–
REG_DIOMAPPING2
, 0x00 );

1072 
	}
}

1074 
	$SX1272Wrôe
–
uöt8_t
 
addr
, uöt8_à
d©a
 )

1076 
	`SX1272WrôeBuf„r
–
addr
, &
d©a
, 1 );

1077 
	}
}

1079 
uöt8_t
 
	$SX1272Ród
–
uöt8_t
 
addr
 )

1081 
uöt8_t
 
d©a
;

1082 
	`SX1272RódBuf„r
–
addr
, &
d©a
, 1 );

1083  
d©a
;

1084 
	}
}

1086 
	$SX1272WrôeBuf„r
–
uöt8_t
 
addr
, uöt8_à*
buf„r
, uöt8_à
size
 )

1088 
uöt8_t
 
i
;

1091 
	`GpioWrôe
–&
SX1272
.
Spi
.
Nss
, 0 );

1093 
	`SpiInOut
–&
SX1272
.
Spi
, 
addr
 | 0x80 );

1094  
i
 = 0; i < 
size
; i++ )

1096 
	`SpiInOut
–&
SX1272
.
Spi
, 
buf„r
[
i
] );

1100 
	`GpioWrôe
–&
SX1272
.
Spi
.
Nss
, 1 );

1101 
	}
}

1103 
	$SX1272RódBuf„r
–
uöt8_t
 
addr
, uöt8_à*
buf„r
, uöt8_à
size
 )

1105 
uöt8_t
 
i
;

1108 
	`GpioWrôe
–&
SX1272
.
Spi
.
Nss
, 0 );

1110 
	`SpiInOut
–&
SX1272
.
Spi
, 
addr
 & 0x7F );

1112  
i
 = 0; i < 
size
; i++ )

1114 
buf„r
[
i
] = 
	`SpiInOut
–&
SX1272
.
Spi
, 0 );

1118 
	`GpioWrôe
–&
SX1272
.
Spi
.
Nss
, 1 );

1119 
	}
}

1121 
	$SX1272WrôeFifo
–
uöt8_t
 *
buf„r
, uöt8_à
size
 )

1123 
	`SX1272WrôeBuf„r
–0, 
buf„r
, 
size
 );

1124 
	}
}

1126 
	$SX1272RódFifo
–
uöt8_t
 *
buf„r
, uöt8_à
size
 )

1128 
	`SX1272RódBuf„r
–0, 
buf„r
, 
size
 );

1129 
	}
}

1131 
	$SX1272SëMaxPaylﬂdLígth
–
RadioModems_t
 
modem
, 
uöt8_t
 
max
 )

1133 
	`SX1272SëModem
–
modem
 );

1135  
modem
 )

1137 
MODEM_FSK
:

1138 if–
SX1272
.
Sëtögs
.
Fsk
.
FixLí
 =
Ál£
 )

1140 
	`SX1272Wrôe
–
REG_PAYLOADLENGTH
, 
max
 );

1143 
MODEM_LORA
:

1144 
	`SX1272Wrôe
–
REG_LR_PAYLOADMAXLENGTH
, 
max
 );

1147 
	}
}

1149 
	$SX1272SëPublicNëw‹k
–
boﬁ
 
íabÀ
 )

1151 
	`SX1272SëModem
–
MODEM_LORA
 );

1152 if–
íabÀ
 =
åue
 )

1155 
	`SX1272Wrôe
–
REG_LR_SYNCWORD
, 
LORA_MAC_PUBLIC_SYNCWORD
 );

1160 
	`SX1272Wrôe
–
REG_LR_SYNCWORD
, 
LORA_MAC_PRIVATE_SYNCWORD
 );

1162 
	}
}

1164 
	$SX1272OnTimeoutIrq
( )

1166  
SX1272
.
Sëtögs
.
Sèã
 )

1168 
RF_RX_RUNNING
:

1169 if–
SX1272
.
Sëtögs
.
Modem
 =
MODEM_FSK
 )

1171 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 = 
Ál£
;

1172 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
SyncW‹dDëe˘ed
 = 
Ál£
;

1173 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 = 0;

1174 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 = 0;

1177 
	`SX1272Wrôe
–
REG_IRQFLAGS1
, 
RF_IRQFLAGS1_RSSI
 |

1178 
RF_IRQFLAGS1_PREAMBLEDETECT
 |

1179 
RF_IRQFLAGS1_SYNCADDRESSMATCH
 );

1180 
	`SX1272Wrôe
–
REG_IRQFLAGS2
, 
RF_IRQFLAGS2_FIFOOVERRUN
 );

1182 if–
SX1272
.
Sëtögs
.
Fsk
.
RxC⁄töuous
 =
åue
 )

1185 
	`SX1272Wrôe
–
REG_RXCONFIG
, 
	`SX1272Ród
–REG_RXCONFIG ) | 
RF_RXCONFIG_RESTARTRXWITHOUTPLLLOCK
 );

1186 
	`TimîSèπ
–&
RxTimeoutSyncW‹d
 );

1190 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1191 
	`TimîSt›
–&
RxTimeoutSyncW‹d
 );

1194 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
RxTimeout
 != NULL ) )

1196 
RadioEvíts
->
	`RxTimeout
( );

1199 
RF_TX_RUNNING
:

1200 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1201 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
TxTimeout
 != NULL ) )

1203 
RadioEvíts
->
	`TxTimeout
( );

1209 
	}
}

1211 
	$SX1272OnDio0Irq
( )

1213 vﬁ©ûê
uöt8_t
 
úqFœgs
 = 0;

1215  
SX1272
.
Sëtögs
.
Sèã
 )

1217 
RF_RX_RUNNING
:

1220  
SX1272
.
Sëtögs
.
Modem
 )

1222 
MODEM_FSK
:

1223 if–
SX1272
.
Sëtögs
.
Fsk
.
CrcOn
 =
åue
 )

1225 
úqFœgs
 = 
	`SX1272Ród
–
REG_IRQFLAGS2
 );

1226 if––
úqFœgs
 & 
RF_IRQFLAGS2_CRCOK
 ) != RF_IRQFLAGS2_CRCOK )

1229 
	`SX1272Wrôe
–
REG_IRQFLAGS1
, 
RF_IRQFLAGS1_RSSI
 |

1230 
RF_IRQFLAGS1_PREAMBLEDETECT
 |

1231 
RF_IRQFLAGS1_SYNCADDRESSMATCH
 );

1232 
	`SX1272Wrôe
–
REG_IRQFLAGS2
, 
RF_IRQFLAGS2_FIFOOVERRUN
 );

1234 
	`TimîSt›
–&
RxTimeoutTimî
 );

1236 if–
SX1272
.
Sëtögs
.
Fsk
.
RxC⁄töuous
 =
Ál£
 )

1238 
	`TimîSt›
–&
RxTimeoutSyncW‹d
 );

1239 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1244 
	`SX1272Wrôe
–
REG_RXCONFIG
, 
	`SX1272Ród
–REG_RXCONFIG ) | 
RF_RXCONFIG_RESTARTRXWITHOUTPLLLOCK
 );

1245 
	`TimîSèπ
–&
RxTimeoutSyncW‹d
 );

1248 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
RxEº‹
 != NULL ) )

1250 
RadioEvíts
->
	`RxEº‹
( );

1252 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 = 
Ál£
;

1253 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
SyncW‹dDëe˘ed
 = 
Ál£
;

1254 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 = 0;

1255 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 = 0;

1261 if––
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 =0 ) && ( SX1272.Sëtögs.FskPackëH™dÀr.
NbByãs
 == 0 ) )

1263 if–
SX1272
.
Sëtögs
.
Fsk
.
FixLí
 =
Ál£
 )

1265 
	`SX1272RódFifo
––
uöt8_t
* )&
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
, 1 );

1269 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 = 
	`SX1272Ród
–
REG_PAYLOADLENGTH
 );

1271 
	`SX1272RódFifo
–
RxTxBuf„r
 + 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
, SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes );

1272 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 +–SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes );

1276 
	`SX1272RódFifo
–
RxTxBuf„r
 + 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
, SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes );

1277 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 +–SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes );

1280 
	`TimîSt›
–&
RxTimeoutTimî
 );

1282 if–
SX1272
.
Sëtögs
.
Fsk
.
RxC⁄töuous
 =
Ál£
 )

1284 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1285 
	`TimîSt›
–&
RxTimeoutSyncW‹d
 );

1290 
	`SX1272Wrôe
–
REG_RXCONFIG
, 
	`SX1272Ród
–REG_RXCONFIG ) | 
RF_RXCONFIG_RESTARTRXWITHOUTPLLLOCK
 );

1291 
	`TimîSèπ
–&
RxTimeoutSyncW‹d
 );

1294 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
RxD⁄e
 != NULL ) )

1296 
RadioEvíts
->
	`RxD⁄e
–
RxTxBuf„r
, 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
, SX1272.Sëtögs.FskPackëH™dÀr.
RssiVÆue
, 0 );

1298 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 = 
Ál£
;

1299 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
SyncW‹dDëe˘ed
 = 
Ál£
;

1300 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 = 0;

1301 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 = 0;

1303 
MODEM_LORA
:

1305 
öt8_t
 
¢r
 = 0;

1308 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_RXDONE
 );

1310 
úqFœgs
 = 
	`SX1272Ród
–
REG_LR_IRQFLAGS
 );

1311 if––
úqFœgs
 & 
RFLR_IRQFLAGS_PAYLOADCRCERROR_MASK
 ) =
RFLR_IRQFLAGS_PAYLOADCRCERROR
 )

1314 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_PAYLOADCRCERROR
 );

1316 if–
SX1272
.
Sëtögs
.
LoRa
.
RxC⁄töuous
 =
Ál£
 )

1318 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1320 
	`TimîSt›
–&
RxTimeoutTimî
 );

1322 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
RxEº‹
 != NULL ) )

1324 
RadioEvíts
->
	`RxEº‹
( );

1329 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
SƒVÆue
 = 
	`SX1272Ród
–
REG_LR_PKTSNRVALUE
 );

1330 if–
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
SƒVÆue
 & 0x80 )

1333 
¢r
 = ( ( ~
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
SƒVÆue
 + 1 ) & 0xFF ) >> 2;

1334 
¢r
 = -snr;

1339 
¢r
 = ( 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
SƒVÆue
 & 0xFF ) >> 2;

1342 
öt16_t
 
rssi
 = 
	`SX1272Ród
–
REG_LR_PKTRSSIVALUE
 );

1343 if–
¢r
 < 0 )

1345 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
RssiVÆue
 = 
RSSI_OFFSET
 + 
rssi
 + (Ñssi >> 4 ) +

1346 
¢r
;

1350 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
RssiVÆue
 = 
RSSI_OFFSET
 + 
rssi
 + (Ñssi >> 4 );

1353 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
Size
 = 
	`SX1272Ród
–
REG_LR_RXNBBYTES
 );

1354 
	`SX1272RódFifo
–
RxTxBuf„r
, 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
Size
 );

1356 if–
SX1272
.
Sëtögs
.
LoRa
.
RxC⁄töuous
 =
Ál£
 )

1358 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1360 
	`TimîSt›
–&
RxTimeoutTimî
 );

1362 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
RxD⁄e
 != NULL ) )

1364 
RadioEvíts
->
	`RxD⁄e
–
RxTxBuf„r
, 
SX1272
.
Sëtögs
.
LoRaPackëH™dÀr
.
Size
, SX1272.Sëtögs.LoRaPackëH™dÀr.
RssiVÆue
, SX1272.Sëtögs.LoRaPackëH™dÀr.
SƒVÆue
 );

1372 
RF_TX_RUNNING
:

1373 
	`TimîSt›
–&
TxTimeoutTimî
 );

1375  
SX1272
.
Sëtögs
.
Modem
 )

1377 
MODEM_LORA
:

1379 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_TXDONE
 );

1381 
MODEM_FSK
:

1383 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1384 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
TxD⁄e
 != NULL ) )

1386 
RadioEvíts
->
	`TxD⁄e
( );

1394 
	}
}

1396 
	$SX1272OnDio1Irq
( )

1398  
SX1272
.
Sëtögs
.
Sèã
 )

1400 
RF_RX_RUNNING
:

1401  
SX1272
.
Sëtögs
.
Modem
 )

1403 
MODEM_FSK
:

1406 if––
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 =0 ) && ( SX1272.Sëtögs.FskPackëH™dÀr.
NbByãs
 == 0 ) )

1408 if–
SX1272
.
Sëtögs
.
Fsk
.
FixLí
 =
Ál£
 )

1410 
	`SX1272RódFifo
––
uöt8_t
* )&
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
, 1 );

1414 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 = 
	`SX1272Ród
–
REG_PAYLOADLENGTH
 );

1418 if––
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 - SX1272.Sëtögs.FskPackëH™dÀr.
NbByãs
 ) > SX1272.Sëtögs.FskPackëH™dÀr.
FifoThªsh
 )

1420 
	`SX1272RódFifo
––
RxTxBuf„r
 + 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 ), SX1272.Sëtögs.FskPackëH™dÀr.
FifoThªsh
 );

1421 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 +SX1272.Sëtögs.FskPackëH™dÀr.
FifoThªsh
;

1425 
	`SX1272RódFifo
––
RxTxBuf„r
 + 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 ), SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes );

1426 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 +–SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes );

1429 
MODEM_LORA
:

1431 
	`TimîSt›
–&
RxTimeoutTimî
 );

1433 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_RXTIMEOUT
 );

1435 
SX1272
.
Sëtögs
.
Sèã
 = 
RF_IDLE
;

1436 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
RxTimeout
 != NULL ) )

1438 
RadioEvíts
->
	`RxTimeout
( );

1445 
RF_TX_RUNNING
:

1446  
SX1272
.
Sëtögs
.
Modem
 )

1448 
MODEM_FSK
:

1450 if––
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
Size
 - SX1272.Sëtögs.FskPackëH™dÀr.
NbByãs
 ) > SX1272.Sëtögs.FskPackëH™dÀr.
ChunkSize
 )

1452 
	`SX1272WrôeFifo
––
RxTxBuf„r
 + 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 ), SX1272.Sëtögs.FskPackëH™dÀr.
ChunkSize
 );

1453 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 +SX1272.Sëtögs.FskPackëH™dÀr.
ChunkSize
;

1458 
	`SX1272WrôeFifo
–
RxTxBuf„r
 + 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
, SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes );

1459 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
NbByãs
 +SX1272.Sëtögs.FskPackëH™dÀr.
Size
 - SX1272.Settings.FskPacketHandler.NbBytes;

1462 
MODEM_LORA
:

1471 
	}
}

1473 
	$SX1272OnDio2Irq
( )

1475  
SX1272
.
Sëtögs
.
Sèã
 )

1477 
RF_RX_RUNNING
:

1478  
SX1272
.
Sëtögs
.
Modem
 )

1480 
MODEM_FSK
:

1482 if–
SX1272
.
DIO4
.
p‹t
 =
NULL
 )

1484 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 = 
åue
;

1487 if––
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 =
åue
 ) && ( SX1272.Sëtögs.FskPackëH™dÀr.
SyncW‹dDëe˘ed
 =
Ál£
 ) )

1489 
	`TimîSt›
–&
RxTimeoutSyncW‹d
 );

1491 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
SyncW‹dDëe˘ed
 = 
åue
;

1493 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
RssiVÆue
 = -–
	`SX1272Ród
–
REG_RSSIVALUE
 ) >> 1 );

1495 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
AfcVÆue
 = ( 
öt32_t
 )–)–––
uöt16_t
 )
	`SX1272Ród
–
REG_AFCMSB
 ) << 8 ) |

1496 –
uöt16_t
 )
	`SX1272Ród
–
REG_AFCLSB
 ) ) *

1497 –)
FREQ_STEP
;

1498 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
RxGaö
 = ( 
	`SX1272Ród
–
REG_LNA
 ) >> 5 ) & 0x07;

1501 
MODEM_LORA
:

1502 if–
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 =
åue
 )

1505 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_FHSSCHANGEDCHANNEL
 );

1507 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
FhssCh™geCh™√l
 != NULL ) )

1509 
RadioEvíts
->
	`FhssCh™geCh™√l
––
	`SX1272Ród
–
REG_LR_HOPCHANNEL
 ) & 
RFLR_HOPCHANNEL_CHANNEL_MASK
 ) );

1517 
RF_TX_RUNNING
:

1518  
SX1272
.
Sëtögs
.
Modem
 )

1520 
MODEM_FSK
:

1522 
MODEM_LORA
:

1523 if–
SX1272
.
Sëtögs
.
LoRa
.
FªqH›On
 =
åue
 )

1526 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_FHSSCHANGEDCHANNEL
 );

1528 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
FhssCh™geCh™√l
 != NULL ) )

1530 
RadioEvíts
->
	`FhssCh™geCh™√l
––
	`SX1272Ród
–
REG_LR_HOPCHANNEL
 ) & 
RFLR_HOPCHANNEL_CHANNEL_MASK
 ) );

1541 
	}
}

1543 
	$SX1272OnDio3Irq
( )

1545  
SX1272
.
Sëtögs
.
Modem
 )

1547 
MODEM_FSK
:

1549 
MODEM_LORA
:

1550 if––
	`SX1272Ród
–
REG_LR_IRQFLAGS
 ) & 
RFLR_IRQFLAGS_CADDETECTED
 ) == RFLR_IRQFLAGS_CADDETECTED )

1553 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_CADDETECTED
 | 
RFLR_IRQFLAGS_CADDONE
 );

1554 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
CadD⁄e
 != NULL ) )

1556 
RadioEvíts
->
	`CadD⁄e
–
åue
 );

1562 
	`SX1272Wrôe
–
REG_LR_IRQFLAGS
, 
RFLR_IRQFLAGS_CADDONE
 );

1563 if––
RadioEvíts
 !
NULL
 ) && ( RadioEvíts->
CadD⁄e
 != NULL ) )

1565 
RadioEvíts
->
	`CadD⁄e
–
Ál£
 );

1572 
	}
}

1574 
	$SX1272OnDio4Irq
( )

1576  
SX1272
.
Sëtögs
.
Modem
 )

1578 
MODEM_FSK
:

1580 if–
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 =
Ál£
 )

1582 
SX1272
.
Sëtögs
.
FskPackëH™dÀr
.
PªambÀDëe˘ed
 = 
åue
;

1586 
MODEM_LORA
:

1591 
	}
}

1593 
	$SX1272OnDio5Irq
( )

1595  
SX1272
.
Sëtögs
.
Modem
 )

1597 
MODEM_FSK
:

1599 
MODEM_LORA
:

1604 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\adc.c

15 
	~"bﬂrd.h
"

16 
	~"adc-bﬂrd.h
"

21 
boﬁ
 
	gAdcInôülized
 = 
Ál£
;

23 
	$AdcInô
–
Adc_t
 *
obj
, 
PöNames
 
adcI≈ut
 )

25 if–
AdcInôülized
 =
Ál£
 )

27 
AdcInôülized
 = 
åue
;

29 
	`AdcMcuInô
–
obj
, 
adcI≈ut
 );

30 
	`AdcMcuC⁄fig
( );

32 
	}
}

34 
	$AdcDeInô
–
Adc_t
 *
obj
 )

36 
AdcInôülized
 = 
Ál£
;

37 
	}
}

39 
uöt16_t
 
	$AdcRódCh™√l
–
Adc_t
 *
obj
, 
uöt32_t
 
ch™√l
 )

41 if–
AdcInôülized
 =
åue
 )

43  
	`AdcMcuRódCh™√l
–
obj
, 
ch™√l
 );

49 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\delay.c

15 
	~"bﬂrd.h
"

17 
	$Dñay
–
s
 )

19 
	`DñayMs
–
s
 * 1000.0f );

20 
	}
}

22 
	$DñayMs
–
uöt32_t
 
ms
 )

24 
	`HAL_Dñay
–
ms
 );

25 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\fifo.c

15 
	~"fifo.h
"

17 
uöt16_t
 
	$FifoNext
–
Fifo_t
 *
fifo
, 
uöt16_t
 
ödex
 )

19  ( 
ödex
 + 1 ) % 
fifo
->
Size
;

20 
	}
}

22 
	$FifoInô
–
Fifo_t
 *
fifo
, 
uöt8_t
 *
buf„r
, 
uöt16_t
 
size
 )

24 
fifo
->
Begö
 = 0;

25 
fifo
->
End
 = 0;

26 
fifo
->
D©a
 = 
buf„r
;

27 
fifo
->
Size
 = 
size
;

28 
	}
}

30 
	$FifoPush
–
Fifo_t
 *
fifo
, 
uöt8_t
 
d©a
 )

32 
fifo
->
End
 = 
	`FifoNext
( fifo, fifo->End );

33 
fifo
->
D©a
[fifo->
End
] = 
d©a
;

34 
	}
}

36 
uöt8_t
 
	$FifoP›
–
Fifo_t
 *
fifo
 )

38 
uöt8_t
 
d©a
 = 
fifo
->
D©a
[
	`FifoNext
–fifo, fifo->
Begö
 )];

40 
fifo
->
Begö
 = 
	`FifoNext
( fifo, fifo->Begin );

41  
d©a
;

42 
	}
}

44 
	$FifoFlush
–
Fifo_t
 *
fifo
 )

46 
fifo
->
Begö
 = 0;

47 
fifo
->
End
 = 0;

48 
	}
}

50 
boﬁ
 
	$IsFifoEm±y
–
Fifo_t
 *
fifo
 )

52  ( 
fifo
->
Begö
 =fifo->
End
 );

53 
	}
}

55 
boﬁ
 
	$IsFifoFuŒ
–
Fifo_t
 *
fifo
 )

57  ( 
	`FifoNext
–
fifo
, fifo->
End
 ) =fifo->
Begö
 );

58 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\gpio.c

19 
	~"bﬂrd.h
"

21 
	~"gpio-bﬂrd.h
"

23 #i‡
deföed
–
BOARD_IOE_EXT
 )

24 
	~"gpio-i€.h
"

27 
	$GpioInô
–
Gpio_t
 *
obj
, 
PöNames
 
pö
, 
PöModes
 
mode
, 
PöC⁄figs
 
c⁄fig
, 
PöTy≥s
 
ty≥
, 
uöt32_t
 
vÆue
 )

29 if––
uöt32_t
 )–
pö
 >> 4 ) <= 6 )

31 
	`GpioMcuInô
–
obj
, 
pö
, 
mode
, 
c⁄fig
, 
ty≥
, 
vÆue
 );

35 #i‡
	`deföed
–
BOARD_IOE_EXT
 )

37 
	`GpioI€Inô
–
obj
, 
pö
, 
mode
, 
c⁄fig
, 
ty≥
, 
vÆue
 );

40 
	}
}

42 
	$GpioSëI¡îru±
–
Gpio_t
 *
obj
, 
IrqModes
 
úqMode
, 
IrqPri‹ôõs
 
úqPri‹ôy
, 
GpioIrqH™dÀr
 *
úqH™dÀr
 )

44 if––
uöt32_t
 )–
obj
->
pö
 >> 4 ) <= 6 )

46 
	`GpioMcuSëI¡îru±
–
obj
, 
úqMode
, 
úqPri‹ôy
, 
úqH™dÀr
 );

50 #i‡
	`deföed
–
BOARD_IOE_EXT
 )

52 
	`GpioI€SëI¡îru±
–
obj
, 
úqMode
, 
úqPri‹ôy
, 
úqH™dÀr
 );

55 
	}
}

57 
	$GpioRemoveI¡îru±
–
Gpio_t
 *
obj
 )

59 if––
uöt32_t
 )–
obj
->
pö
 >> 4 ) <= 6 )

65 #i‡
	`deföed
–
BOARD_IOE_EXT
 )

70 
	}
}

72 
	$GpioWrôe
–
Gpio_t
 *
obj
, 
uöt32_t
 
vÆue
 )

74 if––
uöt32_t
 )–
obj
->
pö
 >> 4 ) <= 6 )

76 
	`GpioMcuWrôe
–
obj
, 
vÆue
 );

80 #i‡
	`deföed
–
BOARD_IOE_EXT
 )

82 
	`GpioI€Wrôe
–
obj
, 
vÆue
 );

85 
	}
}

87 
	$GpioToggÀ
–
Gpio_t
 *
obj
 )

89 if––
uöt32_t
 )–
obj
->
pö
 >> 4 ) <= 6 )

91 
	`GpioMcuToggÀ
–
obj
 );

95 #i‡
	`deföed
–
BOARD_IOE_EXT
 )

97 
	`GpioI€Wrôe
–
obj
, 
	`GpioI€Ród
( obj ) ^ 1 );

100 
	}
}

102 
uöt32_t
 
	$GpioRód
–
Gpio_t
 *
obj
 )

104 if––
uöt32_t
 )–
obj
->
pö
 >> 4 ) <= 6 )

106  
	`GpioMcuRód
–
obj
 );

110 #i‡
	`deföed
–
BOARD_IOE_EXT
 )

112  
	`GpioI€Ród
–
obj
 );

117 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\i2c.c

15 
	~"bﬂrd.h
"

16 
	~"i2c-bﬂrd.h
"

21 
boﬁ
 
	gI2cInôülized
 = 
Ál£
;

23 
	$I2cInô
–
I2c_t
 *
obj
, 
PöNames
 
s˛
, PöName†
sda
 )

25 if–
I2cInôülized
 =
Ál£
 )

27 
I2cInôülized
 = 
åue
;

29 
	`I2cMcuInô
–
obj
, 
s˛
, 
sda
 );

30 
	`I2cMcuF‹m©
–
obj
, 
MODE_I2C
, 
I2C_DUTY_CYCLE_2
, 
åue
, 
I2C_ACK_ADD_7_BIT
, 400000 );

32 
	}
}

34 
	$I2cDeInô
–
I2c_t
 *
obj
 )

36 
I2cInôülized
 = 
Ál£
;

37 
	`I2cMcuDeInô
–
obj
 );

38 
	}
}

40 
	$I2cRe£tBus
–
I2c_t
 *
obj
 )

42 
I2cInôülized
 = 
Ál£
;

43 
	`I2cInô
–
obj
, 
I2C_SCL
, 
I2C_SDA
 );

44 
	}
}

46 
uöt8_t
 
	$I2cWrôe
–
I2c_t
 *
obj
, 
uöt8_t
 
devi˚Addr
, 
uöt16_t
 
addr
, uöt8_à
d©a
 )

48 if–
I2cInôülized
 =
åue
 )

50 if–
	`I2cMcuWrôeBuf„r
–
obj
, 
devi˚Addr
, 
addr
, &
d©a
, 1 ) =
FAIL
 )

53 if–
	`I2cMcuWrôeBuf„r
–
obj
, 
devi˚Addr
, 
addr
, &
d©a
, 1 ) =
FAIL
 )

55  
FAIL
;

59  
SUCCESS
;

64  
SUCCESS
;

69  
FAIL
;

71 
	}
}

73 
uöt8_t
 
	$I2cWrôeBuf„r
–
I2c_t
 *
obj
, 
uöt8_t
 
devi˚Addr
, 
uöt16_t
 
addr
, uöt8_à*
buf„r
, uöt16_à
size
 )

75 if–
I2cInôülized
 =
åue
 )

77 if–
	`I2cMcuWrôeBuf„r
–
obj
, 
devi˚Addr
, 
addr
, 
buf„r
, 
size
 ) =
FAIL
 )

80 if–
	`I2cMcuWrôeBuf„r
–
obj
, 
devi˚Addr
, 
addr
, 
buf„r
, 
size
 ) =
FAIL
 )

82  
FAIL
;

86  
SUCCESS
;

91  
SUCCESS
;

96  
FAIL
;

98 
	}
}

100 
uöt8_t
 
	$I2cRód
–
I2c_t
 *
obj
, 
uöt8_t
 
devi˚Addr
, 
uöt16_t
 
addr
, uöt8_à*
d©a
 )

102 if–
I2cInôülized
 =
åue
 )

104 –
	`I2cMcuRódBuf„r
–
obj
, 
devi˚Addr
, 
addr
, 
d©a
, 1 ) );

108  
FAIL
;

110 
	}
}

112 
uöt8_t
 
	$I2cRódBuf„r
–
I2c_t
 *
obj
, 
uöt8_t
 
devi˚Addr
, 
uöt16_t
 
addr
, uöt8_à*
buf„r
, uöt16_à
size
 )

114 if–
I2cInôülized
 =
åue
 )

116 –
	`I2cMcuRódBuf„r
–
obj
, 
devi˚Addr
, 
addr
, 
buf„r
, 
size
 ) );

120  
FAIL
;

122 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\timer.c

15 
	~"bﬂrd.h
"

16 
	~"πc-bﬂrd.h
"

22 vﬁ©ûê
uöt8_t
 
	gHasLo›edThroughMaö
 = 0;

27 
TimîEvít_t
 *
	gTimîLi°Hód
 = 
NULL
;

38 
TimîIn£πNewHódTimî
–
TimîEvít_t
 *
obj
, 
uöt32_t
 
ªmaöögTime
 );

49 
TimîIn£πTimî
–
TimîEvít_t
 *
obj
, 
uöt32_t
 
ªmaöögTime
 );

56 
TimîSëTimeout
–
TimîEvít_t
 *
obj
 );

64 
boﬁ
 
TimîExi°s
–
TimîEvít_t
 *
obj
 );

71 
TimîTime_t
 
TimîGëVÆue
( );

73 
TimîInô
–
TimîEvít_t
 *
obj
, –*
ˇŒback
 )( ) )

75 
obj
->
Time°amp
 = 0;

76 
obj
->
RñﬂdVÆue
 = 0;

77 
obj
->
IsRu¬ög
 = 
Ál£
;

78 
obj
->
CÆlback
 = 
ˇŒback
;

79 
obj
->
Next
 = 
NULL
;

80 
	}
}

82 
	$TimîSèπ
–
TimîEvít_t
 *
obj
 )

84 
uöt32_t
 
ñ≠£dTime
 = 0;

85 
uöt32_t
 
ªmaöögTime
 = 0;

87 
	`BﬂrdDißbÀIrq
( );

89 if––
obj
 =
NULL
 ) || ( 
	`TimîExi°s
–obj ) =
åue
 ) )

91 
	`BﬂrdE«bÀIrq
( );

95 
obj
->
Time°amp
 = obj->
RñﬂdVÆue
;

96 
obj
->
IsRu¬ög
 = 
Ál£
;

98 if–
TimîLi°Hód
 =
NULL
 )

100 
	`TimîIn£πNewHódTimî
–
obj
, obj->
Time°amp
 );

104 if–
TimîLi°Hód
->
IsRu¬ög
 =
åue
 )

106 
ñ≠£dTime
 = 
	`TimîGëVÆue
( );

107 if–
ñ≠£dTime
 > 
TimîLi°Hód
->
Time°amp
 )

109 
ñ≠£dTime
 = 
TimîLi°Hód
->
Time°amp
;

111 
ªmaöögTime
 = 
TimîLi°Hód
->
Time°amp
 - 
ñ≠£dTime
;

115 
ªmaöögTime
 = 
TimîLi°Hód
->
Time°amp
;

118 if–
obj
->
Time°amp
 < 
ªmaöögTime
 )

120 
	`TimîIn£πNewHódTimî
–
obj
, 
ªmaöögTime
 );

124 
	`TimîIn£πTimî
–
obj
, 
ªmaöögTime
 );

127 
	`BﬂrdE«bÀIrq
( );

128 
	}
}

130 
	$TimîIn£πTimî
–
TimîEvít_t
 *
obj
, 
uöt32_t
 
ªmaöögTime
 )

132 
uöt32_t
 
aggªg©edTime°amp
 = 0;

133 
uöt32_t
 
aggªg©edTime°ampNext
 = 0;

135 
TimîEvít_t
* 
¥ev
 = 
TimîLi°Hód
;

136 
TimîEvít_t
* 
cur
 = 
TimîLi°Hód
->
Next
;

138 if–
cur
 =
NULL
 )

140 
obj
->
Time°amp
 -
ªmaöögTime
;

141 
¥ev
->
Next
 = 
obj
;

142 
obj
->
Next
 = 
NULL
;

146 
aggªg©edTime°amp
 = 
ªmaöögTime
;

147 
aggªg©edTime°ampNext
 = 
ªmaöögTime
 + 
cur
->
Time°amp
;

149  
¥ev
 !
NULL
 )

151 if–
aggªg©edTime°ampNext
 > 
obj
->
Time°amp
 )

153 
obj
->
Time°amp
 -
aggªg©edTime°amp
;

154 if–
cur
 !
NULL
 )

156 
cur
->
Time°amp
 -
obj
->Timestamp;

158 
¥ev
->
Next
 = 
obj
;

159 
obj
->
Next
 = 
cur
;

164 
¥ev
 = 
cur
;

165 
cur
 = cur->
Next
;

166 if–
cur
 =
NULL
 )

168 
aggªg©edTime°amp
 = 
aggªg©edTime°ampNext
;

169 
obj
->
Time°amp
 -
aggªg©edTime°amp
;

170 
¥ev
->
Next
 = 
obj
;

171 
obj
->
Next
 = 
NULL
;

176 
aggªg©edTime°amp
 = 
aggªg©edTime°ampNext
;

177 
aggªg©edTime°ampNext
 =ággªg©edTime°ampNexà+ 
cur
->
Time°amp
;

182 
	}
}

184 
	$TimîIn£πNewHódTimî
–
TimîEvít_t
 *
obj
, 
uöt32_t
 
ªmaöögTime
 )

186 
TimîEvít_t
* 
cur
 = 
TimîLi°Hód
;

188 if–
cur
 !
NULL
 )

190 
cur
->
Time°amp
 = 
ªmaöögTime
 - 
obj
->Timestamp;

191 
cur
->
IsRu¬ög
 = 
Ál£
;

194 
obj
->
Next
 = 
cur
;

195 
obj
->
IsRu¬ög
 = 
åue
;

196 
TimîLi°Hód
 = 
obj
;

197 
	`TimîSëTimeout
–
TimîLi°Hód
 );

198 
	}
}

200 
	$TimîIrqH™dÀr
( )

202 
uöt32_t
 
ñ≠£dTime
 = 0;

205 i‡–
TimîLi°Hód
 =
NULL
 )

210 
ñ≠£dTime
 = 
	`TimîGëVÆue
( );

212 if–
ñ≠£dTime
 >
TimîLi°Hód
->
Time°amp
 )

214 
TimîLi°Hód
->
Time°amp
 = 0;

218 
TimîLi°Hód
->
Time°amp
 -
ñ≠£dTime
;

221 
TimîLi°Hód
->
IsRu¬ög
 = 
Ál£
;

223  ( 
TimîLi°Hód
 !
NULL
 ) && ( TimîLi°Hód->
Time°amp
 == 0 ) )

225 
TimîEvít_t
* 
ñ≠£dTimî
 = 
TimîLi°Hód
;

226 
TimîLi°Hód
 = TimîLi°Hód->
Next
;

228 if–
ñ≠£dTimî
->
CÆlback
 !
NULL
 )

230 
ñ≠£dTimî
->
	`CÆlback
( );

235 if–
TimîLi°Hód
 !
NULL
 )

237 if–
TimîLi°Hód
->
IsRu¬ög
 !
åue
 )

239 
TimîLi°Hód
->
IsRu¬ög
 = 
åue
;

240 
	`TimîSëTimeout
–
TimîLi°Hód
 );

243 
	}
}

245 
	$TimîSt›
–
TimîEvít_t
 *
obj
 )

247 
	`BﬂrdDißbÀIrq
( );

249 
uöt32_t
 
ñ≠£dTime
 = 0;

250 
uöt32_t
 
ªmaöögTime
 = 0;

252 
TimîEvít_t
* 
¥ev
 = 
TimîLi°Hód
;

253 
TimîEvít_t
* 
cur
 = 
TimîLi°Hód
;

256 if––
TimîLi°Hód
 =
NULL
 ) || ( 
obj
 == NULL ) )

258 
	`BﬂrdE«bÀIrq
( );

262 if–
TimîLi°Hód
 =
obj
 )

264 if–
TimîLi°Hód
->
IsRu¬ög
 =
åue
 )

266 
ñ≠£dTime
 = 
	`TimîGëVÆue
( );

267 if–
ñ≠£dTime
 > 
obj
->
Time°amp
 )

269 
ñ≠£dTime
 = 
obj
->
Time°amp
;

272 
ªmaöögTime
 = 
obj
->
Time°amp
 - 
ñ≠£dTime
;

274 if–
TimîLi°Hód
->
Next
 !
NULL
 )

276 
TimîLi°Hód
->
IsRu¬ög
 = 
Ál£
;

277 
TimîLi°Hód
 = TimîLi°Hód->
Next
;

278 
TimîLi°Hód
->
Time°amp
 +
ªmaöögTime
;

279 
TimîLi°Hód
->
IsRu¬ög
 = 
åue
;

280 
	`TimîSëTimeout
–
TimîLi°Hód
 );

284 
TimîLi°Hód
 = 
NULL
;

289 if–
TimîLi°Hód
->
Next
 !
NULL
 )

291 
ªmaöögTime
 = 
obj
->
Time°amp
;

292 
TimîLi°Hód
 = TimîLi°Hód->
Next
;

293 
TimîLi°Hód
->
Time°amp
 +
ªmaöögTime
;

297 
TimîLi°Hód
 = 
NULL
;

303 
ªmaöögTime
 = 
obj
->
Time°amp
;

305  
cur
 !
NULL
 )

307 if–
cur
 =
obj
 )

309 if–
cur
->
Next
 !
NULL
 )

311 
cur
 = cur->
Next
;

312 
¥ev
->
Next
 = 
cur
;

313 
cur
->
Time°amp
 +
ªmaöögTime
;

317 
cur
 = 
NULL
;

318 
¥ev
->
Next
 = 
cur
;

324 
¥ev
 = 
cur
;

325 
cur
 = cur->
Next
;

329 
	`BﬂrdE«bÀIrq
( );

330 
	}
}

332 
boﬁ
 
	$TimîExi°s
–
TimîEvít_t
 *
obj
 )

334 
TimîEvít_t
* 
cur
 = 
TimîLi°Hód
;

336  
cur
 !
NULL
 )

338 if–
cur
 =
obj
 )

340  
åue
;

342 
cur
 = cur->
Next
;

344  
Ál£
;

345 
	}
}

347 
	$TimîRe£t
–
TimîEvít_t
 *
obj
 )

349 
	`TimîSt›
–
obj
 );

350 
	`TimîSèπ
–
obj
 );

351 
	}
}

353 
	$TimîSëVÆue
–
TimîEvít_t
 *
obj
, 
uöt32_t
 
vÆue
 )

355 
	`TimîSt›
–
obj
 );

356 
obj
->
Time°amp
 = 
vÆue
;

357 
obj
->
RñﬂdVÆue
 = 
vÆue
;

358 
	}
}

360 
TimîTime_t
 
	$TimîGëVÆue
( )

362  
	`RtcGëEœp£dAœrmTime
( );

363 
	}
}

365 
TimîTime_t
 
	$TimîGëCuºítTime
( )

367  
	`RtcGëTimîVÆue
( );

368 
	}
}

370 
TimîTime_t
 
	$TimîGëEœp£dTime
–
TimîTime_t
 
ßvedTime
 )

372  
	`RtcCompuãEœp£dTime
–
ßvedTime
 );

373 
	}
}

375 
TimîTime_t
 
	$TimîGëFutuªTime
–
TimîTime_t
 
evítInFutuª
 )

377  
	`RtcCompuãFutuªEvítTime
–
evítInFutuª
 );

378 
	}
}

380 
	$TimîSëTimeout
–
TimîEvít_t
 *
obj
 )

382 
HasLo›edThroughMaö
 = 0;

383 
obj
->
Time°amp
 = 
	`RtcGëAdju°edTimeoutVÆue
( obj->Timestamp );

384 
	`RtcSëTimeout
–
obj
->
Time°amp
 );

385 
	}
}

387 
	$TimîLowPowîH™dÀr
( )

389 if––
TimîLi°Hód
 !
NULL
 ) && ( TimîLi°Hód->
IsRu¬ög
 =
åue
 ) )

391 if–
HasLo›edThroughMaö
 < 5 )

393 
HasLo›edThroughMaö
++;

397 
HasLo›edThroughMaö
 = 0;

398 if–
	`GëBﬂrdPowîSour˚
–Ë=
BATTERY_POWER
 )

400 
	`RtcE¡îLowPowîSt›Mode
( );

404 
	}
}

	@C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\uart.c

15 
	~"bﬂrd.h
"

16 
	~"u¨t-bﬂrd.h
"

17 #i‡
deföed
–
USE_USB_CDC
 )

18 
	~"u¨t-usb-bﬂrd.h
"

21 
	~"u¨t.h
"

27 
	#TX_BUFFER_RETRY_COUNT
 10

	)

29 
	$U¨tInô
–
U¨t_t
 *
obj
, 
uöt8_t
 
u¨tId
, 
PöNames
 
tx
, PöName†
rx
 )

31 if–
obj
->
IsInôülized
 =
Ál£
 )

33 
obj
->
IsInôülized
 = 
åue
;

35 if–
u¨tId
 =
UART_USB_CDC
 )

37 #i‡
	`deföed
–
USE_USB_CDC
 )

38 
	`U¨tUsbInô
–
obj
, 
u¨tId
, 
NC
, NC );

43 
	`U¨tMcuInô
–
obj
, 
u¨tId
, 
tx
, 
rx
 );

46 
	}
}

48 
	$U¨tC⁄fig
–
U¨t_t
 *
obj
, 
U¨tMode_t
 
mode
, 
uöt32_t
 
baudøã
, 
W‹dLígth_t
 
w‹dLígth
, 
St›Bôs_t
 
°›Bôs
, 
P¨ôy_t
 
∑rôy
, 
FlowCål_t
 
ÊowCål
 )

50 if–
obj
->
IsInôülized
 =
Ál£
 )

53 
	`as£π_∑øm
–
FAIL
 );

55 if–
obj
->
U¨tId
 =
UART_USB_CDC
 )

57 #i‡
	`deföed
–
USE_USB_CDC
 )

58 
	`U¨tUsbC⁄fig
–
obj
, 
mode
, 
baudøã
, 
w‹dLígth
, 
°›Bôs
, 
∑rôy
, 
ÊowCål
 );

63 
	`U¨tMcuC⁄fig
–
obj
, 
mode
, 
baudøã
, 
w‹dLígth
, 
°›Bôs
, 
∑rôy
, 
ÊowCål
 );

65 
	}
}

67 
	$U¨tDeInô
–
U¨t_t
 *
obj
 )

69 
obj
->
IsInôülized
 = 
Ál£
;

70 if–
obj
->
U¨tId
 =
UART_USB_CDC
 )

72 #i‡
	`deföed
–
USE_USB_CDC
 )

73 
	`U¨tUsbDeInô
–
obj
 );

78 
	`U¨tMcuDeInô
–
obj
 );

80 
	}
}

82 
uöt8_t
 
	$U¨tPutCh¨
–
U¨t_t
 *
obj
, 
uöt8_t
 
d©a
 )

84 if–
obj
->
U¨tId
 =
UART_USB_CDC
 )

86 #i‡
	`deföed
–
USE_USB_CDC
 )

87  
	`U¨tUsbPutCh¨
–
obj
, 
d©a
 );

94  
	`U¨tMcuPutCh¨
–
obj
, 
d©a
 );

96 
	}
}

98 
uöt8_t
 
	$U¨tGëCh¨
–
U¨t_t
 *
obj
, 
uöt8_t
 *
d©a
 )

100 if–
obj
->
U¨tId
 =
UART_USB_CDC
 )

102 #i‡
	`deföed
–
USE_USB_CDC
 )

103  
	`U¨tUsbGëCh¨
–
obj
, 
d©a
 );

110  
	`U¨tMcuGëCh¨
–
obj
, 
d©a
 );

112 
	}
}

114 
uöt8_t
 
	$U¨tPutBuf„r
–
U¨t_t
 *
obj
, 
uöt8_t
 *
buf„r
, 
uöt16_t
 
size
 )

116 if–
obj
->
U¨tId
 =
UART_USB_CDC
 )

118 #i‡
	`deföed
–
USE_USB_CDC
 )

119  
	`U¨tUsbPutBuf„r
–
obj
, 
buf„r
, 
size
 );

126 
uöt8_t
 
ªåyCou¡
;

127 
uöt16_t
 
i
;

129  
i
 = 0; i < 
size
; i++ )

131 
ªåyCou¡
 = 0;

132  
	`U¨tPutCh¨
–
obj
, 
buf„r
[
i
] ) != 0 )

134 
ªåyCou¡
++;

137 if–
ªåyCou¡
 > 
TX_BUFFER_RETRY_COUNT
 )

145 
	}
}

147 
uöt8_t
 
	$U¨tGëBuf„r
–
U¨t_t
 *
obj
, 
uöt8_t
 *
buf„r
, 
uöt16_t
 
size
, uöt16_à*
nbRódByãs
 )

149 
uöt16_t
 
loˇlSize
 = 0;

151  
loˇlSize
 < 
size
 )

153 if–
	`U¨tGëCh¨
–
obj
, 
buf„r
 + 
loˇlSize
 ) == 0 )

155 
loˇlSize
++;

163 *
nbRódByãs
 = 
loˇlSize
;

165 if–
loˇlSize
 == 0 )

170 
	}
}

	@
1
.
0
49
7087
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\apps\Receive-Ping-Florent\XRange\main.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\adc-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\cmsis\arm-gcc\startup_stm32l151xc.s
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\cmsis\system_stm32l1xx.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\gpio-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\i2c-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\rtc-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\spi-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\sx1272-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\uart-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\uart-usb-board.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\usb\cdc\src\usbd_cdc_if.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\usb\cdc\src\usbd_conf.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\XRange\usb\cdc\src\usbd_desc.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Inc\stm32l1xx_hal_def.h
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_adc.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_adc_ex.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_cortex.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_dma.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_gpio.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_i2c.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pcd.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pcd_ex.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pwr.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_pwr_ex.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rcc.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rcc_ex.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rtc.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_rtc_ex.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_spi.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_spi_ex.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32L1xx_HAL_Driver\Src\stm32l1xx_hal_uart.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Class\CDC\Src\usbd_cdc.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Core\Src\usbd_core.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Core\Src\usbd_ctlreq.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\STM32_USB_Device_Library\Core\Src\usbd_ioreq.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\sysIrqHandlers.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\boards\mcu\stm32\utilities.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\radio\radio.h
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\radio\sx1272\sx1272.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\adc.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\delay.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\fifo.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\gpio.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\i2c.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\timer.c
C:\Users\florent\Documents\homenolot\doc\Recherche\WaspMote\LoRa-Netblocks\XRange-master\LoRaMac\src\system\uart.c
